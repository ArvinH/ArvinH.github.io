{"componentChunkName":"component---src-templates-tag-tsx","path":"/tags/web","result":{"pageContext":{"posts":[{"excerpt":"chromium æ‰‹ä¸‹ç•™æƒ…ï¼Œåˆ¥å»¢æ‰ SVG SMIL å‘€ï¼","html":"<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-additive.svg\" alt=\"animate values attribute demo\">\n</p>\n<p>chromium æ‰‹ä¸‹ç•™æƒ…ï¼Œåˆ¥å»¢æ‰ SVG SMIL å‘€ï¼</p>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>å‰å¹¾å€‹ç¦®æ‹œçœ‹åˆ° jotai çš„ä½œè€…æ¨æ–‡æåˆ° jotai çš„ logo ç”¨äº† <code class=\"language-text\">animateTransform</code> ä¾†è£½ä½œå‹•ç•«ï¼ˆä¸çŸ¥é“ jotai çš„å¯ä»¥çœ‹é€™ç¯‡ - <a href=\"https://blog.techbridge.cc/2021/03/01/jotai-intro/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JÅtai ä»‹ç´¹</a>ï¼‰ï¼š</p>\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">If you are not familiar with SVG animation, check this out. jotai <a href=\"https://t.co/Zadia8oug7\">https://t.co/Zadia8oug7</a> ğŸ‘» logo is using &lt;animateTransform&gt;. <a href=\"https://t.co/vll2SU5f16\">pic.twitter.com/vll2SU5f16</a></p>&mdash; Daishi Kato (@dai_shi) <a href=\"https://twitter.com/dai_shi/status/1401516470882893827?ref_src=twsrc%5Etfw\">June 6, 2021</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<img src=\"https://raw.githubusercontent.com/pmndrs/jotai/master/img/title.svg\" alt=\"jotai logo\">\n<p>(è¦ç­‰ä¸€æœƒå…’æ‰æœƒå‡ºç¾...å¦‚æœæ²’æœ‰ï¼Œå¯èƒ½æ˜¯ cache å•é¡Œï¼Œå¯ä»¥é»<a href=\"https://raw.githubusercontent.com/pmndrs/jotai/master/img/title.svg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ­¤</a>é–‹æ–°é æŸ¥çœ‹ã€‚)</p>\n<p>svg æª”æ¡ˆæœƒå‹•ä¸ç¨€å¥‡ï¼Œåƒæ˜¯<a href=\"https://blog.techbridge.cc/2019/11/06/svg-animation-in-10mins/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ååˆ†é˜ã€äº”æ­¥é©Ÿï¼ŒSVG å‹•èµ·ä¾†ï¼</a>ä¸­ä»‹ç´¹çš„ï¼Œé€éç¬¬ä¸‰æ–¹å¥—ä»¶å¯ä»¥å¾ˆå®¹æ˜“é”æˆï¼Œæˆ–æ˜¯ç”¨ä¸€äº›ç¹ªåœ–ã€å‹•ç•«å·¥å…·ä¹Ÿè¡Œï¼Œä¾‹å¦‚ï¼š<a href=\"https://app.svgator.com/#/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SVGator</a>ï¼Œä¸éé€™äº›éƒ½å¾—æ­é… JavaScriptï¼Œç„¶è€Œç°¡å–®çš„å‹•ç•«åªè¦åˆ©ç”¨ SVG æ”¯æ´çš„èªæ³•å³å¯é”æˆï¼</p>\n<p>ä»Šå¤©å°±ä¸€èµ·ä¾†äº†è§£ä¸€ä¸‹ï¼Œæ€éº¼åœ¨ä¸é å…¶å®ƒå¥—ä»¶çš„ç‹€æ³ä¸‹ï¼Œå–®ç´”çš„è£½ä½œ SVG å‹•ç•«ã€‚</p>\n<h2 id=\"svg-animation-with-smil\" style=\"position:relative;\"><a href=\"#svg-animation-with-smil\" aria-label=\"svg animation with smil permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SVG animation with SMIL</h2>\n<p>èƒ½è®“ SVG ä¸é  JavaScript èˆ‡ CSS å°±èƒ½å‹•èµ·ä¾†æ˜¯å› ç‚ºä½¿ç”¨äº† <a href=\"https://www.w3.org/TR/REC-smil\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SMILï¼ˆSynchronized Multimedia Integration Languageï¼‰</a>ï¼ŒéŸ³åŒ smileï¼Œæ˜¯ W3C çš„æ¨™æº–ä¹‹ä¸€ï¼Œæ—¨åœ¨ä»¥ XML æ ¼å¼æä¾›å¤šåª’é«”çš„äº¤äº’è¡¨ç¾ï¼ˆç™½è©±é»å…¶å¯¦å°±æ˜¯å‹•ç•«ï¼‰ï¼Œæ˜¯ Web ä¸Šå‹•ç•«çš„é–‹è·¯å…ˆé‹’ï¼Œå•Ÿç™¼äº† Web animation èˆ‡ CSS animationã€‚SVG èˆ‡ SMIL çš„é–‹ç™¼åœ˜éšŠåˆä½œï¼Œè®“ SVG èƒ½åˆ©ç”¨ SMIL é”åˆ°å¦‚ä¸‹æ•ˆæœï¼š</p>\n<ul>\n<li>å‹•ç•«åŒ–å…ƒç´ çš„æ•¸å€¼å±¬æ€§ï¼ˆx, y å€¼ç­‰ç­‰)</li>\n<li>å‹•ç•«åŒ–å…ƒç´ çš„ transform å±¬æ€§ï¼ˆå¹³ç§»ã€æ—‹è½‰ï¼‰</li>\n<li>å‹•ç•«åŒ–å…ƒç´ é¡è‰²</li>\n<li>è»Œè·¡è·¯ç·šç§»å‹•å‹•ç•«ï¼Œé¡ä¼¼æ–¼ <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/offset-path\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CSS ä¸­çš„ <code class=\"language-text\">offset-path</code></a></li>\n</ul>\n<p>å…‰æ˜¯é€™äº›ç‰¹æ€§å°±å¤ æˆ‘å€‘çµ„åˆå‡ºå¾ˆå¤šç¨®çš„å‹•ç•«äº†ï¼Œé‚„ä¸éœ€è¦ JavaScript èˆ‡ CSS çš„è¼”åŠ©ã€‚</p>\n<p>ä½¿ç”¨æ–¹æ³•ä¹Ÿä¸é›£ï¼Œåªè¦åœ¨ SVG å…ƒç´ å…§ç½®å…¥ä»¥ä¸‹å››ç¨®å…ƒç´ å³å¯æ“ä½œå‹•ç•«ï¼š</p>\n<ol>\n<li><code class=\"language-text\">&lt;set></code></li>\n<li><code class=\"language-text\">&lt;animate></code></li>\n<li><code class=\"language-text\">&lt;animateTransform></code></li>\n<li><code class=\"language-text\">&lt;animateMotion></code></li>\n</ol>\n<p>æ¥è‘—æˆ‘å€‘é‡å°é€™å››ç¨®å…ƒç´ ä¸€ä¸€ä»‹ç´¹ã€‚</p>\n<p>ä¸éåœ¨é–‹å§‹å‰ï¼Œæœ‰å€‹å°æ’æ›²å€¼å¾—ä¸€æã€‚</p>\n<p>SMIL é€™å€‹æ¨™æº–å…¶å¯¦åœ¨ 2015 å¹´çš„æ™‚å€™å·®é»è¢«å»¢é™¤ï¼Œå› ç‚ºä½¿ç”¨äººæ•¸å°‘ï¼Œæ”¯æ´çš„ä¸»æµç€è¦½å™¨ä¹Ÿä¸å¤šï¼Œæ‰€ä»¥ chromium å·¥ç¨‹å¸«æœ¬ä¾†æƒ³è¦ deprecate å®ƒï¼Œé †å‹¢æ¨å»£ Web animation èˆ‡ CSS animationï¼Œä½†åœ¨æ¶ˆæ¯å…¬å¸ƒå¾Œï¼Œæ”¶åˆ°äº†ç¤¾ç¾¤å¾ˆå¤šäººçš„å›é¥‹ï¼Œæœ€çµ‚æ±ºå®šæš«åœå»¢é™¤è¨ˆåŠƒï¼Œä¹Ÿå› æ­¤æˆ‘å€‘åˆ°ç¾åœ¨éƒ½é‚„èƒ½ä½¿ç”¨ SVG SMIL animationï¼Œ<a href=\"https://caniuse.com/svg-smil\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä¸»æµç€è¦½å™¨ä¹Ÿéƒ½æ”¯æ´</a>äº†ï¼Œä½¿ç”¨è€…ä¹Ÿå¾ 0.04% ä¸Šå‡åˆ° <a href=\"https://www.chromestatus.com/metrics/feature/timeline/popularity/501\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">1% ä»¥ä¸Š</a>ã€‚</p>\n<p>æœ‰èˆˆè¶£çš„è®€è€…å¯ä»¥å›è¿½ä¸€ä¸‹<a href=\"https://groups.google.com/a/chromium.org/g/blink-dev/c/5o0yiO440LM\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é€™ä¸²è¨è«–</a>ã€‚</p>\n<h2 id=\"svg-animation-element-ä»‹ç´¹èˆ‡ç¤ºç¯„\" style=\"position:relative;\"><a href=\"#svg-animation-element-%E4%BB%8B%E7%B4%B9%E8%88%87%E7%A4%BA%E7%AF%84\" aria-label=\"svg animation element ä»‹ç´¹èˆ‡ç¤ºç¯„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SVG animation element ä»‹ç´¹èˆ‡ç¤ºç¯„</h2>\n<h3 id=\"set\" style=\"position:relative;\"><a href=\"#set\" aria-label=\"set permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;set></h3>\n<p>åˆ©ç”¨ <code class=\"language-text\">&lt;set></code> å…ƒç´ ä½ èƒ½å¤ æŒ‡å®šåœ¨ä¸€æ®µæ™‚é–“å¾Œï¼Œæ”¹è®Š svg çš„ä¸€å€‹å±¬æ€§ï¼Œä¾‹å¦‚ 2 ç§’å¾Œå°‡ Rick çš„çœ¼ç›è®Šæˆå¾€ä¸‹çœ‹ï¼š</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-set.svg\" alt=\"set element demo\">\n</p>\n<p>ç–‘ï¼Ÿä½ èªªä»–æœ¬ä¾†å°±æ˜¯å¾€ä¸‹çœ‹çš„ï¼Ÿ</p>\n<p>é‚£æ˜¯å› ç‚º <code class=\"language-text\">set</code> ä¸æœƒé‡è¤‡åŸ·è¡Œï¼Œå¾ä½ è¼‰å…¥é€™ç¯‡æ–‡ç« åˆ°çœ‹åˆ°é€™å€‹ä½ç½®ç‚ºæ­¢ï¼Œç›¸ä¿¡å·²ç¶“è¶…é 2 ç§’ï¼Œæ‰€ä»¥å·²ç¶“æ˜¯åŸ·è¡Œå¾Œçš„çµæœï¼Œå»ºè­°ä½ æŒ‰å³éµ -> \"åœ¨æ–°åˆ†é ä¸­é–‹å•Ÿåœ–ç‰‡\"ï¼Œå¯¦éš›é«”é©—ä¸€ä¸‹ï¼Œå†ä¸ç„¶çœ‹çœ‹ä¸‹é¢çš„ gif ä¹Ÿè¡Œï¼š</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-svg-animation-set.gif\" alt=\"set element demo\">\n</p>\n<p>ç›¸é—œç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>circle</span> <span class=\"token attr-name\">cx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>56.7573<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>92.8179<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">r</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>set</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>cy<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>105.7318<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2s<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>circle</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>å°‡ <code class=\"language-text\">&lt;set></code> å…ƒç´ æ”¾åœ¨ä½ æƒ³è¦å¥—ç”¨æ•ˆæœçš„ svg shape å…§å³å¯ã€‚</p>\n<p><code class=\"language-text\">attributeName</code> æŒ‡å®šä½ è¦æ›´å‹•çš„å±¬æ€§ï¼›<code class=\"language-text\">to</code> ä»£è¡¨è®ŠåŒ–å€¼ï¼›<code class=\"language-text\">begin</code> ä»£è¡¨å¾è¼‰å…¥å¾Œçš„ä»€éº¼æ™‚å€™é–‹å§‹åŸ·è¡Œã€‚</p>\n<p>é™¤äº† <code class=\"language-text\">attributeName</code> å¤–ï¼Œæœ‰å¦ä¸€å€‹åƒæ•¸å« <code class=\"language-text\">attributeType</code>ï¼Œç”¨ä¾†å‘Šè¨´ç€è¦½å™¨ä½ è¦å‹•ç•«åŒ–çš„å±¬æ€§å€¼æ˜¯å±¬æ–¼ <code class=\"language-text\">XML</code>ï¼ˆe.g. <code class=\"language-text\">cy</code>ï¼‰ï¼Œé‚„æ˜¯ <code class=\"language-text\">CSS</code>ï¼ˆe.g. <code class=\"language-text\">opacity</code>ï¼‰ï¼Œä¸æŒ‡å®šçš„è©±ï¼Œç€è¦½å™¨æœƒè‡ªå·±çŒœã€‚ä¸éå‘¢ï¼Œé€™å€‹åƒæ•¸ä¹Ÿå·²ç¶“ <a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/attributeType\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">deprecated</a> äº†ï¼Œæ‰€ä»¥å¯¦éš›ä¸Šæˆ‘å€‘ä¸å†éœ€è¦å®ƒã€‚</p>\n<h3 id=\"animate\" style=\"position:relative;\"><a href=\"#animate\" aria-label=\"animate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;animate></h3>\n<p><code class=\"language-text\">&lt;animate></code> å…ƒç´ è®“ä½ èƒ½é‡å°å–®ä¸€å±¬æ€§è®ŠåŒ–å¥—ç”¨å‹•ç•«è£œé–“æ•ˆæœã€‚ç”¨æ³•ä¸€æ¨£æ˜¯æ”¾åœ¨ä½ æƒ³è¦å¥—ç”¨æ•ˆæœçš„ svg shape å…§ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>circle</span> <span class=\"token attr-name\">cx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>56.7573<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>92.8179<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">r</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animate</span>\n      <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>cx<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">from</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>56.7573<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>64.7573<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>circle</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>èˆ‡ <code class=\"language-text\">&lt;set></code> ç›¸æ¯”ï¼Œå¤šäº† <code class=\"language-text\">from</code> å±¬æ€§ä¾†æŒ‡å®šè¦å¾å“ªå€‹å€¼é–‹å§‹åšè®ŠåŒ–ï¼Œ<code class=\"language-text\">dur</code> æŒ‡å®šå‹•ç•«çš„åŸ·è¡Œæ™‚é–“ï¼Œ<code class=\"language-text\">repeatCount</code> æŒ‡å®šè¦é‡è¤‡å¹¾æ¬¡ï¼Œé€™é‚Šæˆ‘å€‘è¨­å®š <code class=\"language-text\">indefinite</code> è®“ä»–ç„¡é™é‡æ’­ï¼ˆè‹¥çœ‹ä¸åˆ°æ•ˆæœè«‹ä»¥åˆ†é é–‹æ–°åœ–ç‰‡ï¼‰ï¼š</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate.svg\" alt=\"animate element demo\">\n</p>\n<p>åˆ©ç”¨ <code class=\"language-text\">animate</code>ï¼Œè®“ Rick çš„çœ¼ç›å‘å³çœ‹ã€‚</p>\n<p>ä¹Ÿå¯ä»¥ç”¨ä¾†æ”¹è®Šé¡è‰²ï¼š</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-color.svg\" alt=\"animate element color demo\">\n</p>\n<p>ä¹Ÿå› ç‚ºå¯ä»¥ç”¨ä¾†æ”¹è®Šé¡è‰²ï¼Œæ‰€ä»¥æœ¬ä¾†æœ‰å€‹ <code class=\"language-text\">&lt;animateColor></code> å…ƒç´ å°±è¢«å–ä»£æ‰äº†ï¼Œç¾åœ¨<a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Element/animatecolor\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å·²ç¶“ deprecated äº†</a>ã€‚</p>\n<h3 id=\"animatetransform\" style=\"position:relative;\"><a href=\"#animatetransform\" aria-label=\"animatetransform permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;animateTransform></h3>\n<p><code class=\"language-text\">&lt;animateTransform></code> å¯ä»¥ç”¨ä¾†æ§åˆ¶ <code class=\"language-text\">transform</code> å±¬æ€§ï¼Œç”¨ <code class=\"language-text\">animate</code> ç„¡æ³•åšåˆ°ã€‚è·Ÿ CSS ä¸­çš„ transform ä¸€æ¨£ï¼Œå¯ä»¥æ§åˆ¶ <strong>translation</strong>ã€<strong>scaling</strong>ã€<strong>rotation</strong> è·Ÿ <strong>skewing</strong>ã€‚</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-transform.svg\" alt=\"animateTransform element demo\">\n</p>\n<p>å¯ä»¥è®“ Rick é ­è½‰èµ·ä¾†ï¼Œçœ‹èµ·ä¾†é —ã„ã„§ã„¤ LOL\nï¼ˆè¨»ï¼šç¶“å¯¦æ¸¬ï¼ŒanimateTransform åœ¨æ‰‹æ©Ÿä¸Šä¼¼ä¹ä¸æ”¯æ´ï¼Œè«‹ç”¨æ¡Œé¢ç‰ˆç€è¦½å™¨æŸ¥çœ‹æ­¤ç¯„ä¾‹ï¼‰</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rotate<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">from</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>360 0 0<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>å¦‚ä¸Šé¢æ‰€è¿°ï¼Œè¦æ§åˆ¶ <code class=\"language-text\">transform</code> å±¬æ€§ï¼Œæ‰€ä»¥ <code class=\"language-text\">attributeName=\"transform\"</code>ï¼Œæ¥è‘— <code class=\"language-text\">type</code> åƒæ•¸å°±çœ‹ä½ æƒ³è¦ transform çš„é¡å‹æ˜¯ä»€éº¼ï¼Œ<code class=\"language-text\">rotate</code>ã€<code class=\"language-text\">scale</code> éƒ½å¯ä»¥ã€‚å…¶é¤˜ <code class=\"language-text\">from</code>ã€<code class=\"language-text\">to</code>ã€<code class=\"language-text\">begin</code>ã€<code class=\"language-text\">dur</code>ç­‰åƒæ•¸éƒ½èˆ‡ä¹‹å‰çš„ç›¸åŒï¼Œç”¨ä¾†æŒ‡å®šå‹•ç•«çš„èµ·å§‹çµ‚é»å€¼ã€æ™‚é–“é•·åº¦èˆ‡åŸ·è¡Œæ¬¡æ•¸ã€‚</p>\n<h3 id=\"animatemotion\" style=\"position:relative;\"><a href=\"#animatemotion\" aria-label=\"animatemotion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;animateMotion></h3>\n<p>æœ€å¾Œä¸€å€‹å…ƒç´ ï¼Œ<code class=\"language-text\">animateMotion</code>ï¼Œè®“ svg æ²¿è‘—è»Œè·¡ <code class=\"language-text\">path</code> ç§»å‹•ï¼ˆè‹¥çœ‹ä¸åˆ°æ•ˆæœè«‹ä»¥åˆ†é é–‹æ–°åœ–ç‰‡ï¼‰ï¼š</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-motion.svg\" alt=\"animateMotion element demo\">\n</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!--è»Œè·¡--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M10,50 q60,50 100,0 q60,-50 100,0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\">&lt;!-- Rick é£›èˆ¹ svg--></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateMotion</span>\n    <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M10,50 q60,50 100,0 q60,-50 100,0<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>ä¸Šè¿°ç¨‹å¼ç¢¼å…§çš„ <code class=\"language-text\">&lt;path></code> åªæ˜¯ç‚ºäº†è®“å¤§å®¶çœ‹æ¸…æ¥šè·¯å¾‘èˆ‡å¯¦éš›å‹•ç•«çš„è»Œè·¡ç„¡é—œï¼Œå¯¦éš›ä½¿ç”¨ä¸Šåªè¦çµ¦å®š <code class=\"language-text\">animateMotion</code> ä¸€æ¢ <code class=\"language-text\">path</code> å±¬æ€§å€¼ï¼ŒåŒ…å« <code class=\"language-text\">animateMotion</code> å…ƒç´ çš„ svg å°±æœƒè·Ÿè‘—è©²è·¯å¾‘ç§»å‹•ã€‚</p>\n<p>å…¶ä»–å±¬æ€§å€¼è·Ÿå…¶ä»–å…ƒç´ é›·åŒï¼Œä¸é <code class=\"language-text\">animateMotion</code> é‚„æœ‰å€‹ç‰¹åˆ¥çš„å±¬æ€§å€¼ <code class=\"language-text\">rotate</code>ï¼Œç”¨ä¾†æŒ‡å®šæ˜¯å¦è¦éš¨è‘—è·¯å¾‘ç§»å‹•çš„åŒæ™‚ï¼Œé¸è½‰ç¶å®šçš„ svg ç‰©ä»¶ï¼Œå¯ä»¥è¨­å®šç‚º <code class=\"language-text\">auto</code> æˆ– <code class=\"language-text\">auto-reverse</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateMotion</span>\n  <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M10,50 q60,50 100,0 q60,-50 100,0<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rotate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>auto<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-motion-rotate.svg\" alt=\"animateMotion element demo\">\n</p>\n<p>æ­¤å¤–ï¼Œé™¤äº†çµ¦å®š <code class=\"language-text\">path</code> å±¬æ€§å€¼å¤–ï¼Œå…¶å¯¦ä¹Ÿèƒ½å¤ åˆ©ç”¨æ—¢æœ‰çš„ <code class=\"language-text\">&lt;path></code> ä¾†ç•¶ä½œ <code class=\"language-text\">animateMotion</code> çš„è·¯å¾‘ï¼Œä½†æ˜¯å¾—é€é <code class=\"language-text\">mpath</code> é€™å€‹ sub-elementï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!--è»Œè·¡--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>path1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M10,50 q60,50 100,0 q60,-50 100,0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\">&lt;!-- Rick é£›èˆ¹ svg--></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateMotion</span> <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mpath</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#path1<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>animateMotion</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>è¦æ³¨æ„çš„æ˜¯ï¼Œè‹¥è¦ä½¿ç”¨ <code class=\"language-text\">xlink:href</code> ä¾†æŒ‡å®šé€£æ¥çš„ svg å…ƒç´ ï¼Œåœ¨ä½ çš„ <code class=\"language-text\">&lt;svg></code> tag ä¸Šå¾—å…ˆè¨˜å¾—å®£å‘Š <code class=\"language-text\">xmlns:xlink=\"http://www.w3.org/1999/xlink\"</code>ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>300<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>200<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 500 300<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>xlink</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/1999/xlink<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>æœ‰äº† <code class=\"language-text\">xlink:href</code>ï¼Œæˆ‘å€‘ä¹Ÿå°±ä¸ç”¨åƒä¹‹å‰ç¯„ä¾‹ä¸­æ‰€åšçš„ä¸€æ¨£ï¼Œä¸€å®šå¾—æŠŠ <code class=\"language-text\">animate</code> å…ƒç´ æ”¾åœ¨è¦ç¶å®šçš„ svg shape å…§ï¼Œå¯ä»¥é€é <code class=\"language-text\">id</code> èˆ‡ <code class=\"language-text\">xlink:href</code> ä¾†é€£çµï¼Œä¾‹å¦‚ç¬¬ä¸€å€‹ <code class=\"language-text\">&lt;set></code> çš„ç¯„ä¾‹å¯æ”¹ç‚ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>circle</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>eyes<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>56.7573<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>92.8179<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">r</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>circle</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>set</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#eyes<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>cy<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>105.7318<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2s<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>è‡³æ­¤æˆ‘å€‘ä»‹ç´¹å®Œäº†å››ç¨® SVG animation elementï¼Œé™¤äº†å€‹åˆ¥æ‹¿ä¾†ä½¿ç”¨å¤–ï¼Œé€™äº›å…ƒç´ æ˜¯èƒ½å¤ çµ„åˆåœ¨ä¸€èµ·ä½¿ç”¨çš„ï¼Œå°±åªè¦å€‹åˆ¥æŠŠå°æ‡‰çš„ animate element å¥—ç”¨åœ¨æƒ³è¦çš„ svg shape ä¸Šå³å¯ï¼Œèˆ‰ä¾‹ä¾†èªªï¼Œå¯ä»¥è®“ Rick æ—‹è½‰çš„åŒæ™‚ï¼Œé«®è‰²æ”¹è®Šã€çœ¼ç›è½‰å‹•ï¼ˆå¯å³éµçœ‹ svg åŸå§‹ç¢¼ï¼Œåœ¨è£¡é¢å¯ä»¥æ‰¾åˆ°å¤šå€‹ animate elementï¼‰ï¼š</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-combine.svg\" alt=\"combine animate elements demo\">\n</p>\n<p>ï¼ˆè¨»ï¼šç¶“å¯¦æ¸¬ï¼ŒanimateTransform åœ¨æ‰‹æ©Ÿä¸Šä¼¼ä¹ä¸æ”¯æ´ï¼Œè«‹ç”¨æ¡Œé¢ç‰ˆç€è¦½å™¨æŸ¥çœ‹æ­¤ç¯„ä¾‹ï¼‰</p>\n<h2 id=\"svg-smil-animation-é‡é»åƒæ•¸ä»‹ç´¹\" style=\"position:relative;\"><a href=\"#svg-smil-animation-%E9%87%8D%E9%BB%9E%E5%8F%83%E6%95%B8%E4%BB%8B%E7%B4%B9\" aria-label=\"svg smil animation é‡é»åƒæ•¸ä»‹ç´¹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SVG SMIL animation é‡é»åƒæ•¸ä»‹ç´¹</h2>\n<p>åœ¨ä¸Šé¢çš„ Demo è£¡é¢ï¼Œæˆ‘å€‘å¯ä»¥ç™¼ç¾ SVG animate element æœ‰å¾ˆå¤šåƒæ•¸å¯ä»¥ä½¿ç”¨ï¼Œç¯„ä¾‹ä¸­åªç”¨åˆ°äº†ä¸€éƒ¨åˆ†ï¼Œä½†å…¶å¯¦é€™äº›åƒæ•¸èƒ½è¨­å®šçš„å€¼éƒ½æœ‰ä¸å°‘è®ŠåŒ–ï¼Œæƒ³è¦æ¸…æ¥šçŸ¥é“æ¯ä¸€å€‹åƒæ•¸çš„ç”¨é€”èˆ‡ç¯„ä¾‹ï¼Œæ¨è–¦åƒè€ƒé€™ç¯‡æ–‡ç«  - <a href=\"https://css-tricks.com/guide-svg-animations-smil/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">A Guide to SVG Animations (SMIL)</a>ï¼Œä¸ä»‹æ„ç°¡é«”ä¸­æ–‡çš„è©±ï¼Œå¯ä»¥çœ‹<a href=\"https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é€™ç¯‡</a>ï¼Œéƒ½å¯«å¾—éå¸¸å¥½éå¸¸è©³ç´°ã€‚</p>\n<p>åœ¨é€™å€‹ç« ç¯€æˆ‘æœƒé‡é»ä»‹ç´¹ä¸€äº›æˆ‘è¦ºå¾—æ¯”è¼ƒæœ‰è¶£åŠå¯¦ç”¨çš„åƒæ•¸ã€‚</p>\n<h3 id=\"from-to-by-values\" style=\"position:relative;\"><a href=\"#from-to-by-values\" aria-label=\"from to by values permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>from, to, by, values</h3>\n<p><code class=\"language-text\">from</code> è·Ÿ <code class=\"language-text\">to</code> åœ¨å‰é¢çš„ç¯„ä¾‹ä¸­éƒ½æœ‰çœ‹åˆ°ï¼ŒåŠŸèƒ½ä¹Ÿå¦‚åŒå­—é¢èˆ¬å¥½æ‡‚ï¼Œå°±æ˜¯æŒ‡å®šå‹•ç•«è®ŠåŒ–çš„ç§»å‹•å€é–“ï¼Œå¾ï¼ˆ<code class=\"language-text\">from</code>ï¼‰æŸå€‹å€¼è®ŠåŒ–åˆ°ï¼ˆ<code class=\"language-text\">to</code>ï¼‰å¦å€‹å€¼ï¼›è€Œ <code class=\"language-text\">by</code> å‰‡æ˜¯ä»£è¡¨ä½ç§»é‡ï¼Œç›¸å°æ–¼æ˜ç¢ºå‘ŠçŸ¥è¦è®Šå‹•åˆ°å“ªå€‹å€¼ï¼Œæˆ‘å€‘å¯ä»¥ç”¨ <code class=\"language-text\">by</code> å‘Šè¨´ svg è¦è®Šå‹•â€å¤šå°‘çš„é‡â€œï¼Œä¾‹å¦‚å‰é¢ <code class=\"language-text\">animateTransform</code> çš„ä¾‹å­ï¼Œæˆ‘å€‘å¯ä»¥æ”¹ç‚ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rotate<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">from</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">by</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>360<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>çœ‹åˆ°é€™é‚Šä½ æ‡‰è©²æœƒæ³¨æ„åˆ°ï¼Œ<code class=\"language-text\">by</code> è·Ÿ <code class=\"language-text\">to</code> åŠŸèƒ½ä¸Šæœ‰é»é‡è¤‡ï¼Œæ‰€ä»¥å½¼æ­¤ä¹‹é–“æœ‰å„ªå…ˆæ¬Šï¼Œå¦‚æœåŒæ™‚æœ‰æŒ‡å®š <code class=\"language-text\">to</code> èˆ‡ <code class=\"language-text\">by</code>ï¼Œå‰‡åªæœƒå¥—ç”¨åˆ° <code class=\"language-text\">to</code> çš„å€¼ã€‚</p>\n<p>å†ä¾†çœ‹çœ‹ <code class=\"language-text\">values</code>ï¼Œé€™å€‹å‰›å‰›çš„ç¯„ä¾‹éƒ½æ²’å‡ºç¾ï¼Œå®ƒçš„åŠŸç”¨æ˜¯ä¾†è£œè¶³ <code class=\"language-text\">from</code>ã€<code class=\"language-text\">to</code>ã€<code class=\"language-text\">by</code> çš„ä¸è¶³ã€‚ä¸è¶³çš„é»åœ¨æ–¼ï¼Œ <code class=\"language-text\">from</code>ã€<code class=\"language-text\">to</code>ã€<code class=\"language-text\">by</code> åªèƒ½æŒ‡å®šå…©å€‹å€¼ä¹‹é–“çš„è®ŠåŒ–ï¼Œå¾ a è®ŠåŒ–åˆ° bï¼Œè€Œ <code class=\"language-text\">values</code> å¯ä»¥çµ¦å®šå¤šå€‹å€¼ï¼Œç”¨åˆ†è™Ÿ <code class=\"language-text\">;</code> éš”é–‹ï¼Œå°±èƒ½æœ‰ a -> b -> c -> b -> a é€™æ¨£çš„è®ŠåŒ–ï¼Œèˆ‰å€‹ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>translate<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">values</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20;120;20<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-values.svg\" alt=\"animate values attribute demo\">\n</p>\n<h3 id=\"begin-end\" style=\"position:relative;\"><a href=\"#begin-end\" aria-label=\"begin end permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>begin, end</h3>\n<p><code class=\"language-text\">begin</code> è·Ÿ <code class=\"language-text\">end</code> åˆ†åˆ¥ç”¨ä¾†æ§åˆ¶ä½•æ™‚é–‹å§‹åŸ·è¡Œå‹•ç•«ï¼Œä½•æ™‚åœæ­¢å‹•ç•«ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘å€‘éƒ½åªç”¨åˆ°æ™‚é–“ï¼Œåƒæ˜¯ <code class=\"language-text\">begin=\"2s\"</code>ï¼Œä½†å…¶å¯¦é€™å…©å€‹åƒæ•¸èƒ½çµ¦çš„å€¼æœ‰éå¸¸å¤šçš„ç¨®é¡ï¼Œè€Œä¸”èƒ½å‘ <code class=\"language-text\">values</code> ä¸€æ¨£è³¦äºˆå¤šå€‹å€¼ï¼Œåªè¦ç”¨ <code class=\"language-text\">;</code> éš”é–‹å³å¯ï¼š</p>\n<p><code class=\"language-text\">begin = &lt;offset-value> | &lt;syncbase-value> | &lt;event-value> | &lt;repeat-value> | &lt;accessKey-value> | &lt;wallclock-sync-value></code></p>\n<p>æ¯ç¨®é¡å‹çš„è©³ç´°ä»‹ç´¹ï¼Œæˆ‘æ¨è–¦ç›´æ¥çœ‹ <a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/begin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MDN</a>ï¼Œæˆ–æ˜¯å°å²¸ç¶²å‹çš„<a href=\"https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ•´ç†</a>ï¼Œé€™é‚Šæˆ‘åªèªªæ˜å¹¾å€‹æˆ‘è¦ºå¾—æ¯”è¼ƒå¯¦ç”¨çš„ã€‚</p>\n<p>é¦–å…ˆæ˜¯ <code class=\"language-text\">&lt;syncbase-value></code>ã€‚</p>\n<p>å¾å­—é¢æœ‰é»é›£æ‡‚ï¼Œä¸»è¦æ˜¯ç”¨å…¶ä»– animate å…ƒç´ çš„ begin/end å€¼å†åšåŠ æ¸›ï¼Œèˆ‰å€‹ä¾‹å­å°±æ¯”è¼ƒå¥½æ‡‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- Rick head --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>scale<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">values</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1;1.2;1<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ship.end<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3s<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- spaceship --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ship<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>translate<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">values</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20;120;20<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>é€™æ¬¡ç¯„ä¾‹ä¸­çš„ svg å…§æœ‰å…©å€‹ animate å…ƒç´ ï¼Œçµ¦å®šé‡å°å¤ªç©ºèˆ¹åšå‹•ç•«çš„å…ƒç´ ä¸€å€‹ id å€¼ <code class=\"language-text\">ship</code>ï¼Œç„¶å¾Œåœ¨ Rick çš„å‹•ç•«å…ƒç´ ä¸Šåˆ©ç”¨ <code class=\"language-text\">begin=\"ship.end\"</code>ï¼Œå°±å¯ä»¥è®“ Rick é ­çš„å‹•ç•«ç­‰åˆ°å¤ªç©ºèˆ¹çš„å‹•ç•«åšå®Œå¾Œå†å•Ÿå‹•ï¼Œæ•ˆæœå¦‚ä¸‹ï¼ˆé€™éœ€è¦éº»ç…©è®€è€…ç”¨æ–°åˆ†é é–‹å•Ÿåœ–ç‰‡ä¾†è§€çœ‹ï¼‰ï¼š</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-begin-syncbase.svg\" alt=\"animate begin syncbase demo\">\n</p>\n<p>å¦ä¸€å€‹æˆ‘è¦ºå¾—å¯¦ç”¨çš„å€¼æ˜¯ <code class=\"language-text\">event-value</code>ï¼Œçœ‹åå­—å°±çŸ¥é“ï¼Œæ˜¯å¯ä»¥ä¾ç…§ <code class=\"language-text\">event</code> ä¾†å•Ÿå‹•æˆ–çµ‚çµå‹•ç•«ï¼Œç”¨æ³•èˆ‡ <code class=\"language-text\">syncbase-value</code> é›·åŒï¼Œçµ¦å®šå…ƒç´  idï¼Œç„¶å¾Œæ ¹æ“šè©²å…ƒç´ è§¸ç™¼çš„äº‹ä»¶è®“å‹•ç•« <code class=\"language-text\">begin</code> æˆ–æ˜¯ <code class=\"language-text\">end</code>ã€‚å¹¾ä¹æ‰€æœ‰ DOM element æ”¯æ´çš„ event éƒ½èƒ½ä½¿ç”¨ï¼Œ<a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/begin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MDN</a> æœ‰åˆ—å‡ºæ‰€æœ‰å¯ç”¨äº‹ä»¶ã€‚</p>\n<p>ä¸€æ¨£èˆ‰å€‹ä¾‹å­ï¼Œé»æ“Š Rick å°±èƒ½è®“å¤ªç©ºèˆ¹ç§»å‹•ï¼ˆç¤™æ–¼ blog æ ¼å¼ï¼Œé€™ç¯„ä¾‹å¾—æ”¾åœ¨ codepen ä¸Šï¼‰ï¼š</p>\n<p class=\"codepen\" data-height=\"182\" data-theme-id=\"29194\" data-default-tab=\"result\" data-user=\"arvin0731\" data-slug-hash=\"BaWEJpm\" style=\"height: 182px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"SVG SMIL Demo - rick and spaceship\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/BaWEJpm\">\n  SVG SMIL Demo - rick and spaceship</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n<p>ç¨‹å¼ç¢¼å¦‚ä¸‹ï¼Œ<code class=\"language-text\">rickhead.click</code>ï¼ˆ[å…ƒç´  id].[event]ï¼‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rickhead<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!--// ç•¥ --></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ship<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>translate<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">values</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20;120;20<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rickhead.click<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>æœ€å¾Œæ˜¯ <code class=\"language-text\">indefinite</code>ï¼Œå¦‚æœä½ çš„ <code class=\"language-text\">begin</code> å€¼ç‚º <code class=\"language-text\">indefinite</code>ï¼Œä»£è¡¨ç„¡é™ç­‰å¾…ï¼Œé€™æ™‚å°±éœ€è¦é€é <code class=\"language-text\">[animate å…ƒç´ ].beginElement()</code> ä¾†è§¸ç™¼ï¼Œæˆ–æ˜¯ç”¨ <code class=\"language-text\">&lt;a></code> tag çš„ <code class=\"language-text\">xlink:href=\"#[animate å…ƒç´  id]\"</code> ä¾†å•Ÿå‹•ã€‚</p>\n<p class=\"codepen\" data-height=\"189\" data-theme-id=\"29194\" data-default-tab=\"html,result\" data-user=\"arvin0731\" data-slug-hash=\"PopgERE\" style=\"height: 189px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"SVG SMIL Demo - rick and spaceship - event trigger\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/PopgERE\">\n  SVG SMIL Demo - rick and spaceship - event trigger</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n<h3 id=\"calcmode-keytimes-keysplines\" style=\"position:relative;\"><a href=\"#calcmode-keytimes-keysplines\" aria-label=\"calcmode keytimes keysplines permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>calcMode, keyTimes, keySplines</h3>\n<p>é€™ä¸‰å€‹åƒæ•¸ä¸»è¦è®“ä½ èƒ½å¤ æ›´ç´°å¾®çš„èª¿æ•´å‹•ç•«çš„é€Ÿåº¦è®ŠåŒ–ã€‚</p>\n<p><code class=\"language-text\">calcMode</code> æœ‰å››ç¨®æ¨¡å¼ï¼š<code class=\"language-text\">discrete</code>ã€<code class=\"language-text\">linear</code>ã€<code class=\"language-text\">paced</code>ã€<code class=\"language-text\">spline</code>ã€‚</p>\n<p><strong>discrete</strong> é¡§åæ€ç¾©å°±æ˜¯é›¢æ•£çš„ï¼Œ<code class=\"language-text\">from</code> å€¼è·³åˆ° <code class=\"language-text\">to</code> å€¼ä¸åšè£œé–“; <strong>linear</strong> è·Ÿ <strong>paced</strong> æˆ‘è¦ºå¾—æ•ˆæœé›·åŒï¼Œéƒ½æ˜¯è®“è®“è£œé–“å‹•ç•«çš„é€Ÿåº¦ç¶­æŒä¸€è‡´ï¼ˆlinearï¼‰èˆ‡å¹³å‡ï¼ˆpacedï¼‰; <code class=\"language-text\">spline</code> å‰‡æ˜¯ä½¿ç”¨è²å¼æ›²ç·šï¼Œéœ€è¦æ­é… <code class=\"language-text\">keyTimes</code> èˆ‡ <code class=\"language-text\">keySplines</code> ä¾†ä½¿ç”¨ã€‚</p>\n<p><code class=\"language-text\">keyTimes</code> å°±æ˜¯é—œéµå½±æ ¼ï¼Œè·Ÿå‰é¢æéçš„ <code class=\"language-text\">values</code> ä¸€æ¨£ï¼Œå¯ä»¥æ¥å—å¤šå€‹ä»¥åˆ†è™Ÿå€éš”çš„å€¼ï¼Œå®šç¾©å‹•ç•«çš„é—œéµæ™‚é–“é»ï¼Œæ­é…ä¸åŒçš„ <code class=\"language-text\">calcMode</code> å°±èƒ½åœ¨ä¸åŒçš„æ™‚é–“é»æœ‰ä¸åŒçš„é€Ÿåº¦æ•ˆæœã€‚</p>\n<p><code class=\"language-text\">keySpline</code> æ˜¯ç•¶ä½  <code class=\"language-text\">calcMode</code> è¨­å®šç‚º <code class=\"language-text\">spline</code> æ™‚ï¼Œç”¨ä¾†å®šç¾©è²å¼æ›²ç·šçš„å››å€‹æ§åˆ¶é»çš„ã€‚</p>\n<p>é€™é‚Šç›´æ¥å¼•ç”¨å°å²¸ç¶²å‹ç²¾ç·»çš„ Demo é é¢çµ¦å¤§å®¶åƒè€ƒï¼Œç”¨çœ‹çš„æœƒæ¯”è¼ƒæ¸…æ¥šå¥½ç†è§£ï¼š<a href=\"http://www.zhangxinxu.com/study/201408/svg-animation-calcmode.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">calcModeã€keyTimesã€keySplines å±¬æ€§ DEMO</a>ã€‚è©²ä½œè€…å°æ–¼ <code class=\"language-text\">keySpline</code> çš„å€¼ä¹Ÿæœ‰<a href=\"https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç•«åœ–èªªæ˜</a>ï¼Œå¾ˆå¥½æ‡‚ï¼Œæœ‰èˆˆè¶£ç ”ç©¶çš„è©±å€¼å¾—ä¸€çœ‹ã€‚</p>\n<h3 id=\"additive\" style=\"position:relative;\"><a href=\"#additive\" aria-label=\"additive permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>additive</h3>\n<p>çœ‹åˆ°æœ€å¾Œï¼Œä¸çŸ¥é“ä½ æœƒä¸æœƒæœ‰å€‹ç–‘å•ï¼šå¦‚æœæˆ‘æƒ³é‡å°åŒçš„ SVG shape çš„åŒå€‹å±¬æ€§åšå¤šå€‹é€£çºŒè®ŠåŒ–æ™‚è©²æ€éº¼è¾¦ï¼Ÿ</p>\n<p>ä¾‹å¦‚ï¼šé€é <code class=\"language-text\">animateTransform</code> å…ˆå°‡åœ–æ¡ˆæ”¾å¤§å†ä½ç§»ã€‚</p>\n<p>é€™æ™‚å°±è¦é  <code class=\"language-text\">additive</code> é€™å€‹åƒæ•¸å‡ºé¦¬äº†ï¼Œ<code class=\"language-text\">additive</code> åƒæ•¸å‘ŠçŸ¥ SVG æ˜¯å¦è¦ç´¯åŠ ï¼ˆ<code class=\"language-text\">sum</code>ï¼‰å‹•ç•«æ•ˆæœï¼Œæˆ–æ˜¯å–ä»£ï¼ˆ<code class=\"language-text\">replace</code>ï¼‰ï¼Œé è¨­æ˜¯ <code class=\"language-text\">replace</code>ã€‚</p>\n<p>ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>scale<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">by</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1.1<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">additive</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sum<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rotate<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">from</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>360 0 0<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">additive</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sum<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-additive.svg\" alt=\"animate values attribute demo\">\n</p>\n<p>ï¼ˆè¨»ï¼šç¶“å¯¦æ¸¬ï¼ŒanimateTransform åœ¨æ‰‹æ©Ÿä¸Šä¼¼ä¹ä¸æ”¯æ´ï¼Œè«‹ç”¨æ¡Œé¢ç‰ˆç€è¦½å™¨æŸ¥çœ‹æ­¤ç¯„ä¾‹ï¼‰</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>ä»Šå¤©èŠ±äº†ä¸å°çš„ç¯‡å¹…ä»‹ç´¹äº† SVG SMIL animationï¼Œæ„Ÿè¬çœ‹åˆ°é€™é‚Šçš„å„ä½ï¼Œè£½ä½œ Demo çš„éç¨‹å°æˆ‘ä¾†èªªå¾ˆæœ‰è¶£ï¼Œä¹Ÿå­¸ç¿’äº†æ€éº¼ç¹ªè£½ SVGï¼Œå¾ç¶²è·¯ä¸Šçš„å…¶ä»–è³‡æºä¹ŸæŸ¥åˆ°è¨±å¤šè©³ç´°çš„è³‡æ–™ï¼Œæ”¶ç©«ä¸å°‘ï¼å¸Œæœ›å°çœ‹åˆ°é€™ç¯‡æ–‡ç« çš„ä½ å€‘ä¹Ÿèƒ½æœ‰æ‰€å•Ÿç™¼ï¼Œé™¤äº†å¸¸ç”¨çš„ Web animation èˆ‡ CSS animation å¤–ï¼Œæœ‰æ©Ÿæœƒä¹Ÿè©¦è©¦ç”¨ SVG ç›´æ¥ä½œå‹•ç•«å§ï¼</p>\n<h3 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h3>\n<ol>\n<li><a href=\"https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¶…çº§å¼ºå¤§çš„SVG SMIL animationåŠ¨ç”»è¯¦è§£</a></li>\n<li><a href=\"https://css-tricks.com/guide-svg-animations-smil/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">A Guide to SVG Animations (SMIL)</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/SVG_animation_with_SMIL\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SVG animation with SMIL</a></li>\n<li><a href=\"http://tutorials.jenkov.com/svg/svg-animation.html#set\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SVG Animation</a></li>\n</ol>","id":"d92d1023-e99a-574a-8942-b9f6a51ceb0d","fields":{"slug":"svg-smil-animation-intro"},"frontmatter":{"date":"2021-06-18T08:56:40.000Z","title":"è®“ SVG è‡ªå·±å‹•èµ·ä¾†ï¼ SVG SMIL Animation ä»‹ç´¹","tags":["web","svg","animation","smil"],"type":"tech","slug":"svg-smil-animation-intro"},"timeToRead":14},{"excerpt":"è£½ä½œå‹•ç•«ï¼Œäººäººæœ‰è²¬ã€‚","html":"<p>è£½ä½œå‹•ç•«ï¼Œäººäººæœ‰è²¬ã€‚</p>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>ç–«æƒ…å‡æº«ï¼Œå¾…åœ¨å®¶è£¡æ•‘äººæ•‘å·±ï¼Œé™¤äº†æ‰“é›»å‹•ç©å¥èº«ç’°å¤–ï¼Œä¹Ÿæ˜¯å€‹å¥½æ©Ÿæœƒä¾†åŸ¹é¤ŠåŸ¹é¤Šè‡ªå·±çš„ç¾è¡“èƒ½åŠ›ï¼Œç„¶è€Œå¹³å¸¸å·¥ä½œæ²’ä»€éº¼æ©Ÿæœƒè£½ä½œå‹•ç•«çš„æˆ‘ï¼Œå³ä¾¿æœ‰äº†æ™‚é–“ï¼Œä¹Ÿä¸çŸ¥é“è¦å¾ä½•ä¸‹æ‰‹ï¼Œä¸Šäº† Dribbbleã€CodePen æ‰¾éˆæ„Ÿï¼Œçš„ç¢ºçœ‹åˆ°å¾ˆå¤šæœ‰è¶£çš„ä½œå“ï¼Œä½†æ˜¯å¤§å¤šéƒ½å¾ˆè¤‡é›œï¼Œä¸åƒæ˜¯ä¸€å€‹é€±æœ«åˆå¾Œçš„ä¼‘é–’è‰¯å“ï¼Œä¾‹å¦‚ï¼Œ<a href=\"https://www.tinydesign.co.uk/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ben Evans</a> çš„é€™å€‹ä½œå“ï¼š</p>\n<p class=\"codepen\" data-height=\"379\" data-theme-id=\"dark\" data-default-tab=\"result\" data-user=\"ivorjetski\" data-slug-hash=\"xxGYWQG\" data-preview=\"true\" style=\"height: 379px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"Pure CSS Landscape - An Evening in Southwold\">\n  <span>See the Pen <a href=\"https://codepen.io/ivorjetski/pen/xxGYWQG\">\n  Pure CSS Landscape - An Evening in Southwold</a> by Ben Evans (<a href=\"https://codepen.io/ivorjetski\">@ivorjetski</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n<p>é€™å¼µåƒæ˜¯ç…§ç‰‡ä¸€æ¨£çš„åœ–ç‰‡ï¼Œä½ èƒ½æƒ³åƒæ˜¯å–®ç´”ç”¨ CSS è£½ä½œçš„å—ï¼Ÿä½œè€…æœ‰æ”¾ä¸Šä»–è£½ä½œé€™ä½œå“çš„<a href=\"https://youtu.be/rUCVBNNyjC4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç¸®æ™‚å½±ç‰‡</a>ï¼ˆå½±ç‰‡çš„éŸ³æ¨‚é‚„æ˜¯ä»–è‡ªå·±åšçš„ï¼ŒçœŸæœ‰æ‰è¯ï¼‰ï¼Œé›–ç„¶ä¸çŸ¥é“ç¸½å…±èŠ±äº†å¤šå°‘æ™‚é–“ï¼Œä½†ä»¥ä»–çš„å¦ä¸€å€‹åŒæ¨£é©šäººä¸”è‡³å°‘èŠ±è²»ä¸€ç™¾å°æ™‚çš„<a href=\"https://codepen.io/ivorjetski/pen/dBYWWZ\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä½œå“</a>æ¨æ–·ï¼Œæ™‚æ•¸å°‘ä¸åˆ°å“ªå»çš„ã€‚</p>\n<p>æˆ‘çŸ¥é“å¾ˆå¤šäººæœƒè¦ºå¾—ï¼Œã€å°å‘€å¾ˆé…·ï¼Œä½†ç‚ºä»€éº¼ï¼Ÿã€ã€‚</p>\n<p>æˆ‘ä¹Ÿä¸æ‡‚ç‚ºä»€éº¼ï¼Œä½†çŸ¥é“èƒ½åˆ©ç”¨ CSS åšå‡ºé€™ç¨®æ¥µé™çœŸçš„å¾ˆä»¤äººæ„Ÿåˆ°èˆˆå¥®ã€‚å…‰æ˜¯è§€å¯Ÿä»–çš„ç¨‹å¼ç¢¼å°±å¯ä»¥å­¸åˆ°ä¸å°‘æŠ€å·§ï¼Œåƒæ˜¯ï¼š</p>\n<ol>\n<li>Custom HTML tag</li>\n</ol>\n<p>å³ä¾¿æ˜¯ç”¨ CSS ç¹ªåœ–ï¼Œç›¸ä¿¡å¤§éƒ¨åˆ†çš„äººä¹Ÿéƒ½æ˜¯ç”¨æ™®é€šçš„ <code class=\"language-text\">div</code>ã€<code class=\"language-text\">span</code> ä¾†çµ„è£åœ–æ¡ˆï¼Œä½†å¦‚æœä½ æ‰“é–‹å‰›å‰›é‚£ç¯„ä¾‹çš„ HTMLï¼Œæœƒçœ‹åˆ°é€™æ¨£çš„çµæ§‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>landscape</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>sky</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n      ...<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span>\n    <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>sky</span>\n  <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>landscape</span>\n<span class=\"token punctuation\">></span></span></code></pre></div>\n<p>å…¨éƒ½æ˜¯ custom elementï¼Œä»¥ç‚ºæ˜¯ä»–è‡ªè£½çš„ web component ä½†ä»–åˆæ²’æœ‰å°æ‡‰çš„ Javascriptï¼ŸğŸ¤”</p>\n<p>å…¶å¯¦ç¾ä»Šç€è¦½å™¨å°é€™ç¨® invalid çš„ HTML tag å®¹å¿åº¦å¾ˆé«˜ï¼Œåªè¦æœ‰çµ¦å®š CSSï¼Œç€è¦½å™¨é‚„æ˜¯èƒ½æ­£å¸¸æ¸²æŸ“å‡ºä¾†ã€‚å¯¦éš›å°ˆæ¡ˆä¸Šç•¶ç„¶ä¸å»ºè­°é€™æ¨£åšï¼Œä½†åœ¨è£½ä½œ CSS ç¹ªåœ–æˆ–è—è¡“å‹•ç•«é€™é¡é€šå¸¸æ“æœ‰è¤‡é›œ HTML çµæ§‹çš„ä½œå“ä¸Šæ™‚ï¼Œå°±èƒ½è®“ç¨‹å¼ç¢¼çœ‹èµ·ä¾†ç°¡æ½”è¨±å¤šï¼Œç­‰åŒæ–¼è®“ tag name å–ä»£ class nameã€‚</p>\n<ol start=\"2\">\n<li>Responsive rem</li>\n</ol>\n<p>æˆ‘å€‘éƒ½çŸ¥é“ <code class=\"language-text\">rem</code> æœƒéš¨è‘— root element çš„ font-size è‡ªå‹•èª¿æ•´å¤§å°ï¼Œæ‰€ä»¥è‹¥æ˜¯æˆ‘å€‘ä¹Ÿèƒ½å‹•æ…‹èª¿æ•´ root element çš„å¤§å°ï¼Œä¸¦ç”¨ <code class=\"language-text\">rem</code> ä¾†è¨­å®šæ‰€æœ‰å…ƒç´ çš„ sizeï¼Œé‚£å°±èƒ½è®“é é¢è¼•é¬† responsiveã€‚è¦åšåˆ°é€™é»å¯ä»¥åˆ©ç”¨ <code class=\"language-text\">vmin</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">html</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1vmin<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">vmin</code> å°æ‡‰ viewport çš„çŸ­é‚Šï¼Œæ„å³è¢å¹•ç¸®å°æ™‚ï¼Œè©²å€¼ä¹Ÿæœƒéš¨ä¹‹è®Šå°ï¼Œé€™æ¨£å°±èƒ½é”åˆ°æˆ‘å€‘è¦çš„æ•ˆæœã€‚</p>\n<p>å…¶å¯¦é‚„æœ‰å…¶ä»–æŠ€å·§ï¼Œä½†å·²ç¶“æ‰¯å¤ é äº†ğŸ˜…ã€‚</p>\n<p>é›–ç„¶è©¦è‘—ç†è§£é«˜æ‰‹å¦‚ä½•åšåˆ°æ˜¯èƒ½å¸æ”¶ä¸å°‘ç¶“é©—ï¼Œä½†é‚„æ˜¯æœƒæƒ³è¦è‡ªå·±å‹•æ‰‹åšé»ä»€éº¼ï¼Œå¥½åœ¨æˆ‘åˆç™¼ç¾äº†å¦ä¸€å€‹ç¨å¾®å¹³æ˜“è¿‘äººçš„é«˜æ‰‹ - <a href=\"https://dribbble.com/ai\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Aaron Iker</a>ï¼Œä»–å¤§å¤šçš„ä½œå“éƒ½åœç¹åœ¨ä¸€å€‹ç¶²é ä¸Šä¸å¯ç¼ºä¹ï¼Œä½†é®®å°‘è¢«äººæ‹¿ä¾†åšæ–‡ç« çš„å…ƒä»¶ - <strong>\"æŒ‰éˆ•\"</strong>ä¸Šã€‚</p>\n<p>æŒ‰éˆ•ï¼Œå¹¾ä¹æ‰€æœ‰ç¶²é éƒ½æœƒç”¨åˆ°å®ƒï¼Œä½†å°±æ˜¯æ‹¿ä¾†è§¸ç™¼ä¸€äº›å‹•ä½œï¼Œè¢«è§¸ç™¼çš„å‹•ä½œæ‰æ˜¯æˆ‘å€‘åœ¨æ„çš„ï¼Œå¾ˆå°‘æœƒåœ¨ä¸Šé ­å¤šä½œè‘—å¢¨ï¼Œé ‚å¤šåŠ å€‹ Hover è®Šè‰²æˆ–ä½ç§»å°±å¾ˆå·®ä¸å¤šäº†ã€‚</p>\n<p>ä½†çœ‹çœ‹ä¸‹é¢é€™å€‹<a href=\"https://dribbble.com/shots/14524315-Download-Button\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å¯¦ä¾‹</a>ï¼š</p>\n<p><video width=\"100%\" height=\"315\" controls src=\"https://cdn.dribbble.com/users/414694/screenshots/14524315/media/d4970a372ae0c6b9a4bf8d60c4d5d82f.mp4\"></video></p>\n<p>ä¸€é»å°å·§æ€ï¼Œç¬é–“å°±è®“æŒ‰éˆ•æ´»äº†èµ·ä¾†ã€‚</p>\n<p>è€Œä¸”å› ç‚ºç¯„åœé™ç¸®åœ¨äº†æŒ‰éˆ•çš„å¤§å°ï¼Œå°±ç®—å‹•ç•«ç¨å¾®è¯éº—ä¸€äº›ä¹Ÿä¸æœƒå°æ•´é«”é é¢é€ æˆå¤ªå¤šå¹²æ“¾ã€‚</p>\n<p>å—åˆ° Aaron å•Ÿç™¼ï¼Œè¶è‘—ç©ºé–’æ™‚é–“æˆ‘ä¹Ÿè©¦è‘—åšäº†ä¸€å€‹<a href=\"https://codepen.io/arvin0731/full/dyvvrBb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æŒ‰éˆ•å‹•ç•«</a>ï¼Œä»Šå¤©é€™ç¯‡æ–‡ç« å°±åˆ†äº«ä¸€ä¸‹éç¨‹ä¸­ä½¿ç”¨åˆ°çš„å·¥å…·èˆ‡çœ‰è§’ï¼</p>\n<p><video width=\"100%\" height=\"315\" controls src=\"https://i.imgur.com/I27O5GT.mp4\"></video></p>\n<h2 id=\"éˆæ„Ÿä¾†æº\" style=\"position:relative;\"><a href=\"#%E9%9D%88%E6%84%9F%E4%BE%86%E6%BA%90\" aria-label=\"éˆæ„Ÿä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>éˆæ„Ÿä¾†æº</h2>\n<p>é€™æ¬¡çš„æŒ‰éˆ•å‹•ç•«ä¸»è¦ä¿®æ”¹è‡ª Dribbble ä¸Š <a href=\"https://dribbble.com/yorkun\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">YorKun</a> çš„ä½œå“ - <a href=\"https://dribbble.com/shots/15522609-Button-Lock-Animation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Button Lock Animation</a>ï¼Œæ„Ÿè¬ä½œè€…é‚„æœ‰é™„ä¸Š Figma æª”æ¡ˆï¼Œè®“æˆ‘èƒ½æ›´è¼•é¬†çš„åƒç…§ Styleã€‚</p>\n<p>ä¸éæˆ‘ä¸¦æ²’æœ‰å®Œå…¨ç…§è‘—åŸä½œçš„å‹•ç•«è£½ä½œï¼Œä¸»è¦æ˜¯æƒ³å¤šè©¦è©¦ä¸€äº›ä¸åŒçš„å‹•ç•«çµ„åˆï¼Œæ¥ä¸‹ä¾†æˆ‘æœƒä¸€ä¸€ä»‹ç´¹ã€‚</p>\n<h2 id=\"å‹•ç•«å¯¦ä½œ\" style=\"position:relative;\"><a href=\"#%E5%8B%95%E7%95%AB%E5%AF%A6%E4%BD%9C\" aria-label=\"å‹•ç•«å¯¦ä½œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‹•ç•«å¯¦ä½œ</h2>\n<p>æˆ‘ä¸€é–‹å§‹æƒ³é”åˆ°çš„å‹•ç•«æœ‰å››é …ï¼š</p>\n<ol>\n<li>æ»‘å‹•è§£é–</li>\n<li>é–é ­é–‹å•Ÿèˆ‡æ‰è½</li>\n<li>å°æ‡‰é–‹é–ç‹€æ…‹çš„å‹•ç•«</li>\n<li>é–é ­æ‹–æ‹‰æ™‚çš„ 2D ç‰©ç†æ•ˆæœ</li>\n</ol>\n<p>ç†è«–ä¸Šæ‡‰è©²æ˜¯å¾ˆå¿«å°±èƒ½å®Œæˆï¼Œä½†å› ç‚ºå° GSAP ä¸ç†Ÿï¼ŒèŠ±äº†äº›å†¤æ‰è·¯ï¼Œå°è‡´æœ€å¾Œåªå®Œæˆäº†å‰ä¸‰é …çš„æ•ˆæœï¼Œç®—æ˜¯å·®å¼·äººæ„ã€‚</p>\n<p>ç”¨åˆ°çš„å·¥å…·ä¸»è¦æ˜¯ <a href=\"https://greensock.com/docs/v3/GSAP/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GSAP</a> èˆ‡ GSAP çš„ <a href=\"https://greensock.com/draggable/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Draggable plugin</a></p>\n<h3 id=\"æ»‘å‹•è§£é–\" style=\"position:relative;\"><a href=\"#%E6%BB%91%E5%8B%95%E8%A7%A3%E9%8E%96\" aria-label=\"æ»‘å‹•è§£é– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ»‘å‹•è§£é–</h3>\n<p>GSAP çš„ <a href=\"https://greensock.com/draggable/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Draggable plugin</a> çœŸçš„æœ‰å¤ ç°¡å–®å¥½ç”¨ï¼Œåªè¦çµ¦å®šæƒ³è¦å•Ÿå‹• Draggable çš„ DOM ç‰©ä»¶ï¼Œä¸¦æŒ‡å®šè¦æ‹–æ‹‰çš„æ–¹å‘ï¼ˆtypeï¼‰èˆ‡ç¯„åœï¼ˆboundsï¼‰ï¼Œå°±èƒ½ç¬é–“å®Œæˆé€™æ¨£çš„æ•ˆæœï¼ˆ<a href=\"https://codepen.io/arvin0731/pen/JjWWyZG?editors=1010\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">demo ç”±æ­¤å»</a>ï¼‰ï¼š</p>\n<p><video width=\"100%\" height=\"315\" controls src=\"https://i.imgur.com/1aL8FNc.mp4\"></video></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// è¨»å†Š gsap çš„ draggable plugin</span>\ngsap<span class=\"token punctuation\">.</span><span class=\"token function\">registerPlugin</span><span class=\"token punctuation\">(</span>Draggable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// æŠŠéœ€è¦äº’å‹•çš„ DOM ç”¨ querySelector é¸å‡ºä¾†</span>\n<span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".unlock-btn\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> lockerArea <span class=\"token operator\">=</span> button<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".locker\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> dropArea <span class=\"token operator\">=</span> button<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".drop\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ä¸»è¦çš„ Draggable instance</span>\nDraggable<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  type<span class=\"token operator\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span>\n  bounds<span class=\"token operator\">:</span> button<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">onDrag</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">onRelease</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">hitTest</span><span class=\"token punctuation\">(</span>dropArea<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      gsap<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        x<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n        ease<span class=\"token operator\">:</span> <span class=\"token string\">\"elastic.out(1, .75)\"</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// this.disable();</span>\n      gsap<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        x<span class=\"token operator\">:</span> dropArea<span class=\"token punctuation\">.</span>offsetLeft <span class=\"token operator\">-</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n        ease<span class=\"token operator\">:</span> <span class=\"token string\">\"elastic.out(1, .8)\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">onUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          tl<span class=\"token punctuation\">.</span><span class=\"token function\">restart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¸­é–“å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘å€‘æŒ‡å®š <code class=\"language-text\">type</code> ç‚º <code class=\"language-text\">x</code>ï¼Œè¡¨ç¤ºç§»å‹•æ–¹å‘ç‚º x è»¸ï¼Œè€Œ <code class=\"language-text\">bounds</code> ç‚º <code class=\"language-text\">button</code> DOM ç‰©ä»¶ï¼Œæ‰€ä»¥æœ€å¤šä¸æœƒæ‹–ç§»è¶…é butotn çš„ç¯„åœã€‚</p>\n<p>å¦å¤–ï¼Œå½±ç‰‡ä¸­æœ‰ä¸€å€‹æ•ˆæœæ˜¯ç•¶ä½ æ‹–æ‹‰åˆ°å‰å¾Œå…©ç«¯é»çš„æ™‚å€™ï¼Œæœƒæœ‰ä¸€å€‹å¸åŠ›æŠŠæ‹–ç§»ä¸­çš„ç‰©ä»¶å¸éå»ï¼Œé€™æ®µå…¶å¯¦æ˜¯éœ€è¦é é¡å¤–çš„å…©å€‹å‹•ç•«æ•ˆæœä¾†é”æˆã€‚</p>\n<p><code class=\"language-text\">Draggable.create()</code> å¯ä»¥å‚³å…¥çš„ Option ä¸­ï¼Œèƒ½æŒ‡å®š <code class=\"language-text\">onDrag</code> èˆ‡ <code class=\"language-text\">onRelease</code> handlerï¼Œåœ¨ <code class=\"language-text\">onRelease</code> çš„æ™‚å€™æˆ‘å€‘å¯ä»¥é€é <code class=\"language-text\">this.hitTest(dropArea)</code> é€™å€‹ Draggable å…§å»ºçš„å‡½å¼åˆ¤æ–·æ‹–æ‹‰ä¸­çš„ç‰©ä»¶æ˜¯å¦è§¸ç¢°åˆ°å¦ä¸€å€‹æŒ‡å®šçš„ DOM ç‰©ä»¶ï¼Œè‹¥é‚„æ²’ç¢°åˆ°ï¼Œæˆ‘å€‘å°±æ‹‰å›åˆ°èµ·é»ï¼Œä¹Ÿå°±æ˜¯é€™æ®µæ‰€åšçš„äº‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">gsap<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  x<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  duration<span class=\"token operator\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n  ease<span class=\"token operator\">:</span> <span class=\"token string\">\"elastic.out(1, .75)\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é€é <code class=\"language-text\">gsap.to</code> å¯ä»¥è®“æŒ‡å®šçš„ DOM ç‰©ä»¶è®Šæ›åˆ°æˆ‘å€‘å‚³å…¥çš„ property ç‹€æ…‹ï¼Œä»¥æ­¤ä¾‹å­ä¾†èªªå°±æ˜¯ä½ç§»åˆ°åŸé»ï¼Œç­‰åŒæ–¼ apply  <code class=\"language-text\">transform:translateX(0)</code>ã€‚</p>\n<p>è€Œè‹¥è§¸ç¢°åˆ°æŒ‡å®šç‰©ä»¶ï¼Œå‰‡å¯ä»¥èª¿æ•´ <code class=\"language-text\">x</code> ä¾†å°‡æ‹–ç§»ç‰©ä»¶ç›´æ¥æ‹‰åˆ°æŒ‡å®šç‰©ä»¶ï¼Œé€™æ¨£å°±èƒ½è£½é€ å‡º<em>å¸åŠ›</em>çš„æ•ˆæœã€‚</p>\n<p>æ­¤å¤–ï¼Œåœ¨è§¸ç¢°åˆ°ç‰©ä»¶å¾Œçš„ <code class=\"language-text\">gsap.to</code> å‡½å¼ä¸­ï¼Œæˆ‘å€‘ä¹Ÿå‚³å…¥äº† <code class=\"language-text\">onUpdate</code> handlerï¼Œè©² handler æœƒåœ¨å‹•ç•«å®Œæˆå¾Œè¢«è§¸ç™¼ï¼Œå‰›å¥½è®“æˆ‘å€‘èƒ½æ¥è‘—ä¸‹ä¸€éšæ®µçš„å‹•ç•« - <strong>é–é ­é–‹å•Ÿèˆ‡æ‰è½</strong>ã€‚</p>\n<h3 id=\"é–é ­é–‹å•Ÿèˆ‡æ‰è½\" style=\"position:relative;\"><a href=\"#%E9%8E%96%E9%A0%AD%E9%96%8B%E5%95%9F%E8%88%87%E6%8E%89%E8%90%BD\" aria-label=\"é–é ­é–‹å•Ÿèˆ‡æ‰è½ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>é–é ­é–‹å•Ÿèˆ‡æ‰è½</h3>\n<p>ç•¶æ‹–ç§»ç‰©ä»¶è§¸ç¢°åˆ°æŒ‡å®šç‰©ä»¶æ™‚ï¼Œ<code class=\"language-text\">onUpdate</code> æœƒè¢«è§¸ç™¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">onUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  tl<span class=\"token punctuation\">.</span><span class=\"token function\">restart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">onUpdate</code> ä¸­æˆ‘å€‘æ”¾çš„æ˜¯ä¸€å€‹ <a href=\"https://greensock.com/docs/v3/GSAP/Timeline\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Timeline</code> ç‰©ä»¶</a>ï¼Œå®ƒèƒ½è®“æˆ‘å€‘é€²è¡Œåºåˆ—å‹•ç•«ï¼Œä¸€æ­¥æ­¥æŒ‡å®šå„å€‹ç‰©ä»¶è©²å¦‚ä½•ä¾åºåŸ·è¡Œå‹•ç•«ã€‚</p>\n<p>ç”±æ–¼æˆ‘æ˜¯å°‡æ•´å€‹ timeline å‹•ç•«å®šç¾©åœ¨åˆ¥è™•ï¼Œæ‰€ä»¥ç•¶ <code class=\"language-text\">onUpdate</code> è¢«è§¸ç™¼æ™‚æ˜¯å‘¼å« <code class=\"language-text\">tl.restart()</code>ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥å®šç¾©åœ¨ handler è£¡é¢ã€‚</p>\n<p>Timeline ä½¿ç”¨æ–¹æ³•ä¸€æ¨£ç°¡å–®ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> tl <span class=\"token operator\">=</span> gsap<span class=\"token punctuation\">.</span><span class=\"token function\">timeline</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> paused<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//create the timeline</span></code></pre></div>\n<p>å…ˆå‰µå»ºä¸€å€‹ timeline ç‰©ä»¶ï¼Œé€™é‚Šå‚³å…¥ <code class=\"language-text\">{ paused: true }</code> æ˜¯å› ç‚ºæˆ‘å¸Œæœ›åœ¨ä¹‹å¾Œæ‰è§¸ç™¼ä»–ï¼ˆä¸Šè¿°æ‰€èªªï¼Œåœ¨æ‹–ç§»ç‰©ä»¶ç§»å‹•åˆ°æŒ‡å®šå€åŸŸå¾Œæ‰è§¸ç™¼)ï¼Œæ‰€ä»¥å…ˆé è¨­è®“ä»–æš«åœï¼Œé€™æ¨£æˆ‘å€‘åœ¨ <code class=\"language-text\">onUpdate</code> æ™‚å†å‘¼å« <code class=\"language-text\">restart()</code> å³å¯ã€‚</p>\n<p>é¡Œå¤–è©±ï¼Œä¸€é–‹å§‹æˆ‘ä¸¦ä¸æ˜¯ç”¨ <a href=\"https://greensock.com/docs/v3/GSAP/Timeline\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Timeline</a> è€Œæ˜¯åœ¨æ¯å€‹ <code class=\"language-text\">gsap.to</code> çš„ <code class=\"language-text\">onUpdate</code> ä¸­å»å‘¼å«å¦ä¸€å€‹ <code class=\"language-text\">gsap.to</code>ï¼Œé€™æ¨£é›–ç„¶ä¹Ÿæ˜¯å¯è¡Œï¼Œä½†è®“ç¨‹å¼ç¢¼å¯è®€æ€§é™ä½å¾ˆå¤šï¼Œæœ€çµ‚æˆ‘æ‰æ”¹æˆç”¨ <a href=\"https://greensock.com/docs/v3/GSAP/Timeline\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Timeline</a> ä¾†ä¸²æ¥åºåˆ—å‹•ç•«ã€‚</p>\n<p>æ¥è‘—å°±æ˜¯é‡å°æ¯å€‹æˆ‘å€‘æƒ³è¦è§¸ç™¼å‹•ç•«çš„ DOM ç‰©ä»¶è¨­å®šæ¬²è®ŠåŒ–çš„å€¼ï¼š</p>\n<p>å…ˆè®“æ•´å€‹é–é ­çš„èº«é«”éƒ¨åˆ†å¾€ä¸‹ä½ç§»ï¼Œè®“ä¸Šé¢éµç’°éƒ¨åˆ†ä¿æŒåŸåœ°ï¼Œé€ å‡ºé–‹é–çš„æ•ˆæœã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">tl<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerBody<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  y<span class=\"token operator\">:</span> <span class=\"token string\">\"120%\"</span><span class=\"token punctuation\">,</span>\n  duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"/image/button-animation-open-lock.gif\" alt=\"demo\"></p>\n<p>æ¥è‘—åˆ©ç”¨ <code class=\"language-text\">keyframes</code> é‡å°å–®ä¸€ç‰©ä»¶é€²è¡Œä¸€é€£ä¸²è¼ƒç‚ºç´°ç·»çš„å‹•ç•«ï¼Œé€™é‚Šä¸»è¦æ˜¯è¦å°‡æ•´å€‹é–é ­ï¼ˆåŒ…å«èº«é«”èˆ‡éµç’°éƒ¨åˆ†ï¼‰é€²è¡Œä½ç§»èˆ‡æ—‹è½‰ï¼Œç‡Ÿé€ å‡ºé–é ­æ‰“é–‹ä¸¦å¾é–ä¸Šæ‹¿æ‰çš„å‹•ç•«ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">tl<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerBody<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/*...ç•¥*/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>locker<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    keyframes<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        rotation<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span>\n        x<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n        transformOrigin<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        x<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n        y<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        x<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n        y<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        y<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n        opacity<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"/image/button-animation-drop-locker.gif\" alt=\"demo\"></p>\n<p>æ¥è‘—ä¹Ÿæ˜¯å·®ä¸å¤šçš„æ­¥é©Ÿï¼Œä¸€æ­¥æ­¥å°å…¶ä»–çš„ DOM ç‰©ä»¶åŠ ä¸Šæœ€å¾Œçš„ - <strong>å°æ‡‰é–‹é–ç‹€æ…‹çš„å‹•ç•«</strong>ï¼Œæ›¿æ›æ‰ <em>UNLOCK</em> å­—æ¨£ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">tl<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerBody<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/*...ç•¥*/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>locker<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/*...ç•¥*/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    rotation<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n    duration<span class=\"token operator\">:</span> <span class=\"token number\">0.3</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".message,.drop,.locker-area\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    y<span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n    opacity<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    duration<span class=\"token operator\">:</span> <span class=\"token number\">0.1</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">fromTo</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\".read-ok, .unlock-msg\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      y<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n      opacity<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      opacity<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      y<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ³¨æ„åˆ°çš„æ˜¯æˆ‘å€‘é™¤äº†å‚³å…¥ DOM object çµ¦ <code class=\"language-text\">gsap.to</code> èˆ‡ <code class=\"language-text\">gsap.fromTo</code> å¤–ï¼Œä¹Ÿèƒ½ç›´æ¥æŒ‡å®š class nameï¼Œéå¸¸æ–¹ä¾¿ã€‚</p>\n<p>å°±é€™æ¨£ç°¡å–®å¹¾è¡Œç¨‹å¼ç¢¼ï¼Œå°±åšå¥½äº†ä¸€å€‹å¥—ç”¨åœ¨æŒ‰éˆ•ä¸Šçš„å‹•ç•«ï¼Œæ‡‰è©²é‚„ç®—æ˜¯ä¸éŒ¯å§ï¼</p>\n<p class=\"codepen\" data-height=\"369\" data-theme-id=\"29194\" data-default-tab=\"result\" data-user=\"arvin0731\" data-slug-hash=\"dyvvrBb\" style=\"height: 369px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"Drag to unlock button with locker (final ver.)\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/dyvvrBb\">\n  Drag to unlock button with locker (final ver.)</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>ä»Šå¤©ç°¡å–®ç·´ç¿’äº†ä¸€ä¸‹å¾ Dribbble ä¸Šæ‰¾éˆæ„Ÿç„¶å¾Œç”¨å‰ç«¯æŠ€è¡“å°‡å‹•ç•«å¯¦ä½œå‡ºä¾†çš„éç¨‹ï¼Œæˆ–è¨±æ²’æœ‰ä»€éº¼æ–°çš„æ±è¥¿ï¼Œä½†å¸Œæœ›èƒ½çµ¦å¤§å®¶å¸¶ä¾†é»å•Ÿç™¼ï¼Œé˜²ç–«æœŸé–“ä¸å¦¨åœ¨å®¶åšé»æœ‰è¶£çš„å‹•ç•«æˆ– CSS artï¼Œè‡ªå¨›å¨›äººä¸€ä¸‹ï¼</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://www.tinydesign.co.uk/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ben Evans</a> </li>\n<li><a href=\"https://dribbble.com/ai\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Aaron Iker</a></li>\n<li><a href=\"https://greensock.com/docs/v3/GSAP/gsap.to()\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GSAP</a></li>\n<li><a href=\"https://frontend.horse/articles/realistic-art-with-css/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">frontend.horse</a></li>\n</ol>","id":"e7b1f0f4-81d4-5ddc-9c87-245af6ede978","fields":{"slug":"practice-animation-on-button"},"frontmatter":{"date":"2021-05-22T13:37:30.000Z","title":"ç·´ç¿’å‹•ç•«çš„å¥½é¸æ“‡ - æŒ‰éˆ•","tags":["css","gsap","web"],"type":"tech","slug":"practice-animation-on-button"},"timeToRead":9},{"excerpt":"æœ€è¿‘å¾ˆè¿· Netflix ä¸Šçš„ Formula 1: Drive to Surviveï¼Œçœ‹å„å®¶è»Šå» èˆ‡è»Šæ‰‹ç‚ºäº†çˆ­å¥ªé‚£å¹¾ç§’çš„é€Ÿåº¦è€Œæ‹¼ç›¡å…¨åŠ›ï¼Œéå¸¸ç†±è¡€å‹µå¿—ï¼ŒæŠŠé€™ç²¾ç¥å»¶ä¼¸åˆ°ç¶²é è£½ä½œä¸Šï¼Œå¤§æ¦‚å°±æ˜¯è¦å°‡ç¶²é æ•ˆèƒ½èª¿æ•´åˆ°æ¥µè‡´ï¼Œå„ç¨®èƒ½æ¸›å°‘ Loading æ™‚é–“çš„æŠ€å·§éƒ½å¾—ç”¨ä¸Šã€‚","html":"<p>æœ€è¿‘å¾ˆè¿· Netflix ä¸Šçš„ Formula 1: Drive to Surviveï¼Œçœ‹å„å®¶è»Šå» èˆ‡è»Šæ‰‹ç‚ºäº†çˆ­å¥ªé‚£å¹¾ç§’çš„é€Ÿåº¦è€Œæ‹¼ç›¡å…¨åŠ›ï¼Œéå¸¸ç†±è¡€å‹µå¿—ï¼ŒæŠŠé€™ç²¾ç¥å»¶ä¼¸åˆ°ç¶²é è£½ä½œä¸Šï¼Œå¤§æ¦‚å°±æ˜¯è¦å°‡ç¶²é æ•ˆèƒ½èª¿æ•´åˆ°æ¥µè‡´ï¼Œå„ç¨®èƒ½æ¸›å°‘ Loading æ™‚é–“çš„æŠ€å·§éƒ½å¾—ç”¨ä¸Šã€‚</p>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>æœ€è¿‘å…¬å¸æœ‰å€‹è¡ŒéŠ·æ´»å‹•éœ€è¦åšä¸€å€‹ç°¡å–®çš„ SPAï¼ŒåŸºæœ¬ä¸Šåªæœ‰ç°¡å–®çš„ä¸‰å€‹é é¢ï¼Œå®Œå…¨å¯ä»¥åˆ©ç”¨ Gatsby æˆ– Nextjs ä¾†è£½ä½œéœæ…‹é é¢ï¼Œç„¶å¾Œéƒ¨ç½²åˆ° CDN ä¸Šé ­ï¼Œæ•ˆèƒ½ä¸Šä¾†èªªç†æ‡‰è¶³å¤ å¥½äº†ï¼Œä½†æ˜¯æˆ‘å€‘çš„è¨­è¨ˆå¸«åœ¨é é¢ä¸Šæ··ç”¨äº†å¤šç¨®çš„å­—é«”ï¼Œå°¤å…¶æ˜¯æ—¥æ–‡éƒ¨åˆ†ï¼Œé™¤äº†ä¸€èˆ¬ç€è¦½å™¨å…§å»ºçš„å­—é«”å¤–ï¼ŒæŸäº›å…ƒä»¶æ¡ç”¨é¡å¤–çš„å…è²»å­—é«”ï¼Œä¾‹å¦‚ <a href=\"https://www.freejapanesefont.com/corporate-logo-font-download/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Corporate Logo Font</a>ï¼Œé€™ä»£è¡¨æˆ‘å€‘éœ€è¦é¡å¤–å»ä¸‹è¼‰é€™äº›å­—å‹ï¼Œä½†ç‚ºäº†é é¢ä¸Šçš„å¹¾å€‹å­—ï¼Œå»ä¸‹è¼‰ä¸€æ•´å€‹å­—å‹æª”æ¡ˆï¼ˆttf, 2.6MBï¼‰å¯¦åœ¨å¾ˆæµªè²»ï¼Œå› æ­¤åªå¥½ä¾†ç ”ç©¶ä¸€ä¸‹å¦‚ä½•å®¢è£½åŒ–å­—å‹æª”æ¡ˆï¼Œåªè¼‰å…¥æˆ‘å€‘éœ€è¦çš„å­—ã€‚</p>\n<p>é›–ç„¶é€™æ„Ÿè¦ºæ˜¯å€‹å¾ˆå®¹æ˜“é‡åˆ°çš„éœ€æ±‚ï¼Œä½†æˆ‘é‚„çœŸçš„æ˜¯ç¬¬ä¸€æ¬¡å¯¦éš›éœ€è¦è™•ç†ï¼Œæ„Ÿè¬åŒäº‹ Carlos æä¾›è§£æ³•ï¼Œé€éé€™ç¯‡æ–‡ç« ç­†è¨˜ä¸€ä¸‹ï¼Œå¸Œæœ›å°ä»–äººä¹Ÿæœ‰é»å¹«åŠ©ã€‚</p>\n<h3 id=\"é–‹å§‹å‰å…ˆç¨ç¨è¤‡ç¿’ä¸€ä¸‹ä»€éº¼æ˜¯-ttfé‚„æœ‰ä»€éº¼å…¶ä»–å­—å‹æ ¼å¼å‘¢\" style=\"position:relative;\"><a href=\"#%E9%96%8B%E5%A7%8B%E5%89%8D%E5%85%88%E7%A8%8D%E7%A8%8D%E8%A4%87%E7%BF%92%E4%B8%80%E4%B8%8B%E4%BB%80%E9%BA%BC%E6%98%AF-ttf%E9%82%84%E6%9C%89%E4%BB%80%E9%BA%BC%E5%85%B6%E4%BB%96%E5%AD%97%E5%9E%8B%E6%A0%BC%E5%BC%8F%E5%91%A2\" aria-label=\"é–‹å§‹å‰å…ˆç¨ç¨è¤‡ç¿’ä¸€ä¸‹ä»€éº¼æ˜¯ ttfé‚„æœ‰ä»€éº¼å…¶ä»–å­—å‹æ ¼å¼å‘¢ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>é–‹å§‹å‰å…ˆç¨ç¨è¤‡ç¿’ä¸€ä¸‹ï¼Œä»€éº¼æ˜¯ ttfï¼Ÿé‚„æœ‰ä»€éº¼å…¶ä»–å­—å‹æ ¼å¼å‘¢ï¼Ÿ</h3>\n<p><a href=\"https://zh.wikipedia.org/zh-tw/TrueType\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TTFï¼ˆTrueType Fontï¼‰</a>æ˜¯ç”±è˜‹æœå’Œå¾®è»Ÿå…±åŒé–‹ç™¼çš„ä¸€ç¨®é›»è…¦è¼ªå»“å­—å‹é¡å‹æ¨™æº–ï¼Œæ˜¯ Mac èˆ‡ Windows ä¸Šæœ€å¸¸è¦‹çš„æ ¼å¼ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰ä¸»æµç€è¦½å™¨éƒ½æ”¯æ´ï¼Œä¹Ÿæ˜¯å…è²»æˆ–ä¾¿å®œçš„ç¬¬ä¸‰æ–¹å­—é«”æœ€å¸¸æä¾›çš„æ ¼å¼ã€‚ç¼ºé»æ˜¯æª”æ¡ˆæœªç¶“éå£“ç¸®ï¼Œæ–‡ä»¶å¤§å°è¼ƒå¤§ã€‚</p>\n<p>å¦ä¸€å€‹ä¸»æµæ ¼å¼ç‚º <a href=\"https://zh.wikipedia.org/zh-hant/OpenType\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OTFï¼ˆOpenType Fontï¼‰</a>ï¼Œæ˜¯ä¸€ç¨®å¯ç¸®æ”¾å­—å‹ï¼ˆscalable fontï¼‰é›»è…¦å­—å‹é¡å‹ï¼Œç”± TrueType å»¶ä¼¸è€Œä¾†ï¼Œæ¡ç”¨ PostScript æ ¼å¼ï¼Œæ˜¯å¾®è»Ÿèˆ‡ Adobe è¯åˆé–‹ç™¼ï¼Œç”¨ä¾†æ›¿ä»£ TrueType å­—å‹çš„æ–°å­—å‹ã€‚</p>\n<p><a href=\"https://zh.wikipedia.org/wiki/Web%E9%96%8B%E6%94%BE%E5%AD%97%E5%9E%8B%E6%A0%BC%E5%BC%8F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WOFFï¼ˆWeb Open Font Formatï¼‰</a> å‰‡æ˜¯å®Œå…¨ç‚ºäº† Web è€Œè¨­è¨ˆçš„æ ¼å¼ï¼Œç”± Mozillaã€Microsoft èˆ‡ Opera åˆä½œæ¨å‡ºã€‚WOFF çš„å­—å‹éƒ½ç¶“ç”± WOFF çš„ç·¨ç¢¼å·¥å…·å£“ç¸®ï¼Œé«”ç©èƒ½æ¯” tff å° 40%ï¼Œç¾åœ¨å·²ç¶“æ˜¯ç¶²é å­—é«”çš„æ¨è–¦æ¨™æº–ã€‚WOFF2 å‰‡æ˜¯ WOFF çš„å‡ç´šç‰ˆï¼Œé«”ç©å¯ä»¥å£“å¾—æ›´å°ã€‚</p>\n<p>æœ€å¾Œï¼Œç•¶ç„¶å¤§å®¶ç†Ÿæ‚‰çš„ SVG ä¹Ÿå¯ä»¥ç®—æ˜¯ä¸€ç¨®ã€‚</p>\n<p>åœ¨ä¸»æµçš„ä½œæ¥­ç³»çµ±èˆ‡ç€è¦½å™¨ä¸Šï¼Œé€™å¹¾ç¨®æ ¼å¼çš„æ”¯æ´åº¦éƒ½å¾ˆé«˜ï¼Œè€Œå…¶ä¸»è¦çš„ç´°ç¯€å·®ç•°ï¼Œå› ç‚ºéæœ¬ç¯‡é‡é»ï¼Œå°±ä¸å¤šè‘—å¢¨ï¼Œæœ‰èˆˆè¶£çš„è®€è€…å¯ä»¥åˆ° wiki ä¸ŠæŸ¥çœ‹ã€‚</p>\n<p>ä»Šå¤©è¦æ¸›å°‘çš„å­—å‹æª”æ¡ˆç‚ºæœ€å¸¸è¦‹çš„ tff æ ¼å¼ã€‚</p>\n<p>é †å¸¶ä¸€æï¼Œç•¶æˆ‘åœ¨æ’°å¯«æ–‡ç« çš„æ™‚å€™ï¼Œå°æ–¼å­—å‹ã€å­—é«”ç­‰åè©çš„å·®ç•°å¾ˆæ¨¡ç³Šï¼Œå¥½åœ¨ JustFont åœ¨<a href=\"https://blog.justfont.com/2013/02/some_nouns/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å¤šå¹´å‰çš„ä¸€ç¯‡æ–‡ç« </a>è§£é‡‹å¾—è »æ¸…æ¥šçš„ï¼Œæ¨è–¦å¤§å®¶ç†è§£ä¸€ä¸‹ï¼</p>\n<h2 id=\"setup\" style=\"position:relative;\"><a href=\"#setup\" aria-label=\"setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setup</h2>\n<p>è¦é‡å°å­—å‹é€²è¡Œè™•ç†çš„è©±ï¼Œé¦–å…ˆæˆ‘å€‘éœ€è¦ä¸‹è¼‰ FontForgeï¼ŒFontForge æ˜¯ä¸€å€‹å¾ˆæœ‰åçš„è»Ÿé«”ï¼Œå¯ä»¥ç”¨ä¾†è¨­è¨ˆã€å‰µå»ºå­—é«”ï¼Œæˆ–æ˜¯é€²è¡Œå„ç¨®å­—å‹ç›¸é—œçš„æ“ä½œï¼Œå¯ä»¥å¾ <a href=\"https://fontforge.org/en-US/downloads/mac-dl/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://fontforge.org/en-US/downloads/mac-dl/</a> ä¸‹è¼‰ Mac ç‰ˆæœ¬ï¼ˆä¹Ÿæœ‰ Linux èˆ‡ Windows çš„ç‰ˆæœ¬ï¼‰ã€‚</p>\n<p>åœ¨å®˜ç¶²ä¸Šä½ å¯ä»¥æ‰¾åˆ°è¨±å¤šæ–‡ä»¶ï¼Œç”šè‡³æ˜¯ä¸€æ•´å€‹ <a href=\"http://designwithfontforge.com/en-US/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ebook</a> ä¾†æ•™ä½ å¦‚ä½•ç”¨ FontForge ä¾†è¨­è¨ˆå­—é«”ã€‚</p>\n<h3 id=\"ç”¨-fontforge-é–‹å•ŸåŸå§‹å­—å‹æª”\" style=\"position:relative;\"><a href=\"#%E7%94%A8-fontforge-%E9%96%8B%E5%95%9F%E5%8E%9F%E5%A7%8B%E5%AD%97%E5%9E%8B%E6%AA%94\" aria-label=\"ç”¨ fontforge é–‹å•ŸåŸå§‹å­—å‹æª” permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç”¨ FontForge é–‹å•ŸåŸå§‹å­—å‹æª”</h3>\n<p>è¼‰å¥½ FontForge å¾Œï¼Œæˆ‘å€‘å…ˆæ‰“é–‹åŸå§‹çš„å­—å‹æª”ï¼Œé€™é‚Šä»¥å‰é¢æåˆ°çš„ Corporate Logo Font ç‚ºä¾‹ï¼ˆè¨»ï¼š åœ¨ MacOS Catalina æˆ– Big Surï¼Œç›´æ¥é»é¸è¼‰å¥½åœ¨ Apps å…§çš„ FontForge app å¯èƒ½æœƒè¢« OS æ“‹ä¸‹ä¾†ï¼Œå¿«ä¸€é»çš„æ–¹å¼æ˜¯<code class=\"language-text\">æŒ‰å³éµ -> \"Show Package Contents\" -> \"Contents\" -> \"MacOS\"</code>ï¼Œç„¶å¾Œé»é¸ FontForg.appï¼Œæ¥è€…å°±æœƒæ‰“é–‹ terminal ä¸¦åŸ·è¡Œ FontForgeã€‚ï¼‰ï¼š</p>\n<p><img src=\"/image/fontforge-corporatelogo-original.png\" alt=\"original-font-file-in-fontforge\"></p>\n<p>é–‹å•Ÿå¾Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„å­—åœ–ï¼Œæ¥è‘—å…¶å¯¦ä½ å°±å¯ä»¥é¸å–ä½ ä¸è¦çš„å­—åœ–ï¼Œç„¶å¾Œ <code class=\"language-text\">clear</code> æ‰å®ƒå€‘ï¼š</p>\n<p><img src=\"/image/clear-font.png\" alt=\"clear-font\"></p>\n<p>ä½†ç…§é€™æ¨£è™•ç†ï¼Œå¼„åˆ°å¤©è’åœ°è€å…­è¦ªä¸èªéƒ½å¼„ä¸å®Œã€‚å·¥ç¨‹å¸«è¦ç”¨æ›´è°æ˜çš„è§£æ³•ã€‚</p>\n<h2 id=\"æ­£ç¢ºçš„å§¿å‹¢\" style=\"position:relative;\"><a href=\"#%E6%AD%A3%E7%A2%BA%E7%9A%84%E5%A7%BF%E5%8B%A2\" aria-label=\"æ­£ç¢ºçš„å§¿å‹¢ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ­£ç¢ºçš„å§¿å‹¢</h2>\n<p>æ‰“å¾ä¸€é–‹å§‹ï¼Œæˆ‘å€‘å°±æ˜¯å› ç‚ºåŸå§‹å­—æª”è£¡é¢å¤ªå¤šæˆ‘å€‘ä¸è¦çš„æ±è¥¿ï¼Œæˆ‘å€‘éœ€è¦çš„å¾ˆå°‘ï¼Œæ‰æƒ³è¦å¾åŸå§‹æª”æ¡ˆä¸­æ“·å–éœ€è¦çš„éƒ¨åˆ†ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œå°±æ‡‰è©²å¾æˆ‘å€‘<strong>æƒ³è¦çš„å­—åœ–</strong>ä¸‹æ‰‹ï¼Œè€Œä¸æ˜¯æ…¢æ…¢åˆªæ‰æˆ‘å€‘ä¸è¦çš„å­—åœ–ã€‚</p>\n<p>FontForge å…¶å¯¦æœ‰æä¾›ä¸€å€‹å¾ˆæ–¹ä¾¿çš„åŠŸèƒ½ï¼Œå«åš <code class=\"language-text\">Invert Selection</code>ï¼Œèƒ½å¤ é¸å–æ‰€æœ‰<em>ä½ æ²’æœ‰é¸å–åˆ°çš„æ±è¥¿</em>ï¼Œç›´æ¥çœ‹å€‹å‹•åœ–ç¯„ä¾‹ï¼š</p>\n<p><img src=\"/image/fontforge-invert-select.gif\" alt=\"fontforge-invert-select\"></p>\n<p>é€™æ¨£ä¸€ä¾†ï¼Œå°±å¾ˆç°¡å–®äº†ï¼Œåªè¦é¸å–ä½ä½ æƒ³è¦çš„å­—åœ–ï¼Œç„¶å¾Œé»é¸ <code class=\"language-text\">Edit -> Select -> Invert Selection</code>ï¼Œå°±å®Œæˆäº†ï¼Œæ¥è‘—å°±æŠŠ Fontforge è‡ªå‹•å¹«ä½ é¸å–çš„å­—åœ– <code class=\"language-text\">clear</code> æ‰å³å¯ã€‚</p>\n<p>ä½†é€™æ¨£é‚„æ˜¯æœ‰å€‹å•é¡Œã€‚</p>\n<p>å­—å‹æª”å…§å®¹é€™éº¼å¤šï¼Œæˆ‘è¦æ‰‹å‹•åœ¨ FontForge ä¸­æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„å­—åœ–ä¸ä¹Ÿæ˜¯æ‰¾åˆ°å±±çª®æ°´ç›¡å—ï¼Ÿ</p>\n<h3 id=\"æ­£ç¢ºå§¿å‹¢äºŒ\" style=\"position:relative;\"><a href=\"#%E6%AD%A3%E7%A2%BA%E5%A7%BF%E5%8B%A2%E4%BA%8C\" aria-label=\"æ­£ç¢ºå§¿å‹¢äºŒ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ­£ç¢ºå§¿å‹¢äºŒ</h3>\n<p>FontForge æ˜¯å€‹è »å¼·å¤§çš„å·¥å…·ï¼Œé™¤äº† GUI ä»¥å¤–ï¼Œä¹Ÿæä¾› interpretersï¼Œè®“ä½ èƒ½æ’°å¯« scripts ä¾†ä¿®æ”¹å­—å‹æª”ã€‚</p>\n<p>ä¸€å€‹ interpreter æ˜¯ Pythonï¼Œå¦ä¸€å€‹å‰‡æ˜¯å…¶å…§å»ºçš„ scripting languageã€‚<a href=\"https://fontforge.org/docs/scripting/scripting.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è©³ç´°çš„ç¯„ä¾‹ã€èªæ³•ç­‰å¯ä»¥å¾å®˜ç¶²æŸ¥çœ‹ï¼Œæ–‡ä»¶å¾ˆå®Œæ•´</a>ã€‚</p>\n<p>æœ‰äº† scripting çš„åŠŸèƒ½ï¼Œæˆ‘å€‘å°±ä¸ç”¨è‡ªå·±æ‰‹å‹•é¸å–å­—åœ–å•¦ã€‚</p>\n<p>åœ¨ FontForge UI ä¸Šï¼Œä½ å¯ä»¥é»é¸ <code class=\"language-text\">File -> Execute Script</code> å«å‡º Dialogï¼Œå¯ä»¥é¸æ“‡ç›´æ¥è²¼ä¸Š Python ç¨‹å¼ç¢¼ï¼Œä¹Ÿå¯ä»¥é¸æ“‡ <code class=\"language-text\">FF -> Call</code>ï¼Œä¾†è¼‰å…¥ä½¿ç”¨å¦ä¸€å€‹å…§å»º interpreter çš„ script fileã€‚</p>\n<p><img src=\"/image/fontforge-exec-scripts.gif\" alt=\"fontforge-exec-scripts\"></p>\n<p>å› ç‚ºæˆ‘å€‘è¦è™•ç†çš„å‹•ä½œå¾ˆç°¡å–®ï¼Œåªæœ‰ä¸‰å€‹å‹•ä½œï¼ˆé¸å–å­—å‹ã€åè½‰é¸å–ã€åˆªé™¤ï¼‰ï¼Œæ‰€ä»¥ç›´æ¥ç”¨å…§å»ºçš„ script language å…¶å¯¦æ¯”è¼ƒç°¡å–®ï¼Œå¯ä»¥åˆ©ç”¨ NodeJS ä¾†ç”¢ç”ŸåŸ·è¡Œæª”ã€‚</p>\n<h3 id=\"éœ€è¦çš„-api\" style=\"position:relative;\"><a href=\"#%E9%9C%80%E8%A6%81%E7%9A%84-api\" aria-label=\"éœ€è¦çš„ api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>éœ€è¦çš„ API</h3>\n<p>ä¸‰å€‹å‹•ä½œï¼Œé¸å–å­—åœ–ã€åè½‰é¸å–ã€åˆªé™¤ï¼Œåˆ†åˆ¥å°æ‡‰çš„ API ç‚º <code class=\"language-text\">SelectMore()</code>ã€<code class=\"language-text\">SelectInvert()</code>ã€<code class=\"language-text\">DetachAndRemoveGlyphs()</code>ã€‚</p>\n<p>æˆ‘å€‘è¦åŒ¯å…¥é€² FontForge çš„åŸ·è¡Œæª”ï¼Œå°±åªéœ€è¦é€™ä¸‰å€‹ API å³å¯ã€‚</p>\n<p><code class=\"language-text\">SelectMore()</code> ç”¨æ³•æ˜¯å‚³å…¥å­—å‹çš„ unicode ä½œç‚ºåƒæ•¸ï¼Œå³å¯é¸å–è©²å­—åœ–ï¼Œä¸éåŸ·è¡Œä¸€æ¬¡åªèƒ½é¸å–ä¸€å€‹å­—åœ–ã€‚<code class=\"language-text\">SelectInvert()</code> èˆ‡ <code class=\"language-text\">DetachAndRemoveGlyphs()</code> å‰‡ä¸éœ€è¦åƒæ•¸ã€‚</p>\n<h3 id=\"ç¯„ä¾‹ç¨‹å¼\" style=\"position:relative;\"><a href=\"#%E7%AF%84%E4%BE%8B%E7%A8%8B%E5%BC%8F\" aria-label=\"ç¯„ä¾‹ç¨‹å¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¯„ä¾‹ç¨‹å¼</h3>\n<p>çŸ¥é“äº†éœ€è¦çš„ APIï¼Œæˆ‘å€‘å°±å¯ä»¥ä¾†å¯«ç¨‹å¼ç”¢ç”ŸåŸ·è¡Œæª” <code class=\"language-text\">subset-font.pe</code>ï¼Œ<code class=\"language-text\">.pe</code> æ˜¯ FontForge å¯ä»¥æ¥å—çš„æ ¼å¼ï¼Œ<code class=\"language-text\">.ff</code> ä¹Ÿè¡Œï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// æŒ‘é¸å‡ºä½ é é¢ä¸Šéœ€è¦ç”¨åˆ°çš„å­—</span>\n<span class=\"token keyword\">const</span> characters <span class=\"token operator\">=</span> <span class=\"token string\">'123æ‹›å¾…ã‚³ãƒ¼ãƒ‰'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> stream <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">createWriteStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./subset-font.pe'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nstream<span class=\"token punctuation\">.</span><span class=\"token function\">once</span><span class=\"token punctuation\">(</span><span class=\"token string\">'open'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fd</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  characters<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">char</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// è½‰æ›æˆ 16 é€²ä½</span>\n    <span class=\"token keyword\">let</span> hex <span class=\"token operator\">=</span> char<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// è£œé›¶ï¼Œä»¥ç¬¦åˆ \\u æ ¼å¼</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hex<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      hex <span class=\"token operator\">=</span> hex<span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// ç„¶å¾ŒåŸ·è¡Œæª”å…§å¯«å…¥ SelectMore</span>\n    stream<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">SelectMore(\"u</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>hex<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\")\\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// åè½‰é¸æ“‡ï¼Œé¸å–æ‰€æœ‰å…¶ä»–ä¸è¦çš„å­—</span>\n  stream<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SelectInvert()\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// æœ€å¾Œç§»é™¤å­—å‹</span>\n  stream<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DetachAndRemoveGlyphs()\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  stream<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åˆ©ç”¨ FontForge API æ­é…ä¸Šé¢ç¨‹å¼å¾Œï¼Œæœƒç”¢ç”Ÿä»¥ä¸‹å…§å®¹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"shsubset-font.pe\"><pre class=\"language-shsubset-font.pe\"><code class=\"language-shsubset-font.pe\">SelectMore(&quot;u0031&quot;)\nSelectMore(&quot;u0032&quot;)\nSelectMore(&quot;u0033&quot;)\nSelectMore(&quot;u62db&quot;)\nSelectMore(&quot;u5f85&quot;)\nSelectMore(&quot;u30b3&quot;)\nSelectMore(&quot;u30fc&quot;)\nSelectMore(&quot;u30c9&quot;)\nSelectInvert()\nDetachAndRemoveGlyphs()</code></pre></div>\n<p>æ¥è‘—ä¾ç…§<a href=\"#%E6%AD%A3%E7%A2%BA%E5%A7%BF%E5%8B%A2%E4%BA%8C\">æ­£ç¢ºå§¿å‹¢äºŒ</a>çš„æ–¹å¼ï¼ŒåŒ¯å…¥æ­¤åŸ·è¡Œæª”ï¼ŒFontForge å°±æœƒç”¢ç”ŸåªåŒ…å«æˆ‘å€‘æƒ³è¦çš„å­—åœ–çš„å­—å‹æª”äº†ï¼ï¼š</p>\n<p><img src=\"/image/fontforge-script-subset-font.gif\" alt=\"fontforge-script-subset-font.gif\"></p>\n<p>ä¸éå› ç‚ºåˆªæ‰çš„å­—åœ–å¾ˆå¤šï¼Œæˆ‘å€‘å¯ä»¥é€²ä¸€æ­¥é€é FontForge çš„å£“ç¸®åŠŸèƒ½ä¾†è¼”åŠ©æˆ‘å€‘æª¢è¦–æˆå“ï¼š</p>\n<p>å‰›åŸ·è¡Œå®Œ script å¾Œï¼Œç•«é¢æœƒåœç•™åœ¨ select æ‰€æœ‰å…¶ä»–ä½ ä¸è¦çš„å­—åœ–çš„ç‹€æ…‹ï¼Œä½ å¯ä»¥å…ˆéš¨ä¾¿é»é¸ç©ºç™½è™• deselect æ‰€æœ‰å­—åœ–ï¼Œç„¶å¾Œé¸æ“‡ <code class=\"language-text\">Encoding -> Compact</code>ï¼š</p>\n<p><img src=\"/image/fontforge-compact.gif\" alt=\"fontforge-compact\"></p>\n<p>å°±èƒ½æ¸…æ¥šçœ‹åˆ°æ•´å€‹æª”æ¡ˆçš„ç¢ºåªå‰©ä¸‹æˆ‘å€‘æ‰€é¸çš„å­—åœ–ï¼ˆä»¥ä¸Šé¢ç¯„ä¾‹ script ä¾†èªªå°±æ˜¯ <code class=\"language-text\">123æ‹›å¾…ã‚³ãƒ¼ãƒ‰</code>ï¼‰ã€‚</p>\n<p>æœ€å¾Œæ­¥é©Ÿå°±æ˜¯ç”¢ç”Ÿå­—å‹æª”æ¡ˆï¼Œé»é¸ <code class=\"language-text\">File -> Generate Fonts...</code>ï¼Œç„¶å¾Œçœ‹ä½ è¦ export æˆä»€éº¼æ ¼å¼ï¼Œå¦‚æœæ˜¯ç¶²é ä¸Šè¦ç”¨ï¼Œç•¶ç„¶å°±æ¨è–¦ä½¿ç”¨ <code class=\"language-text\">woff</code>ï¼š</p>\n<p><img src=\"/image/fontforge-subset-font-generate-file.png\" alt=\"fontforge-subset-font-generate-file\"></p>\n<p>æŒ‰ä¸‹ <code class=\"language-text\">Generate</code> å¾Œå¯èƒ½æœƒå‡ºç¾ Errorï¼Œå¯ä»¥ä¸ç”¨ç†ä»–ï¼Œç¹¼çºŒ generateï¼š</p>\n<p><img src=\"/image/fontforge-generate-error.png\" alt=\"fontforge-generate-error\"></p>\n<p>é€™æ¨£å°±å¤§åŠŸå‘Šæˆäº†ï¼</p>\n<p>ï¼ˆè¨»ï¼šé—œæ‰ FontForge æ™‚ï¼Œè¨˜å¾—é¸ <code class=\"language-text\">Don't Save</code>ï¼Œä¸ç„¶æœƒè“‹æ‰åŸå§‹çš„æª”æ¡ˆå–”ï¼ï¼‰</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>é€™å€‹æ–¹å¼å¯ä»¥ç”¨åœ¨å„ç¨®å­—é«”æª”æ¡ˆï¼Œéå¸¸æ–¹ä¾¿ï¼Œå°æ–¼éœæ…‹é é¢ä¸Šå…§å®¹æ–‡å­—ä¸å¤ªæœƒè®Šå‹•çš„ç‹€æ³ä¸‹ï¼Œåˆ©ç”¨é€™å€‹æŠ€å·§å¯ä»¥å¤§å¹…é™ä½éœ€è¦è¼‰å…¥çš„æª”æ¡ˆå¤§å°ï¼Œä»¥æˆ‘å…¬å¸å°ˆæ¡ˆçš„ä¾‹å­ä¾†èªªï¼Œå¾åŸæœ¬ 2.6MB çš„ tff æª”æ¡ˆï¼Œæœ€å¾Œå¯ä»¥è®Šæˆ 8KB çš„ woff æª”æ¡ˆï¼Œçœä¸‹çš„å¤§å°å¾ˆå¯è§€çš„ã€‚</p>\n<p>ç°¡å–®çš„ç­†è¨˜ï¼Œå¸Œæœ›å°å¤§å®¶æœ‰å¹«åŠ©ï¼</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://zhuanlan.zhihu.com/p/28179203\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web å­—é«”ç°¡ä»‹: TTF, OTF, WOFF, EOT &#x26; SVG</a></li>\n<li><a href=\"https://stackoverflow.com/questions/35555816/delete-all-unused-characters-from-a-ttf-font-with-fontforge/35754448#35754448\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Delete all unused characters from a TTF-font with Fontforge</a></li>\n<li><a href=\"https://fontforge.org/docs/scripting/scripting.html#\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">fontforge docs</a></li>\n<li><a href=\"https://blog.justfont.com/2013/02/some_nouns/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[but] é›œè«‡ â”€ å¸¸å¸¸ææ··çš„ä¸€äº›è©</a></li>\n</ol>","id":"50a95194-1c2f-534b-9d86-281727779fe5","fields":{"slug":"make-smaller-ttf-font-files-for-web"},"frontmatter":{"date":"2021-04-23T23:20:17.000Z","title":"é€éæ¸›å°‘ ttf å­—é«”æª”æ¡ˆå¤§å°ä¾†å¢é€²ç¶²é æ•ˆèƒ½","tags":["web","font","performance"],"type":"tech","slug":"make-smaller-ttf-font-files-for-web"},"timeToRead":8},{"excerpt":"ä»Šå¹´ åœ°å‘³ãƒãƒ­ã‚¦ã‚£ãƒ³ çš„ç¬¬ä¸€åæˆ‘çµ¦é€™ä½ LOL - ãƒ‘ãƒ³ãƒ€ãŒè¶³ã«ã¾ã¨ã‚ã‚Šã¤ã„ã¦ã—ã¾ã†é£¼è‚²å“¡","html":"<blockquote>\n<p>ä»Šå¹´ åœ°å‘³ãƒãƒ­ã‚¦ã‚£ãƒ³ çš„ç¬¬ä¸€åæˆ‘çµ¦é€™ä½ LOL - ãƒ‘ãƒ³ãƒ€ãŒè¶³ã«ã¾ã¨ã‚ã‚Šã¤ã„ã¦ã—ã¾ã†é£¼è‚²å“¡</p>\n</blockquote>\n<!-- more -->\n<blockquote class=\"twitter-tweet\" data-dnt=\"true\" data-theme=\"light\"><p lang=\"ja\" dir=\"ltr\">ãƒ‘ãƒ³ãƒ€ãŒè¶³ã«ã¾ã¨ã‚ã‚Šã¤ã„ã¦ã—ã¾ã†é£¼è‚²å“¡<a href=\"https://twitter.com/hashtag/%E5%9C%B0%E5%91%B3%E3%83%8F%E3%83%AD%E3%82%A6%E3%82%A3%E3%83%B3?src=hash&amp;ref_src=twsrc%5Etfw\">#åœ°å‘³ãƒãƒ­ã‚¦ã‚£ãƒ³</a> <a href=\"https://twitter.com/hashtag/DPZ?src=hash&amp;ref_src=twsrc%5Etfw\">#DPZ</a> <a href=\"https://t.co/GlHyjuZJ5R\">pic.twitter.com/GlHyjuZJ5R</a></p>&mdash; ãƒã‚« (@chica_1107) <a href=\"https://twitter.com/chica_1107/status/1322368574380335104?ref_src=twsrc%5Etfw\">October 31, 2020</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>å¤§ç´„æ˜¯åœ¨å‰é™£å­ GitHub çš„ profile readme å¾ˆå¤¯çš„æ™‚å€™ï¼Œæˆ‘åœ¨ç¶²è·¯ä¸Šçœ‹åˆ°äº† matter.js é€™å€‹å¥—ä»¶çš„ä½œå“ï¼Œè…¦è¢‹ä¸­å°±èŒç”Ÿä¸€å€‹é»å­æƒ³è©¦è©¦çœ‹ï¼Œä½†å› ç‚ºçœŸçš„æ²’æœ‰å¯¦éš›ç”¨è™•ï¼Œä¹Ÿä¸ç¢ºå®šæ•ˆæœå¥½ä¸å¥½ï¼Œå°±è¢«æˆ‘ä¸€ç›´æ“±ç½®ï¼Œç›´åˆ°é€™å€‹é€±æœ«çš„ç©ºé–’æ™‚é–“æ‰æ±ºå®šè¦ä¾†å¯¦ç¾å®ƒã€‚</p>\n<p>æ•´é«”æƒ³æ³•æ˜¯é€™æ¨£çš„ï¼Œæˆ‘æƒ³å¾ä¸Šæ‰è½ä¸€å€‹åˆ©ç”¨ GitHub contribution graph æ‹¼æ¹Šå‡ºçš„åå­—ï¼Œç„¶å¾Œæ‰è½è‡³ç•«é¢ä¸­é–“å¾Œï¼Œé™¤äº†åå­—ä»¥å¤–çš„æ–¹å¡Šå°±æœƒå› ç‚ºæ’æ“Šè€Œå™´æ•£ï¼Œæœ€å¾Œåªç•™ä¸‹åå­—ã€‚</p>\n<p>é€™é‚Šç”¨æˆ‘è€å©†â˜ºï¸ çš„åå­—ä½œç‚ºç¯„ä¾‹å…ˆçµ¦å¤§å®¶çœ‹çœ‹æˆæœï¼š</p>\n<p><img src=\"/image/HSI-HOver-DropName-loop.gif\" alt=\"wife\"></p>\n<p>è€Œæ”¾åˆ° GitHub é é¢çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>\n<p><img src=\"/image/github-demo.gif\" alt=\"github\"></p>\n<p>æ•ˆæœè·Ÿæˆ‘æƒ³åƒçš„é‚„æ˜¯æœ‰é»å·®ç•°ï¼Œä¸éä¹Ÿæœ‰å…«æˆåƒäº†ï¼Œä»Šå¤©å°±åˆ©ç”¨æˆ‘è£½ä½œçš„å°ç©å…·ä¾†ä»‹ç´¹ä¸€ä¸‹ matter.js çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼ã€‚</p>\n<h2 id=\"åŸºæœ¬ä»‹ç´¹\" style=\"position:relative;\"><a href=\"#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%B4%B9\" aria-label=\"åŸºæœ¬ä»‹ç´¹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>åŸºæœ¬ä»‹ç´¹</h2>\n<p><img src=\"/image/matterjs-website.png\" alt=\"matterjs-website\"></p>\n<p>matter.js æ˜¯ä¸€å¥—ç”± JavaScript æ’°å¯«çš„ç‰©ç†å¼•æ“ï¼Œè®“ä½ èƒ½é€é JS åœ¨ç€è¦½å™¨ä¸Šæ¨¡æ“¬ç‰©ç†åæ‡‰ï¼Œå¯ä»¥è¼•æ˜“èª¿æ•´ç‰©é«”é‡é‡ã€è³ªé‡ã€é€Ÿåº¦ï¼Œç”šè‡³æ˜¯å¯†åº¦ã€æ‘©æ“¦åŠ›ç­‰ç­‰è®Šé‡ï¼Œéå¸¸é©åˆç”¨åœ¨éœ€è¦å‘ˆç¾ç‰©ç†æ•ˆæœçš„ 2D éŠæˆ²ä¸­ã€‚</p>\n<p>å…¶æä¾›çš„ API ä¹Ÿè¨­è¨ˆå¾—ç°¡å–®å¥½ç”¨ï¼Œåªæ˜¯é›–ç„¶æ¯å€‹ API éƒ½æœ‰æ–‡ä»¶ï¼Œä½†å…§å®¹éƒ½ä¸å¤ªå¯¦ç”¨ï¼Œå¦‚æœä½ éœ€è¦èª¿æ•´ç´°ç¯€çš„è©±ï¼Œè¦é¦¬å°±è‡ªå·±æ…¢æ…¢æ›´å‹•å˜—è©¦ï¼Œä¸ç„¶å°±å¾—æŸ¥çœ‹å…¶åŸå§‹ç¢¼æœƒæ¯”è¼ƒæ¸…æ¥šã€‚</p>\n<p>è€Œè‡³æ–¼æ”¯æ´åº¦éƒ¨åˆ†ä¹Ÿç„¡é ˆæ“”å¿ƒï¼Œç€è¦½å™¨æ”¯æ´ IE8+ï¼Œæ‰‹æ©Ÿçš„è§¸æ§ Event ä¹Ÿä¸æˆå•é¡Œã€‚æˆ‘è¦ºå¾—æ˜¯å¦ä¸€å€‹å¦‚åŒ GSAP ä¸€æ¨£å€¼å¾—èŠ±é»æ™‚é–“å­¸ç¿’æŠŠç©çš„å‰ç«¯å·¥å…·ã€‚</p>\n<p>åœ¨é€²å…¥æˆ‘å€‘çš„ç¯„ä¾‹è£½ä½œè§£æå‰ï¼Œæˆ‘æƒ³å…ˆæ¢åˆ—ä»‹ç´¹ matter.js ä¸­çš„å¸¸ç”¨å¥—ä»¶ï¼Œé™¤äº†å…ˆäº†è§£æ•´é«”çš„ Context å¤–ï¼Œä¹Ÿèƒ½ç•¶ä½œä¹‹å¾Œèªªæ˜å¯¦ä½œå…§å®¹æ™‚çš„ referenceã€‚</p>\n<h3 id=\"matterjs-çš„é€šç”¨æ¨¡çµ„\" style=\"position:relative;\"><a href=\"#matterjs-%E7%9A%84%E9%80%9A%E7%94%A8%E6%A8%A1%E7%B5%84\" aria-label=\"matterjs çš„é€šç”¨æ¨¡çµ„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Matter.js çš„é€šç”¨æ¨¡çµ„</h3>\n<p>matter.js çš„ API å®šç¾©çš„å¾ˆæ˜“æ‡‚ï¼Œæ—¢ç„¶æ˜¯åšç‰©ç†æ¨¡æ“¬ï¼Œç•¶ç„¶å°±è¦æœ‰ <code class=\"language-text\">World</code>ã€<code class=\"language-text\">Body</code> èˆ‡ <code class=\"language-text\">Constraint</code>ï¼Œè€Œé€™äº›ä¹Ÿæ˜¯ä½ ä½¿ç”¨ matter.js æ‰€éœ€è¦çš„åŸºç¤å…ƒä»¶ã€‚</p>\n<p><strong>World</strong>: matter.js é€éæ­¤æ¨¡çµ„ä¾†å‰µå»ºä¸€å€‹æ¨¡æ“¬ä¸–ç•Œï¼Œå¯ä»¥å¾®èª¿ä¸–ç•Œä¸­çš„ä¸€äº›å±¬æ€§ï¼Œåƒæ˜¯é‡åŠ›ã€é‚Šç•Œç­‰ç­‰ï¼Œè€Œä¸€å€‹ä¸–ç•Œç•¶ç„¶æ˜¯ç”±å¤šå€‹ Bodies æ‰€çµ„æˆã€‚</p>\n<p><strong>Bodies</strong>: Bodies æ¨¡çµ„æä¾›ä½ æ–¹æ³•å»ç”Ÿæˆä¸€äº›ç‰©é«”ï¼Œåƒæ˜¯åœ“å½¢ç‰©é«”ã€æ–¹å½¢ç‰©é«”ç­‰ç­‰ï¼Œä½ ä¹Ÿå¯ä»¥å‚³å…¥ svgã€img å»å®¢è£½åŒ–ç‰©é«”å½¢ç‹€èˆ‡æ¨£å¼ã€‚ç”¢ç”Ÿçš„ç‰©é«”æ”¾å…¥ World ä¸­å¾Œå°±å¯ä»¥è¢« render åœ¨ç•«é¢ä¸Šã€‚</p>\n<p><strong>Body</strong>: åˆ©ç”¨ Bodies ç”¢ç”Ÿçš„ç‰©ä»¶å¯ä»¥åˆ©ç”¨ Body æ¨¡çµ„ä¾†é€²è¡Œé€²ä¸€æ­¥çš„æ“æ§ã€‚é€é Bodyï¼Œä½ å¯ä»¥æ—‹è½‰ã€ç¸®æ”¾ã€ä½ç§»ä½ çš„ç‰©é«”ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹ç‰©é«”æœ¬èº«çš„å¯†åº¦ã€é€Ÿåº¦ç­‰ç­‰ã€‚æ›å¥è©±èªªï¼ŒBody è®“ä½ èª¿æ•´ç‰©é«”çš„ç‰©ç†ç‰¹æ€§ã€‚</p>\n<p><strong>Engine</strong>: å¼•æ“ï¼Œé¡§åæ€ç¾©å°±æ˜¯é©…å‹•æ•´å€‹æ¨¡æ“¬ç‰©ç†ä¸–ç•Œçš„å‹•åŠ›ï¼Œæ ¹æ“š Body çš„ç‰©ç†æ€§è³ªä¾†ç²¾æº–æŒæ§ <code class=\"language-text\">World</code> å…§ <code class=\"language-text\">Body</code> å½¼æ­¤é–“çš„ç‰©ç†ç¾è±¡ï¼Œç¢ºä¿èƒ½æ¨¡æ“¬å‡ºç¬¦åˆè¨­å®šçš„åæ‡‰ã€‚æ˜¯ matter.js çš„æ ¸å¿ƒã€‚ä¸»è¦çš„<a href=\"https://github.com/liabru/matter-js/blob/master/src/core/Engine.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç¨‹å¼ç¢¼</a>æ„å¤–çš„æ²’æœ‰å¾ˆé•·ï¼Œå¯ä»¥å¤§ç•¥çœ‹å‡º Engine æœƒè² è²¬æ§åˆ¶ Bodies ä¹‹é–“çš„ç‹€æ…‹æ›´æ–°ã€‚</p>\n<p><strong>Render</strong>: matter.js æœ‰æä¾›ä¸€å€‹ Canvas based çš„ Rendererï¼Œè®“ä½ èƒ½å°‡ Engine æ‰€å‚¬å‹•çš„çµæœç¹ªè£½å‡ºä¾†ï¼Œé€™å€‹å…§å»ºçš„ Render æ¨¡çµ„ä¸»è¦æ˜¯è®“ä½ ç”¨åœ¨é–‹ç™¼èˆ‡é™¤éŒ¯ä¸Šçš„ï¼Œä½†å°æ–¼ç°¡å–®çš„å‹•ç•«æˆ–éŠæˆ²ï¼Œé‚„æ˜¯å¯ä»¥ä½¿ç”¨ã€‚å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œè©²æ¨¡çµ„é è¨­åªæœƒç¹ªè£½å‡º wirefram èˆ‡å‘é‡ï¼Œä½ è¦ä¸»å‹•å°‡ <code class=\"language-text\">render.options.wireframes</code> è¨­ç‚º falseï¼Œå¦å‰‡ï¼Œä»¥ä»Šå¤©çš„æ¨¡çµ„ç‚ºä¾‹ï¼ˆæˆ‘å€‘ä»Šå¤©çš„ç¯„ä¾‹ä¹Ÿæ˜¯ç”¨æ­¤æ¨¡çµ„é–‹ç™¼ã€‚ï¼‰ï¼Œä»–æœƒè®Šæˆé€™æ¨£ï¼š</p>\n<p><img src=\"/image/matterjs-wireframe.png\" alt=\"matterjs-wireframe\"></p>\n<p>ä¸éç…§é€™æ¨£çœ‹ä¾†ï¼Œä¾ç…§å®˜æ–¹çš„æ„æ€ï¼Œå¦‚æœä½ è¦ä½¿ç”¨ matter.js ä¾†è£½ä½œéŠæˆ²ç­‰ç­‰ï¼ŒåŸºæœ¬ä¸Šæ‡‰è©²è¦è‡ªå·±å¯¦ä½œ Renderï¼Œä½ æ‰èƒ½æ›´å¥½çš„æ§åˆ¶ç•«é¢çš„è®ŠåŒ–ã€‚å®˜æ–¹æœ‰æä¾›ä¸€äº› Renderer çš„<a href=\"https://github.com/liabru/matter-js/wiki/Rendering#renderer-example\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç¯„ä¾‹</a>ï¼Œä¹Ÿå¯ä»¥å¾å…¶<a href=\"https://github.com/liabru/matter-js/blob/master/src/render/Render.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">åŸå§‹ç¢¼</a>åƒè€ƒã€‚</p>\n<p><strong>Composites</strong>: é€™å€‹æ¨¡çµ„æœ‰é»åƒæ˜¯ Bodies æ¨¡çµ„ï¼Œå·®åˆ¥åœ¨æ–¼ Bodies æ¨¡çµ„è®“ä½ å‰µå»ºå‡º â€ä¸€å€‹â€œ ç‰©é«”ï¼Œè€Œ Composites æä¾›æ–¹æ³•è®“ä½ å‰µå»ºå‡ºå¤šå€‹ç‰©é«”æ‰€çµ„åˆè€Œæˆçš„ç‰©é«”ï¼Œåƒæ˜¯ Stackã€Pyramid æˆ–ç”šè‡³æ˜¯ Car, Chain ç­‰ç­‰å¸¸ç”¨çš„å…§å»ºçµ„åˆã€‚</p>\n<p><strong>Composite</strong>: å¦‚åŒ Body å°æ‡‰æ–¼ Bodiesï¼ŒComposite å°±æ˜¯å°æ‡‰æ–¼ Composites çš„æ¨¡çµ„ï¼Œè®“ä½ æ§åˆ¶ç”± Composites å‰µå»ºå‡ºçš„çµ„åˆç‰©é«”çš„ç‰©ç†ç‰¹æ€§ã€‚</p>\n<p><strong>Constraint</strong>: Constraint æ¨¡çµ„è®“ä½ èƒ½ç‚ºå…©å€‹ç‰©é«”ä¹‹é–“å¢åŠ ç‰©ç†é™åˆ¶ï¼Œåƒæ˜¯å…©ç‰©é«”ä¸€å®šè¦é–“éš”ä¸€å®šè·é›¢ç­‰ç­‰ã€‚é€™å€‹æ¨¡çµ„åœ¨æˆ‘å€‘é€™æ¬¡çš„ç¯„ä¾‹ä¸­æˆ‘æ²’æœ‰ç”¨åˆ°ï¼Œä¸éå®˜ç¶²æœ‰ä¸å°‘ç¯„ä¾‹éƒ½æœ‰ä½¿ç”¨ï¼Œåƒæ˜¯ <a href=\"https://brm.io/matter-js/demo/#newtonsCradle\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Newton's Cradle</a>ã€‚</p>\n<p><strong>MouseConstraint</strong>: å¦‚åŒ Constraintï¼Œé€™å€‹æ¨¡çµ„è®“ä½ å¢åŠ æ»‘é¼ èˆ‡ç‰©é«”ä¹‹é–“çš„â€ç´„æŸâ€ï¼Œé€éå»ºç«‹ç‰©é«”èˆ‡æ»‘é¼ çš„é™åˆ¶ï¼Œå°±å¯ä»¥è®“ä½¿ç”¨è€…é€éæ»‘é¼ èˆ‡ä½ å‰µå»ºçš„ç‰©é«”äº’å‹•ã€‚å‰é¢çš„ç¯„ä¾‹ä¸­æ²’ç”¨åˆ°ï¼Œä½†å¾Œé¢æˆ‘æœƒç¨å¾®å¸¶åˆ°å¦‚ä½•ä½¿ç”¨ã€‚</p>\n<h2 id=\"çŸ¥é“äº†åŸºæœ¬æ¨¡çµ„å°±å¾åšä¸­å­¸å§\" style=\"position:relative;\"><a href=\"#%E7%9F%A5%E9%81%93%E4%BA%86%E5%9F%BA%E6%9C%AC%E6%A8%A1%E7%B5%84%E5%B0%B1%E5%BE%9E%E5%81%9A%E4%B8%AD%E5%AD%B8%E5%90%A7\" aria-label=\"çŸ¥é“äº†åŸºæœ¬æ¨¡çµ„å°±å¾åšä¸­å­¸å§ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çŸ¥é“äº†åŸºæœ¬æ¨¡çµ„ï¼Œå°±å¾åšä¸­å­¸å§</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> Engine <span class=\"token operator\">=</span> Matter<span class=\"token punctuation\">.</span>Engine<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Render <span class=\"token operator\">=</span> Matter<span class=\"token punctuation\">.</span>Render<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Composites <span class=\"token operator\">=</span> Matter<span class=\"token punctuation\">.</span>Composites<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> World <span class=\"token operator\">=</span> Matter<span class=\"token punctuation\">.</span>World<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Bodies <span class=\"token operator\">=</span> Matter<span class=\"token punctuation\">.</span>Bodies<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Body <span class=\"token operator\">=</span> Matter<span class=\"token punctuation\">.</span>Body<span class=\"token punctuation\">;</span></code></pre></div>\n<p>èµ·æ‰‹å¼å°±æ˜¯å…ˆå°‡å…ˆå‰ä»‹ç´¹éçš„æ¨¡çµ„éƒ½å®£å‘Šå‡ºä¾†ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// create engine</span>\n<span class=\"token keyword\">const</span> engine <span class=\"token operator\">=</span> Engine<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> world <span class=\"token operator\">=</span> engine<span class=\"token punctuation\">.</span>world<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// create renderer</span>\n<span class=\"token keyword\">const</span> render <span class=\"token operator\">=</span> Render<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  element<span class=\"token operator\">:</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">,</span>\n  engine<span class=\"token operator\">:</span> engine<span class=\"token punctuation\">,</span>\n  options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    width<span class=\"token operator\">:</span> <span class=\"token number\">920</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ¥è‘—å‰µå»º instanceï¼Œåˆ©ç”¨ <code class=\"language-text\">Engine.create()</code> å‰µé€  Engine å¯¦ä¾‹ï¼Œè€Œ <code class=\"language-text\">engine.world</code> æœ€å¾Œæœƒéœ€è¦å‚³çµ¦ <code class=\"language-text\">World</code> æ¨¡çµ„ï¼Œå¯ä»¥æƒ³åƒæˆæ˜¯æ­¤å¼•æ“ï¼ˆEngineï¼‰ æ‰€é©…å‹•çš„ä¸–ç•Œï¼ˆworldï¼‰ã€‚</p>\n<p><code class=\"language-text\">Render</code> çš„éƒ¨åˆ†æˆ‘å€‘è¦æŒ‡å®šä½¿ç”¨çš„ engineã€è¦æ¸²æŸ“çš„ root elementï¼Œä»¥åŠå¯¬é«˜ç­‰åŸºæœ¬é¸é …ã€‚æ›´ç´°éƒ¨çš„ properties å¯ä»¥åƒè€ƒ<a href=\"https://brm.io/matter-js/docs/classes/Render.html#properties\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜ç¶²æ–‡ä»¶</a>ï¼Œä»¥æˆ‘å€‘çš„ç¯„ä¾‹ä¾†èªªï¼Œåªéœ€è¦é€™æ¨£å°±å¤ äº†ã€‚</p>\n<p>åˆ°ç›®å‰ç‚ºæ­¢ï¼Œæˆ‘å€‘è¨­å®šå¥½äº† <code class=\"language-text\">Engine</code> èˆ‡ <code class=\"language-text\">Render</code> çš„å¯¦ä¾‹ï¼Œä»£è¡¨æˆ‘å€‘å·²ç¶“æº–å‚™å¥½äº†ä¸€å€‹è™›æ“¬çš„ä¸–ç•Œï¼Œç„¶è€Œå…‰æ˜¯æº–å‚™å¥½é‚„ä¸å¤ ï¼Œæˆ‘å€‘éœ€è¦â€œå•Ÿå‹•â€å®ƒã€‚</p>\n<p>æ‰€è¬‚çš„å•Ÿå‹•ï¼Œå…¶å¯¦å°±æ˜¯è¦ä¸æ–·åœ°å»å‘¼å« <code class=\"language-text\">Engine.update()\b</code> ä¾†è§¸ç™¼å¼•æ“è¨ˆç®—ï¼Œæˆ–æ˜¯è®“ Renderer æ›´æ–°ç•«é¢ï¼ŒåŸ·è¡Œé¡ä¼¼ä¸‹é¢çš„å‹•ä½œï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>run<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Engine<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span>engine<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span> <span class=\"token operator\">/</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è€Œå¯¦éš›ä¸Š matter.js å…§æœ‰å¦ä¸€å€‹æ¨¡çµ„ <code class=\"language-text\">Matter.Runner</code>ï¼Œå¯ä»¥ä¾†å¹«å¿™é‹è¡Œå¼•æ“èˆ‡è§¸ç™¼ Renderï¼Œåœ¨ <code class=\"language-text\">Engine</code> èˆ‡ <code class=\"language-text\">Render</code> ç‰©ä»¶å…§éƒ½æœ‰å€‹å« <code class=\"language-text\">run</code> çš„ helper å‡½å¼ï¼Œå°±æ˜¯ç”¨åˆ°æ­¤å…§å»º Runner æ¨¡çµ„ï¼Œåªè¦å°‡å¯¦ä¾‹æ”¾å…¥ï¼Œmatter.js çš„ <code class=\"language-text\">Runner</code> å°±æœƒå¹«å¿™åŸ·è¡Œ Runner è©²åšçš„äº‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">Engine<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>engine<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nRender<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>render<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¸éï¼Œèˆ‡å‰é¢æåˆ°çš„ <code class=\"language-text\">Matter.Render</code> é¡ä¼¼ï¼Œä¾ç…§å®˜ç¶²èªªæ³•ï¼Œå…§å»ºçš„ <code class=\"language-text\">Matter.Runner</code> ä¸»è¦ä¹Ÿæ˜¯é–‹ç™¼èˆ‡é™¤éŒ¯ç”¨é€”ï¼Œåªé©åˆç”¨åœ¨ç°¡å–®çš„å°æ‡‰ç”¨ä¸Šã€‚</p>\n<h3 id=\"è¬äº‹ä¿±å‚™åªæ¬ æ±é¢¨\" style=\"position:relative;\"><a href=\"#%E8%90%AC%E4%BA%8B%E4%BF%B1%E5%82%99%E5%8F%AA%E6%AC%A0%E6%9D%B1%E9%A2%A8\" aria-label=\"è¬äº‹ä¿±å‚™åªæ¬ æ±é¢¨ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è¬äº‹ä¿±å‚™ï¼Œåªæ¬ æ±é¢¨</h3>\n<p>Engine èˆ‡ Render éƒ½å•Ÿå‹•äº†ï¼Œè™›æ“¬ä¸–ç•Œå·²ä¸Šç·šï¼Œå†ä¾†å°±åªè¦å¾€è£¡é¢ä¸Ÿå…¥ç‰©é«”å°±å¥½äº†ã€‚</p>\n<p>åˆ†æä¸€ä¸‹æˆ‘çš„é»å­ï¼š<em>å¾ä¸Šæ‰è½ä¸€å€‹åˆ©ç”¨ GitHub contribution graph æ‹¼æ¹Šå‡ºçš„åå­—ï¼Œç„¶å¾Œæ‰è½è‡³ç•«é¢ä¸­é–“å¾Œï¼Œé™¤äº†åå­—ä»¥å¤–çš„æ–¹å¡Šå°±æœƒå› ç‚ºæ’æ“Šè€Œå™´æ•£ï¼Œæœ€å¾Œåªç•™ä¸‹åå­—ã€‚</em></p>\n<p>å¤§è‡´éœ€è¦å¹¾å€‹æ¢ä»¶ï¼š</p>\n<ul>\n<li>ä¸€å †å°æ–¹å¡Šä¾†å †ç–Šå‡º contribution graphã€‚</li>\n<li>å°æ–¹å¡Šè¦èƒ½è‡ªç”±å¢œè½ï¼Œè€Œä»£è¡¨åå­—éƒ¨åˆ†çš„å°æ–¹å¡Šåˆ°æŸå€‹é»æ™‚éœ€è¦åœä½ã€‚</li>\n<li>å°æ–¹å¡Šè¦èƒ½æœ‰å™´æ•£çš„æ•ˆæœã€‚</li>\n</ul>\n<p>å¾ matter.js çš„å®˜ç¶²ä¸­å¯ä»¥æ‰¾åˆ°è¨±å¤šç¯„ä¾‹ï¼Œå¾é‚£äº›ç¯„ä¾‹å…§ï¼Œå¯ä»¥å¤§è‡´æ‘¸ç´¢å‡ºè‡ªå·±éœ€è¦å“ªäº›æ¨¡çµ„æ‰èƒ½æ‹¼æ¹Šå‡ºé€™æ¨£çš„æ•ˆæœã€‚</p>\n<p>é¦–å…ˆï¼Œå¯ä»¥åˆ©ç”¨ <code class=\"language-text\">Composites.stack</code> <a href=\"https://brm.io/matter-js/docs/classes/Composites.html#method_stack\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ref</a> ä¾†è£½é€ å‡ºå †ç–Šå¥½çš„ contribution graphï¼š</p>\n<blockquote>\n<p>API: Matter.Composites.stack(xx, yy, columns, rows, columnGap, rowGap, callback)</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> stack <span class=\"token operator\">=</span> Composites<span class=\"token punctuation\">.</span><span class=\"token function\">stack</span><span class=\"token punctuation\">(</span><span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...ç•¥</span>\n  <span class=\"token keyword\">const</span> block <span class=\"token operator\">=</span> Bodies<span class=\"token punctuation\">.</span><span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    render<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      fillStyle<span class=\"token operator\">:</span> color<span class=\"token punctuation\">[</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// éš¨æ©Ÿçµ¦å®šæ ¼å­é¡è‰²</span>\n      strokeStyle<span class=\"token operator\">:</span> <span class=\"token string\">'#fff'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    frictionAir<span class=\"token operator\">:</span> <span class=\"token number\">0.03</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...ç•¥</span>\n  <span class=\"token keyword\">return</span> block<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">Composites.stack</code> å‰é¢å…­å€‹åƒæ•¸å¯ä»¥å®šç¾©ä¸€å€‹ grid ç©ºé–“ï¼Œç¯„ä¾‹ä¸­æˆ‘å€‘åœ¨ç›¸å°æ–¼ <code class=\"language-text\">Render</code> è¨­å®šç¯„åœçš„ x è»¸ 125px èˆ‡ y è»¸ 15px çš„ä½ç½®é–‹å§‹æ”¾ç½® stackï¼Œä¸¦å®šç¾©è©² grid æ˜¯ 45 x 7 çš„æ ¼å­ï¼ˆGitHub ä¸Šæ¯è¡Œä¸ƒå¤©ï¼Œå¤§ç´„ 45 é€±ï¼‰ï¼Œæ¯å€‹æ–¹å¡Šå¤§å° 15px x 15pxï¼Œæ ¼å­èˆ‡æ ¼å­ä¹‹é–“æˆ‘å€‘ä¸éœ€è¦ç©ºæ ¼ï¼Œå› æ­¤ columnGap èˆ‡ rowGap éƒ½å¡« 0ã€‚</p>\n<p>è€Œæœ€å¾Œçš„ callback å‡½æ•¸ä¸­ï¼Œå¯ä»¥çµ„åˆå¤šå€‹ body ä¾†æ“ºæ”¾åœ¨å…¶ grid ç©ºé–“ä¸­ã€‚èˆ‰ä¾‹ä¾†èªªï¼Œæˆ‘å€‘æƒ³è¦ç¹ªè£½å‡º contribution graph çš„è©±ï¼Œå°±æ˜¯åœ¨ callback å‡½å¼ä¸­ï¼Œåˆ©ç”¨ <code class=\"language-text\">Bodies.rectangle</code> ä¾†ç”¢ç”Ÿä¸€å€‹å€‹çš„å°æ–¹å¡Šï¼Œåœ¨é€™å€‹ callback ä¸­å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼ŒåŒ…å«å®šç¾©æ–¹å¡Šçš„é¡è‰²ã€ç‹€æ…‹ç­‰ç­‰ã€‚ </p>\n<p>åˆ°é€™é‚Šå¯ä»¥ç¹ªè£½å‡ºä¸€å€‹é‚„ä¸éŒ¯çš„ contribution graphï¼š</p>\n<p><img src=\"/image/github-graph.png\" alt=\"github-graph\"></p>\n<h3 id=\"é‚£åå­—å‘¢\" style=\"position:relative;\"><a href=\"#%E9%82%A3%E5%90%8D%E5%AD%97%E5%91%A2\" aria-label=\"é‚£åå­—å‘¢ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>é‚£åå­—å‘¢ï¼Ÿ</h3>\n<p>è¦å®¢è£½åŒ– contribution graph å¥½åƒå¾ˆä¸å°‘æ–¹å¼ï¼Œåƒæ˜¯<a href=\"https://hackernoon.com/hack-your-github-contribution-graph-d88bdb417351\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é€™å€‹</a>ï¼Œä½†æˆ‘æ²’æƒ³é‚£éº¼å¤š LOL ç•¢ç«Ÿä¸€é–‹å§‹åªæ˜¯æƒ³å¯¦é©—çœ‹çœ‹ï¼Œæ‰€ä»¥å°±ç”¨æœ€åœŸç‚®çš„æ–¹å¼ï¼Œç”¨ <a href=\"https://www.pixilart.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pixilart</a> æ‰‹å‹•åœ¨ 45x7 çš„æ ¼å­ä¸Šç”¨ pixel art çš„æ–¹å¼å¯«å‡ºåå­—ï¼Œç„¶å¾Œå†æ…¢æ…¢æŠŠæ ¼å­æ•¸å‡ºä¾†ï¼Œå»ºç«‹ä¸€å€‹é›™å±¤é™£åˆ—ä¾†å­˜ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> nameBlock <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'N'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'N'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'N'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'N'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'N'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'N'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'N'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç„¶å¾Œåœ¨å‰›å‰›çš„ <code class=\"language-text\">Composites.stack</code> çš„ callback å‡½æ•¸ä¸­ï¼Œæˆ‘å°±èƒ½åˆ¤æ–·ç•¶ä¸‹ç¹ªè£½çš„ bodyï¼ˆrectangleï¼‰æ˜¯ä¸æ˜¯å±¬æ–¼åå­—çš„ä¸€éƒ¨åˆ†ï¼Œé€²ä¸€æ­¥åšè™•ç†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// æ ¹æ“šç•¶ä¸‹çš„ rectangle ä½ç½® (x, y) èˆ‡ nameBlock åšæ¯”å°</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">static</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> indexX <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">-</span> <span class=\"token number\">125</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">15</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> indexY <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">-</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">15</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> block <span class=\"token operator\">=</span> nameBlock<span class=\"token punctuation\">[</span>indexY<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// è‹¥æ˜¯å±¬æ–¼åå­—çš„ä¸€éƒ¨åˆ†ï¼Œè¨­å®šç‚º staticï¼Œç„¶å¾Œçµ¦äºˆä¸åŒçš„é¡è‰²è¨­å®š</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>block <span class=\"token operator\">&amp;&amp;</span> block<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>indexX<span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'#229A3B'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#196126'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'#EBEDEF'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#C5E48B'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> stack <span class=\"token operator\">=</span> Composites<span class=\"token punctuation\">.</span><span class=\"token function\">stack</span><span class=\"token punctuation\">(</span><span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isStatic<span class=\"token punctuation\">,</span> color<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">static</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> block <span class=\"token operator\">=</span> Bodies<span class=\"token punctuation\">.</span><span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//...ç•¥</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> block<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç¹ªè£½æˆæœï¼š</p>\n<p><img src=\"/image/matterjs-githubgraph-withname.png\" alt=\"withName\"></p>\n<p>å¦å¤–ï¼Œåœ¨ä¸Šé¢æˆ‘è‡ªè£½çš„ <code class=\"language-text\">static</code> å‡½å¼ä¸­ï¼Œæœƒæ ¹æ“š rectangle æ˜¯å¦å±¬æ–¼åå­—çš„ä¸€éƒ¨åˆ†ï¼Œå›å‚³ <code class=\"language-text\">isStatic</code> å¸ƒæ—å€¼ï¼Œé€™å€‹å€¼å…¶å¯¦æ˜¯å±¬æ–¼ <code class=\"language-text\">Body</code> çš„ä¸€å€‹ propertyï¼Œè‹¥ <code class=\"language-text\">isStatic</code> è¨­ç‚º trueï¼Œå‰‡è©²ç‰©é«”å°±ä¸æœƒå—åˆ°å…¶ä»–ç‰©é«”çš„ç‰©ç†å½±éŸ¿ï¼Œå¾ˆé©åˆç”¨åœ¨è£½ä½œç‰†å£ä¹‹é¡çš„ç‰©é«”ï¼Œä¹Ÿæ°å¥½å¯ä»¥ç”¨ä¾†æ»¿è¶³æˆ‘å¸Œæœ›åå­—èƒ½è¢«å®šä½çš„éœ€æ±‚ã€‚</p>\n<p>è€Œç”±æ–¼æˆ‘å¸Œæœ›æ–¹å¡Šå€‘æ˜¯åœ¨æ‰è½åˆ°ä¸€åŠçš„æ™‚å€™ï¼Œåå­—æ‰å¡ä½ï¼Œè€Œå…¶é¤˜çš„æ–¹å¡Šå¾—éš¨è‘—åœ°å¿ƒå¼•åŠ›ç¹¼çºŒä¸‹è½ï¼Œæ‰€ä»¥æˆ‘å¿…é ˆè¦å»¶ç·©è¨­å®š <code class=\"language-text\">isStatic</code> çš„æ™‚é–“é»ï¼Œä¸èƒ½åœ¨æˆ‘ä½¿ç”¨ <code class=\"language-text\">Bodies</code> å‰µå»º rectangle æ™‚å°±è¨­å®šï¼Œéœ€è¦ä¾†å€‹ setTimeout æ‰è¡Œï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  Body<span class=\"token punctuation\">.</span><span class=\"token function\">setStatic</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">,</span> isStatic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">800</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç”±æ–¼å› ç‚ºâ€œç‰©ç†ç•Œâ€çš„æ­£å¸¸ç¾è±¡ï¼Œæ–¹å¡Šæœƒå¾æˆ‘å€‘è¨­å®šçš„ y è»¸ 15px çš„åœ°æ–¹æ‰è½ï¼Œè€Œåœ¨ä¸‹è½çš„ 800ms æ™‚ï¼Œæˆ‘å€‘é€é <a href=\"https://brm.io/matter-js/docs/classes/Body.html#method_setStatic\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Body.setStatic()</code></a> é€™å€‹ method è®“å±¬æ–¼åå­—éƒ¨åˆ†çš„æ–¹å¡Šè®Šç‚º staticï¼Œé€™æ¨£å°±èƒ½é”åˆ°åå­—æ‰è½ä¸€åŠæ™‚å®šä½ï¼Œå…¶é¤˜æ–¹å¡Šç¹¼çºŒæ‰è½çš„æ•ˆæœï¼š</p>\n<p><img src=\"/image/name-fix-block-drop.gif\" alt=\"name-fix-block-drop\"></p>\n<h3 id=\"å¢åŠ é˜»ç¤™æ‘©æ“¦åŠ›èˆ‡é€Ÿåº¦\" style=\"position:relative;\"><a href=\"#%E5%A2%9E%E5%8A%A0%E9%98%BB%E7%A4%99%E6%91%A9%E6%93%A6%E5%8A%9B%E8%88%87%E9%80%9F%E5%BA%A6\" aria-label=\"å¢åŠ é˜»ç¤™æ‘©æ“¦åŠ›èˆ‡é€Ÿåº¦ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å¢åŠ é˜»ç¤™ã€æ‘©æ“¦åŠ›èˆ‡é€Ÿåº¦</h3>\n<p>æƒ³è¦çš„æ•ˆæœé”æˆä¸€åŠäº†ï¼Œå°±æ˜¯æ–¹å¡Šæ‰è½é€Ÿåº¦å¤ªç·šæ€§äº†ï¼Œè€Œä¸”ç›´ç›´è½åˆ°ç•«é¢å¤–ä¹Ÿæœ‰é»å¥½ç¬‘ï¼Œæˆ‘å€‘éœ€è¦è£½é€ ä¸€é»éšœç¤™ç‰©ä»¥åŠæ”¹è®Šç‰©é«”çš„é€Ÿåº¦ï¼Œç”¢ç”Ÿæ’æ“Šçš„æ•ˆæœã€‚</p>\n<p>é¦–å…ˆï¼Œå¢åŠ éšœç¤™ç‰©ã€‚</p>\n<p>è¦å¢åŠ éšœç¤™ç‰©å¾ˆç°¡å–®ï¼Œmatter.js çš„ç¯„ä¾‹è£¡é¢å¾ˆå¤šéƒ½æœ‰åˆ©ç”¨ <a href=\"https://brm.io/matter-js/docs/classes/Bodies.html#method_rectangle\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Bodies.rectangle</code></a> å»å‰µå»ºç‰†å£ï¼Œæ§åˆ¶ç‰©é«”çš„æ´»å‹•ç¯„åœï¼Œé€™åœ¨è£½ä½œéŠæˆ²æ™‚ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘å€‘ä¹Ÿå¯ä»¥å¦‚æ³•æ³¡è£½ï¼Œå¢åŠ å››é¢å…«æ–¹çš„ç‰†å£ï¼š</p>\n<blockquote>\n<p>API: Matter.Bodies.rectangle(x, y, width, height, [options])</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> wallOption <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  render<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    fillStyle<span class=\"token operator\">:</span> <span class=\"token string\">'transparernt'</span><span class=\"token punctuation\">,</span>\n    strokeStyle<span class=\"token operator\">:</span> <span class=\"token string\">'#FBFBFB'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  isStatic<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> topWall <span class=\"token operator\">=</span> Bodies<span class=\"token punctuation\">.</span><span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span><span class=\"token number\">450</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">650</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> wallOption<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> bottomWall <span class=\"token operator\">=</span> Bodies<span class=\"token punctuation\">.</span><span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span><span class=\"token number\">450</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> wallOption<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> rightWall <span class=\"token operator\">=</span> Bodies<span class=\"token punctuation\">.</span><span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span><span class=\"token number\">880</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">420</span><span class=\"token punctuation\">,</span> wallOption<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> leftWall <span class=\"token operator\">=</span> Bodies<span class=\"token punctuation\">.</span><span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span><span class=\"token number\">110</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">420</span><span class=\"token punctuation\">,</span> wallOption<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç‰†å£çš„è£½ä½œå°±æ˜¯åˆ©ç”¨å‰é¢æåˆ°çš„ <code class=\"language-text\">isStatic</code> å±¬æ€§ï¼Œè®“ä»–å›ºå®šä½ï¼Œç„¶å¾Œè¨­å®šå¥½æ“ºæ”¾ä½ç½®èˆ‡é•·å¯¬å³å¯ã€‚å”¯ä¸€è¦æ³¨æ„çš„æ˜¯ï¼Œç‰†å£çš„é•·åº¦è¦èª¿æ•´ï¼Œä¸èƒ½å››é¢éƒ½ã„§æ¨£é•·ï¼Œé€™æ¨£å°æ–¹å¡Šæ’æ“Šåˆ°ç‰†å£å¾Œï¼Œé‚„èƒ½å¾é‚Šç·£æ‰è½æˆ–å‘å¤–å™´æ•£ï¼Œæ•ˆæœæœƒå¥½ä¸€é»ã€‚</p>\n<p>åŠ äº†ç‰†å£å¾Œï¼Œè®“å°æ–¹å¡Šä¸æœƒç›´ç›´æ‰è½ï¼Œæœ‰äº†ä¸€äº›å›é¥‹æ„Ÿï¼š</p>\n<p><img src=\"/image/matterjs-wall.gif\" alt=\"matter-js-wall\"></p>\n<p>æ¥è‘—æ˜¯ç‰©é«”çš„é€Ÿåº¦ã€‚</p>\n<p><code class=\"language-text\">Matter.Body</code> æœ‰æä¾› <a href=\"https://brm.io/matter-js/docs/classes/Body.html#method_setVertices\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">setVelocity</code></a> é€™å€‹å±¬æ€§å¯ä»¥ç«‹å³å¢åŠ ç‰©é«”æœ¬èº«çš„ç·šæ€§é€Ÿåº¦ï¼Œèª¿æ•´çš„æ–¹å¼ç‚ºçµ¦äºˆä¸€å€‹å‘é‡ï¼Œå› æ­¤å¯ä»¥èª¿æ•´æ–½äºˆé€Ÿåº¦çš„æ–¹å‘æ€§ï¼š</p>\n<blockquote>\n<p>API: Matter.Body.setVertices(body, vertices), Vertor: { x: 0, y: 0 }</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">Body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocity</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>x<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é€™æ¨£å°±æœƒè®“ä¸€å€‹å°æ–¹å¡Šå¾€ x è»¸ 3ï¼Œy è»¸ -10 çš„æ–¹å‘å¢åŠ é€Ÿåº¦ï¼Œå†åŠ ä¸Šå…ˆå‰åŠ å…¥çš„ç‰†å£èˆ‡å›ºå®šä½çš„åå­—æ–¹å¡Šï¼Œç”¢ç”Ÿçš„æ’æ“Šåå½ˆå°±èƒ½é”æˆé€™æ¨£çš„æ•ˆæœï¼š</p>\n<p><img src=\"/image/matter-js-velocity.gif\" alt=\"velocity\"></p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œ<code class=\"language-text\">Bodies.rectangle</code> åœ¨å®£å‘Šæ™‚èƒ½å¤ å‚³å…¥èª¿æ•´ç‰©ç†ç‰¹æ€§çš„ propertiesï¼Œåƒæ˜¯ <code class=\"language-text\">frictionAir</code> å¯ä»¥æ”¹è®Šç‰©é«”çš„ç©ºæ°£æ‘©æ“¦åŠ›ï¼Œæ•¸å€¼è¶Šé«˜ï¼Œç‰©é«”æ‰è½è¶Šæ…¢ï¼Œä¸¦ä¸”éƒ½èƒ½é€é <code class=\"language-text\">Matter.Body</code> å»æ“æ§ï¼Œä¾‹å¦‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">Body<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> frictionAir<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç›¸é—œ <a href=\"https://brm.io/matter-js/docs/classes/Body.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">API</a> å®˜ç¶²éƒ½æœ‰æ¢åˆ—å‡ºä¾†ã€‚</p>\n<p>å°‡ä¸Šè¿°èª¿æ•´ç‰©é«”ç‰©ç†ç‰¹æ€§çš„å‡½å¼å‘¼å«æ­é…é©ç•¶çš„ setTimeoutï¼Œå°±èƒ½å¤ å®Œæˆæˆ‘å€‘ä»Šå¤©çš„ç¯„ä¾‹æ•ˆæœï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> stack <span class=\"token operator\">=</span> Composites<span class=\"token punctuation\">.</span><span class=\"token function\">stack</span><span class=\"token punctuation\">(</span><span class=\"token number\">125</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isStatic<span class=\"token punctuation\">,</span> color<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">static</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> block <span class=\"token operator\">=</span> Bodies<span class=\"token punctuation\">.</span><span class=\"token function\">rectangle</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...ç•¥</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    Body<span class=\"token punctuation\">.</span><span class=\"token function\">setStatic</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">,</span> isStatic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">800</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    Body<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> frictionAir<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">600</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isStatic<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      Body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocity</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>x<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">900</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> block<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å–”å°äº†ï¼Œæœ€å¾Œç•¶ç„¶è¦è¨˜å¾—æŠŠæˆ‘å€‘ç”¢ç”Ÿçš„ Stack composites èˆ‡ç‰†å£æ”¾å…¥æ¨¡æ“¬çš„ä¸–ç•Œä¸­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// const world = engine.world;</span>\nWorld<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>world<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n  stack<span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// walls</span>\n  topWall<span class=\"token punctuation\">,</span>\n  bottomWall<span class=\"token punctuation\">,</span>\n  rightWall<span class=\"token punctuation\">,</span>\n  leftWall\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"one-more-thing\" style=\"position:relative;\"><a href=\"#one-more-thing\" aria-label=\"one more thing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>One more thing...</h3>\n<p>matter.js ä¸»æ‰“ç‰©ç†å¼•æ“ï¼Œç•¶ç„¶ä¸æ˜¯å–®ç´”ç”¨ä¾†è£½é€ å‹•ç•«ï¼Œè€Œæ˜¯ç”¨ä¾†è£½ä½œéŠæˆ²ç­‰ç­‰ï¼Œä¹Ÿå°±æ˜¯èªªè¦èƒ½èˆ‡ä½¿ç”¨è€…äº’å‹•ï¼Œè€Œæ–¹æ³•å°±æ˜¯ä¸€é–‹å§‹æåˆ°éçš„ <code class=\"language-text\">MouseConstraint</code>ï¼Œé›–ç„¶é€™æ¬¡ç¯„ä¾‹ç”¨ä¸è‘—é€™å€‹æ±è¥¿ï¼Œä½†é‚„æ˜¯æ”¾å€‹ä½¿ç”¨æ–¹æ³•åœ¨é€™é‚Šä¾›åƒè€ƒï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> Mouse <span class=\"token operator\">=</span> Matter<span class=\"token punctuation\">.</span>Mouse<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> MouseConstraint <span class=\"token operator\">=</span> Matter<span class=\"token punctuation\">.</span>MouseConstraint<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> mouse <span class=\"token operator\">=</span> Mouse<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>render<span class=\"token punctuation\">.</span>canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> mouseConstraint <span class=\"token operator\">=</span> MouseConstraint<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>engine<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  mouse<span class=\"token operator\">:</span> mouse<span class=\"token punctuation\">,</span>\n  constraint<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    stiffness<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    render<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      visible<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nWorld<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>world<span class=\"token punctuation\">,</span> mouseConstraint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç”¨æ³•å…¶å¯¦å¾ˆç°¡å–®ï¼Œå…¶ä¸­ constraint åƒæ•¸ <code class=\"language-text\">visible</code> ä»£è¡¨è‘—æ»‘é¼ çš„æ‹–æ‹‰è»Œè·¡æœƒä¸æœƒå‘ˆç¾å‡ºä¾†ï¼Œè€Œ stiffness å¯ä»¥ç®—æ˜¯èª¿æ•´æ‰€è¨­å®šçš„ constraint çš„éŸŒåº¦ï¼Œèª¿æ•´è©²å€¼å¯ä»¥å½±éŸ¿ç‰©é«”å—ç‰½åˆ¶ï¼ˆèˆ‡æ»‘é¼ äº’å‹•ï¼‰å¾Œç”¢ç”Ÿçš„å½ˆæ€§ã€‚æ–‡å­—å¯èƒ½æœ‰é»é›£ä»¥æè¿°ï¼Œæœ‰éœ€è¦ä½¿ç”¨çš„æ™‚å€™å¯ä»¥å¾å®˜ç¶²æ–‡ä»¶æŸ¥çœ‹å¯èª¿æ•´çš„åƒæ•¸å€¼ï¼Œè©¦è©¦çœ‹æ•ˆæœå†æ±ºå®šè¦å¦‚ä½•è¨­ç½®ã€‚</p>\n<p>ä¸Šè¿°è¨­å®šçš„æ•ˆæœå¦‚ä¸‹ï¼š</p>\n<p><img src=\"/image/matter-js-mouse.gif\" alt=\"matter-js-mouse\"></p>\n<p>æœ€å¾Œæ”¾ä¸Šç¨‹å¼ç¢¼é€£çµä¾›å„ä½åƒè€ƒï¼š<a href=\"https://codepen.io/arvin0731/pen/qBNoLQv\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://codepen.io/arvin0731/pen/qBNoLQv</a></p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>Matter.js æ‡‰è©²ç®—æ˜¯è »ä¹…çš„ä¸€å€‹å·¥å…·äº†ï¼Œä»¥ä½¿ç”¨ä¸Šä¾†èªªéå¸¸å®¹æ˜“ä¸Šæ‰‹ï¼Œåšäº›å°å‹•ç•«å°éŠæˆ²è »é©åˆçš„ï¼Œè‡³æ–¼è¦çœŸçš„ç”¨ä¾†è£½ä½œè¤‡é›œçš„éŠæˆ²çš„è©±ï¼Œå¯èƒ½é‚„æ˜¯è¦å†å¤šç ”ç©¶ä»–çš„æ•ˆèƒ½å¦‚ä½•ï¼Œç•¢ç«Ÿæˆ‘é€™æ¬¡ä¸¦æ²’æœ‰è§¸ç¢°åˆ°é‚£å¡Šï¼Œå°±æ­¡è¿æœ‰æ¥è§¸éçš„è®€è€…åˆ†äº«äº†ï¼</p>\n<p>ç•¢ç«Ÿé€™å€‹ç¯„ä¾‹ä¹Ÿæ˜¯æ‹¼æ‹¼æ¹Šæ¹Šè€Œä¾†çš„ï¼Œé€±æœ«å°ç©å…·å°±æ˜¯é€™æ¨£ï¼Œçš„ç¢ºæ²’è¾¦æ³•ç†è§£åˆ°ä»–åº•å±¤æ˜¯å¦‚ä½•å¯¦ä½œï¼Œä½†æ˜¯è‡³å°‘å®Œæˆäº†æƒ³è¦çš„æ•ˆæœï¼Œç„¶å¾Œä¹ŸçŸ¥é“äº†é€™å€‹å·¥å…·çš„ä¸€äº›åŸºæœ¬ç”¨æ³•ï¼Œä¹‹å¾Œæœ‰éœ€è¦æ™‚å¯ä»¥å¿«é€Ÿæ‹¿ä¾†ä½¿ç”¨ã€‚</p>\n<p>ä¸éï¼Œæé†’è‡ªå·±ä¹Ÿæé†’å¤§å®¶ï¼Œè¦è¨˜å¾—æ’¥å‡ºæ™‚é–“å»ç†è§£åº•å±¤åŸç†ï¼Œå› ç‚ºé€™æ‰æ˜¯èƒ½è®“ä½ æˆé•·çš„è¦ç´ ï¼Œå…±å‹‰ä¹‹å•¦ï¼</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://brm.io/matter-js/docs/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">matter-js website</a></li>\n<li><a href=\"https://code.tutsplus.com/series/getting-started-with-matterjs--cms-1186\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Getting Started with Matter.js</a></li>\n<li><a href=\"https://www.pixilart.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pixilart</a></li>\n</ol>","id":"8449f260-f743-5214-ab33-8d991fd3b091","fields":{"slug":"matterjs-intro"},"frontmatter":{"date":"2020-11-01T13:37:30.000Z","title":"ä½¿ç”¨ Matter.js 2D ç‰©ç†å¼•æ“è£½ä½œå‹•ç•«","tags":["web","matterjs","2d physics","for fun"],"type":"tech","slug":"matterjs-intro"},"timeToRead":15},{"excerpt":"ã€Gotta remember we live what we choose; It's not what you say, it's what you do; And the life you want is the life you have to make.ã€- Life is so cool (ä¸€é¦–æˆ‘å¿ƒæ„›çš„äººæ¨è–¦çš„æ­Œ :) )","html":"<blockquote>\n<p>ã€Gotta remember we live what we choose; It's not what you say, it's what you do; And the life you want is the life you have to make.ã€- Life is so cool (ä¸€é¦–æˆ‘å¿ƒæ„›çš„äººæ¨è–¦çš„æ­Œ :) )</p>\n</blockquote>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>ç¨å¾®å–æ¨£äº†èƒ¡ç«‹å…ˆå‰<a href=\"https://blog.techbridge.cc/2020/07/11/an-interesting-styled-component-bug/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ–‡ç« </a>çš„æ¨™é¡Œï¼Œä½†å¯¦éš›ä¸Šé€™ç¯‡æ–‡ç« æƒ³åˆ†äº«çš„é¢å‘ä¸å¤ªã„§æ¨£ï¼Œä¸¦ä¸æ˜¯ styled-components æœ¬èº«çš„ issue æˆ–æ˜¯å…¶æ‰€å¼•ç”¨çš„åº•å±¤å¥—ä»¶çš„ bugï¼Œæ¯”è¼ƒåƒæ˜¯ç‰¹å®šçš„ä½¿ç”¨æƒ…å¢ƒï¼Œä»¥åŠå° styled-components å¯¦éš›é‹ä½œåŸç†ä¸ç†Ÿæ‚‰ç­‰å› ç´ ï¼Œæ‰€å°è‡´çš„ bugã€‚é€™å€‹ bug ä¸æ˜¯å¾ˆå®¹æ˜“è¢«ç™¼ç¾ï¼Œè§£æ±ºçš„æ–¹æ³•ä¹Ÿç®—æ˜¯æœ‰é» hackï¼ˆé‹ç”¨åˆ°èˆ‡å®˜æ–¹æ–‡æª”æè¿°ä¸ç¬¦åˆçš„ APIï¼‰ï¼Œæˆ‘è¦ºå¾—è »æœ‰è¶£çš„ï¼ŒåŠ ä¸Šä¸»è¦çš„è§£æ³•å¯¦ä½œæ˜¯ç”±æˆ‘<a href=\"https://github.com/whatasod\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">åŒäº‹</a>è™•ç†ï¼Œæ‰€ä»¥æƒ³å¯«ä¸‹ä¾†çµ¦è‡ªå·±åšä¸€å€‹ç´€éŒ„ï¼Œçµ¦è‡ªå·±ç•™é»å°è±¡ï¼Œå°å¤§å®¶å¯èƒ½æ²’æœ‰ç›´æ¥å¹«åŠ©ï¼Œå¯ä»¥ç•¶æ•…äº‹çœ‹çœ‹åšå€‹åƒè€ƒã€‚</p>\n<p>TL;DR</p>\n<p>ä¸‹é¢çš„ç¯‡å¹…å¤§éƒ¨åˆ†åœ¨è¬›è§£ç™¼ç¾å•é¡Œçš„æµç¨‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è·³åˆ°<a href=\"#%E9%87%8D%E6%96%B0%E6%A2%B3%E7%90%86%E4%B8%80%E4%B8%8B%E5%95%8F%E9%A1%8C%E8%88%87%E8%A7%A3%E6%B3%95\">æœ€å¾Œ</a>çœ‹é‡é»ã€‚</p>\n<h2 id=\"ä¸€åˆ‡çš„é–‹ç«¯\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E5%88%87%E7%9A%84%E9%96%8B%E7%AB%AF\" aria-label=\"ä¸€åˆ‡çš„é–‹ç«¯ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ä¸€åˆ‡çš„é–‹ç«¯</h2>\n<p>åœ˜éšŠå…§æœ‰å€‹å°ˆæ¡ˆæ˜¯å°ˆé–€æä¾›çµ¦è¡ŒéŠ·äººå“¡è£½ä½œè¡ŒéŠ·é é¢çš„å…§éƒ¨å·¥å…·ï¼Œtech stack ä¸­æœ‰ä½¿ç”¨ React èˆ‡ styled-componentsã€‚åŸæœ¬æœ€æ—©çš„å¯¦ä½œæ–¹å¼æ˜¯ç°¡å–®çš„ Single Page Applicationï¼Œé€é API æ‹‰å–å…§å®¹é€²è¡Œ renderï¼Œè€Œç”±æ–¼é é¢å¤§å¤šæ˜¯åœ¨ App å…§çš„ WebView é–‹å•Ÿï¼Œç‚ºäº†æé«˜ä½¿ç”¨è€…ç¶“é©—ï¼Œæˆ‘å€‘æ±ºå®šå°‡é é¢å…ˆè¡Œåœ¨ server ç«¯é€²è¡Œ prerenderï¼Œå°‡ HTML æ”¾ç½® CDNï¼Œclient ç«¯è¼‰å…¥æ‰€éœ€è³‡æºå¾Œï¼ŒJS å†é€é <code class=\"language-text\">ReactDOM.hydrate</code> é€²è¡Œ hydrationï¼Œè®“æœ‰äº’å‹•åŠŸèƒ½çš„ react component å¯ä»¥é‹ä½œã€‚</p>\n<p>prerender çš„åšæ³•ï¼Œéå¸¸ç›´æ¥ï¼Œæˆ‘å€‘ä½¿ç”¨ puppeteer é–‹å•Ÿ Headless server ç›´æ¥ render åŸæœ¬çš„ SPA é é¢ï¼ŒæŠŠ <code class=\"language-text\">page.content()</code> çµ¦å­˜èµ·ä¾†ã€‚</p>\n<p>æœƒæ¡ç”¨é€™ç¨®åšæ³•çš„ä¸€å€‹åŸå› æ˜¯å› ç‚ºåŸæœ¬ç”¨åœ¨ SPA ä¸Šçš„ component å…¶å¯¦ä¹ŸåŒæ™‚å…±ç”¨åœ¨å…§éƒ¨å·¥å…·ä¸­ï¼Œè€Œæ•´å€‹ SPA é é¢ä¹Ÿé‚„ä¿ç•™è‘—ä½œç‚ºé è¦½ï¼Œè®“ä½¿ç”¨è€…åœ¨ç·¨è¼¯è£½ä½œè¡ŒéŠ·é é¢çš„æ™‚å€™èƒ½å¤ å³æ™‚çœ‹åˆ°é é¢å¤–è§€ï¼Œå› æ­¤èˆ‡å…¶ä¿®æ”¹æˆ <code class=\"language-text\">ReactDOM.renderToString()</code>ï¼Œç›´æ¥å°‡ SPA æ¸²æŸ“å®Œçš„çµæœå­˜ä¸‹ä¾†ï¼Œç›´è¦ºä¸Šç°¡å–®å¾ˆå¤šï¼Œç¨‹å¼ç¢¼çš„æ›´å‹•ä¹Ÿå°‘ã€‚</p>\n<p>prerender å®Œå¾Œï¼Œæ¥è‘—æœƒæŠŠä¸éœ€è¦åœ¨å‰ç«¯ rehydrate çš„ component å¾ JS bundle ä¸­ç§»é™¤ï¼Œinject éœ€è¦çš„ style tagï¼Œæœ€å¾Œé€£åŒ HTML ä¸€èµ·æ”¾åˆ° CDN ä¸Šã€‚</p>\n<p>è¦ inject style tag çš„åŸå› æ˜¯å› ç‚º styled-components å¦‚åŒå¤šæ•¸ CSS-in-JS è§£æ±ºæ–¹æ¡ˆï¼Œæ˜¯ä½¿ç”¨ CSSOM å» insertRuleï¼Œè€Œé€™æ¨£çš„åšæ³•åœ¨ Chrome 85 ä»¥å‰æ˜¯ç„¡æ³•é€é devtool ä¾†èª¿æ•´ styleï¼Œåœ¨é–‹ç™¼éšæ®µé™¤éŒ¯ä¸Šç¨å«Œéº»ç…©ï¼Œæ‰€ä»¥æˆ‘å€‘åˆ©ç”¨ prerender å®Œçš„å„ªåŒ–éšæ®µä¾†æŠŠ styled-components æ”¾åœ¨ CSSOM ä¸­çš„ sheet æŠ“å‡ºä¾†å¡åˆ° style tag ä¸­ï¼ˆè¨»ï¼šç•¶æ™‚ä½¿ç”¨çš„é‚„ä¸æ˜¯ styled-components v5+ å› æ­¤æ²’æœ‰ <code class=\"language-text\">disableCSSOMInjection</code> option å¯ç”¨ã€‚ï¼‰</p>\n<p>ç°¡å–®çš„æ¶æ§‹åœ–ï¼š</p>\n<p><img src=\"/image/mock-structure.png\" alt=\"simple structure\"></p>\n<p>åŸºæœ¬ä¸Šé€™æ¨£ä¸€åˆ‡éƒ½å¾ˆé †åˆ©ï¼Œå¯¦éš›æ¸¬è©¦ä¸Šç·šä¹Ÿéƒ½æ²’ä»€éº¼å¤ªå¤§å•é¡Œã€‚</p>\n<p>ä½†æ˜¯æœ‰å€‹éš±è—çš„ bug æˆ‘å€‘ä¸€ç›´éƒ½æ²’æœ‰ç™¼ç¾ï¼Œå°±æ˜¯ <strong>prerender å®Œçš„é é¢å­˜æœ‰æ¨£å¼è·‘ç‰ˆçš„æ©Ÿæœƒã€‚</strong></p>\n<p>è€Œä¸”é€™å€‹æƒ…æ³ä¸¦ä¸æ˜¯å¾ˆå®¹æ˜“ç™¼ç”Ÿï¼Œå¯¦éš›ä¸Šåœ¨æˆ‘å€‘æ„è­˜åˆ°ä¹‹å‰ï¼ŒPM æ—©å·²å›å ±éä¸€å…©æ¬¡ï¼Œä½†åŸºæ–¼æ…£æ€§ï¼Œç™¼ç¾é é¢æœ‰é»å¥‡æ€ªæ™‚ï¼Œè‡ªç„¶åæ‡‰æ˜¯é‡æ–°æ•´ç†ã€é‡æ–°åŸ·è¡Œï¼Œçœ‹çœ‹èƒ½å¦é‡ç¾ issueï¼Œè€Œé€™å€‹ bug åœ¨é‡æ–° prerender å¾Œæœ‰è »å¤§çš„æ©Ÿç‡æœƒå†æ¬¡éš±è—èµ·ä¾†ï¼Œä¹Ÿå› æ­¤æ²’æœ‰ç²å¾—è¶³å¤ çš„æ³¨æ„åŠ›è®“æˆ‘å€‘æŒçºŒå°ˆç ”ä¸‹å»ã€‚</p>\n<p>ç›´åˆ°æŸå€‹åŒäº‹åœ¨å¯¦ä½œä¸€å€‹é é¢è¼‰å…¥å¾Œæœƒæœ‰è¼ƒå¤šç‹€æ…‹è®ŠåŒ–çš„ component æ™‚ï¼Œä»–ç™¼ç¾åˆ°ï¼Œåœ¨æ²’æœ‰æ›´å‹•ç¨‹å¼ç¢¼çš„æƒ…æ³ä¸‹ï¼Œåœ¨ client ç«¯æ‰å‹•æ…‹å‡ºç¾çš„ component æ¨£å¼å»è·‘æ‰äº†ï¼Œä½†ç€è¦½å™¨ first load HTML æ™‚å»æ˜¯æ­£å¸¸çš„ã€‚</p>\n<h2 id=\"åˆ°åº•æ˜¯ä»€éº¼å•é¡Œ\" style=\"position:relative;\"><a href=\"#%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E9%BA%BC%E5%95%8F%E9%A1%8C\" aria-label=\"åˆ°åº•æ˜¯ä»€éº¼å•é¡Œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>åˆ°åº•æ˜¯ä»€éº¼å•é¡Œ</h2>\n<p>ç‚ºäº†é™¤éŒ¯ï¼Œæˆ‘åˆ©ç”¨ Devtool æ’å…¥ä¸­æ–·é»ï¼Œç™¼ç¾åˆ°ç¬¬ä¸€æ¬¡ HTML è¼‰å…¥æ™‚ï¼Œä¸€åˆ‡çš„ Style éƒ½æ˜¯æ­£å¸¸çš„ï¼ŒåŒ…å« styled-components æ‰€ç”¢ç”Ÿçš„ class name ä»¥åŠæˆ‘å€‘ inject åˆ° html å…§çš„ style tagï¼›ç„¶è€Œç•¶ JS bundle è¼‰å…¥ï¼Œå‰ç«¯ react component é‡æ–° render å¾Œï¼ŒHTML DOM ä¸Šçš„ styled-components class name èˆ‡åŸå…ˆçš„ä¸åŒï¼Œclass name æ‰€å°æ‡‰çš„ css style rule ä¹Ÿä¸ä¸€æ¨£ã€‚</p>\n<p>æ¥è‘—å†ç´°çœ‹æœ€çµ‚ç€è¦½å™¨æ¸²æŸ“çš„ HTMLï¼Œç™¼ç¾åˆ° <code class=\"language-text\">&lt;head></code> å…§æœ‰å…©å€‹å±¬æ–¼ styled-components çš„ style tagã€‚</p>\n<p><img src=\"/image/two-style-tag.png\" alt=\"two style tag\"></p>\n<p>åˆ°é€™é‚Šå•é¡Œå°±æ¯”è¼ƒæ¸…æ¥šäº†ã€‚</p>\n<p><strong>æˆ‘å€‘å¡äº†å…©æ¬¡ styled-components ç”¢ç”Ÿçš„ style tagï¼Œæ‰€ä»¥å°è‡´ class name çš„ style æœ‰è¡çªã€‚</strong></p>\n<p>ä¸Šé¢ç´…ç·šæ‹¬å¼§çš„éƒ¨åˆ†æ˜¯æˆ‘å€‘åœ¨ server-side inject é€²å»ï¼Œå«æœ‰ css text çš„ style tagï¼›ä¸‹æ–¹é»ƒç·šæ¨™è¨˜çš„å‰‡æ˜¯ client ç«¯ hydrate å¾Œï¼Œæ‰€ç”¢ç”Ÿçš„æ–°çš„ style tagã€‚</p>\n<p>é€ æˆçš„å¾Œæœå°±æ˜¯å…©å€‹æ¯«ç„¡ç›¸å¹²çš„ component æœ‰æ©Ÿæœƒå…±äº«äº†åŒæ¨£çš„ class nameï¼Œå…¶ä¸­ä¸€å€‹ component çš„ style å°±è·‘æ‰äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!--Call to action component--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sc-AxiKw iOTgPf<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!--FQA component--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sc-AxhUy iOTgPf<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨æˆ‘å€‘çš„ case ä¸­ï¼Œç”±æ–¼æˆ‘å€‘é‚„æœƒæŠŠä¸éœ€è¦åœ¨å‰ç«¯ rehydrate çš„ react component code å¾ JS bundle è£¡æ‹¿æ‰ï¼Œæ‰€ä»¥é‚£äº›æˆ‘å€‘æ‰€è¬‚ <em>éœæ…‹çš„ component</em> æ¨£å¼åŸºæœ¬ä¸Šä¸å¤ªæœƒå—å½±éŸ¿ï¼Œæ‰è®“é€™å€‹ bug æ¯”è¼ƒé›£ç™¼ç¾ã€‚</p>\n<h2 id=\"è§£æ±ºæ–¹æ¡ˆ\" style=\"position:relative;\"><a href=\"#%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" aria-label=\"è§£æ±ºæ–¹æ¡ˆ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è§£æ±ºæ–¹æ¡ˆ</h2>\n<p>æ—¢ç„¶ç™¼ç¾å¤šäº†ä¸€å€‹ style tagï¼Œé‚£æˆ‘å€‘æŠŠå¾Œä¾†è“‹ä¸Šå»çš„é‚£å€‹ tag æ‹¿æ‰ä¸å°±å¾—äº†å—ï¼Ÿ</p>\n<p>ä½†äº‹æƒ…æœç„¶ä¸æ˜¯æ†¨äººæƒ³å¾—é€™éº¼ç°¡å–®ã€‚</p>\n<p>æ‹¿æ‰åœ¨ client-side é‡æ–°ç”¢ç”Ÿçš„ style tag æ˜¯å¯ä»¥ç¢ºä¿æ•´å€‹ application åªåƒåˆ°æˆ‘å€‘åŸå…ˆåœ¨ server ç«¯ inject çš„ CSS æ¨£å¼ï¼Œä½†åœ¨ rehydrate çš„éç¨‹ä¸­ï¼Œcomponent çš„ class name ä¹Ÿè®Šäº†ï¼Œæ‰€ä»¥å–®ç´”æ‹¿æ‰ client side style tag åè€Œè®“æ•´å€‹é é¢çš„æ¨£å¼æ›´åŠ æ…˜çƒˆã€‚</p>\n<p>é‚„æ˜¯å¾—å¾æ ¹æœ¬è§£æ±ºå•é¡Œã€‚</p>\n<p>ä¹‹æ‰€ä»¥æœƒç”¢ç”Ÿå…©å€‹ style tagï¼ŒåŸå› åœ¨æ–¼æˆ‘å€‘åœ¨ client ç«¯é€²è¡Œ hydration æ™‚ï¼Œä¸¦<strong>æ²’æœ‰æ­£ç¢ºè™•ç† styled-components çš„ hydration</strong>ï¼Œåªé¡§æ…®åˆ°äº† react component æœ¬èº«çš„ hydrationï¼Œå°æ–¼ styled-compponent ä¾†èªªï¼Œæˆ‘å€‘åœ¨ server-side inject çš„ style tag <strong>ä¸è¶³ä»¥è®“ä»–é€²è¡Œ rehydrateï¼ˆåŸå› å¾Œé¢æœƒèªªæ˜ï¼‰</strong>ï¼Œæ‰€ä»¥ä»–å¯¦éš›ä¸Šåªèƒ½é‡æ–° render æ‰€æœ‰ component çš„ styleï¼Œé‡æ–°ç”¢ç”Ÿ class name èˆ‡ style tagã€‚</p>\n<p>è€Œåœ¨äº†è§£åˆ°æˆ‘å€‘è‡ªå·± inject çš„ style tag ç„¡æ³•è®“ styled-components é€²è¡Œ rehydrate å¾Œï¼Œæˆ‘è©¦è‘—ç”¨å‰é¢æåˆ°éçš„ <code class=\"language-text\">disableCSSOMInjection</code>ï¼Œæ ¹æ“š<a href=\"https://styled-components.com/docs/api#stylesheetmanager\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜ç¶²</a>ï¼Œå¯ä»¥æ­é… <code class=\"language-text\">StyleSheetManager</code>ï¼Œè®“ styled-components è‡ªå·± export å‡ºå«æœ‰ css text çš„ style tagï¼Œä½†çµæœé‚„æ˜¯ä¸€æ¨£æœ‰å•é¡Œï¼ˆå¾Œé¢æœƒè§£é‡‹åŸå› ï¼‰ã€‚</p>\n<p>å› æ­¤ï¼Œé‚„æ˜¯å¾—ä»”ç´°äº†è§£è©²å¦‚ä½•è®“ styled component èƒ½æ­£ç¢º rehydrateï¼Œè®€å–æˆ‘å€‘åœ¨ prerender æ™‚å°±å·²ç¶“è™•ç†éçš„ styleï¼Œæ‰ä¸æœƒé€ æˆ class name è¡çªï¼Œä»¥åŠæœ‰å¤šé¤˜çš„ style tag ç”¢ç”Ÿã€‚</p>\n<h3 id=\"styled-components-çš„-hydration\" style=\"position:relative;\"><a href=\"#styled-components-%E7%9A%84-hydration\" aria-label=\"styled components çš„ hydration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>styled-components çš„ hydration</h3>\n<p>çŸ¥é“ solution çš„æ–¹å‘å¾Œï¼Œé–‹å§‹åˆ°å®˜ç¶²æŸ¥é–±é—œæ–¼ server side hydration çš„è³‡æ–™ï¼Œç™¼ç¾æœ‰é‡å° server-side rendering æ‰€æå‡ºçš„<a href=\"https://styled-components.com/docs/advanced#server-side-rendering\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è§£æ±ºæ–¹æ¡ˆ</a>ï¼šåˆ©ç”¨ <code class=\"language-text\">ServerStyleSheet</code> å¯ä»¥æ­é… <code class=\"language-text\">StyleSheetManager</code> providerï¼Œè®“ styled-components åœ¨ server-side èƒ½å¤ ç”¢ç”Ÿ css styleï¼Œä¸¦ä¸”æä¾›æ©Ÿåˆ¶è®“è©² style èƒ½åœ¨ client-side è¢« rehydrateï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> sheet <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ServerStyleSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> <span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyleSheetManager</span></span> <span class=\"token attr-name\">sheet</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>sheet<span class=\"token punctuation\">.</span>instance<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">YourApp</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyleSheetManager</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> styleTags <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getStyleTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// or sheet.getStyleElement();</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// handle error</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n  sheet<span class=\"token punctuation\">.</span><span class=\"token function\">seal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>çœ‹èµ·ä¾†å°±æ˜¯è©²é€™æ¨£åšï¼Œä¸éå‘¢ï¼Œå…‰å¾åå­—å°±è·Ÿä½ èªªäº†ä»–æ˜¯çµ¦ä½ åœ¨ Server ç”¨çš„ï¼Œç”šè‡³é‚„åœ¨æ–‡æª”ä¸­å¯«ä¸Šï¼š<em>Just make sure not to use it on the client-side.</em></p>\n<p>ä½†æˆ‘å€‘çš„ prerender å¯¦éš›ä¸Šæ˜¯è·‘åœ¨ client ç«¯ï¼Œé€™æ¨£è‚¯å®šä¸è¡Œå§ï¼Ÿ</p>\n<p>æˆ‘åŸæœ¬ä¹Ÿæ˜¯é€™æ¨£æƒ³ï¼Œæ‰“ç®—æ”¾æ£„çš„æ™‚å€™ï¼Œæˆ‘å„ªç§€çš„<a href=\"https://github.com/whatasoda\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">åŒäº‹</a>è·‘å»è®€äº†è®€ styled-components çš„åŸå§‹ç¢¼ï¼Œç™¼ç¾ <code class=\"language-text\">ServerStyleSheet</code> å…§å…¶å¯¦æ²’æœ‰ç”¨åˆ°ä»»ä½• NodeJS ç¨æœ‰çš„ APIï¼Œä¹Ÿå°±æ˜¯èªªå¯¦éš›ä¸Š <code class=\"language-text\">ServerStyleSheet</code> è·‘åœ¨ client ç«¯ä¹Ÿæ˜¯æ²’å•é¡Œçš„ï¼</p>\n<p><code class=\"language-text\">ServerStyleSheet</code> è·Ÿä¸€èˆ¬ styled-components åœ¨ client ç«¯ä½¿ç”¨çš„ <code class=\"language-text\">StyleSheet</code>ï¼ˆstyled-components è‡ªå·±<a href=\"https://github.com/styled-components/styled-components/blob/b19d17f1d6739d0cc6da826cf701a9ee3c075525/packages/styled-components/src/sheet/Sheet.js#L26\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å¯¦ä½œçš„ç‰ˆæœ¬</a>ï¼Œä¸¦é <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/StyleSheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Browser å…§å»ºçš„ StyleSheet</a>ï¼‰å·®åˆ¥åœ¨æ–¼ï¼Œ<code class=\"language-text\">ServerStyleSheet</code> å¤šå‚³äº†ä¸€å€‹ <a href=\"https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/models/ServerStyleSheet.js#L22\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">isServer = true</code> çš„ option</a> çµ¦ <code class=\"language-text\">StyleSheet</code>ï¼Œè€Œé€™æœƒä½¿å¾— styled-components çš„ <code class=\"language-text\">StyleSheet</code> åœ¨ <code class=\"language-text\">makeTag</code> çš„æ™‚å€™ï¼Œä¸æ˜¯å»ç”Ÿæˆä¸€å€‹å¯¦éš›çš„ style tagï¼Œè€Œæ˜¯ç”¢ç”Ÿä¸€å€‹ <code class=\"language-text\">VirtualTag</code>ï¼š</p>\n<p><a href=\"https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/sheet/Tag.js#L7-L16\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">source code</a></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">/** Create a CSSStyleSheet-like tag depending on the environment */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> makeTag <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> isServer<span class=\"token punctuation\">,</span> useCSSOMInjection<span class=\"token punctuation\">,</span> target <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> SheetOptions<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Tag <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isServer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VirtualTag</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>useCSSOMInjection<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CSSOMTag</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextTag</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é€™å€‹ <code class=\"language-text\">VirtualTag</code> åŒ…å«æ‰€æœ‰ style çš„è³‡è¨Šï¼Œä½†ä¸éœ€è¦æ“ä½œåˆ°å¯¦éš›çš„ DOMï¼Œé€™å°±æ˜¯è®“ styled-components èƒ½æ”¯æ´ SSR çš„åŸå› ã€‚</p>\n<p>è€Œ <code class=\"language-text\">StyleSheet</code> çš„ <code class=\"language-text\">toString</code> <a href=\"https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/sheet/Sheet.js#L122\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å‡½å¼</a>ï¼Œèƒ½å¤  serialize <code class=\"language-text\">makeTag</code> ç”¢ç”Ÿçš„ tag çš„å…§å®¹ï¼š</p>\n<p><a href=\"https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/sheet/Rehydration.js#L10-L39\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">source code</a></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">outputSheet</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>sheet<span class=\"token operator\">:</span> Sheet<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> tag <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getTag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> length <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> tag<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> css <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> group <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> group <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> group<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">getIdForGroup</span><span class=\"token punctuation\">(</span>group<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>id <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> names <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>names<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> rules <span class=\"token operator\">=</span> tag<span class=\"token punctuation\">.</span><span class=\"token function\">getGroup</span><span class=\"token punctuation\">(</span>group<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>names <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">||</span> rules<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> selector <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SC_ATTR</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.g</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>group<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">[id=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"]</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> content <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>names <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      names<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          content <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// NOTE: It's easier to collect rules and have the marker</span>\n    <span class=\"token comment\">// after the actual rules to simplify the rehydration</span>\n    css <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>rules<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>selector<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">{content:\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>content<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"}</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SPLITTER</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> css<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å†æ­é… <code class=\"language-text\">ServerStyleSheet</code> æä¾›çš„ <code class=\"language-text\">getStyleTags</code> æ–¹æ³•ï¼Œèƒ½å¤  output å‡ºæ­£ç¢ºçš„ style tag ä¾† inject åˆ°ä½  SSR ç”¢ç”Ÿçš„ HTML å…§ï¼Œè®“ styled-components å¯ä»¥é †åˆ© Rehydrateã€‚</p>\n<p>è€Œä½•è¬‚ â€œæ­£ç¢ºâ€ çš„ style tag å‘¢ï¼Ÿ</p>\n<p>åœ¨æˆ‘å€‘æœ€ä¸€é–‹å§‹çš„å¯¦ä½œä¸­ï¼Œæˆ‘å€‘è‡ªå·±æ˜¯é€éä¸‹é¢é€™èˆ¬æ–¹å¼ç”¢ç”Ÿå‡ºè¦ inject åˆ° HTML ä¸­çš„ style tagï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'style'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">elem</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// styled-components é è¨­ç”¢ç”Ÿçš„ tag æœƒæ˜¯ç©ºçš„ï¼Œå› ç‚ºæ¡ç”¨ CSSOM API insertRule</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>elem<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">!==</span> <span class=\"token string\">''</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>elem<span class=\"token punctuation\">.</span>sheet <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">CSSStyleSheet</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\t\n  elem<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>elem<span class=\"token punctuation\">.</span>sheet<span class=\"token punctuation\">.</span>cssRules <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\t\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rule</span> <span class=\"token operator\">=></span> rule<span class=\"token punctuation\">.</span>cssText<span class=\"token punctuation\">)</span>\t\n    <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¹Ÿå°±æ˜¯èªªæˆ‘å€‘æ˜¯å–å‡º styled-components é è¨­ç”¢å‡ºçš„ style tagï¼ŒæŠŠå…¶ä¸­çš„ cssRules è®€å‡ºä¾†å¾Œå¡å›å»ã€‚</p>\n<p>é€™æ¨£çš„åšæ³•éŒ¯åœ¨æœƒä¿ç•™ style tag ä¸Šçš„å…¶ä»–å±¬æ€§ï¼Œåƒæ˜¯ <code class=\"language-text\">data-styled=active</code>ã€‚</p>\n<p>ç•¶ styled-components åœ¨é€²è¡Œ Rehydrate æ™‚ï¼Œä»–æœƒå»æŠ“å– <code class=\"language-text\">data-styled</code> ä¸ç‚º <code class=\"language-text\">active</code> çš„ style tag ä¾† parseï¼Œä¸¦é€²è¡Œ rehydrateï¼š</p>\n<p><a href=\"https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/sheet/Rehydration.js#L89\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">source code</a></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rehydrateSheet</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>sheet<span class=\"token operator\">:</span> Sheet<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> nodes <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SELECTOR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> l <span class=\"token operator\">=</span> nodes<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> l<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> node <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>nodes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> HTMLStyleElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node <span class=\"token operator\">&amp;&amp;</span> node<span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SC_ATTR</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token constant\">SC_ATTR_ACTIVE</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">rehydrateSheetFromTag</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        node<span class=\"token punctuation\">.</span>parentNode<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é€™ä¹Ÿèªªæ˜äº†ç‚ºä»€éº¼ä¸€é–‹å§‹æˆ‘ä½¿ç”¨ <code class=\"language-text\">disableCSSOMInjection</code> è®“ styled-components å¹«æˆ‘ç”¢ç”Ÿ text node-based çš„ css style tag ä¹Ÿæ²’æœ‰ç”¨ï¼Œå› ç‚ºé‚£æ¨£ç”¢ç”Ÿçš„ style tag ã„§æ¨£æœƒæ˜¯å¸¶æœ‰ <code class=\"language-text\">data-style=active</code> çš„å±¬æ€§ï¼Œä¸¦ä¸æœƒè¢« styled-components æ‹¿å» rehydrateã€‚</p>\n<p>é€™æ™‚æˆ‘å€‘æ›´åŠ é‡æ¸…äº†å•é¡Œã€‚</p>\n<p>é¦–å…ˆï¼Œæœ‰å…©å€‹ styled-components çš„ style tag çš„ç¢ºä¸å°ï¼Œä½†<strong>é‡é»æ˜¯é€™å…©å€‹ style tag åŒæ™‚éƒ½æ“æœ‰ <code class=\"language-text\">data-styled</code> ç‚º <code class=\"language-text\">true</code> çš„å±¬æ€§ï¼Œä»¥è‡´æ–¼ styled-components åœ¨ rehydrate çš„æ™‚å€™æŠ“ä¸åˆ°å¯ç”¨çš„ style tagã€‚</strong></p>\n<p>å¦å¤–ï¼Œä¹Ÿä¸æ˜¯å–®ç´” <code class=\"language-text\">data-styled</code> ä¸ç‚º <code class=\"language-text\">true</code> çš„ style tag å°±å¯ä»¥è¢« rehydrateï¼Œå‰é¢æåˆ° <code class=\"language-text\">StyleSheet</code> çš„ <code class=\"language-text\">toString</code> èƒ½å¤  serialize <code class=\"language-text\">VirtualTag</code> çš„å…§å®¹ï¼Œå…¶ä¸­æœ‰ä¸€æ®µç¨‹å¼ç¢¼èˆ‡è¨»è§£ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// NOTE: It's easier to collect rules and have the marker</span>\n<span class=\"token comment\">// after the actual rules to simplify the rehydration</span>\ncss <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>rules<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>selector<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">{content:\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>content<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"}</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SPLITTER</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é€™é‚ŠæŒ‡ç¤ºå‡ºï¼Œè¦èƒ½å¤ è¢« rehydrate çš„ text node-based çš„ css style tagï¼Œéœ€è¦æœ‰ç‰¹å®šçš„ <code class=\"language-text\">SPLITTER</code>ï¼š</p>\n<p><a href=\"https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/constants.js#L13\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">source code</a></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">SPLITTER</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/*!sc*/\\n'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a href=\"https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/sheet/Rehydration.js#L55\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">source code</a></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rehydrateSheetFromTag</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>sheet<span class=\"token operator\">:</span> Sheet<span class=\"token punctuation\">,</span> style<span class=\"token operator\">:</span> HTMLStyleElement<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> parts <span class=\"token operator\">=</span> style<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SPLITTER</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rules<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ... ç•¥</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h2 id=\"é‡æ–°æ¢³ç†ä¸€ä¸‹å•é¡Œèˆ‡è§£æ³•\" style=\"position:relative;\"><a href=\"#%E9%87%8D%E6%96%B0%E6%A2%B3%E7%90%86%E4%B8%80%E4%B8%8B%E5%95%8F%E9%A1%8C%E8%88%87%E8%A7%A3%E6%B3%95\" aria-label=\"é‡æ–°æ¢³ç†ä¸€ä¸‹å•é¡Œèˆ‡è§£æ³• permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>é‡æ–°æ¢³ç†ä¸€ä¸‹å•é¡Œèˆ‡è§£æ³•</h2>\n<h3 id=\"å•é¡Œ\" style=\"position:relative;\"><a href=\"#%E5%95%8F%E9%A1%8C\" aria-label=\"å•é¡Œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å•é¡Œ</h3>\n<p>æˆ‘å€‘é é¢ prerender å®Œçš„çµæœï¼Œåœ¨ client ç«¯ first load èˆ‡ JS bundle rehydrate å¾Œçš„æ¨£å¼ä¸åŒï¼ŒåŸå› æ˜¯åˆ©ç”¨ client side render è£½ä½œ prerender æ™‚ï¼Œç”¢ç”Ÿå…©å€‹åŒæ¨£æ“æœ‰ <code class=\"language-text\">data-styled=true</code> å±¬æ€§çš„ styled-components style tagï¼Œé€ æˆ styled-components ç„¡æ³• rehydrateï¼Œåªå¥½é‡æ–°ç”¢ç”Ÿæ–°çš„ style tagï¼Œå› è€Œç ´å£äº†é é¢æ¨£å¼ã€‚</p>\n<h3 id=\"è§£æ³•\" style=\"position:relative;\"><a href=\"#%E8%A7%A3%E6%B3%95\" aria-label=\"è§£æ³• permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è§£æ³•</h3>\n<p>ä½¿ç”¨ <code class=\"language-text\">ServerStyleSheet</code> æ­é… <code class=\"language-text\">StyleSheetManager</code> åœ¨ prerender éšæ®µç”Ÿæˆ <code class=\"language-text\">VirtualTag</code>ï¼ˆé€™é‚Šçš„ä½¿ç”¨æ–¹æ³•ç¨å¾® hack äº†ä¸€é»ï¼Œå› ç‚ºæˆ‘å€‘çš„ prerender æ˜¯ client-side renderï¼Œè€Œå®˜æ–¹ä¸å»ºè­°å°‡ <code class=\"language-text\">ServerStyleSheet</code> ä½¿ç”¨åœ¨ client sideï¼‰ï¼Œæ¥è‘—å†é€é <code class=\"language-text\">ServerStyleSheet</code> çš„ <code class=\"language-text\">getStyleTags</code> å–å¾—å¯è¢« styled-components å­˜å–é€²è¡Œ rehydration çš„ style tagï¼Œä¸¦ inject åˆ° prerendered HTML ä¸­ã€‚</p>\n<p>ä¸»è¦çš„ç¨‹å¼ç¢¼ç‰‡æ®µå¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> sheet <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ServerStyleSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// æ”¾åœ¨æ•´å€‹ Application çš„æœ€ä¸Šå±¤</span>\n<span class=\"token keyword\">const</span> StyleSheetProvider<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">FC</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>StyleSheetManager sheet<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sheet<span class=\"token punctuation\">.</span>instance<span class=\"token punctuation\">}</span> children<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// åœ¨ prerender çµæŸï¼Œç”¢ç”Ÿ HTML å¾ŒåŸ·è¡Œ</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">injectStyleElement</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'style'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  style<span class=\"token punctuation\">.</span>outerHTML <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getStyleTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  sheet<span class=\"token punctuation\">.</span><span class=\"token function\">seal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åˆ°é€™é‚Šç‚ºæ­¢å°±ç®—æ˜¯å°‡å•é¡Œè§£æ±ºäº†ï¼Œä½†æœƒç™¼ç¾é‚„æ˜¯æœ‰å•é¡Œï¼Œé›–ç„¶ style tag æˆåŠŸåªå‰©ä¸‹ä¸€å€‹ï¼Œçœ‹èµ·ä¾† rehydrate ä¹Ÿæœ‰æˆåŠŸï¼Œä½†æ¨£å¼é‚„æ˜¯è·‘æ‰äº†ã€‚</p>\n<p>é‚„å¥½é€™å€‹åŸå› å¾ˆå¥½æ‰¾ï¼Œå®˜ç¶²å°±æœ‰<a href=\"https://styled-components.com/docs/advanced#tooling-setup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è§£ç­”</a> ï¼š</p>\n<blockquote>\n<p>In order to reliably perform server side rendering and have the client side bundle pick up without issues, you'll need to use our babel plugin. It prevents checksum mismatches by adding a deterministic ID to each styled component.</p>\n</blockquote>\n<p>å°±æ˜¯ SSR æœ€å¸¸è¦‹çš„ checksum issueï¼Œæˆ‘å€‘éœ€è¦çµ¦æ¯ä¸€å€‹ styled-component ä¸€å€‹åœ¨å‰å¾Œç«¯ä¸€è‡´çš„ IDï¼Œé€™æ¨£æ‰å¯ä»¥ç¢ºä¿ rehydrate å¾Œèƒ½å¤ æ“æœ‰ç›¸åŒçš„ classã€‚</p>\n<p>åŠ ä¸Š <a href=\"https://styled-components.com/docs/tooling#babel-plugin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">babel-plugin</a> å¾Œå•é¡Œå°±æˆåŠŸè§£æ±ºäº†ï¼</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>ç¶“éé€™æ¬¡çš„é™¤éŒ¯éç¨‹ï¼Œæˆ‘æ‰ç™¼ç¾è‡ªå·±å°æ–¼ styled-component é€™é¡ React ç”Ÿæ…‹ç³»çš„å¥—ä»¶äº†è§£åº¦ä¸å¤ æ·±ï¼Œæ‰å°è‡´åœ¨ä¸€é–‹å§‹è¨­è¨ˆå¯¦ä½œ prerender æ™‚æ²’æœ‰æ³¨æ„åˆ°é€™ä»¶äº‹æƒ…ï¼Œå¦å¤–ä¹Ÿé€éé€™æ¬¡çš„ç´€éŒ„ç™¼ç¾è¦å°‡ä¸€å€‹ bug çš„åŸå› èˆ‡è§£æ³•å¾é ­åˆ°å°¾æ›¸å¯«å‡ºä¾†æœ‰å¤šå›°é›£ï¼Œç•¢ç«Ÿæ•´å€‹é™¤éŒ¯éç¨‹ä½ å¯èƒ½æ˜¯è·³è€€æ€§çš„åœ¨æ€è€ƒå„ç¨®å¯èƒ½ï¼Œæ–‡ç« ä¸­çš„æ¯å€‹æ­¥é©Ÿå…¶å¯¦ä¹Ÿçµ•å°ä¸æ˜¯é€™æ¨£ä¸€æ­¥æ­¥æ‰¾å‡ºè§£æ³•çš„ï¼Œè¦æœ‰æ¢ç†çš„å°‡å…¶æ¢³ç†å‡ºä¸€å€‹æµæš¢çš„ flow çœŸçš„éœ€è¦ä¸€é»åŠŸåŠ›ï¼Œçœ‹ä¾†æˆ‘é‚„æœ‰å¾ˆå¤§çš„é€²æ­¥ç©ºé–“ï¼</p>\n<p>é›–ç„¶é€™æ¬¡çš„å•é¡Œå¯¦éš›ä¸Šçš„è§£æ³•ä¸éœ€è¦æ›´å‹•å¤šå°‘ç¨‹å¼ç¢¼ï¼ŒåŸç†ä¹Ÿå¾ˆç°¡å–®ï¼Œä½†è‹¥æ˜¯æ²’æœ‰åƒæˆ‘åŒäº‹é‚£æ¨£é‘½å…¥ç¨‹å¼ç¢¼å»æŸ¥çœ‹ï¼Œå…‰æ˜¯æ†‘é è‡ªå·±çš„é‚è¼¯æ˜¯å¾ˆé›£æ€è€ƒå‡ºä¾†çš„ã€‚æ•´å€‹éç¨‹å­¸ç¿’åˆ°å¾ˆå¤šï¼Œé‡åˆ°é€™å€‹ bug çœŸæ˜¯å¤ªå¥½äº†ï¼ï¼ˆå¥½åƒæ€ªæ€ªçš„...ï¼‰</p>\n<h3 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h3>\n<ol>\n<li><a href=\"https://styled-components.com/docs/advanced\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">styled-component website</a></li>\n<li><a href=\"https://github.com/styled-components/styled-components/blob/master/packages/styled-components/src/sheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">styled-component source code</a></li>\n</ol>","id":"342141e0-0a2e-53ff-8ba8-a915956520a3","fields":{"slug":"styld-component-prerendering-issue"},"frontmatter":{"date":"2020-08-15T13:37:30.000Z","title":"å¦ä¸€å€‹èˆ‡ styled-components ç›¸é—œçš„ debug ç´€éŒ„","tags":["web","styled-components","server-side generated page","react"],"type":"tech","slug":"styld-component-prerendering-issue"},"timeToRead":13},{"excerpt":"å¥½æ­Œåˆ†äº«ï¼šæµ·è±šåˆ‘è­¦ã€å®‰å¹³ä¹‹å…‰ã€","html":"<blockquote>\n<p>å¥½æ­Œåˆ†äº«ï¼š<a href=\"https://youtu.be/ZrpZB8-VBD0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æµ·è±šåˆ‘è­¦ã€å®‰å¹³ä¹‹å…‰ã€</a></p>\n</blockquote>\n<iframe width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/ZrpZB8-VBD0\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>ä¸Šå€‹æœˆåœ¨ <a href=\"https://dev.to/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Dev.to</a> ä¸Šçœ‹åˆ° <a href=\"https://dev.to/devteam/announcing-the-grant-for-the-web-hackathon-on-dev-3kd1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Announcing the Grant For The Web Hackathon on DEV</a> é€™å€‹ Hackathon æ¯”è³½ï¼Œé›–ç„¶çœ‹åˆ°çš„æ™‚å€™æ¯”è³½å·²ç¶“çµæŸäº†ï¼Œä½†é‚„æ˜¯ä»”ç´°çœ‹äº†ä»–çš„å…§å®¹ï¼Œç™¼ç¾æåˆ°äº†ä¸€å€‹æˆ‘æ²’è½éçš„åè© - Web Monetizationï¼Œçœ‹åˆ° monetizationğŸ’° å°±å‹¾èµ·æˆ‘çš„èˆˆè¶£äº†...æ‰€ä»¥ç¨å¾®æŸ¥è©¢äº†äº›è³‡æ–™ï¼Œåšé»ç­†è¨˜é †ä¾¿åˆ†äº«çµ¦å¤§å®¶ã€‚</p>\n<h2 id=\"ä»€éº¼æ˜¯-web-monetizationåˆç‚ºä»€éº¼éœ€è¦å®ƒ\" style=\"position:relative;\"><a href=\"#%E4%BB%80%E9%BA%BC%E6%98%AF-web-monetization%E5%8F%88%E7%82%BA%E4%BB%80%E9%BA%BC%E9%9C%80%E8%A6%81%E5%AE%83\" aria-label=\"ä»€éº¼æ˜¯ web monetizationåˆç‚ºä»€éº¼éœ€è¦å®ƒ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ä»€éº¼æ˜¯ Web Monetizationï¼Œåˆç‚ºä»€éº¼éœ€è¦å®ƒ</h2>\n<p><a href=\"https://webmonetization.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web Monetizationï¼ˆWMï¼‰</a> æ˜¯ç›®å‰æ­£åœ¨è¨è«–å¸Œæœ›èƒ½åˆ—ç‚º W3C æ¨™æº–çš„ä¸€å€‹ Web APIï¼Œæ—¨åœ¨é€éæ¨™æº–ä¸”é–‹æ”¾çš„ API èˆ‡ protocol (<a href=\"https://interledger.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">interledger</a>) ä¾†é€²è¡Œå…§å®¹å‰µä½œè€…èˆ‡ä½¿ç”¨è€…é–“çš„å°é¡ä»˜è²»ã€‚</p>\n<p>é€éé€™æ–°çš„ Web API ï¼Œæä¾›ç¶²è·¯ç”¨æˆ¶ä¸€å€‹é™¤äº†è¨‚é–±ã€å»£å‘Šç­‰ä»¥å¤–çš„ç²åˆ©æ–¹å¼ï¼Œä¸¦åŒæ™‚å…¼é¡§è³‡æ–™éš±ç§èˆ‡ä½¿ç”¨è€…é«”é©—ã€‚åœ¨å¾Œé¢çš„ç« ç¯€æœƒå†è©³ç´°é»ä»‹ç´¹å…¶æ¶æ§‹èˆ‡ API æ ¼å¼ã€‚</p>\n<p>æœƒçœ‹åˆ°é€™ç¯‡æ–‡ç« çš„è®€è€…ï¼Œæƒ³å¿…ä¹Ÿå¸¸å¸¸åœ¨ Medium ç­‰å…§å®¹å¹³å°é–±è®€è³‡è¨Šï¼Œå°æ–¼ç›®å‰å¸‚é¢ä¸Šæ–‡å­—å…§å®¹å‰µä½œè€…æ‰€èƒ½ç‡Ÿåˆ©çš„ç®¡é“ä¸æœƒå¤ªé™Œç”Ÿï¼Œåƒæ˜¯ Pay wallã€è¨‚é–±ã€å»£å‘Šç½®å…¥ã€è´ŠåŠ©ã€LikeCoin ç­‰ç­‰ã€‚</p>\n<p>é€™äº›æ©Ÿåˆ¶éƒ½æä¾›äº†å‰µä½œè€…ä¸€å€‹å–å¾—å›å ±çš„ä¾†æºï¼Œä½†åŒæ™‚ä¹Ÿå¸¶ä¾†ç›¸å°æ‡‰çš„å•é¡Œã€‚</p>\n<p>é¦–å…ˆæ˜¯é–±è®€é«”é©—ï¼ŒPay wall èˆ‡å»£å‘Šç½®å…¥ï¼Œéƒ½æ˜¯ä¿éšœå‰µä½œè€…åŸºæœ¬å›å ±çš„æ©Ÿåˆ¶ï¼Œä½†æ¯ç•¶é»é€²ä¸€ç¯‡æ–‡ç« å»ç™¼ç¾è‡ªå·±è¢«æ“‹åœ¨ç‰†å¤–ï¼Œæˆ–æ˜¯è¢«è¿«å°‡æ³¨æ„åŠ›åˆ†æ•£åˆ°é‹ªå¤©è“‹åœ°çš„å»£å‘Šï¼Œéƒ½è®“ä½¿ç”¨è€…çš„é«”é©—å¤§å¹…ä¸‹é™ï¼Œæ›´åˆ¥æå»£å‘ŠèƒŒå¾Œéš±å«çš„éš±ç§å®‰å…¨ç–‘æ…®ã€‚</p>\n<p>å†è€…ï¼Œç„¡è«–æ˜¯ä»˜è²»åŠ å…¥ pay wallã€è¨‚é–±ã€ç›´æ¥ Patreonã€buymeacoffee è´ŠåŠ©æˆ–æ˜¯ LikeCoinï¼Œéƒ½æ˜¯éœ€è¦ä½¿ç”¨è€…èˆ‡å‰µä½œè€…é›™æ–¹åœ¨ä¸åŒçš„å¹³å°ä¸Šè¨»å†Šå¸³è™Ÿï¼Œé‡è¤‡å¸³è™Ÿè¨­å®šçš„æµç¨‹ä¸€æ–¹é¢æµªè²»é‡‘éŒ¢æ™‚é–“ï¼ˆåŠ ä¸Šå­¸ç¿’æœå‹™æ“ä½œçš„æ™‚é–“æˆæœ¬ï¼‰ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿæ˜¯åœ¨å‡ºè³£ä½ è‡ªèº«çš„è³‡æ–™ï¼Œå°‡å…¶æ•£æ’­åˆ°å„å€‹å¹³å°ä¸Šæ–¹ã€‚æ›´åˆ¥ææœ€å¸¸ç™¼ç”Ÿçš„ç‹€æ³æ‡‰è©²æ˜¯ï¼Œä½¿ç”¨è€…ä¸€çœ‹åˆ°éœ€è¦å¦å¤–è¨»å†Šæ–°å¸³è™Ÿä¸”ä»˜è²»ï¼Œä¹¾è„†æ”¾æ£„é–±è®€è©²ç¯‡æ–‡ç« ï¼Œç•¢ç«Ÿå¾ˆå°‘æœƒæœ‰äººæƒ³åªç‚ºäº†é–±è®€æŸç¯‡æ–‡ç« å°±ä»˜å‡ºé€™äº›ä»£åƒ¹ã€‚</p>\n<p>é€é Web Monetization API çš„æ¨™æº–åŒ–ï¼Œç†è«–ä¸Šä¾†èªªï¼Œå‰µä½œè€…èˆ‡ä½¿ç”¨è€…å¯ä»¥å„è‡ªé¸æ“‡å–œæ­¡çš„æœå‹™å¹³å°ï¼Œè€Œæœå‹™é–“é€éçµ±ä¸€çš„ protocol æºé€šï¼Œé›™æ–¹éƒ½ä¸å†éœ€è¦åˆ°è™•å‰µå»ºå¸³è™Ÿã€‚</p>\n<p>è€Œä¸”æœ‰äº†æ¨™æº–çš„ JavaScript APIï¼Œå‰µä½œè€…å¯ä»¥è‡ªè¡ŒæŒæ§å¸Œæœ›çš„ monetization æ¨¡å¼ï¼Œåƒæ˜¯å¸¸è¦‹çš„ Exlusive contentã€å»£å‘Šç§»é™¤ç­‰ç­‰ï¼Œæ›´é€²ä¸€æ­¥çš„è©±ç”šè‡³èƒ½åšåˆ°<a href=\"https://webmonetization.org/docs/probabilistic-rev-sharing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ–‡ç« åˆ†æ½¤</a> æˆ–æ˜¯ä¾ç…§é–±è®€æ™‚é–“é•·çŸ­ä¾†æ±ºå®šè²»ç”¨å¤šå¯¡ç­‰åŠŸèƒ½ã€‚å®˜ç¶²æœ‰ä¸€äº›æŒºé…·çš„<a href=\"https://webmonetization.org/docs/exclusive-content\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ‡‰ç”¨ç¯„ä¾‹</a>ã€‚</p>\n<h2 id=\"web-monetization-çš„æ¶æ§‹\" style=\"position:relative;\"><a href=\"#web-monetization-%E7%9A%84%E6%9E%B6%E6%A7%8B\" aria-label=\"web monetization çš„æ¶æ§‹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Monetization çš„æ¶æ§‹</h2>\n<p>Web Monetization çš„æ¶æ§‹èˆ‡é‹ä½œæµç¨‹ï¼Œå¯ä»¥å¾å…¶å®˜ç¶²çš„ <a href=\"https://webmonetization.org/docs/explainer#sequence-diagram\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sequence diagram</a> ä¾†ç†è§£ï¼Œä½†å¯ä»¥å…ˆçœ‹æˆ‘ç•«çš„ç°¡åŒ–ç‰ˆæµç¨‹ä¾†åˆç•¥äº†è§£ä¸€ä¸‹ï¼š</p>\n<p><img src=\"/image/wm-simple-flow.png\" alt=\"wm-simple-flow\"></p>\n<p>ç°¡å–®ä¸‰å€‹æ­¥é©Ÿï¼š1. ä½¿ç”¨è€…åŠ å…¥ <code class=\"language-text\">WM Sender</code> çš„æœƒå“¡ä¸¦å„²å€¼ï¼›2. å…§å®¹å‰µé€ è€…è¨­å®šä»–çš„æ•¸ä½éŒ¢åŒ…åˆ° <code class=\"language-text\">WM Receiver</code> ä¸Šï¼Œä¸¦åœ¨ç¶²ç«™ä¸Šå•Ÿç”¨ Web Monetizationï¼›3. ç•¶ä½¿ç”¨è€…åˆ°äº†å‰µä½œè€…çš„ç¶²ç«™æ™‚ï¼Œsender å°±æœƒå°‡éŒ¢å‚³é€çµ¦ receiverï¼Œå‰µä½œè€…å°±èƒ½ç²å¾—é‡‘éŒ¢ã€‚</p>\n<p>å†ä¾†å›åˆ°å®˜ç¶²çš„ <a href=\"https://webmonetization.org/docs/explainer#sequence-diagram\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sequence diagram</a> ï¼š</p>\n<p><img src=\"/image/webmonetization-flow.svg\" alt=\"webmonetization-flow\"></p>\n<p>Web Monetization çš„å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼ˆè™Ÿç¢¼å°æ‡‰åœ–ä¸­çš„åºåˆ—è™Ÿç¢¼ï¼‰ï¼š</p>\n<ol>\n<li>è¦å•Ÿå‹•æ•´å€‹ Web Monetization æµç¨‹çš„ç¬¬ä¸€æ­¥æ˜¯ä½ çš„ç¶²ç«™éœ€è¦å…ˆæœ‰è¨­å®šä¸€å€‹ç‰¹æ®Šçš„ <code class=\"language-text\">meta</code> tagï¼Œè©² tag åŒ…å«äº†ä¸€å€‹å«åš <a href=\"https://webmonetization.org/docs/explainer#payment-pointers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">payment pointer</a> è³‡è¨Šï¼ŒæœƒæŒ‡å‘ç¶²ç«™è¨­å®šçš„ Walletã€‚ç€è¦½å™¨åœ¨è§£æ HTML tag æ™‚ç™¼ç¾é€™è³‡è¨Šæ™‚ï¼Œå°±å¯ä»¥çŸ¥é“æ¥ä¸‹ä¾†è¦å¾€å“ªè£¡é€å‡º paymentã€‚</li>\n<li>\n<p>ç€è¦½å™¨æœƒç”¨å…§éƒ¨å¯¦ä½œçš„ Web Monetization agent ä¾†è¨ˆç®—è¦ä»˜çµ¦ç¶²ç«™å¤šå°‘è²»ç”¨ã€‚</p>\n<ul>\n<li>ä¹‹æ‰€ä»¥è¦è¨ˆç®—ï¼Œæ˜¯å› ç‚º Web Monetization æä¾› Micropaymentï¼Œèƒ½å¤ ä»˜éå¸¸å°é‡çš„é‡‘é¡ï¼Œä¸å¿…ç¸½æ˜¯æ•´æ•¸ï¼Œæ‰€ä»¥å³ä¾¿ä½¿ç”¨è€…çš„éŒ¢åŒ…å…§æ²’æœ‰è¶³å¤ é‡‘é¡ï¼Œç¶²ç«™ä¹Ÿèƒ½å¤ èª¿æ•´æä¾›å°æ‡‰çš„å…§å®¹ï¼Œæ¯”å¦‚èªªç™¼ç¾ä½¿ç”¨è€…åªå‰©åå¡Šï¼Œä½†çœ‹ä¸€ç¯‡æ–‡ç« è¦äº”åå¡Šï¼Œé‚£ç¶²ç«™æ–¹å¯ä»¥é¸æ“‡æ”¶å–åå¡Šè²»ç”¨è®“ä½¿ç”¨è€…çœ‹ä¸€åŠçš„å…§å®¹ç­‰ç­‰ã€‚</li>\n</ul>\n</li>\n<li>æ¥è‘—ç€è¦½å™¨æœƒç”¢ç”Ÿä¸€çµ„å”¯ä¸€çš„ session ID ä½œç‚ºæ­¤æ¬¡ payment çš„ session ç´€éŒ„ã€‚</li>\n<li>å¾ç¬¬ä¸€æ­¥å¾—åˆ°çš„ payment pointer url å¯ä»¥ç”¨ä¾†å–å¾—å¯¦éš›çš„ä»˜æ¬¾ä½å€èˆ‡ secretã€‚</li>\n<li>[Optional] å¯ä»¥å¦å¤–è¨­ç½®ä¸€å€‹ receipt verifier service åœ¨ç¶²ç«™èˆ‡ WM Receiver ä¸­é–“ï¼Œç”¨ä¾†ç”¢ç”Ÿæ”¶æ“šç­‰è³‡è¨Šã€‚</li>\n<li>\n<p>ç•¶ä¸Šè¿°éç¨‹å®Œæˆå¾Œï¼Œåªè¦ä½¿ç”¨è€…é‚„ focus åœ¨åŒå€‹ç¶²ç«™ä¸Šï¼Œç€è¦½å™¨å°±å¯ä»¥é–‹å§‹å°‡è¨ˆç®—å¥½çš„ä»˜æ¬¾é‡‘é¡å¾ä½¿ç”¨è€…çš„ WM Sender é€çµ¦ WM Receiverã€‚</p>\n<ul>\n<li>é€™é‚Šç‰¹åˆ¥å¼·èª¿ focus åœ¨ç¶²ç«™ä¸Šï¼Œæ˜¯å› ç‚ºæ ¹æ“šç›®å‰çš„ Specï¼Œé‚„æ²’æœ‰è¦ç¯„åˆ°è¦å¦‚ä½•é‡å°åœ¨ Background tabs çš„ç¶²ç«™é€²è¡Œä»˜è²»ï¼Œä¾‹å¦‚åœ¨èƒŒæ™¯æ’­æ”¾çš„éŸ³æ¨‚æœå‹™ç­‰ç­‰ï¼Œä½†åœ¨ <a href=\"https://github.com/WICG/webmonetization/issues/17\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web Incubator CG (WICG)</a> ä¸­æ˜¯æœ‰é–‹å€‹ Issue åœ¨è¨è«–çš„ã€‚</li>\n</ul>\n</li>\n<li>WM Sender æ”¶åˆ°ç€è¦½å™¨çš„ä»˜æ¬¾éœ€æ±‚å¾Œï¼Œé–‹å§‹å‘ WM Receiver streaming paymentã€‚</li>\n<li>[Optional] è‹¥æ˜¯æœ‰ä½¿ç”¨ receipt verifier serviceï¼ŒWM Receiver å¯ä»¥åœ¨é€™æ­¥ç”¢ç”Ÿæ”¶æ“šä¸¦å‚³å›çµ¦ WM Senderã€‚</li>\n<li>WM Sender é€šçŸ¥ç€è¦½å™¨ä»˜æ¬¾æˆåŠŸã€‚</li>\n<li>æ”¶åˆ°é€šçŸ¥å¾Œï¼Œç€è¦½å™¨å¯ä»¥é€é API dispatch event å‘ŠçŸ¥ç¶²ç«™ä»˜æ¬¾æˆåŠŸ</li>\n<li>æ¥è‘—ç¶²ç«™å°±èƒ½æ ¹æ“šä»˜æ¬¾ç‹€æ…‹æä¾›ä¸åŒçš„å…§å®¹æˆ–æœå‹™çµ¦ä½¿ç”¨è€…ï¼Œéœ€è¦çš„è©±ï¼Œä¹Ÿèƒ½é€é receipt verifier service ä¾†é©—è­‰è©²ç­†äº¤æ˜“[Optional]ã€‚</li>\n</ol>\n<p>ç„¡è«–æ˜¯æˆ‘çš„ç°¡åŒ–æµç¨‹ï¼Œæˆ–æ˜¯å®˜ç¶²ä¸Šçš„å®Œæ•´æµç¨‹ï¼Œé‡é»éƒ½åœ¨å…©å€‹ä¸»è¦è§’è‰²ä¸Šï¼š<code class=\"language-text\">WM Receiver</code> èˆ‡ <code class=\"language-text\">WM Sender</code>ã€‚</p>\n<p>å…§å®¹å‰µä½œè€…éœ€è¦è¨­å®š <code class=\"language-text\">WM Receiver</code>ï¼Œè€Œä½¿ç”¨è€…å‰‡éœ€è¦æœ‰ <code class=\"language-text\">WM Sender</code>ã€‚</p>\n<h3 id=\"web-monetization-sender\" style=\"position:relative;\"><a href=\"#web-monetization-sender\" aria-label=\"web monetization sender permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Monetization Sender</h3>\n<p>ç•¶ä½ æ˜¯ Web Monetization çš„ä½¿ç”¨è€…æ–¹æ™‚ï¼Œéœ€è¦æœ‰ WM Senderï¼Œä½ éœ€è¦è¨»å†Š WM Sender çš„æœƒå“¡ï¼Œä¸¦ç¹³äº¤è²»ç”¨ï¼Œä½œç‚ºä½ ä»˜æ¬¾çµ¦å…§å®¹å‰µä½œè€…çš„è³‡é‡‘ã€‚</p>\n<p>è€Œç›®å‰å”¯ä¸€çš„ WM sender æ˜¯ä¸€é–“å« <a href=\"https://coil.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Coil</a> çš„å…¬å¸ï¼ŒåŒæ™‚ä¹Ÿæ˜¯æå‡ºæ•´å€‹ Web Monetizaiton æ¨™æº–åŒ–çš„äººã€‚</p>\n<p>åŠ å…¥ä¸¦æˆç‚º Web Monetization çš„ä½¿ç”¨è€…å°±å¹¾å€‹æ­¥é©Ÿï¼š</p>\n<ol>\n<li>è¨»å†Šä¸€å€‹ coil å¸³è™Ÿ - <a href=\"https://coil.com/signup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://coil.com/signup</a></li>\n<li>è¨­å®šä½ çš„ä¿¡ç”¨å¡è³‡è¨Šä»¥æ¯æœˆæœ€ä½äº”ç¾å…ƒçš„é‡‘é¡è¨‚é–± Coil æœå‹™ï¼ˆWM Senderï¼‰</li>\n<li>æœ€å¾Œä½ éœ€è¦ä¸‹è¼‰ä¸€å€‹ç€è¦½å™¨ Extensionï¼Œä»¥å•Ÿç”¨ Web Monetizationï¼Œå› ç‚ºç›®å‰æ­¤ API é‚„åœ¨ W3C æ¨™æº–çš„è¨è«–éšæ®µï¼Œéœ€è¦é€é Extension æ‰èƒ½åœ¨ç›®å‰ä¸»æµç€è¦½å™¨ä¸Šä½¿ç”¨ã€‚<a href=\"https://chrome.google.com/webstore/detail/coil/locbifcbeldmnphbgkdigjmkbfkhbnca?hl=en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Chrome</a>, <a href=\"https://addons.mozilla.org/en-US/firefox/addon/coil/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Firefox</a>, <a href=\"https://microsoftedge.microsoft.com/addons/detail/ljionajlbinlfkdnpkloejeoogfgkojm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Edge</a></li>\n</ol>\n<p>ç•¶ä½ è£å¥½ Extension å¾Œï¼Œåˆ°ä»»ä¸€ç¶²ç«™ï¼Œè©² Extension å¯ä»¥è®“ä½ çŸ¥é“è©²ç¶²ç«™æ˜¯å¦æ”¯æ´ Web Monetizationï¼š</p>\n<p><img src=\"/image/wm-extension-example.png\" alt=\"extension-example\"></p>\n<h3 id=\"web-monetization-receiver\" style=\"position:relative;\"><a href=\"#web-monetization-receiver\" aria-label=\"web monetization receiver permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Monetization Receiver</h3>\n<p>Coil èº«ç‚ºæ­¤æ¨™æº–çš„ææ¡ˆäººå…¼å”¯ä¸€ä¸€å€‹å¯¦ä½œ Web Monetization Sender çš„å…¬å¸ï¼Œä½œç‚º Web Monetization Receiver çš„æä¾›å•†ä¹Ÿæ˜¯åˆæƒ…åˆç†ã€‚</p>\n<p>ä½†è‡³å°‘ä½ çš„ Payment pointerï¼Œä¹Ÿå°±æ˜¯ä½ çš„éŒ¢åŒ…å¯ä»¥æœ‰ä¸åŒé¸æ“‡ï¼Œä½ å¯ä»¥é¸æ“‡ä»»ä½•æœ‰æ”¯æ´ <a href=\"https://interledger.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">interledger</a> protocol çš„æ•¸ä½éŒ¢åŒ…ï¼Œç›®å‰æœ‰ï¼š</p>\n<ol>\n<li>GateHub XRP - Defaults to XRP but can be exchanged for any currency supported by GateHub</li>\n<li>Stronghold - USD (Local regulations prevent Stronghold from supporting certain countries and regions.</li>\n<li>Uphold - USD, EUR, GBP, CAD, PLN, XRP, BTC, ETH, +59 more</li>\n</ol>\n<p>åœ¨ Coil çš„ç¶²ç«™ä¸Šå¯ä»¥æ‰¾åˆ°<a href=\"https://help.coil.com/accounts/digital-wallets-payment-pointers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å„å®¶å¹³å°çš„è¨­å®šæ–¹å¼</a>ã€‚</p>\n<p>å–å¾—çš„ Payment pointer å…¶å¯¦å°±æ˜¯ä¸€å€‹é¡ä¼¼ url æ ¼å¼çš„ç¶²å€ï¼š</p>\n<ul>\n<li>GateHub - <code class=\"language-text\">$ilp.gatehub.net/123456789</code></li>\n<li>Stronghold - <code class=\"language-text\">$pay.stronghold.co/1b567ec83c151f44fb693fabc3d02ac09bb</code></li>\n<li>Uphold - <code class=\"language-text\">$ilp.uphold.com/ABC3DefGHi67jk</code></li>\n</ul>\n<p>æœ‰äº† Payment pointerï¼Œä¹Ÿè¨­å®šåˆ° Coil è®“å®ƒçŸ¥é“è¦æŠŠæœƒå“¡çš„éŒ¢è½‰åˆ°ä½ çš„å“ªå€‹éŒ¢åŒ…å¾Œï¼Œå°±åªéœ€è¦å°‡ä¸‹é¢é€™å€‹ <code class=\"language-text\">meta</code> tag è¨­å®šåˆ°ä½ çš„ç¶²ç«™å…§å³å¯é–‹å§‹å•Ÿå‹•æ•´å€‹æµç¨‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- ç•¶ç„¶ content è¦æ›æˆä½ è‡ªå·±çš„ payment pointer --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>monetization<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$ilp.uphold.com/ABC3DefGHi67jk<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"ç¨å¾®ä¾†çœ‹å€‹ç¨‹å¼ç¢¼\" style=\"position:relative;\"><a href=\"#%E7%A8%8D%E5%BE%AE%E4%BE%86%E7%9C%8B%E5%80%8B%E7%A8%8B%E5%BC%8F%E7%A2%BC\" aria-label=\"ç¨å¾®ä¾†çœ‹å€‹ç¨‹å¼ç¢¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¨å¾®ä¾†çœ‹å€‹ç¨‹å¼ç¢¼</h2>\n<p>ç•¢ç«Ÿé€™æ˜¯ä¸€å€‹é‚„æœªæˆç‚ºæ¨™æº–çš„ APIï¼Œç›¸ä¿¡åˆ°é€šéææ¡ˆä¸¦æ­£å¼å¯¦ä½œåœ¨ç€è¦½å™¨ä¸Šæ™‚ï¼ŒAPI æˆ–å¤šæˆ–å°‘æœƒæœ‰æ‰€æ”¹è®Šï¼Œå› æ­¤å°±ä¸æ¢ç©¶å¤ªå¤š API ç´°ç¯€ï¼Œé™„ä¸Šä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹è®“å¤§å®¶æœ‰é»æ„Ÿè¦ºå°±å¥½ï¼š</p>\n<p>åœ¨ä½ çš„ç¶²ç«™ä¸­å¯ä»¥æ”¾å…¥ä»¥ä¸‹çš„ç¨‹å¼ç‰‡æ®µï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\">&lt;!-- content è¦æ›æˆä½ è‡ªå·±çš„ payment pointer --></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>monetization<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$ilp.uphold.com/ABC3DefGHi67jk<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n    <span class=\"token selector\">.hidden</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>monetization<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      document<span class=\"token punctuation\">.</span>monetization<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'monetizationstart'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'exclusive'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hidden'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n    Show me the money!\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>exclusive<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    Here's some exclusive content for people who pay me!\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>ç•¶ç€è¦½å™¨åµæ¸¬åˆ°ä½ çš„é é¢å«æœ‰ <code class=\"language-text\">&lt;meta name=\"monetization\" content=\"...\"></code> æ™‚ï¼Œ<code class=\"language-text\">WM Sender</code> å¯ä»¥å•Ÿå‹• Web monetization é€²è¡Œä»˜æ¬¾ï¼Œä»˜æ¬¾æˆåŠŸå¾Œ <code class=\"language-text\">WM Receiver</code> å¯ä»¥ dispatch ä¸€å€‹ <code class=\"language-text\">monetizationstart</code> eventï¼Œä½ çš„ç¶²ç«™ç›£è½åˆ°å¾Œï¼Œå°±å¯ä»¥æŠŠç¨å®¶å…§å®¹é¡¯ç¤ºçµ¦ä½¿ç”¨è€…ï¼š</p>\n<p><img src=\"/image/wm-sample-demo.gif\" alt=\"wm-sample-demo\"></p>\n<p>æƒ³çœ‹å®Œæ•´ä¸€é»çš„ç¯„ä¾‹å¯ä»¥åˆ°é€™å€‹ç¶²ç«™ç©ç©ï¼Œ<a href=\"https://testwebmonetization.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://testwebmonetization.com/</a>ï¼Œè£¡é¢é™„æœ‰ç¨‹å¼ç¢¼ï¼ŒåŒ…å«äº†å¦ä¸€å€‹ event <code class=\"language-text\">monetizationprogress</code>ï¼ˆç”¨ä¾†è¨˜éŒ„ä»˜æ¬¾é€²åº¦ï¼‰çš„ç”¨æ³•ï¼š</p>\n<p><img src=\"/image/wm-sample-demo2.gif\" alt=\"wm-sample-demo2\"></p>\n<p>Wait...</p>\n<p>å¾é€™å…©å€‹ç¯„ä¾‹ä¾†çœ‹ï¼Œæˆ‘ç™¼å€‹ Event ä½ å°±å¯ä»¥ç•¶ä½œæˆ‘ä»˜æ¬¾äº†ï¼Œæ ¹æœ¬æ˜¯æ¼æ´å§ï¼Ÿ</p>\n<p>å–®å¾ç¯„ä¾‹ä¾†çœ‹çš„ç¢ºæ˜¯é€™æ¨£ï¼Œä½†åˆ¥å¿˜äº†åœ¨<a href=\"Web%20Monetization%20%E7%9A%84%E6%9E%B6%E6%A7%8B\">å®Œæ•´çš„ Web monetization æµç¨‹</a> ä¸­æœ‰æåˆ°ï¼Œæ¥æ”¶åˆ° event çš„ç¶²ç«™å¯ä»¥å†å»å‘ <code class=\"language-text\">WM Receiver</code> ç¢ºèªæ”¶æ“šèˆ‡ä»˜æ¬¾ç‹€æ³ï¼Œåšé€²ä¸€æ­¥çš„é©—è­‰ï¼Œé€™å€‹ <a href=\"https://github.com/sharafian/web-monetization-access#asking-for-proof\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">repo</a> æä¾›äº†ç¯„ä¾‹å‘Šè¨´ä½ å¯ä»¥åˆ©ç”¨ JWT èˆ‡ Interledger protocol ä¾†è™•ç†ã€‚</p>\n<h2 id=\"èƒŒå¾Œæˆå“¡\" style=\"position:relative;\"><a href=\"#%E8%83%8C%E5%BE%8C%E6%88%90%E5%93%A1\" aria-label=\"èƒŒå¾Œæˆå“¡ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>èƒŒå¾Œæˆå“¡</h2>\n<p>é›–ç„¶æ•´å€‹ Web monetization çš„æµç¨‹ä¸­éƒ½æ²’æœ‰æåˆ°å€å¡Šéˆçš„æŠ€è¡“ï¼Œä½†ä½ é‚„æ˜¯å¾—ç”³è«‹ä¸€å€‹æ•¸ä½éŒ¢åŒ…ï¼Œæ”¶å–åŒ…å«è™›æ“¬è²¨å¹£åœ¨å…§çš„é‡‘éŒ¢ã€‚å°æ–¼å€å¡Šéˆä¸å¤ªç†Ÿæ‚‰çš„æˆ‘å°æ–¼é€™ä»¶äº‹æœ‰é»å¥½å¥‡ï¼Œç¨å¾®æŸ¥äº†ä¸€ä¸‹å¾Œæ‰ç™¼ç¾ï¼ŒCoil çš„å‰µå§‹æˆå“¡å¹¾ä¹éƒ½æ˜¯å‰å¹¾å¹´è²åé æ’­çš„ç‘æ³¢å¹£ï¼ˆRippleï¼‰çš„æˆå“¡ï¼Œåƒæ˜¯ Coil çš„ Founder å’Œç¾ä»» CEO å³æ˜¯æ›¾ä»» Ripple CTO çš„ <a href=\"https://www.linkedin.com/in/justmoon/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Stefan Thomas</a>ï¼Œä¹Ÿé›£æ€ªç›®å‰æ”¯æ´çš„ <code class=\"language-text\">WM Receiver</code> ä¸­æœ‰ <code class=\"language-text\">GateHub</code>ã€‚é€™é‚Šæœ‰å ´ä»–èˆ‡ W3C æˆå“¡çš„<a href=\"https://www.w3.org/blog/2019/09/w3c-interview-coil-on-interledger-protocol-and-web-monetization/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¨ªè«‡ç´€éŒ„</a>ã€‚</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>é›–ç„¶ç›®å‰ä¹çœ‹ä¹‹ä¸‹ï¼ŒWeb Monetization å¾ææ¡ˆåˆ°ç›¸é—œ ecosystem çš„ç™¼å±•ï¼Œéƒ½æ˜¯ç”± Coil ä¸€é–“å…¬å¸æ‰€è² è²¬èˆ‡æŒæ§ï¼Œä½†å…¶ä»–åŸºé‡‘æœƒå¦‚ Mozilla èˆ‡ Creative commons éƒ½æœ‰åƒèˆ‡ï¼Œä»–å€‘ç”šè‡³ä¸€èµ·åˆä½œé–‹è¨­äº†ä¸€å€‹ <a href=\"https://www.grantfortheweb.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GRANT FOR\nTHE WEB</a> çš„ç™¾è¬è¨ˆç•«ï¼Œç›®çš„å°±åœ¨æ¨å»£æ›´å¥åº·çš„ç¶²è·¯ï¼Œç”¨å…¬é–‹çš„æ¨™æº–è¦æ ¼ï¼Œè®“äººå€‘æ‹¿å›å°æ–¼è‡ªå·±å…§å®¹ç‡Ÿåˆ©çš„æŒæ§æ¬Šï¼Œä¸ç”¨å†ä¾è³´æ–¼å„ç¨®æƒ±äººå»£å‘Šã€ä»˜è²»ç‰†èˆ‡å€‹äººéš±ç§è³‡æ–™çš„ä¾µçŠ¯ã€‚</p>\n<p>ç›¸ä¿¡é€™å€‹è¨ˆç•«æ…¢æ…¢æ¨é€²ä¸‹å»çš„è©±ï¼Œæœƒæœ‰æ›´å¤šæœå‹™å‡ºç¾ä½œç‚º <code class=\"language-text\">WM Sender</code>ï¼Œå°±ä¸æœƒæœ‰ Coil å£Ÿæ–·çš„ç–‘æ…®äº†ã€‚</p>\n<p>å¸Œæœ›é€éé€™ç¯‡æ–‡ç« çš„ä»‹ç´¹èƒ½ç¨å¾®å¼•èµ·å¤§å®¶çš„èˆˆè¶£ï¼Œé—œæ³¨é€™å€‹å€‹äººè¦ºå¾—è »æœ‰ç™¼å±•æ·ºåŠ›çš„è¨ˆç•«ï¼</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://webmonetization.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">webmonetization.org</a></li>\n<li><a href=\"https://dev.to/hacksultan/web-monetization-like-i-m-5-1418\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web Monetization like I'm 5</a></li>\n<li><a href=\"https://testwebmonetization.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">testwebmonetization</a></li>\n<li><a href=\"https://github.com/sharafian/web-monetization-access#asking-for-proof\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">web-monetization-access</a></li>\n<li><a href=\"https://forum.grantfortheweb.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Grant for the Web</a></li>\n<li><a href=\"https://coil.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">coil</a></li>\n</ol>","id":"0d410155-3ec5-5718-bed4-a1c9a5e132f3","fields":{"slug":"wtf-is-web-monetization"},"frontmatter":{"date":"2020-07-18T13:50:00.000Z","title":"Web Monetization ç°¡ä»‹","tags":["web","monetization","standard"],"type":"tech","slug":"wtf-is-web-monetization"},"timeToRead":10},{"excerpt":"å¥½æ­Œåˆ†äº«ï¼šSan Cisco - 'On The Line'","html":"<blockquote>\n<p>å¥½æ­Œåˆ†äº«ï¼š<a href=\"https://youtu.be/jlubk5RYCAc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">San Cisco - 'On The Line'</a></p>\n</blockquote>\n<iframe width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/jlubk5RYCAc\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>ç”Ÿæˆè—è¡“ä¸€ç›´æ˜¯æˆ‘å¾ˆæƒ³å­¸ç¿’çš„ä¸»é¡Œï¼Œé›–ç„¶çŸ¥é“å¤§éƒ¨åˆ†çš„äººæœƒä½¿ç”¨ <a href=\"https://processing.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">processing</a>, <a href=\"http://paperjs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">paper.js</a>, æˆ–æ˜¯ <a href=\"https://zimjs.com/art.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">zimjs</a> ä¾†è£½ä½œ Generative art, ä½†åœ¨å°æ–¼è‡ªå·±çš„è—è¡“å¤©ä»½å¾ˆæœ‰è‡ªçŸ¥ä¹‹æ˜çš„æƒ…æ³ä¸‹ï¼Œä¸€ç›´éƒ½æ²’æœ‰å»å˜—è©¦è£½ä½œï¼Œå†åŠ ä¸Šé€™äº›å·¥å…·çš„å­¸ç¿’ä¹Ÿæ˜¯æœ‰ã„§å®šé–€æª»ã€‚</p>\n<p>ç„¶è€Œï¼Œæœ€è¿‘åœ¨ Youtube ä¸Šçœ‹åˆ° <a href=\"https://css-doodle.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">css-doodle</a> çš„<a href=\"https://codepen.io/yuanchuan\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä½œè€… - è¢å·</a>æ–¼ <a href=\"https://www.youtube.com/watch?v=mEpocRIc3q8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CSSConf CN 2019 çš„æ¼”è¬›</a>ï¼Œæ‰äº†è§£åˆ°è¦\"é–‹å§‹\"ä¼¼ä¹æ²’æœ‰é€™éº¼é›£ï¼Œåªè¦æŒæ¡ä¸€äº›åŸºæœ¬è§€å¿µèˆ‡æŠ€å·§å³å¯ï¼Œè€Œä¸”ä»–é–‹ç™¼çš„ web component <a href=\"https://css-doodle.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">css-doodle</a> ç„¡è«–æ˜¯èªæ³•æˆ–æ˜¯ä½¿ç”¨éƒ½ç®—æ˜“æ‡‚å¥½ä¸Šæ‰‹ã€‚</p>\n<p>ä»Šå¤©è—‰ç”±é€™ç¯‡æ–‡ç« åˆ†äº«è©²æ¼”è¬›ä¸­æˆ‘å¾ˆå–œæ­¡çš„ä¸€äº›é‡é»ï¼Œä¸¦è©¦è‘—ä»‹ç´¹èˆ‡é‹ç”¨ CSS/JS å’Œ css-doodle è£½ä½œä¸€äº›ç°¡å–®çš„ç”Ÿæˆè—è¡“ä½œå“ã€‚</p>\n<p>å…ˆçµ¦å¤§å®¶çœ‹ç¬¬ä¸€å€‹å° demoï¼Œé€™æ˜¯åƒç…§è¢å·åœ¨æ¼”è¬›ä¸­æåŠçš„ä¸€å€‹ç¯„ä¾‹å¯¦ä½œï¼Œåˆ©ç”¨ç´” CSS èˆ‡ JS æ‰€è£½ä½œçš„ç°¡å–®ç”Ÿæˆè—è¡“:</p>\n<iframe height=\"423\" style=\"width: 100%;\" scrolling=\"no\" title=\"CSS  Generative Art - sample I\" src=\"https://codepen.io/arvin0731/embed/zYvbKQJ?height=423&theme-id=dark&default-tab=result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/arvin0731/pen/zYvbKQJ'>CSS  Generative Art - sample I</a> by Arvin\n  (<a href='https://codepen.io/arvin0731'>@arvin0731</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<h2 id=\"ç°¡å–®çš„äº‹é‡è¤‡åšå°±ä¸ç°¡å–®\" style=\"position:relative;\"><a href=\"#%E7%B0%A1%E5%96%AE%E7%9A%84%E4%BA%8B%E9%87%8D%E8%A4%87%E5%81%9A%E5%B0%B1%E4%B8%8D%E7%B0%A1%E5%96%AE\" aria-label=\"ç°¡å–®çš„äº‹é‡è¤‡åšå°±ä¸ç°¡å–® permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç°¡å–®çš„äº‹é‡è¤‡åšå°±ä¸ç°¡å–®</h2>\n<p>åœ¨ç”Ÿæˆè—è¡“ä¸­ï¼Œ<code class=\"language-text\">Loop</code> ä½”äº†å¾ˆä¸»è¦çš„è§’è‰²ï¼Œéœ€è¦é€éè¿´åœˆçš„æ–¹å¼å»è‡ªå‹•ç”¢ç”Ÿåœ–æ¡ˆã€‚è€Œåœ–æ¡ˆå…¶å¯¦ä¸éœ€è¦è¤‡é›œï¼Œåœ¨ç¬¬ä¸€å€‹ç¯„ä¾‹ä¸­çš„å…ƒç´ å°±åªæœ‰<strong>ç›´ç·š</strong>ã€‚</p>\n<p>ç°¡å–®çš„ç›´ç·šï¼Œé€é <code class=\"language-text\">transform: rotate()</code>ï¼Œå°±èƒ½å¤ æœ‰ä¸ä¸€æ¨£çš„è®ŠåŒ–ï¼Œè€Œé€éçµ„åˆï¼Œå°‡å¤šå€‹æ“æœ‰ä¸åŒç‹€æ…‹çš„ç›´ç·šä¸²æ¥åœ¨ä¸€èµ·ï¼Œå†åŠ ä¸Šæ™‚é–“å› å­ä½œç‚ºè®Šæ•¸å»æ”¹è®Šç‹€æ…‹ï¼Œå°±å¯ä»¥æ˜¯ä¸€å€‹ç°¡å–®çš„ç”Ÿæˆè—è¡“ã€‚</p>\n<p>ç¨‹å¼ç¢¼ä¹Ÿå¾ˆç°¡çŸ­ï¼š</p>\n<p>å…ˆè¨­å®šä¸€å€‹ 5x5 çš„è¡¨æ ¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">div.grid\n  div\n  div\n  // ç•¥ ... å…± 25 å€‹ div</code></pre></div>\n<p>ç¾åœ¨åˆ©ç”¨ CSS grid å¯ä»¥å¾ˆè¼•æ˜“æ§åˆ¶è¡¨æ ¼çš„å‘ˆç¾ï¼Œæ¥è‘—æˆ‘å€‘å¯ä»¥å°‡ä¹‹å¾Œé æœŸè¦ä¾†æ‹¿éš¨æ©Ÿè®ŠåŒ–çš„å±¬æ€§ä»¥ css variable çš„æ–¹å¼è¨­å®šï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--theme</span><span class=\"token punctuation\">:</span> #FF9800<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--deg</span><span class=\"token punctuation\">:</span> 45deg<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">--gride-size</span><span class=\"token punctuation\">:</span> 50px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.grid</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--gride-size<span class=\"token punctuation\">)</span> * 5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0 auto<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> grid<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 5px solid <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--theme<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> 0 0 18px 1px <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--theme<span class=\"token punctuation\">)</span> inset<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">grid-template-columns</span><span class=\"token punctuation\">:</span> <span class=\"token function\">repeat</span><span class=\"token punctuation\">(</span>5<span class=\"token punctuation\">,</span> 1fr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">grid-auto-rows</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--gride-size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.grid div</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--theme<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--theme<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 1px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> all 1s ease-in<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">skew</span><span class=\"token punctuation\">(</span><span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--deg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transform-origin</span><span class=\"token punctuation\">:</span> top<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>JS çš„éƒ¨åˆ†å°±åªéœ€è¦åœ¨å›ºå®šçš„ time interval ä¸­é–“è³¦ä»¥éš¨æ©Ÿç”¢ç”Ÿçš„æ•¸å€¼åˆ° CSS variable ä¸­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getRandomBoolean</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">randomColor</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> color <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">16777215</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> color<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">6</span> <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">f</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>color<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">:</span> color<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">let</span> sign <span class=\"token operator\">=</span> <span class=\"token string\">'+'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> theme <span class=\"token operator\">=</span> <span class=\"token function\">randomColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> divs <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.grid > div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  theme <span class=\"token operator\">=</span> <span class=\"token function\">randomColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  divs<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">div</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    sign <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token function\">getRandomBoolean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">'+'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">;</span>\n    div<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span><span class=\"token function\">setProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">skew(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>sign<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">45deg)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    root<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span><span class=\"token function\">setProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">'--theme'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">#</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>theme<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä»¥é€™æ¨£çš„åŸºæœ¬æƒ³æ³•å‡ºç™¼ï¼Œå°±å¯ä»¥ä¿®æ”¹æˆä¸åŒçš„è®ŠåŒ–ï¼Œåƒæ˜¯åŠ å…¥ <code class=\"language-text\">clip-path</code> ä¾†é€²ä¸€æ­¥æ“ä½œç•«é¢ä¸­çš„åœ–æ¡ˆå…ƒç´ ï¼š</p>\n<iframe height=\"362\" style=\"width: 100%;\" scrolling=\"no\" title=\"CSS  Generative Art - sample II\" src=\"https://codepen.io/arvin0731/embed/OJyqOXZ?height=362&theme-id=dark&default-tab=result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/arvin0731/pen/OJyqOXZ'>CSS  Generative Art - sample II</a> by Arvin\n  (<a href='https://codepen.io/arvin0731'>@arvin0731</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>å¸¶å…¥ä¸€é»æ•¸å­¸ï¼Œå¯ä»¥ç”¢ç”Ÿæ›´å¤šä¸åŒçš„ polygonï¼š</p>\n<iframe height=\"476\" style=\"width: 100%;\" scrolling=\"no\" title=\"CSS  Generative Art - sample III\" src=\"https://codepen.io/arvin0731/embed/VwvRdXe?height=476&theme-id=dark&default-tab=result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/arvin0731/pen/VwvRdXe'>CSS  Generative Art - sample III</a> by Arvin\n  (<a href='https://codepen.io/arvin0731'>@arvin0731</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>ä¸Šé¢é€™ç¯„ä¾‹ä¸­æˆ‘æ˜¯éš¨ä¾¿ç”¨ä¸‰è§’å‡½æ•¸è¨­å®šä¸€å€‹å…¬å¼ä¾†è·‘ï¼Œä½†åœ¨æ¼”è¬›ä¸­ï¼Œè¢å·æœ‰æåŠ <strong>lissajous curves</strong> é€™å€‹å¤è€çš„æ•¸å­¸å…¬å¼ï¼Œä»–ç™¼ç¾éå¸¸é©åˆç”¨åœ¨ <code class=\"language-text\">clip-path</code> ä¸Šé ­ï¼Œæ­é… <code class=\"language-text\">poylgon</code> çš„ <code class=\"language-text\">fill-rule</code> å±¬æ€§ï¼Œå¯ä»¥åšå‡ºä»¥ä¸‹çš„æ•ˆæœï¼Œåƒæ˜¯è¨±å¤šç‰¹æ®Šçš„æµ·æ´‹ç”Ÿç‰©ä¸€èˆ¬ï¼š</p>\n<p><img src=\"/image/lissajous-curve-clip-path.png\" alt=\"lissajous-curve-clip-path\">\n(å‡ºè™•ï¼š<a href=\"https://youtu.be/mEpocRIc3q8?t=737\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://youtu.be/mEpocRIc3q8?t=737</a>)</p>\n<h2 id=\"ç™¼æ®æ›´å¤šæƒ³åƒåŠ›\" style=\"position:relative;\"><a href=\"#%E7%99%BC%E6%8F%AE%E6%9B%B4%E5%A4%9A%E6%83%B3%E5%83%8F%E5%8A%9B\" aria-label=\"ç™¼æ®æ›´å¤šæƒ³åƒåŠ› permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç™¼æ®æ›´å¤šæƒ³åƒåŠ›</h2>\n<p>å¦¥å–„ä½¿ç”¨ <strong>è¿´åœˆ</strong>ã€<strong>pattern</strong>ã€<strong>éš¨æ©Ÿæ€§</strong>é€™ä¸‰å€‹è¦ç´ ï¼Œå°±å¯ä»¥æœ‰è¨±å¤šçš„å‰µæ„çµ„åˆï¼Œé™¤äº†ä¸Šé¢çš„ç·šæ¢å’Œ <code class=\"language-text\">clip-path</code> å¤–ï¼ŒCSS ç¹ªåœ–å¸¸ç”¨åˆ°çš„ <code class=\"language-text\">border-style</code>, <code class=\"language-text\">border-image</code>, <code class=\"language-text\">gradient</code>, <code class=\"language-text\">box-shadow</code> ç­‰ç­‰éƒ½èƒ½æ‹¿ä¾†å˜—è©¦ã€‚</p>\n<p>é™„ä¸Šå¹¾å€‹è¢å·åœ¨ codepen ä¸Šçš„ä½œå“ï¼š</p>\n<ul>\n<li>border-image: <a href=\"https://codepen.io/yuanchuan/pen/aQjKwO\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://codepen.io/yuanchuan/pen/aQjKwO</a></li>\n<li>background-image + linear-gradient: <a href=\"https://codepen.io/yuanchuan/pen/NLXZLm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://codepen.io/yuanchuan/pen/NLXZLm</a></li>\n<li>radial-gradient: <a href=\"https://codepen.io/yuanchuan/pen/LXPJOW\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://codepen.io/yuanchuan/pen/LXPJOW</a></li>\n</ul>\n<p><img src=\"/image/yuanchuan-works.png\" alt=\"yuanchuan-works\"></p>\n<p>é€™åªæ˜¯å…¶ä½œå“çš„å†°å±±ä¸€è§’ï¼Œæœ‰èˆˆè¶£çš„è®€è€…å¯ä»¥åˆ°ä»–çš„ <a href=\"https://codepen.io/yuanchuan\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">codepen</a> ä¸Šæ¬£è³å„ç¨®çµ¢éº—çš„ç•«ä½œã€‚</p>\n<p>åƒæ˜¯é€™å€‹ç”¨ z-index å †ç–Šå‡ºçš„åŸå¸‚å¤©éš›ç·šåœ–ï¼Œä¸å¾—ä¸ä½©æœä»–çš„å‰µé€ åŠ›ï¼š</p>\n<iframe height=\"306\" style=\"width: 100%;\" scrolling=\"no\" title=\"z-index -- City \" src=\"https://codepen.io/yuanchuan/embed/MMYmqv?height=306&theme-id=dark&default-tab=result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/yuanchuan/pen/MMYmqv'>z-index -- City </a> by yuanchuan\n  (<a href='https://codepen.io/yuanchuan'>@yuanchuan</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>å¦å¤–ï¼Œåœ¨è¢å·çš„æ¼”è¬›ä¸­ï¼Œè®“æˆ‘ç‰¹åˆ¥å°è±¡æ·±åˆ»çš„æ˜¯ä»–åˆ©ç”¨ <code class=\"language-text\">text-shadow</code> çš„æ•ˆæœï¼Œå°‡ä¸€å€‹æ‹¬è™Ÿï¼Œé‹ç”¨åœ¨ç”Ÿæˆè—è¡“ä¸­ï¼Œä½ æ²’çœ‹éŒ¯ï¼Œå°±æ˜¯ <code class=\"language-text\">(</code> é€™å€‹æ‹¬è™Ÿã€‚</p>\n<p>æˆ‘æ‰¾ä¸åˆ°è¢å·<a href=\"https://youtu.be/mEpocRIc3q8?t=1751\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å½±ç‰‡</a>ä¸­çš„ç¯„ä¾‹ï¼Œä½†è‡ªå·±ä¾ç…§ä»–çš„ä»‹ç´¹ç”¨ç´” css/js å¯¦ä½œäº†ä¸€å€‹ç‰ˆæœ¬ï¼š</p>\n<iframe height=\"389\" style=\"width: 100%;\" scrolling=\"no\" title=\"CSS Generative Art - sample IV\" src=\"https://codepen.io/arvin0731/embed/abvMXmX?height=389&theme-id=dark&default-tab=result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/arvin0731/pen/abvMXmX'>CSS Generative Art - sample IV</a> by Arvin\n  (<a href='https://codepen.io/arvin0731'>@arvin0731</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>é™¤äº† <code class=\"language-text\">text-shadow</code>ï¼Œä¸Šé¢ç¯„ä¾‹ä¸­ä¹Ÿç”¨ä¸Šäº† <code class=\"language-text\">filter</code>, <code class=\"language-text\">rotation</code>, <code class=\"language-text\">font-size</code> ç­‰ç­‰çš„éš¨æ©Ÿå±¬æ€§è®ŠåŒ–ï¼Œä¾†ç”Ÿæˆé€™å¹…åœ–æ¡ˆã€‚</p>\n<h2 id=\"css-doodle\" style=\"position:relative;\"><a href=\"#css-doodle\" aria-label=\"css doodle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSS-Doodle</h2>\n<p>ä¸Šé¢çš„ç¯„ä¾‹éƒ½æ˜¯ç”¨ pure css/js å®Œæˆçš„ï¼Œä½†è¢å·å…¶å¯¦è£½ä½œäº†ä¸€å€‹ web componentï¼ŒæŠŠè¨±å¤šè£½ä½œ generative art éœ€è¦çš„ä¸€äº›åŠŸèƒ½å¹«ä½ åŒ…å¥½æˆå¤šå€‹å‡½å¼ï¼Œåƒæ˜¯æƒ³è¦ç”¢ç”Ÿ gridï¼Œä¸ç”¨å†åˆ° html å…§è¤‡è£½ä¸€å¤§å † divï¼Œä¹Ÿä¸ç”¨è‡ªå·±ç”¨ JS createElementï¼Œåªè¦é€é css-doodleï¼Œä¸€å¥è©±å°±èƒ½åšåˆ°ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:doodle</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token atrule\"><span class=\"token rule\">@grid</span><span class=\"token punctuation\">:</span> 1x10 / 85%<span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>css-doodle æ˜¯åŸºæ–¼ Shadow DOM v1 å’Œ Custom Elements v1 å¯¦ä½œçš„ web componentï¼ŒåŸºæœ¬ä¸Šç›®å‰ä¸»æµç€è¦½å™¨éƒ½èƒ½æ”¯æ´ã€‚</p>\n<p>åƒä¸Šé¢çš„ä¾‹å­ï¼Œé€éè¨­å®š css-doodle web component çš„ shadow-dom å±¬æ€§ï¼Œå¯ä»¥è®“ä»–å¹«ä½ ç”¢ç”Ÿ grid layout çš„ divsã€‚è€Œåœ¨ component å…§é™¤äº†èƒ½æ’°å¯«ä¸€èˆ¬çš„ CSS å¤–ï¼Œä¹Ÿèƒ½åˆ©ç”¨ä»–æä¾›çš„ utility function å¿«é€Ÿé”åˆ°ä¸€äº› randomã€pick one ç­‰ç­‰çš„æ•ˆæœã€‚</p>\n<p>æˆ‘å¾ˆå–œæ­¡ä½œè€…åœ¨å®˜ç¶²ä¸Šå¾ˆéœ¸æ°£åœ°ä¸€å¥è©±ï¼šThe limit is the limit of CSS itself.</p>\n<p>å¾ä»–çš„ä½œå“é›†ä¾†çœ‹ï¼Œæ‰€è¨€ä¸å‡ã€‚</p>\n<p>\bcss-doodle çš„å®˜ç¶²å°±æ˜¯ä¸€å€‹è©³ç´°çš„<a href=\"https://css-doodle.com/#usage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä½¿ç”¨æ‰‹å†Š</a>ï¼Œæ¯å€‹ function èˆ‡å±¬æ€§çš„æ—é‚Šéƒ½æœ‰å°æ‡‰çš„å¯¦éš›ç¯„ä¾‹å¹«åŠ©ä½ ç†è§£ã€‚æä¾›çš„å‡½å¼èªªå¤šä¸å¤šï¼Œèªªå°‘ä¹Ÿä¸å°‘ï¼Œä¸€å€‹ä¸€å€‹çœ‹å®Œä¹Ÿä¸ä¸€å®šèƒ½é¦¬ä¸Šè¨˜ä½ï¼Œé‚„æ˜¯å¾—è¦åœ¨å¯¦ä½œæ™‚é‚Šå°ç…§æŸ¥è©¢ã€‚</p>\n<p>æ‰€ä»¥èªªåšä¸­å­¸é‚„æ˜¯æœ€å¿«çš„ï¼Œä»Šå¤©æ–‡ç« æœ€å¾Œå°±ä¾†è§£æä¸€å€‹è¢å·åˆ©ç”¨ css-doodle è£½ä½œçš„ä½œå“ï¼Œä¸€æ–¹é¢èƒ½è‡¨æ‘¹å¤§ç¥çš„å‰µæ„ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿèƒ½æ¯”è¼ƒæ·±åˆ»çš„äº†è§£é€™äº›å‡½å¼çš„ç”¨æ³•ã€‚</p>\n<h2 id=\"css-doodle-ä½œå“è§£æ\" style=\"position:relative;\"><a href=\"#css-doodle-%E4%BD%9C%E5%93%81%E8%A7%A3%E6%9E%90\" aria-label=\"css doodle ä½œå“è§£æ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>css-doodle ä½œå“è§£æ</h2>\n<p>æŒ‘ä¸€å€‹æˆ‘å¾ˆå–œæ­¡çš„ä½œå“ï¼Œéå¸¸çš„æ¼‚äº®ï¼</p>\n<iframe height=\"265\" style=\"width: 100%;\" scrolling=\"no\" title=\"Chasing\" src=\"https://codepen.io/yuanchuan/embed/pBrMNQ?height=265&theme-id=dark&default-tab=result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/yuanchuan/pen/pBrMNQ'>Chasing</a> by yuanchuan\n  (<a href='https://codepen.io/yuanchuan'>@yuanchuan</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>é€™å€‹ä½œå“åˆ†æˆå…©å€‹ componentï¼Œä¸€å€‹æ˜¯èƒŒå¾Œä¸æ–·æ»‘è½çš„ç·šæ¢ï¼Œå¦ä¸€å€‹æ˜¯é¡ä¼¼ä¸æ–·æ—‹è½‰çš„ DNA èºæ—‹ã€‚</p>\n<p>æˆ‘å€‘å–®å°± DNA èºæ—‹ä¾†çœ‹ï¼Œç¨‹å¼ç¢¼éå¸¸ç°¡çŸ­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:doodle</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token atrule\"><span class=\"token rule\">@grid</span><span class=\"token punctuation\">:</span> 45x1 / 40vmin<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> relative<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">z-index</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">:container</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translate</span><span class=\"token punctuation\">(</span>50%<span class=\"token punctuation\">,</span> 33vmin<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">:after, :before</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token atrule\"><span class=\"token rule\">@place-cell</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span></span>\n  <span class=\"token atrule\"><span class=\"token rule\">@size</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">radial-gradient</span><span class=\"token punctuation\">(</span>\n    <span class=\"token atrule\"><span class=\"token rule\">@p</span><span class=\"token punctuation\">(</span>#FFFDE1<span class=\"token punctuation\">,</span> #FB3569<span class=\"token punctuation\">)</span> <span class=\"token atrule\"><span class=\"token rule\">@r</span><span class=\"token punctuation\">(</span>70%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    transparent 0\n  <span class=\"token punctuation\">)</span> \n  <span class=\"token atrule\"><span class=\"token rule\">@pn</span><span class=\"token punctuation\">(</span>30% 50%<span class=\"token punctuation\">,</span> 70% 50%<span class=\"token punctuation\">,</span> 50% 60%<span class=\"token punctuation\">)</span> / \n  <span class=\"token atrule\"><span class=\"token rule\">@r</span><span class=\"token punctuation\">(</span>.1vmin<span class=\"token punctuation\">,</span> 5vmin<span class=\"token punctuation\">)</span> <span class=\"token atrule\"><span class=\"token rule\">@lr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n  no-repeat<span class=\"token punctuation\">;</span></span></span></span></span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token atrule\"><span class=\"token rule\">@place-cell</span><span class=\"token punctuation\">:</span> centerr<span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@size</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span></span>\n\n<span class=\"token property\">will-change</span><span class=\"token punctuation\">:</span> transform<span class=\"token punctuation\">;</span>\n<span class=\"token property\">animation</span><span class=\"token punctuation\">:</span> r 4s linear infinite<span class=\"token punctuation\">;</span>\n<span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>-4s / <span class=\"token atrule\"><span class=\"token rule\">@size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> * <span class=\"token atrule\"><span class=\"token rule\">@i</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n\n<span class=\"token property\">--translate</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translateY</span><span class=\"token punctuation\">(</span><span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>-66vmin / <span class=\"token atrule\"><span class=\"token rule\">@size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> * <span class=\"token atrule\"><span class=\"token rule\">@i</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@keyframes</span> r</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">from</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate<span class=\"token punctuation\">)</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">to</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate<span class=\"token punctuation\">)</span> <span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span>-1turn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¦ä½¿ç”¨ css-doodle çš„è©±ï¼Œä¸Šé¢é€™æ®µ css æ˜¯è¦æ”¾åœ¨ <code class=\"language-text\">&lt;css-doodle></code> component å…§çš„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>css-doodle</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- Your css --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>css-doodle</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h4 id=\"doodle\" style=\"position:relative;\"><a href=\"#doodle\" aria-label=\"doodle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>:doodle</h4>\n<p><code class=\"language-text\">:doodle</code> æ˜¯é‡å° <code class=\"language-text\">&lt;css-doodle></code> é€™å€‹å…ƒç´ æœ¬èº«çš„ selectorï¼Œç¯„ä¾‹ä¸­è¨­å®šäº† <code class=\"language-text\">position</code> èˆ‡ <code class=\"language-text\">z-index</code>ï¼Œæ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯ <code class=\"language-text\">@grid</code> çš„ä½¿ç”¨ã€‚</p>\n<h4 id=\"grid\" style=\"position:relative;\"><a href=\"#grid\" aria-label=\"grid permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@grid</h4>\n<p><code class=\"language-text\">@grid</code> æ˜¯ç”¨ä¾†å®šç¾© css-doodle çš„ grid layoutï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥è¨­å®šåœ¨ <code class=\"language-text\">&lt;css-doodle grid=\"5\"></code> ä¸Šï¼Œä½†æ˜¯ <code class=\"language-text\">@grid</code> çš„å±¬æ€§è¨­å®šæœƒæœ‰æ¯”è¼ƒé«˜çš„å„ªå…ˆæ¬Šã€‚</p>\n<p><code class=\"language-text\">@grid: 45x1 / 40vmin;</code> ä»£è¡¨çš„æ˜¯ doodle size ç‚º <strong>41vmin</strong>ï¼Œä¸”å…¶ä¸­æœ‰ <strong>45 x 1</strong> çš„ gridã€‚(<code class=\"language-text\">vmin</code> ä»£è¡¨çš„æ˜¯ç•¶å‰ <code class=\"language-text\">vh</code> èˆ‡ <code class=\"language-text\">vw</code> ä¸­æœ€å°çš„å€¼)</p>\n<p>ç•¶ä½ è¨­å®šäº† <code class=\"language-text\">grid</code> å¾Œï¼Œ<code class=\"language-text\">css-doodle</code> çš„ <code class=\"language-text\">shadow-dom</code> æœƒé•·å‡ºé¡ä¼¼å¦‚ä¸‹çš„çµæ§‹ï¼š</p>\n<p><img src=\"/image/css-doodle-shadowdom.png\" alt=\"css-doodle-shadowdom\"></p>\n<p>æœƒç”¢ç”Ÿä¸€å€‹ <code class=\"language-text\">&lt;div class=\"container\"></code>ï¼Œä¸¦ä¸”åœ¨è£¡é¢ç”¢ç”Ÿå°æ‡‰ä½ æ‰€è¨­å®šçš„ <code class=\"language-text\">grid</code> æ•¸é‡çš„ <code class=\"language-text\">&lt;div cell></code>ã€‚</p>\n<p>å…¶ä¸­æœ‰å€‹é‡é»æ˜¯ï¼Œåœ¨ <code class=\"language-text\">&lt;css-doodle></code> å…ƒä»¶å…§è¨­å®šçš„ CSS æœƒå¥—ç”¨åˆ°æ¯ä¸€å€‹ <code class=\"language-text\">&lt;div cell></code>ï¼Œä»¥ <code class=\"language-text\">[cell]:nth-of-type(1)</code> é€™æ¨£çš„ css selector æŠŠç”Ÿæˆçš„ css style å€‹åˆ¥æ‡‰ç”¨åˆ° DOM ä¸Šã€‚</p>\n<h4 id=\"container\" style=\"position:relative;\"><a href=\"#container\" aria-label=\"container permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>:container</h4>\n<p><code class=\"language-text\">:container</code> ä»£è¡¨çš„æ˜¯ <code class=\"language-text\">:doodle</code> å…§ grid layout çš„ containerï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢èªªåˆ°çš„ <code class=\"language-text\">&lt;div class=\"container\"></code>ã€‚ç¯„ä¾‹ä¸­è¨­ç½® <code class=\"language-text\">transform: translate(50%, 33vmin)</code> ä¹Ÿå°±åªæ˜¯æŠŠå…¶åç§»åˆ°ç•«é¢ä¸­é–“çš„ä½ç½®ã€‚</p>\n<hr>\n<p>æ¥ä¸‹ä¾†çš„ <code class=\"language-text\">:after, :before</code> æ˜¯æ•´å€‹åœ–å½¢çš„é‡é»ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:after, :before</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token atrule\"><span class=\"token rule\">@place-cell</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span></span>\n  <span class=\"token atrule\"><span class=\"token rule\">@size</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span></span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token function\">radial-gradient</span><span class=\"token punctuation\">(</span>\n    <span class=\"token atrule\"><span class=\"token rule\">@p</span><span class=\"token punctuation\">(</span>#FFFDE1<span class=\"token punctuation\">,</span> #FB3569<span class=\"token punctuation\">)</span> <span class=\"token atrule\"><span class=\"token rule\">@r</span><span class=\"token punctuation\">(</span>70%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    transparent 0\n  <span class=\"token punctuation\">)</span> \n  <span class=\"token atrule\"><span class=\"token rule\">@pn</span><span class=\"token punctuation\">(</span>30% 50%<span class=\"token punctuation\">,</span> 70% 50%<span class=\"token punctuation\">,</span> 50% 60%<span class=\"token punctuation\">)</span> / \n  <span class=\"token atrule\"><span class=\"token rule\">@r</span><span class=\"token punctuation\">(</span>.1vmin<span class=\"token punctuation\">,</span> 5vmin<span class=\"token punctuation\">)</span> <span class=\"token atrule\"><span class=\"token rule\">@lr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n  no-repeat<span class=\"token punctuation\">;</span></span></span></span></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"place-cell\" style=\"position:relative;\"><a href=\"#place-cell\" aria-label=\"place cell permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@place-cell</h4>\n<p><code class=\"language-text\">@place-cell</code> æ˜¯ç”¨ä¾†æŒ‡å®š cell ç›¸å°æ–¼æ•´å€‹ grid layout ä¸­çš„ä½ç½®ï¼Œåœ¨æ­¤ component çš„ <code class=\"language-text\">:after, :before</code> éƒ½è¨­å®š <code class=\"language-text\">@place-cell: center</code>ï¼Œå°±ä»£è¡¨ grid ä¸­ cell çš„ <code class=\"language-text\">:after</code> èˆ‡ <code class=\"language-text\">:before</code> éƒ½ç½®æ–¼ç›¸å°æ–¼æ•´å€‹ grid çš„ä¸­å¿ƒä½ç½®ã€‚</p>\n<h4 id=\"size\" style=\"position:relative;\"><a href=\"#size\" aria-label=\"size permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@size</h4>\n<p>å¾ˆå–®ç´”å°±æ˜¯åŒæ™‚è¨­å®š <code class=\"language-text\">wdith</code> èˆ‡ <code class=\"language-text\">height</code> çš„å€¼ã€‚</p>\n<h4 id=\"background\" style=\"position:relative;\"><a href=\"#background\" aria-label=\"background permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Background</h4>\n<p>ä½œè€…åˆ©ç”¨ grid å…§æ¯å€‹ <code class=\"language-text\">&lt;div cell></code> çš„ <code class=\"language-text\">:after</code> èˆ‡ <code class=\"language-text\">:before</code>ï¼Œä½¿ç”¨ <code class=\"language-text\">background</code> èˆ‡ <code class=\"language-text\">radial-gradient</code> å±¬æ€§ä¾†è£½é€ æˆ‘å€‘çœ‹åˆ°çš„åœ“é»ã€‚</p>\n<p>ä¸»è¦ä½¿ç”¨åˆ° <code class=\"language-text\">background-image</code>ã€<code class=\"language-text\">background-position-x|y</code>ã€<code class=\"language-text\">background-size</code>ã€<code class=\"language-text\">background-repeat</code> å››å€‹å±¬æ€§ã€‚</p>\n<p>å¦‚æœå–®ç´”å–å…¶ä¸­ä¸€å€‹ cell ä¾†è§€å¯Ÿçš„è©±ï¼Œæœƒé•·é€™æ¨£ï¼š</p>\n<p><img src=\"/image/css-doodle-cell-div-single-dot.gif\" alt=\"css-doodle-cell-div-single-dot\"></p>\n<p>è‹¥å†åŠ ä¸Š <code class=\"language-text\">css-doodle</code> æä¾›çš„ä¸€äº› random (@r), pick(@p) ç­‰ utility functionï¼Œå°±å¯ä»¥é€ æˆæ¯ä¸€å€‹ cell div éƒ½å„è‡ªæ“æœ‰å…©å€‹ä¸åŒé¡è‰²ã€å¤§å°ã€ä½ç½®çš„åœ“é»ã€‚</p>\n<p>æ¥ä¸‹ä¾†é‡å° <code class=\"language-text\">background</code> å±¬æ€§æ‰€ä½¿ç”¨åˆ°çš„ utility function ä½œä»‹ç´¹ã€‚</p>\n<h4 id=\"p-pickv1-v2\" style=\"position:relative;\"><a href=\"#p-pickv1-v2\" aria-label=\"p pickv1 v2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@p, @pick(v1, v2,...)</h4>\n<p><code class=\"language-text\">@p</code> ç‚º <code class=\"language-text\">@pick</code> çš„ aliasã€‚å®ƒæœƒå¾çµ¦å®šçš„ list ä¸­éš¨æ©ŸæŒ‘é¸æ•¸å€¼å‡ºä¾†ï¼š</p>\n<p><code class=\"language-text\">@p(#FFFDE1, #FB3569)</code> å°±æœƒå¾é€™å…©å€‹é¡è‰²ä¸­éš¨æ©ŸæŒ‘é¸ä¸€å€‹ã€‚</p>\n<h4 id=\"r-randstart-end\" style=\"position:relative;\"><a href=\"#r-randstart-end\" aria-label=\"r randstart end permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@r, @rand(start [,end])</h4>\n<p><code class=\"language-text\">@r</code> ç‚º <code class=\"language-text\">@rand</code> çš„ aliasã€‚æ¥å—è‡³å°‘ä¸€å€‹åƒæ•¸ï¼Œä½œç‚ºå€é–“çš„é ­èˆ‡å°¾ï¼Œå®ƒæœƒå¾çµ¦å®šçš„å€é–“ä¸­éš¨æ©ŸæŒ‘é¸å…©å€‹æ•¸å€¼ã€‚</p>\n<p>å› æ­¤ç¯„ä¾‹ä¸­ï¼Œ<code class=\"language-text\">background-image</code> çš„ <code class=\"language-text\">radial-gradient</code> å±¬æ€§ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token function\">radial-gradient</span><span class=\"token punctuation\">(</span> @<span class=\"token function\">p</span><span class=\"token punctuation\">(</span>#FFFDE1<span class=\"token punctuation\">,</span> #FB3569<span class=\"token punctuation\">)</span> @<span class=\"token function\">r</span><span class=\"token punctuation\">(</span>70%<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> transparent 0 <span class=\"token punctuation\">)</span> </code></pre></div>\n<p>ç¬¬ä¸€å±¤çš„è¨­å®šç­‰åŒæ–¼éš¨æ©Ÿé¸å–å…©å€‹é¡è‰²ï¼ˆç´…ã€ç™½ï¼‰ï¼Œä¸¦å¾ 0 ~ 70% ä¹‹é–“é¸å–ä¸€å€‹ç™¾åˆ†æ¯”æ•¸å€¼ä½œç‚ºå¤§å°ã€‚</p>\n<h4 id=\"pn-pick-nv1-v2\" style=\"position:relative;\"><a href=\"#pn-pick-nv1-v2\" aria-label=\"pn pick nv1 v2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@pn, @pick-n(v1, v2,...)</h4>\n<p><code class=\"language-text\">@pn</code> ç‚º <code class=\"language-text\">@pick-n</code> çš„ aliasã€‚æœƒå¾çµ¦å®šçš„ list ä¸­ï¼Œä¸€å€‹ä¸€å€‹å–å‡ºï¼Œå°æ‡‰åˆ° <code class=\"language-text\">grid</code> ä¸­çš„ <code class=\"language-text\">cell</code>ã€‚</p>\n<p>ä»¥ç¯„ä¾‹ä¾†èªªï¼Œå°±æœƒä¾åºè¨­ç½® <code class=\"language-text\">cell</code> çš„ <code class=\"language-text\">background-position</code> å€¼ç‚º 30% 50%ï¼Œ70% 50% å’Œ 50% 60%ã€‚ï¼ˆä¾ç…§æˆ‘è§€å¯Ÿï¼Œä¼¼ä¹ä¸æœƒä¿è­‰ä¾ç…§åˆ—è¡¨çš„é †åºï¼Œä½†é‚„æ˜¯æœƒä¸€å€‹ä¸€å€‹å°æ‡‰è¨­ç½®åˆ° <code class=\"language-text\">cell</code> ä¸Šï¼‰</p>\n<h4 id=\"lr-last-rand\" style=\"position:relative;\"><a href=\"#lr-last-rand\" aria-label=\"lr last rand permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@lr, @last-rand</h4>\n<p>è‡³æ–¼ <code class=\"language-text\">background-size</code>ï¼Œç¯„ä¾‹ä½¿ç”¨ <code class=\"language-text\">@r(.1vmin, 5vmin) @lr()</code>ï¼Œå…¶ä¸­ <code class=\"language-text\">@r(.1vmin, 5vmin)</code> å°±æ˜¯å¾ .1vim åˆ° 5vmin ä¸­å–ä¸€å€‹å€¼ï¼Œè€Œ <code class=\"language-text\">@lr</code> å‰‡ä»£è¡¨å–å¾—æœ€å¾Œä¸€å€‹ random å‡½å¼æ‰€å–å¾—çš„æ•¸å€¼ï¼Œä¹Ÿå°±æ˜¯ <code class=\"language-text\">@r(.1vmin, 5vmin)</code> çš„çµæœã€‚æœ€çµ‚çš„ <code class=\"language-text\">background-size</code> å°±æœƒæ˜¯å…©å€‹ç›¸åŒçš„éš¨æ©Ÿå€¼ã€‚</p>\n<p>åˆ°ç›®å‰ç‚ºæ­¢ï¼Œè¨­å®šå‡ºä¾†çš„åœ–å½¢æœƒé•·é€™æ¨£ï¼š</p>\n<p><img src=\"/image/css-doodle-no-animation.png\" alt=\"css-doodle-no-animation\"></p>\n<p>æ‰€æœ‰çš„é»æœƒé›†ä¸­åœ¨ä¸€èµ·ï¼Œå› ç‚ºæˆ‘å€‘çš„ grid æ˜¯ <code class=\"language-text\">45x1</code>ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸€å€‹ columnã€‚</p>\n<p>ç¯„ä¾‹ä¸­ï¼Œä½œè€…ç”¨ <code class=\"language-text\">translateY</code> çš„æ–¹å¼ä¾†å°‡æ¯å€‹é»éš¨æ©Ÿå‘ Y è»¸ç§»å‹•ï¼Œä¸¦åŠ ä¸Š <code class=\"language-text\">@keyframe</code> èˆ‡ <code class=\"language-text\">rotate</code> çš„æ•ˆæœï¼Œå°±å®Œæˆäº†èºæ—‹çš„ç”Ÿæˆåœ–æ¡ˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token property\">animation</span><span class=\"token punctuation\">:</span> r 4s linear infinite<span class=\"token punctuation\">;</span>\n<span class=\"token property\">animation-delay</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>-4s / <span class=\"token atrule\"><span class=\"token rule\">@size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> * <span class=\"token atrule\"><span class=\"token rule\">@i</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n\n<span class=\"token property\">--translate</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translateY</span><span class=\"token punctuation\">(</span><span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>-66vmin / <span class=\"token atrule\"><span class=\"token rule\">@size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> * <span class=\"token atrule\"><span class=\"token rule\">@i</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@keyframes</span> r</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">from</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate<span class=\"token punctuation\">)</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">to</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--translate<span class=\"token punctuation\">)</span> <span class=\"token function\">rotateZ</span><span class=\"token punctuation\">(</span>-1turn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"i-index\" style=\"position:relative;\"><a href=\"#i-index\" aria-label=\"i index permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@i, @index</h4>\n<p>å”¯ä¸€ç”¨åˆ°çš„ utility function æ˜¯ <code class=\"language-text\">@i</code>ï¼Œä»£è¡¨ç•¶å‰å¥—ç”¨åˆ°è©² css çš„ <code class=\"language-text\">cell</code> çš„ indexã€‚</p>\n<p>èºæ—‹çš„éƒ¨åˆ†åˆ°æ­¤ç‚ºæ­¢ï¼Œè€Œå¦ä¸€å€‹æ»‘è½æ•ˆæœçš„ doodle é‹ç”¨çš„æŠ€å·§ä¹Ÿå·®ä¸å¤šï¼Œä½†æ˜¯æ•ˆæœå»å®Œå…¨ä¸åŒï¼Œæœ‰èˆˆè¶£çš„è®€è€…å¯ä»¥ç ”ç©¶ codepen ä¸Šçš„åŸå§‹ç¢¼ã€‚</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>ç”Ÿæˆè—è¡“é™¤äº†è¦æœ‰å‰µæ„å¤–ï¼Œæ“æœ‰å¥½çš„å¯¦ä½œå·¥å…·ä¹Ÿå¾ˆé‡è¦ï¼Œ\b<code class=\"language-text\">css-doodle</code> ç®—æ˜¯çµ¦äº†æƒ³å˜—è©¦ç”Ÿæˆè—è¡“çš„äººä¸€å€‹å¥½çš„é–‹é ­ï¼Œåƒæ˜¯æ–‡ç« ä¸€é–‹å§‹æ‰€è£½ä½œçš„ç°¡å–®ç”Ÿæˆè—è¡“ï¼Œä¹Ÿéƒ½èƒ½å¤ é€é <code class=\"language-text\">css-doodle</code> ä¾†å¯¦ä½œï¼Œç¨‹å¼ç¢¼æœƒç°¡çŸ­å¾ˆå¤šã€‚</p>\n<p>è€Œé€é processing ç­‰å·¥å…·èƒ½åšå‡ºæ›´å¤šæ•ˆæœï¼Œç”šè‡³èƒ½æ­é…éŸ³æ¨‚ä¾†åšå‡ºä¸åŒè®ŠåŒ–ï¼Œä»Šå¤©åªæ˜¯é€é <code class=\"language-text\">css-doodle</code> çš„å•Ÿç™¼ï¼Œç·´ç¿’äº†ä¸€äº›ç°¡å–®çš„ç”Ÿæˆè—è¡“ï¼Œé«”é©—äº†ä¸€ä¸‹ï¼Œéå¸¸æœ‰è¶£ï¼Œæ¨è–¦å¤§å®¶ä¸€èµ·ä¾†è©¦è©¦ï¼</p>\n<p>è¢å·çš„å½±ç‰‡å¾ŒåŠæ®µé‚„æœ‰å¾ˆå¤šä½¿ç”¨çµ¢éº—æŠ€å·§çš„ç”Ÿæˆè—è¡“ï¼Œéå¸¸æ¨è–¦å¤§å®¶èŠ±å€‹å››ååˆ†é˜æŠŠå½±ç‰‡çœ‹å®Œï¼Œç›¸ä¿¡æœƒæœ‰ä¸å°‘æ”¶ç©«ï¼Œå°±ç®—ä¸æƒ³è‡ªå·±å˜—è©¦ï¼Œæ¬£è³ä»–æ‰€å‰µä½œçš„ä½œå“ä¹Ÿæ˜¯ä¸€ç¨®äº«å—ã€‚</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://www.youtube.com/watch?v=mEpocRIc3q8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CSSç”Ÿæˆè—è¡“@è¢å·_CSSConf CN 2019</a></li>\n<li><a href=\"https://css-doodle.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">css-doodle</a></li>\n<li><a href=\"https://processing.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">processing</a></li>\n<li><a href=\"http://paperjs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">paper.js</a></li>\n<li><a href=\"https://zimjs.com/art.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">zimjs</a></li>\n</ol>","id":"18096a95-291e-51a8-ab74-8bb45209d2c1","fields":{"slug":"css-generative-art-css-doodle"},"frontmatter":{"date":"2020-05-23T13:37:30.000Z","title":"CSS ç”Ÿæˆè—è¡“åˆæ¢èˆ‡ css-doodle ç°¡ä»‹","tags":["web","css","css-doodle","generative art"],"type":"tech","slug":"css-generative-art-css-doodle"},"timeToRead":13},{"excerpt":"å¥½æ­Œåˆ†äº«ï¼šRescue","html":"<blockquote>\n<p>å¥½æ­Œåˆ†äº«ï¼š<a href=\"https://youtu.be/0WtcPL8Zac4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Rescue</a></p>\n</blockquote>\n<iframe width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/0WtcPL8Zac4\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<!-- more -->\n<h1 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h1>\n<p>å‡ºç¤¾æœƒå¾Œï¼Œå¹³å¸¸ä¸€å¤© 24 å°æ™‚ï¼Œå¯èƒ½æœ‰ 14 å°æ™‚éƒ½æœƒå¾…åœ¨é›»è…¦å‰çš„æˆ‘ï¼Œå°æ–¼æ‰‹æ©ŸåŠŸèƒ½çš„éœ€æ±‚çœŸçš„ä¸å¤šï¼Œä¹Ÿå°±ä¸åƒå­¸ç”Ÿæ™‚ä»£æœƒå¾ˆé—œæ³¨ iOS ä¸Šæœ‰ä»€éº¼æ–°çš„åŠŸèƒ½ã€‚è€Œå°±åœ¨ä¸Šå€‹æœˆçš„æŸå¤©ï¼Œæˆ‘ã„§å¦‚å¾€å¸¸åœ°åœ¨ GitHub ä¸Šé–’æ™ƒæ™‚ï¼Œç™¼ç¾ä¸€æ¬¾å«åš <a href=\"https://shortcuts.fun/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">shortcuts-js</code></a> çš„å¥—ä»¶ï¼ŒåŸä»¥ç‚ºæ˜¯å¦ä¸€å¥—è™•ç†ç¶²é å¿«æ·éµçš„æ¡†æ¶ï¼Œä½†çœ‹äº†å…¶æ•˜è¿°å¯«çš„æ˜¯ã€A JavaScript iOS 12 Shortcuts creatorã€ï¼Œæˆ‘æ‰å»æŸ¥äº†ä¸€ä¸‹ shortcuts æ˜¯ä»€éº¼...</p>\n<p>åŸä¾† iOS 12 æ¨å‡ºäº†ä¸€å€‹å« shortcuts çš„åŠŸèƒ½ï¼Œèƒ½è®“ä½ é€éä¸€é€£ä¸² <strong>Action</strong> çš„çµ„åˆï¼Œè‡ªå‹•åŒ–ä½ çš„ workflowã€‚è€Œè©²å¥—ä»¶çš„ä½œè€…å¾ˆ hardcode çš„<a href=\"https://medium.com/shortcutsjs/creating-ios-12-shortcuts-with-javascript-and-shortcuts-js-942420ca9904\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é€†å‘å·¥ç¨‹è§£æ</a> shortcuts ä¸Šçš„ç¨‹å¼ï¼Œæ’°å¯«å‡ºä¸€å¥— JavaScript çš„å·¥å…·ï¼Œè®“ä½ èƒ½ç”¨ç†Ÿæ‚‰çš„ JavaScript ä¾†æ’°å¯« iOS shortcutsã€‚</p>\n<p>è¦ºå¾—è »æœ‰æ„æ€çš„ï¼Œæ‰€ä»¥ä¹ŸèŠ±äº†å¹¾å€‹å°æ™‚çš„æ™‚é–“ç©äº†ä¸€ä¸‹ï¼Œé€éé€™ç¯‡æ–‡ç« è¨˜éŒ„ä¸€ä¸‹éç¨‹èˆ‡å¿ƒå¾—ã€‚</p>\n<p>ç…§æ…£ä¾‹å…ˆçµ¦å¤§å®¶çœ‹å€‹ç°¡å–®çš„æˆå“ï¼Œæˆ‘å…¶å¯¦åšäº†å…©å€‹ shortcutsï¼Œä¸€å€‹æ˜¯åˆ©ç”¨ Google çš„ <a href=\"https://developers.google.com/fact-check/tools/api/reference/rest/v1alpha1/claims/search?apix_params=%7B%22query%22%3A%22Trump%20got%20infected%22%7D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">fact check api</a> è£½ä½œçš„äº‹å¯¦æŸ¥æ ¸æ·å¾‘ï¼Œè®“ä½ åœ¨ç¶²é ä¸Šå¿«é€ŸæŸ¥é©—è³‡è¨Šï¼Œä½† API å›å‚³çš„è³‡æ–™æ•ˆæœä¸æ˜¯å¾ˆå¥½ï¼Œæ‰€ä»¥åšäº†å¦ä¸€å€‹ <code class=\"language-text\">vConsole shortcuts</code>ï¼Œè®“ä½ èƒ½å¤ åœ¨ä¸€èˆ¬ç¶²é ï¼ˆæ²’æœ‰ç‰¹åˆ¥åœ¨ header çš„ CSP è¨­å®š <code class=\"language-text\">script-src</code> çš„ç¶²é ï¼‰å…§æ’å…¥ <code class=\"language-text\">vConsole</code> å¥—ä»¶çš„ shortcutsï¼Œè®“ä½ èƒ½åœ¨æ‰‹æ©Ÿä¸Šç›´æ¥æ‰“é–‹ consoleï¼</p>\n<p>æƒ³å¯¦éš›ç©ç©çš„å¯ä»¥å¾ iphone ä¸Šä¸‹è¼‰æ­¤ <a href=\"https://www.icloud.com/shortcuts/efffb762336744a5857d5defe6ff0ba7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">iCloud link</a></p>\n<p>ä¸‹è¼‰å‰è¨˜å¾—è¦åˆ° \"è¨­å®š\" -> \"æ·å¾‘\" -> \"å…è¨±ä¸å—ä¿¡ä»»çš„æ·å¾‘\" å°‡è©²é¸é …é–‹å•Ÿã€‚</p>\n<p>ä¸‹è¼‰å®Œå¾Œåˆ°è©² shortcut çš„è©³ç´°è³‡è¨Šé å…§å°‡ <strong>åœ¨å…±äº«å·¥ä½œè¡¨ä¸­é¡¯ç¤º</strong> é¸é …æ‰“é–‹ï¼Œé€™æ¨£æ‰èƒ½åœ¨ safari çš„ç¶²é åˆ†äº« panel æ‰¾åˆ° shortcut ä¾†åŸ·è¡Œã€‚</p>\n<p><img src=\"/image/ios-shortcuts-js-demo.gif\" alt=\"project-demo\" title=\"project-demo\"></p>\n<h2 id=\"ios-shortcuts\" style=\"position:relative;\"><a href=\"#ios-shortcuts\" aria-label=\"ios shortcuts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>iOS Shortcuts</h2>\n<p>åœ¨ Shortcuts å‡ºç¾ä¹‹å‰ï¼Œæœ‰å€‹å«åš Workflow çš„æ‡‰ç”¨ç¨‹å¼å¯ä»¥è®“ä½ é€éå®¢è£½åŒ–çš„è…³æœ¬ï¼Œè‡ªè¨‚è‡ªå‹•åŒ–æµç¨‹ï¼Œè€Œåœ¨ Apple å°‡å…¶è²·ä¸‹å¾Œï¼Œéš¨è‘— iOS 12 ä¸€èµ·æ¨å‡ºï¼Œä¸¦ä¸”é–‹æ”¾å…è²»ä¸‹è¼‰ã€‚</p>\n<p>Shortcuts çš„æ“ä½œæœ‰é»åƒæ˜¯ Scratchï¼Œå¯ä»¥å°‡ä¸€å€‹ä¸€å€‹çš„ action block ä»»æ„çµ„åˆï¼Œä¹Ÿèƒ½å¤ ä¸²æ¥åˆ¥äººåšå¥½çš„ shortcutsï¼Œå°æ–¼ä¸æœƒæ’°å¯«ç¨‹å¼çš„äººä¾†èªªï¼Œæ“ä½œä¸Šç®—è¦ªæ°‘ï¼Œæ‡‰è©²ä¹Ÿæœƒè¦ºå¾—è »æœ‰è¶£çš„ï¼Œçµ¦å¤§å®¶çœ‹ä¸€ä¸‹æ“ä½œéç¨‹ï¼ˆgif å¯èƒ½æœ‰é»å¤§ï¼‰ï¼š</p>\n<p><img src=\"/image/shortcuts-ops-demo.gif\" alt=\"shortcuts-ops-demo\" title=\"shortcuts-ops-demo\"></p>\n<p>å¯ä»¥åŠ å…¥å„ç¨®å…§å»ºæŒ‡ä»¤ï¼Œæ‹–æ‹‰çµ„åˆä½ æƒ³è¦çš„é †åºã€‚</p>\n<p>action çš„ output å¯ä»¥ç•¶ä½œä¸‹ä¸€å€‹ action çš„ inputï¼Œä¹Ÿå¯ä»¥èˆ‡ App äº’å‹•ï¼Œä¾‹å¦‚å¯ä»¥ä¸²æ¥ Evernoteï¼š</p>\n<p><img src=\"/image/interaact-with-app.jpeg\" alt=\"interact-with-app\" title=\"interact-with-app\"></p>\n<p>é™¤äº†ä¸Šé¢ç¯„ä¾‹é€™ç¨®ç°¡å–®çš„æŒ‡ä»¤å †ç–Šï¼Œä¹Ÿæ”¯æ´ <code class=\"language-text\">if-else</code> çµæ§‹ï¼š</p>\n<p><img src=\"/image/if-else.jpeg\" alt=\"if-else\" title=\"if-else\"></p>\n<p>ä½†æ˜¯å‘¢ï¼Œæˆ‘å¾ˆé›£ç›¸ä¿¡æœƒæœ‰å·¥ç¨‹å¸«å¿å—å¾—äº†åœ¨æ‰‹æ©Ÿä¸Šé¢ä¸€å€‹ä¸€å€‹ action æ‹–æ‹‰çµ„åˆï¼Œç„¶å¾Œè¼¸å…¥å…§å®¹ï¼Œå¯¦åœ¨å¤ªéº»ç…©å•¦ã€‚</p>\n<p>é‚„æ˜¯ç›´æ¥å¯«ç¨‹å¼æ¯”è¼ƒèˆ’æœï¼Œè€Œå°æ–¼ç¿’æ…£ JavaScript çš„æˆ‘ä¾†èªªï¼Œ<a href=\"https://shortcuts.fun/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">shortcuts-js</code></a> å°±æ˜¯ä¸€å€‹å¾ˆæ£’çš„é¸æ“‡ï¼</p>\n<h2 id=\"shortcuts-js\" style=\"position:relative;\"><a href=\"#shortcuts-js\" aria-label=\"shortcuts js permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Shortcuts JS</h2>\n<p><img src=\"/image/shortcuts-js-official.png\" alt=\"shortcuts-js-official\"></p>\n<p>Shortcuts JS åŸºæœ¬ä¸Šå°±æ˜¯å°‡ Apple å…§å»ºçš„ Action éƒ½è£½ä½œå‡ºå°æ‡‰çš„ JS ç‰ˆæœ¬ï¼Œä½ å¯ä»¥ç·¨æ’èˆ‡å‘¼å«é‚£äº› JS functionï¼Œshortcuts-js æœƒå¹«ä½ è½‰è­¯æˆ iOS èƒ½é‹è¡Œçš„ <code class=\"language-text\">shortcut</code> æª”æ¡ˆã€‚</p>\n<p>åœ¨ Shortcuts JS çš„ç¶²ç«™ä¸Šå°±æœ‰ä¸€å€‹ playground è®“ä½ å¯¦éš›ç©ç©çœ‹ï¼Œä¸¦ä¸”èƒ½é¦¬ä¸Šä¸‹è¼‰æˆ <code class=\"language-text\">shortcut</code> æª”ï¼Œåªæ˜¯å¾ iOS 13 é–‹å§‹ï¼Œä¸èƒ½å¤ ç›´æ¥å°‡ <code class=\"language-text\">.shortcut</code> æª”æ¡ˆ AirDrop åˆ°æ‰‹æ©Ÿå…§ï¼Œéœ€è¦é€é icloud link æ‰è¡Œã€‚</p>\n<p>å¦å¤–ï¼Œå¾ä»–å€‘ç¶²ç«™ä¸Šèˆ‡ github issue ä¸Šä¹Ÿèƒ½çŸ¥é“ç›®å‰ä¸¦ä¸æ˜¯æ‰€æœ‰ Apple å…§å»ºçš„ actions éƒ½æ”¯æ´ï¼Œæ‰€ä»¥å¯¦éš›ä¸Šè¨±å¤š idea è¦å¯¦ä½œé‚„æ˜¯ä¸å®¹æ˜“ã€‚</p>\n<h3 id=\"å®˜æ–¹ä¸Šç°¡å–®çš„ç¯„ä¾‹\" style=\"position:relative;\"><a href=\"#%E5%AE%98%E6%96%B9%E4%B8%8A%E7%B0%A1%E5%96%AE%E7%9A%84%E7%AF%84%E4%BE%8B\" aria-label=\"å®˜æ–¹ä¸Šç°¡å–®çš„ç¯„ä¾‹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å®˜æ–¹ä¸Šç°¡å–®çš„ç¯„ä¾‹</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//////// Import necessary actions and function ////////</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> actionOutput<span class=\"token punctuation\">,</span> buildShortcut <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@joshfarrant/shortcuts-js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  comment<span class=\"token punctuation\">,</span>\n  wait<span class=\"token punctuation\">,</span>\n  runJavaScriptOnWebPage<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@joshfarrant/shortcuts-js/actions\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">///////////////////////////////////////////////////////</span>\n\n<span class=\"token comment\">//////// Create and arrange actions ////////</span>\n<span class=\"token comment\">// We'll use this later to reference the output of a calculation</span>\n<span class=\"token keyword\">let</span> calcVar <span class=\"token operator\">=</span> <span class=\"token function\">actionOutput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Define a list of actions</span>\n<span class=\"token keyword\">const</span> actions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">comment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    text<span class=\"token operator\">:</span> <span class=\"token string\">'Hello, world!'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">number</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    number<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">calculate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    operand<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    operation<span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> calcVar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">showResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Use the Magic Variable</span>\n    text<span class=\"token operator\">:</span> withVariables<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Total is </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>calcVar<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/////////////////////////////////////////////</span>\n\n<span class=\"token comment\">//////// Generate the Shortcut data ////////</span>\n<span class=\"token keyword\">const</span> shortcut <span class=\"token operator\">=</span> <span class=\"token function\">buildShortcut</span><span class=\"token punctuation\">(</span>actions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Write the Shortcut to a file in the current directory</span>\nfs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">'example.shortcut'</span><span class=\"token punctuation\">,</span> shortcut<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Something went wrong :('</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Shortcut created!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//////////////////////////////////////////////</span></code></pre></div>\n<p>ç”¨ shortcuts js è£½ä½œä¸€å€‹åŸºæœ¬çš„ shortcuts éå¸¸ç°¡å–®ï¼Œåªéœ€è¦ä¸‰å€‹æ­¥é©Ÿï¼š</p>\n<ol>\n<li>è¼‰å…¥ä½ æƒ³è¦ä½¿ç”¨çš„ actionsã€‚</li>\n<li>å‰µå»ºä¸€å€‹ <code class=\"language-text\">actions</code> é™£åˆ—ï¼Œå°‡ä½ æƒ³è¦åŸ·è¡Œçš„ actions ç…§é †åºæ”¾é€²å»ï¼ŒåŸºæœ¬ä¸Šæ¯å€‹ action éƒ½æœƒæœ‰ outputï¼Œè€Œæ¯ä¸€å€‹ output éƒ½æœƒè‡ªå‹•å‚³çµ¦é™£åˆ—ä¸­çš„ä¸‹ä¸€å€‹ actionã€‚å¯ä»¥å¾<a href=\"https://docs.shortcuts.fun/actions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜æ–¹æ–‡ä»¶</a>æŸ¥é–±ç›®å‰ support çš„ actions å…¶è¼¸å…¥è¼¸å‡ºç‚ºä½•ã€‚ä¸éä»–å€‘æ–‡ä»¶æ²’æœ‰å¾ˆé½Šå…¨å°±æ˜¯äº†...</li>\n</ol>\n<p><img src=\"/image/shortcut-js-docs.png\" alt=\"shortcut-js-docs\" title=\"shortcut-js-docs\"></p>\n<ol start=\"3\">\n<li>æœ€å¾Œä¸€å€‹æ­¥é©Ÿå°±æ˜¯é€é shortcuts js çš„ <code class=\"language-text\">buildShortcut()</code> å‡½å¼ä¾†å°‡ä½ ç·¨æ’çš„ actions è½‰åŒ–æˆåˆæ³•çš„ iOS shortcuts formatï¼Œä¸¦å¯«å…¥æª”æ¡ˆã€‚</li>\n</ol>\n<p>æ¥è‘—ä½ å°±èƒ½å°‡é€™å€‹æª”æ¡ˆæ”¾å…¥ icloud ä¸Šï¼Œä¸¦ç”¢ç”Ÿ icloud shortcuts link ä¾†è¼‰å…¥åˆ°ä½ çš„æ‰‹æ©Ÿè£¡ä½¿ç”¨äº†ã€‚</p>\n<p>ç”¢ç”Ÿ icloud shortcuts link çš„æ–¹å¼å…¶å¯¦æˆ‘ä¸æ˜¯å¾ˆç¢ºå®šæœ‰æ²’æœ‰ä»€éº¼æ­£ç¢ºçš„æ–¹å¼ï¼Œä½†æˆ‘åœ¨æœ€å¾Œæœƒåˆ†äº«æˆ‘æ‰€ä½¿ç”¨çš„æ–¹æ³•ã€‚</p>\n<p>é€™é‚Šæˆ‘å€‘å…ˆä¾†è§£é‡‹ä¸€ä¸‹å®˜æ–¹ç¯„ä¾‹çš„ actions åšäº†ä»€éº¼äº‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> actions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">comment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    text<span class=\"token operator\">:</span> <span class=\"token string\">'Hello, world!'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">number</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    number<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">calculate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    operand<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    operation<span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> calcVar<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">showResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Use the Magic Variable</span>\n    text<span class=\"token operator\">:</span> withVariables<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Total is </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>calcVar<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>shortcuts js æ˜¯ç”¨ TypeScript æ’°å¯«çš„ï¼Œæ‰€ä»¥ä½ è¼‰å…¥çš„æ¯å€‹ action ä½ éƒ½èƒ½æ¸…æ¥šåœ°çœ‹åˆ°å…¶æ‰€éœ€è¦çš„åƒæ•¸èˆ‡é¡å‹ã€‚</p>\n<p><code class=\"language-text\">comment</code> action å¦‚å…¶åï¼Œå°±æ˜¯åœ¨ shortcuts ä¸­ä¸‹å€‹è¨»è§£ï¼Œå¯¦éš›ä¸Šæ²’æœ‰ä½œç”¨ï¼Œä½ ä¹Ÿåªèƒ½åœ¨ shortcuts çš„ action flow ä¸­çœ‹å¾—åˆ°å®ƒï¼š</p>\n<p><img src=\"/image/comment-sample.png\" alt=\"comment-sample\" title=\"comment-sample\"></p>\n<p><code class=\"language-text\">number</code> å‰‡æ˜¯è®“ä½ èƒ½è¨­å®šä¸€å€‹æ•¸å­—ï¼Œä»–æœƒå°‡ä½ è¨­å®šçš„æ•¸å­—ç•¶ä½œ output å‚³çµ¦ä¸‹ä¸€å€‹ actionï¼Œåœ¨ç¯„ä¾‹ä¸­å³æ˜¯ <code class=\"language-text\">calculate</code> actionã€‚</p>\n<p><code class=\"language-text\">calculate</code> é™¤äº†æ¥æ”¶ä¸Šä¸€å€‹ action å‚³å…¥çš„ input å¤–ï¼Œä½ éœ€è¦æŒ‡å®šèˆ‡ input æ“ä½œçš„ <code class=\"language-text\">operand</code> èˆ‡ <code class=\"language-text\">operation</code>ï¼›æœ€å¾Œçš„ä¸€å€‹åƒæ•¸æ˜¯ä¸€å€‹å«åš Magic Variable çš„è®Šæ•¸ï¼Œä»–å¯ä»¥ç”¨ä¾†å„²å­˜ action æ‰€ç”¢ç”Ÿçš„çµæœï¼Œä¸¦åœ¨å…¶ä»– action ä¸­ reference ä½¿ç”¨ï¼Œä¾‹å¦‚ç¯„ä¾‹ä¸­çš„ <code class=\"language-text\">showResult</code>ã€‚</p>\n<p><code class=\"language-text\">showResult</code> å°±æ˜¯å°‡ä½ å‚³å…¥çš„ <code class=\"language-text\">text</code> åƒæ•¸å€¼è¼¸å‡ºåˆ°æ‰‹æ©Ÿç•«é¢ä¸­ã€‚åœ¨é€™é‚Šæˆ‘å€‘æƒ³è¦å–å¾— <code class=\"language-text\">caculate</code> æ‰€ output çš„è®Šæ•¸å€¼ï¼Œç„¶è€Œ <code class=\"language-text\">showResult</code> éœ€è¦çš„æ˜¯å­—ä¸²ï¼Œæˆ‘å€‘ä¸èƒ½å–®ç´”çš„å‚³å…¥è®Šæ•¸ï¼Œå¿…é ˆè¦ä½¿ç”¨ä¸€å€‹ç‰¹æ®Šçš„å‡½æ•¸ <code class=\"language-text\">withVariables</code>ï¼Œå°‡è®Šæ•¸å€¼è®€å‡ºä¸¦è½‰æˆ string æ ¼å¼ã€‚</p>\n<p>é€™å€‹ shortcuts åŸ·è¡Œå¾Œå°±æ˜¯æœƒåœ¨ä½ çš„æ‰‹æ©Ÿä¸Šè·³å‡ºä¸€å€‹ dialog ä¸¦é¡¯ç¤º 14 é€™å€‹æ•¸å­—ã€‚</p>\n<h3 id=\"äº†è§£å®˜æ–¹ç¯„ä¾‹å¾Œè‡ªå·±ä¾†å‹•æ‰‹åšçœ‹çœ‹\" style=\"position:relative;\"><a href=\"#%E4%BA%86%E8%A7%A3%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E5%BE%8C%E8%87%AA%E5%B7%B1%E4%BE%86%E5%8B%95%E6%89%8B%E5%81%9A%E7%9C%8B%E7%9C%8B\" aria-label=\"äº†è§£å®˜æ–¹ç¯„ä¾‹å¾Œè‡ªå·±ä¾†å‹•æ‰‹åšçœ‹çœ‹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>äº†è§£å®˜æ–¹ç¯„ä¾‹å¾Œï¼Œè‡ªå·±ä¾†å‹•æ‰‹åšçœ‹çœ‹</h3>\n<p>å¦‚åŒå‰è¨€æåˆ°çš„ï¼Œæˆ‘ä¸€é–‹å§‹æƒ³åšçš„æ˜¯äº‹å¯¦æŸ¥æ ¸çš„ shortcutsï¼Œä¹Ÿå°±æ˜¯èªªè®“ä½¿ç”¨è€…é»é¸ shortcuts å¾Œï¼Œå¯ä»¥è¼¸å…¥æƒ³æŸ¥è©¢çš„äº‹æƒ…ï¼ŒèƒŒå¾Œå‘¼å« Google çš„ <a href=\"https://developers.google.com/fact-check/tools/api/reference/rest/v1alpha1/claims/search?apix_params=%7B%22query%22%3A%22Trump%20got%20infected%22%7D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">fact check api</a>ï¼Œä½†æ˜¯ shortcuts é›–ç„¶æœ‰æä¾› <code class=\"language-text\">Get URL content</code> çš„ acitonï¼Œå»æ²’æœ‰æ–¹ä¾¿çš„è³‡æ–™è™•ç† actionï¼Œå¿…é ˆä½¿ç”¨ <code class=\"language-text\">dictionary</code> ä¹‹é¡çš„ action ä¾†å°‡å›å‚³çš„ JSON format è³‡æ–™è½‰å­˜æˆè¾­å…¸æ ¼å¼ï¼Œæ“ä½œä¸Šå¾ˆç¹ç‘£ï¼Œå¯ä»¥åƒè€ƒ reddit ä¸Šé«˜æ‰‹çš„èªªæ˜ï¼š<a href=\"https://www.reddit.com/r/shortcuts/comments/afbrlh/using_apis_part1_retrieving_data/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">retrieving data</a>ã€<a href=\"https://www.reddit.com/r/shortcuts/comments/afpwo2/using_apis_part_2_parsing_complex_api_responses/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">parsing complex api responses</a>ã€<a href=\"https://www.reddit.com/r/shortcuts/comments/ae80co/quick_and_dirty_guide_to_scraping_data_from/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">scrapign web data</a>ã€‚</p>\n<p>åœ¨èŠ±äº†ä¸å°‘æ™‚é–“å˜—è©¦ç”¨ shortcuts js æŒ‰ç…§ reddits ä¸Šçš„åšæ³•å¯¦ä½œå¾Œï¼Œé‚„æ˜¯ä¸æˆåŠŸï¼Œæ­£ç•¶æƒ³æ”¾æ£„æ™‚ï¼Œæˆ‘çœ‹åˆ°äº†ä¸€å€‹ action å«åš <code class=\"language-text\">runJavaScriptOnWebPage()</code>ï¼Œå¯ä»¥è®“ä½ åœ¨ç¶²é ä¸Šæ’å…¥ JavaScript é‹è¡Œã€‚</p>\n<p>çœ‹åˆ°é€™å€‹å¿ƒèŠ±æ€’æ”¾ä¸€ä¸‹ï¼Œè¦ºå¾—æ’¿åˆ°å¯¶ï¼Œå¯ä»¥åœ¨ç¶²é ä¸Šé‹è¡Œçš„è©±æ›´å¥½ï¼Œåœ¨æƒ³é€²è¡Œäº‹å¯¦æŸ¥æ ¸çš„ç¶²é ä¸Šå•Ÿç”¨é€™å€‹ shortcutsï¼Œç„¶å¾Œä¸€åˆ‡æµç¨‹éƒ½ç›´æ¥ç”¨ JavaScript åœ¨ web page ä¸ŠåŸ·è¡Œå°±å¥½ï¼Œå°±ä¸éœ€è¦é€é shortcuts action ä¾†è™•ç†è³‡æ–™äº†ï¼</p>\n<p>åˆ©ç”¨ <code class=\"language-text\">runJavaScriptOnWebPage()</code> æ‰€å…œå‡ºä¾†çš„ shortcuts ä¸»è¦ç¨‹å¼å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> actions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token function\">runJavaScriptOnWebPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    text<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n      const element = document.querySelector('title');\n      const title = element.textContent;\n      const url = 'https://content-factchecktools.googleapis.com/v1alpha1/claims:search?key=GoogleAPIKey&amp;query=' + title;\n      const result;\n      fetch(url)\n        .then(function(result) {\n          return result.json();\n        })\n        .then(function(data) {\n          result = data;\n          completion(result);\n        });\n      </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> output<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">quickLook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¸æ˜¯å¾ˆç¢ºå®šå…¶ JavaScript åŸ·è¡Œçš„ç’°å¢ƒç‚ºä½•ï¼Œæˆ‘ä¸¦æ²’æœ‰å»ç ”ç©¶ï¼Œä½†æ¸¬è©¦å¾Œæ˜¯ç„¡æ³•ä½¿ç”¨ await çš„ï¼Œä½¿ç”¨å–®ç´”çš„ promise å‰‡å¯ä»¥ã€‚</p>\n<p>é‹è¡Œçµæœå¦‚ä¸‹ï¼š</p>\n<p><img src=\"/image/fact-check-demo.gif\" alt=\"fact-check-demo\" title=\"fact-check-demo\"></p>\n<p>çœ‹èµ·ä¾†åªè¦æŠŠ response åœ¨ç¾åŒ–ä¸€ä¸‹å°±å¥½ï¼Œä½†æ˜¯æˆ‘ç™¼ç¾ Google API å›å‚³çš„çµæœæ²’æœ‰å¾ˆå¥½ï¼Œæœƒå›å‚³å¾ˆå¤šä¸ç›¸å¹²çš„ï¼Œå°±ä¹Ÿä¸æƒ³ç¹¼çºŒå„ªåŒ–äº†ã€‚</p>\n<p>ä¸éæ—¢ç„¶çŸ¥é“å¯ä»¥åœ¨ç¶²é ä¸Šé‹è¡Œ JavaScriptï¼Œé‚£å°±å¯ä»¥åšæ›´å¤šäº‹æƒ…äº†ï¼</p>\n<p>åƒæ˜¯æˆ‘å¾Œä¾†æ‰¾åˆ°çš„é€™ä½<a href=\"https://github.com/realdennis\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é«˜æ‰‹</a>ï¼Œå°±åˆ©ç”¨é€™æ¨£çš„æ–¹å¼ä¾† <a href=\"https://github.com/realdennis/shortcuts-mono/tree/master/packages/shortcuts/sc-background-player\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">bypass Youtube video åœ¨æ‰‹æ©Ÿç¶²é ä¸Šç„¡æ³•èƒŒæ™¯æ’­æ”¾çš„å•é¡Œ</a>ï¼Œæ˜¯æˆ‘ç›®å‰è¦ºå¾—æœ€å¯¦ç”¨çš„ shortcuts XD</p>\n<p>è€Œå‰è¨€ä¸­çš„ç¯„ä¾‹ï¼Œæˆ‘ä¹Ÿæ˜¯åˆ©ç”¨ç›¸åŒæ–¹å¼ï¼Œå°‡ <code class=\"language-text\">vConsole</code> inject åˆ°é é¢ä¸­ï¼Œç¨‹å¼ç¢¼éå¸¸ç°¡å–®ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// injectScript.js</span>\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> script <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'script'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  script<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> <span class=\"token string\">\"https://cdn.bootcss.com/vConsole/3.2.0/vconsole.min.js\"</span><span class=\"token punctuation\">;</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'head'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>script<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// hacky way to wait for script load</span>\n    <span class=\"token keyword\">const</span> script2 <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'script'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    script2<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string\">'window.vConsole = new VConsole();'</span><span class=\"token punctuation\">;</span>\n    document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>script2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">completion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æœ¬ä¾†æ˜¯æƒ³ç›´æ¥åˆ©ç”¨ <code class=\"language-text\">script.onload</code> åœ¨ <code class=\"language-text\">vConsole</code> çš„ script è¼‰å…¥å¾Œé€²è¡Œ initialï¼Œä½†æ˜¯ä¸çŸ¥é“ç‚ºä½•ç„¡æ³•é †åˆ©è§¸ç™¼ï¼Œå› æ­¤åªå¥½ç”¨ setTimeot çš„æ–¹å¼å¿«é€Ÿ hack ä¸€ä¸‹ã€‚ï¼ˆé€™ç¨®å¯¦ä½œæœƒé€ æˆæœ‰æ™‚å¾—å•Ÿç”¨å…©æ¬¡ shortcut æ‰èƒ½æˆåŠŸè¼‰å…¥ vConsole ...ï¼‰</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> injectScript <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./injectScript\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...ç•¥</span>\n<span class=\"token function\">runJavaScriptOnWebPage</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span>\n      text<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n        const injectScript = </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>injectScript<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">;\n        const result = injectScript();\n        completion(result);</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    output\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token comment\">// ...ç•¥</span></code></pre></div>\n<p>å®Œæ•´ç¨‹å¼ç¢¼æˆ‘æ”¾åœ¨ <a href=\"https://github.com/ArvinH/shortcuts-vconsole\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub</a>ã€‚</p>\n<h3 id=\"ç”¢ç”Ÿ-icloud-link\" style=\"position:relative;\"><a href=\"#%E7%94%A2%E7%94%9F-icloud-link\" aria-label=\"ç”¢ç”Ÿ icloud link permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç”¢ç”Ÿ iCloud link</h3>\n<p>å‰é¢èªªéå¾ iOS 13 é–‹å§‹ï¼Œä¸èƒ½å¤ å†éš¨æ„ç”¨ AirDrop ä¸Ÿå…¥ <code class=\"language-text\">.shortcut</code> çš„æª”æ¡ˆï¼Œå¿…é ˆè¦é€é iCloud linkã€‚</p>\n<p>ä½†æˆ‘å…¶å¯¦æ‰¾ä¸å¤ªåˆ°è©²å¦‚ä½•å°‡æˆ‘ç”¢ç”Ÿçš„ <code class=\"language-text\">.shortcut</code> æª”æ¡ˆè½‰æˆ iCloud linkï¼Œå¾Œä¾†åœ¨ <a href=\"https://github.com/joshfarrant/shortcuts-js/issues/217\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub issue</a> ä¸Šæ‰¾åˆ°æœ‰äººåˆ†äº«ä»–å¾ <a href=\"https://www.reddit.com/r/shortcuts/comments/d738kr/ios13_importing_shortcuts_as_files_is_not/f2ngi2e/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">reddit</a> æ‰¾åˆ°çš„ shortcuts - <a href=\"https://www.icloud.com/shortcuts/f9acfff2a5e94138a6574498d22c2813\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Import Shortcut</a>ã€‚</p>\n<p>åªè¦å°‡ä½ åšå¥½çš„ <code class=\"language-text\">.shortcut</code> æª”æ¡ˆæ”¾å…¥ iCloud Driveï¼Œé€éé€™å€‹ <strong>Import Shortcut</strong> å°±èƒ½å¾ä½ çš„ iCloud Drive ä¸­å°‡æª”æ¡ˆæŠ“ä¸‹ä¾†ä¸¦ç”¢ç”Ÿä¸€å€‹ iCloud linkï¼Œæ¥è‘—ç†è«–ä¸Š iPhone å°±æœƒè‡ªå‹• detect åˆ°ï¼Œä½ ä¹Ÿå°±èƒ½ç›´æ¥å®‰è£ã€‚</p>\n<p>P.S. å†æé†’ä¸€ä¸‹ï¼Œè¨˜å¾—è¦åˆ° \"è¨­å®š\" -> \"æ·å¾‘\" -> \"å…è¨±ä¸å—ä¿¡ä»»çš„æ·å¾‘\" å°‡è©²é¸é …é–‹å•Ÿï¼Œæ‰èƒ½ import ä½ è‡ªå·±è£½ä½œçš„ shortcutsã€‚</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>shortcuts é€™å€‹æ¦‚å¿µè »æœ‰æ„æ€çš„ï¼Œä¸€äº›å°å‹•ä½œå…¶å¯¦è‡ªå·±ä¸€æ­¥ä¸€æ­¥åšä¹Ÿæ˜¯å¯ä»¥ï¼Œä½†é€é shortcuts å°‡å¸¸ç”¨çš„å‹•ä½œçµ„ç¹”èµ·ä¾†ï¼Œä¸€éµå°±èƒ½å®Œæˆï¼Œæ¯å€‹æ­¥é©Ÿçœå€‹ä¸‰ã€å››ç§’ï¼Œæ•´é«”å¯èƒ½å°±èƒ½çœæ‰ä½ åç§’ï¼Œå¦‚æœé€™ shortcuts å¾ˆå¸¸ç”¨çš„è©±ï¼Œå‹¢å¿…èƒ½å¢åŠ æ•ˆç‡ï¼Œè‡³å°‘å¿ƒç†å±¤é¢çš„æ„Ÿè¦ºæœ‰ XD</p>\n<p>æ•´é«”ä¾†èªªï¼Œshortcuts js é‚„æœ‰å¾ˆå¤šåœ°æ–¹å¯ä»¥æ”¹é€²ï¼Œç›®å‰æˆ‘è¦ºå¾—é‚„ç¼ºå°‘ä¸€äº›è »é‡è¦çš„ Actionï¼Œä¸€äº›è¼¸å…¥çš„åƒæ•¸ç›®å‰ä¹Ÿä¸æ˜¯å¤ªå¥½ç”¨ï¼Œdebug ä¹Ÿä¸æ–¹ä¾¿ï¼ˆå¿…é ˆè¦è£è¼‰ä¸Šå»æ‰èƒ½æ¸¬è©¦ï¼‰ï¼Œå¸Œæœ›é€éé€™æ¬¡ä»‹ç´¹èƒ½å¼•èµ·å¤šé»äººçš„èˆˆè¶£ï¼Œæˆ–è¨±èƒ½æ›´åŠ æ¨é€²é€™å€‹å°ˆæ¡ˆã€‚</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://shortcuts.fun/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">shortcuts-js website</a></li>\n<li><a href=\"https://github.com/joshfarrant/shortcuts-js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">shortcuts-js github</a> </li>\n<li><a href=\"https://developers.google.com/fact-check/tools/api/reference/rest/v1alpha1/claims/search?apix_params=%7B%22query%22%3A%22Trump%20got%20infected%22%7D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">fact check api</a></li>\n<li><a href=\"https://www.reddit.com/r/shortcuts/comments/afbrlh/using_apis_part1_retrieving_data/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">retrieving data</a></li>\n<li><a href=\"https://www.reddit.com/r/shortcuts/comments/afpwo2/using_apis_part_2_parsing_complex_api_responses/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">parsing complex api responses</a></li>\n<li><a href=\"https://www.reddit.com/r/shortcuts/comments/ae80co/quick_and_dirty_guide_to_scraping_data_from/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">scrapign web data</a>ã€‚</li>\n</ol>","id":"62b18c68-0164-51a0-99a7-ebd11ef41684","fields":{"slug":"ios-shortcuts-js"},"frontmatter":{"date":"2020-04-25T13:37:30.000Z","title":"ç”¨ JS ç©è½‰ iOS shortcuts","tags":["web","iOS","JavaScript","experiment"],"type":"tech","slug":"ios-shortcuts-js"},"timeToRead":11},{"excerpt":"å¥½æ­Œåˆ†äº«ï¼šMonkey Majik + å‰ç”°å…„å¼Ÿ - Change","html":"<blockquote>\n<p>å¥½æ­Œåˆ†äº«ï¼š<a href=\"https://youtu.be/WK1wwgMpFDg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Monkey Majik + å‰ç”°å…„å¼Ÿ - Change</a></p>\n</blockquote>\n<iframe width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/WK1wwgMpFDg\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<!-- more -->\n<h1 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h1>\n<p>å¥½ä¸€é™£å­ä¹‹å‰åœ¨ç¶²è·¯ä¸Šçœ‹åˆ° <a href=\"https://stenciljs.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Stencil JS</a>ï¼ŒåŸä»¥ç‚ºæ˜¯è·Ÿ CSS ç›¸é—œçš„æ¡†æ¶ï¼Œæ²’æƒ³åˆ°æ˜¯ <a href=\"https://ionicframework.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ionic åœ˜éšŠ</a> è£½ä½œçš„ Web Component å·¥å…·ï¼Œåœ¨ GitHub ä¸Šæœ‰ä¸ƒåƒå¤šé¡†æ˜Ÿæ˜Ÿï¼Œçœ‹ä¾†æ˜¯æ·±å—å–œæ„›ï¼Œä½†ç•¶æ™‚æˆ‘å°æ–¼ Web Component å­˜æœ‰ä¸€äº›ç–‘æ…®ï¼Œæ‰€ä»¥æ²’æœ‰å¤šåŠ ç ”ç©¶ï¼Œä¾‹å¦‚ï¼Œé›–ç„¶ä¸»æ‰“ç”¨ Browser åŸç”Ÿæ”¯æ´çš„ Custom Elements ä¾†æ¸²æŸ“å…±ç”¨å…ƒä»¶ï¼Œèƒ½å…±ç”¨åœ¨ä»»ä½•å‰ç«¯æ¡†æ¶ä¸Šï¼Œä½†å…¶å¯¦ä¹Ÿæ„å‘³è‘—ï¼Œä½¿ç”¨é€™å…±ç”¨å…ƒä»¶çš„åœ˜éšŠï¼Œå°æ–¼é€™å€‹å…ƒä»¶çš„æŒæ§åŠ›ä¹Ÿé™ä½äº†ï¼Œè‹¥æ˜¯æƒ³è¦ä¿®æ”¹å…ƒä»¶çš„è¡Œç‚ºï¼Œä¸å¯é¿å…çš„ä¹Ÿå¾—å»å­¸ç¿’å¦‚ä½•ä¿®æ”¹ Web Componentï¼Œåè€Œå¾’å¢æˆæœ¬ã€‚\nä¸éå¾å¦ä¸€å€‹è§’åº¦æƒ³ï¼Œä»Šå¤©è‹¥æœ‰å°ˆé–€çš„åœ˜éšŠåˆ©ç”¨ Web Component ä¾†å»ºæ§‹èˆ‡ç¶­è­·ä¸€æ•´å¥— Design System çš„è©±ï¼Œå¯èƒ½å°±æœƒæ˜¯ä¸éŒ¯çš„é¸æ“‡ã€‚</p>\n<p>ç¸½ä¹‹ï¼Œæœ€è¿‘å¶ç„¶é–“è½åˆ°é«˜æ‰‹å­¸å¼Ÿå†åº¦æåŠ Stencil çš„åå­—ï¼ŒåŠ ä¸Šæˆ‘åœ¨ä¿®æ”¹å€‹äººç¶²ç«™çš„æ™‚å€™ï¼Œæ­£å¥½æƒ³åœ¨æ–‡ç« é åŠ å…¥é¡ä¼¼ Medium çš„æ‹æ‰‹å…ƒä»¶ï¼Œè¦ºå¾—å¯ä»¥åˆ©ç”¨é€™æ©Ÿæœƒä¾†è©¦è©¦çœ‹ï¼Œç”¨ Stencil ä¾†è£½ä½œä¸€å€‹èƒ½åœ¨ React æˆ–å…¶ä»–å‰ç«¯æ¡†æ¶ä¸Šèƒ½é‹è¡Œçš„ Web Componentï¼Œç”¨é€™ç¯‡æ–‡ç« è¨˜éŒ„ä¸‹éç¨‹ã€‚</p>\n<p>å…ˆçœ‹çœ‹æˆå“ï¼š</p>\n<iframe height=\"410\" style=\"width: 100%;\" scrolling=\"no\" title=\"claps-button web component\" src=\"https://codepen.io/arvin0731/embed/preview/ExjGBNq?height=410&theme-id=dark&default-tab=result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/arvin0731/pen/ExjGBNq'>claps-button web component</a> by Arvin\n  (<a href='https://codepen.io/arvin0731'>@arvin0731</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>é»æ“Šæ‹æ‰‹ emoji æ™‚ï¼Œé™¤äº†è¨˜éŒ„é»æ“Šæ¬¡æ•¸å¤–ï¼Œé‚„æœƒæœ‰å…‰é»ç”±å¤–è‡³å…§è¢«å¸å¼•åˆ°æ‰‹ä¸Šï¼Œæœ€å¾Œè®“æ‹æ‰‹ emoji çš„é¡è‰²ç”±ç°éšè½‰é»ƒå†ç™¼ç´…å…‰ï¼Œç‡Ÿé€ å‡ºä¸€ç¨®å…ƒæ°£å½ˆå¸æ”¶èƒ½é‡çš„æ„Ÿè¦ºã€‚</p>\n<p>æ‡¶å¾—çœ‹æ–‡ç« çš„å¯ä»¥åˆ° GitHub ä¸Šçœ‹åŸå§‹ç¢¼ï¼š<a href=\"https://github.com/ArvinH/claps-button\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/ArvinH/claps-button</a></p>\n<h2 id=\"stencil-ç°¡ä»‹\" style=\"position:relative;\"><a href=\"#stencil-%E7%B0%A1%E4%BB%8B\" aria-label=\"stencil ç°¡ä»‹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stencil ç°¡ä»‹</h2>\n<blockquote>\n<p>Stencil is a compiler that generates Web Components (more specifically, Custom Elements). Stencil combines the best concepts of the most popular frameworks into a simple build-time tool.</p>\n</blockquote>\n<p>åœ¨å®˜ç¶²ä¸Šæ¸…æ¥šçš„å¯«åˆ° Stencil çš„å®šä½æ˜¯ä¸€å€‹ Compilerï¼Œç”¨äº†ç›®å‰æµè¡Œçš„ tech stack ä¾†è£½ä½œå‡ºå®Œå…¨ç¬¦åˆæ¨™æº–çš„ Web Componentsã€‚</p>\n<p>åƒè€ƒäº† React çš„ Virtual DOMã€Fiber çš„ Async renderingã€reactive data-bindingï¼Œä¸¦æ”¯æ´ TypeScript å’Œ JSX èªæ³•ã€‚å°æ–¼ç¿’æ…£ç”¨ React é–‹ç™¼çš„äººä¾†èªªï¼Œç®—æ˜¯éå¸¸å¥½ä¸Šæ‰‹çš„ä¸€å¥—å·¥å…·ã€‚</p>\n<p>å®˜ç¶²ä¸Šçš„æ–‡æª”æ¸…æ™°æ˜ç­ï¼Œè€Œä¸”å¾ˆå¥½é–±è®€ï¼Œä¸€è·¯å¾ Introduction é †è‘—è®€ä¸‹å»ï¼Œå°±æœƒé»˜é»˜æŠŠå„ç¨®åŠŸèƒ½èˆ‡ API ä¹Ÿéƒ½çœ‹éä¸€éï¼ŒåŒ…å«å¦‚ä½•æ•´åˆåœ¨ä¸åŒçš„å‰ç«¯æ¡†æ¶ä¸­çš„è³‡è¨Šã€‚</p>\n<p>å…¶ä¸­ä¹ŸèŠ±äº†ä¸€äº›ç¯‡å¹…åœ¨ä»‹ç´¹ç‚ºä»€éº¼ä»–å€‘è¦è£½ä½œé€™å¥—å·¥å…·ï¼Œä»¥åŠä»–å€‘çš„ç›®çš„æ˜¯ä»€éº¼ã€‚å°æ–¼ä»–å€‘çš„å‡ºç™¼é»èˆ‡ç›®æ¨™ï¼Œæˆ‘è¦ºå¾—è »æœ‰æ„æ€çš„ï¼š</p>\n<blockquote>\n<p>Stencil aims to combine the best concepts of the most popular frontend frameworks into a compile-time tool rather than run-time tool.</p>\n</blockquote>\n<p>ä»–å€‘å°æ–¼ Stencil çš„å®šä½æ˜¯å±¬æ–¼ <code class=\"language-text\">compile-time tool</code>ï¼Œæ‡‰ç”¨å„ç¨®å·¥å…·æœ€ä½³åŒ–é–‹ç™¼é«”é©—ï¼Œæœ€çµ‚ç·¨è­¯å‡ºç¬¦åˆ Web Standards ä¸”èƒ½é‹è¡Œåœ¨å¤šæ•¸ç€è¦½å™¨çš„å…ƒä»¶ã€‚</p>\n<p>ç‚ºæ­¤ï¼Œä»–å€‘æä¾›äº† out-of-the-box çš„æŒ‰éœ€åŠ è¼‰ï¼Œé€™é»å°æ–¼ Web Component ä¾†èªªéå¸¸é‡è¦ï¼Œä¹Ÿå¤§å¤§æé«˜æˆ‘çš„ä½¿ç”¨æ„é¡˜ï¼›API éƒ¨åˆ†ä»–å€‘æ˜¯å¾ Web Component æ¨™æº–çš„ lifecycle ä¸Šå†åšå»¶ä¼¸ï¼Œä¸¦æ²’æœ‰å¤ªå¤šä»–å€‘è‡ªå·±çš„å®¢è£½åŒ– APIï¼Œå­¸ç¿’æ›²ç·šç›¸å°ä½ï¼Œä½†é‚„æ˜¯èƒ½ä¿æœ‰è‰¯å¥½çš„é–‹ç™¼é«”é©—ï¼Œåƒæ˜¯åœ¨ä½¿ç”¨ Framework é–‹ç™¼ä¸€èˆ¬ã€‚</p>\n<p>æœ‰èˆˆè¶£çš„è®€è€…å¯ä»¥å‰å¾€<a href=\"https://stenciljs.com/docs/goals-and-objectives\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜ç¶²</a>é–±è®€ï¼Œå…§å®¹ä¸ç®—å¤ªå¤šï¼Œå¾ˆå¿«èƒ½æƒéä¸€éã€‚</p>\n<h2 id=\"å¦‚ä½•è£½ä½œ\" style=\"position:relative;\"><a href=\"#%E5%A6%82%E4%BD%95%E8%A3%BD%E4%BD%9C\" aria-label=\"å¦‚ä½•è£½ä½œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å¦‚ä½•è£½ä½œ</h2>\n<h3 id=\"å°ˆæ¡ˆè¨­å®š\" style=\"position:relative;\"><a href=\"#%E5%B0%88%E6%A1%88%E8%A8%AD%E5%AE%9A\" aria-label=\"å°ˆæ¡ˆè¨­å®š permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å°ˆæ¡ˆè¨­å®š</h3>\n<p>æ¥ä¸‹ä¾†å°±èªªæ˜å¦‚ä½•ä½¿ç”¨ Stencil ä¾†è£½ä½œ Web Componentã€‚</p>\n<p>é¦–å…ˆæˆ‘å€‘åˆ©ç”¨ Stencil çš„ cli é–‹å•Ÿä¸€å€‹å°ˆæ¡ˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> init stencil</code></pre></div>\n<p>ä½ å¯ä»¥çœ‹åˆ°æˆ‘å€‘å…¶å¯¦æœ‰ä¸‰ç¨®é¸æ“‡ï¼š<code class=\"language-text\">ionic-pwa</code>ã€<code class=\"language-text\">app</code>ã€<code class=\"language-text\">component</code></p>\n<p><img src=\"/image/stencil-cli.png\" alt=\"stencil-cli\" title=\"stencil-cli\"></p>\n<p>ionic-pwa èˆ‡ app éƒ½æ˜¯ç”¨ä¾†å»ºæ§‹ä¸€å€‹å®Œæ•´ Web application çš„ starter kitï¼Œå–®ç´”å»ºæ§‹ Component çš„è©±åªéœ€è¦é¸æ“‡ component é€™å€‹ starter kit å³å¯ã€‚æœ‰èˆˆè¶£çš„è®€è€…ä¹Ÿå¯ä»¥è£ ionic-pwa èˆ‡ app è©¦è©¦çœ‹ï¼ŒStencil æä¾›äº†è‡ªå·±çš„ router \bèˆ‡ redux libï¼Œè®“ä½ èƒ½æœ‰èˆ‡é–‹ç™¼ç›®å‰ä¸€èˆ¬å‰ç«¯æ‡‰ç”¨ç¨‹å¼ç›¸ä¼¼çš„é«”é©—ã€‚</p>\n<p>é¸æ“‡å®‰è£å¥½ <code class=\"language-text\">component starter kit</code> å¾Œï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„å°ˆæ¡ˆçµæ§‹ï¼š</p>\n<p><img src=\"/image/stencil-starter-kit-structure.png\" alt=\"stencil-starter-kit-structure\" title=\"stencil starter kit structure\"></p>\n<p>é‡é»åªæœ‰ä¸€å€‹ï¼Œå°±æ˜¯ <code class=\"language-text\">components</code> è³‡æ–™å¤¾ï¼Œåº•ä¸‹åŒ…å«äº† e2e æ¸¬è©¦çš„æª”æ¡ˆã€css æª”èˆ‡ component ä¸»ç¨‹å¼æ‰€åœ¨çš„ <code class=\"language-text\">my-component.tsx</code>ã€‚å¯ä»¥çœ‹åˆ°éƒ½æ˜¯ç”± Typescript ç‚ºä¸»è¦ stackï¼Œå…¶ä¸­çš„ type file <code class=\"language-text\">components.d.ts</code> åœ¨ä½  <code class=\"language-text\">build</code> èˆ‡ <code class=\"language-text\">run dev</code> çš„éç¨‹ä¸­æœƒè‡ªå‹•å¹«ä½  codegen å‡ºä¾†ã€‚</p>\n<p>å…¶ä¸­çš„ <code class=\"language-text\">index.html</code> æ˜¯ <code class=\"language-text\">run dev</code> æ™‚çš„ä¸»è¦ html templateï¼Œä½ å¯ä»¥åœ¨é€™é‚Šæ¸¬è©¦ä½ è¨­è¨ˆçš„ component ä½¿ç”¨æƒ…å¢ƒã€‚</p>\n<p>æ¥è‘—ä¾†çœ‹ä¸€ä¸‹ package.json çš„å…§å®¹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my-first-component\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0.0.1\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Stencil Component Starter\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/index.mjs\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"es2015\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/esm/index.mjs\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"es2017\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/esm/index.mjs\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"types\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/types/index.d.ts\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"collection\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/collection/collection-manifest.json\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"collection:main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/collection/index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"unpkg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/my-first-component/my-first-component.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"files\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"dist/\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"loader/\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"stencil build --docs\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"stencil build --dev --watch --serve\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"stencil test --spec --e2e\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test.watch\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"stencil test --spec --e2e --watchAll\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"generate\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"stencil generate\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@stencil/core\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^1.8.8\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MIT\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åŸºæœ¬çš„ npm script éƒ½å¹«ä½ æº–å‚™å¥½äº†ï¼Œç•¶ä½  <code class=\"language-text\">npm run build</code> çš„æ™‚å€™ï¼Œé™¤äº†åŸºæœ¬çš„ main - <code class=\"language-text\">dist/index.js</code> å¤–ï¼Œmodule æ¨¡å¼çš„ <code class=\"language-text\">dist/index.mjs</code> èˆ‡ <code class=\"language-text\">es2015</code>ã€<code class=\"language-text\">es2017</code> çš„ç·¨è­¯ç‰ˆæœ¬éƒ½æœ‰ï¼Œç”šè‡³æº–å‚™äº†çµ¦ <code class=\"language-text\">unpkg</code> ä½¿ç”¨çš„ destinationã€‚</p>\n<p>å”¯ä¸€ä¸€é»è¦æ³¨æ„çš„æ˜¯ï¼Œç•¶ä½ æº–å‚™è¦ publish ä½ çš„ component åˆ° npm ä¸Šï¼Œè®“äººé€é <a href=\"https://unpkg.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">unpkg</a> ä½¿ç”¨æ™‚ï¼Œè¨˜å¾—ä¸€å®šè¦å…ˆ <code class=\"language-text\">npm run build</code>ï¼Œç”¢ç”Ÿ production build æ‰æœƒæœ‰çš„ç·¨è­¯æª”æ¡ˆï¼Œé€™æ¨£æ‰èƒ½å¤ æ­£ç¢ºåœ°è¢«äººå¼•å…¥ä½¿ç”¨ã€‚</p>\n<p>å¦å¤–ï¼Œè£¡é¢å”¯ä¸€æ¯”è¼ƒç‰¹æ®Šçš„ config æª”æ¡ˆ - <code class=\"language-text\">stencil.config.ts</code> å‰‡æ˜¯ç”¨ä¾†è¨­å®šå„ç¨® stencil plugin çš„ï¼Œä¾‹å¦‚åœ¨æˆ‘çš„ç¯„ä¾‹ä¸­ï¼Œæˆ‘ä½¿ç”¨äº† SCSSï¼Œé€™æ™‚å°±å¯ä»¥åœ¨æ­¤ config æª”ä¸­è¨­å®š scss pluginï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Config <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@stencil/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// sass plugin</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> sass <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@stencil/sass'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> config<span class=\"token operator\">:</span> Config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  namespace<span class=\"token operator\">:</span> <span class=\"token string\">'claps-button'</span><span class=\"token punctuation\">,</span>\n  outputTargets<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token string\">'dist'</span><span class=\"token punctuation\">,</span>\n      esmLoaderPath<span class=\"token operator\">:</span> <span class=\"token string\">'../loader'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token string\">'docs-readme'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token string\">'www'</span><span class=\"token punctuation\">,</span>\n      serviceWorker<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token comment\">// disable service workers</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// can setup plugins here</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">sass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"ç¨‹å¼é–‹ç™¼\" style=\"position:relative;\"><a href=\"#%E7%A8%8B%E5%BC%8F%E9%96%8B%E7%99%BC\" aria-label=\"ç¨‹å¼é–‹ç™¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¨‹å¼é–‹ç™¼</h3>\n<p>åˆ©ç”¨ starter kit æŠŠå°ˆæ¡ˆå»ºç«‹å¥½ï¼Œæ¥è‘—æŠŠåç¨±æ”¹æˆè‡ªå·±çš„ component å¾Œï¼Œå°±èƒ½é–‹å§‹æ­£å¼æ’°å¯«ç¨‹å¼ç¢¼ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Prop<span class=\"token punctuation\">,</span> State<span class=\"token punctuation\">,</span> Listen<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> Host <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@stencil/core'</span><span class=\"token punctuation\">;</span>\n<span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  tag<span class=\"token operator\">:</span> <span class=\"token string\">'claps-button'</span><span class=\"token punctuation\">,</span>\n  styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">'claps-button.scss'</span><span class=\"token punctuation\">,</span>\n  shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">State</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> count<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> color<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Listen</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> capture<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    e<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"counter\"</span> style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          color<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div\n          <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"claps-btn-container\"</span>\n          data<span class=\"token operator\">-</span>count<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span>\n          onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span>\n          ğŸ‘\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"ä¸€æ­¥æ­¥è§£æ\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E6%AD%A5%E6%AD%A5%E8%A7%A3%E6%9E%90\" aria-label=\"ä¸€æ­¥æ­¥è§£æ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ä¸€æ­¥æ­¥è§£æ</h3>\n<p><strong>@Component</strong> decorator æä¾› Stencil compiler é—œæ–¼ä½ çš„å…ƒä»¶çš„ Metadataã€‚å…¶ä¸­ï¼Œ<code class=\"language-text\">tag</code> é¡§åæ€ç¾©å°±æ˜¯ä½ å…ƒä»¶çš„ tag åç¨±è¦å«åšä»€éº¼ï¼›<code class=\"language-text\">styleUrl</code> æ¨™ç¤ºå‡ºä½ è¦å¼•å…¥çš„ css æª”æ¡ˆï¼›<code class=\"language-text\">shadow</code> ä»£è¡¨ä½ çš„å…ƒä»¶æ˜¯å¦è¦ä½¿ç”¨ shadow domã€‚</p>\n<p>ä½¿ç”¨ shadow dom çš„å·®åˆ¥åœ¨æ–¼ä½ æƒ³ä¸æƒ³è¦å…ƒä»¶å…§çš„æ‰€æœ‰å…ƒç´ è¢«å°è£èµ·ä¾†ã€‚ä¸æ¸…æ¥šä½•è¬‚ shadow dom çš„å¯ä»¥çœ‹ <a href=\"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MDN çš„èªªæ˜</a>ã€‚è‹¥æ˜¯ä½ æœ‰é–‹å•Ÿ shadow domï¼Œä½ çš„å…ƒä»¶åœ¨ HTML Tree ä¸­æœƒé•·å¾—åƒé€™æ¨£ï¼š</p>\n<p><img src=\"/image/stencil-shadowdom.png\" alt=\"shadow-dom\" title=\"shadow dom\"></p>\n<p>ä¸‹é¢å¯¦éš› Component å¯¦ä½œçš„éƒ¨åˆ†ï¼Œå‰‡è·Ÿ React Component é¡ä¼¼ï¼Œä¸€æ¨£æœ‰ <code class=\"language-text\">render</code> å‡½å¼å›å‚³ <code class=\"language-text\">JSX</code>ï¼›ã„§æ¨£æœ‰ private/public method å¯ä»¥å®£å‘Šä½¿ç”¨ã€‚</p>\n<p>ä½ å¯ä»¥åˆ©ç”¨ <code class=\"language-text\">@State()</code> èˆ‡ <code class=\"language-text\">@Prop()</code> å…©å€‹ decorator ä¾†å®£å‘Šå…ƒä»¶çš„ç‹€æ…‹(state) èˆ‡å¯æ¥å—çš„ Propsã€‚</p>\n<p><code class=\"language-text\">@Listen()</code> decorator å‰‡æ˜¯ Stencil ç”¨ä¾†ç›£è½å¤–éƒ¨ DOM Event çš„ï¼Œå¯ä»¥å‚³å…¥ä¸åŒçš„ optionï¼Œåƒæ˜¯ä¸Šé¢ç¯„ä¾‹ä¸­çš„ <code class=\"language-text\">{ capture: true }</code> å°±æ˜¯å‘ŠçŸ¥æˆ‘å€‘è¦åœ¨ Capture éšæ®µ fire listenerï¼›ä¹Ÿå¯ä»¥æŒ‡å®š <code class=\"language-text\">target</code>ï¼Œå‘Šè¨´ Stencil ä½ è¦æŠŠé€™å€‹ listener ç¶å®šåœ¨èª°èº«ä¸Šï¼Œåƒæ˜¯ scroll eventï¼Œå¯ä»¥ target åœ¨ window ä¸Šï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@<span class=\"token function\">Listen</span><span class=\"token punctuation\">(</span><span class=\"token string\">'scroll'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> target<span class=\"token operator\">:</span> <span class=\"token string\">'window'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">handleScroll</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ev</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'the body was scrolled'</span><span class=\"token punctuation\">,</span> ev<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ­¤å¤–ï¼Œé‚„æœ‰å€‹ <code class=\"language-text\">@Event()</code> decorator å¯ä»¥ç”¨ä¾† emit data è·Ÿ eventï¼Œä¸¦ç”¨ <code class=\"language-text\">@Listen()</code> decorator æ•ç²ã€‚è©³æƒ…å¯ä»¥<a href=\"https://stenciljs.com/docs/events\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">åƒé–±å®˜ç¶²</a>ã€‚</p>\n<p>æœ€å¾Œåœ¨ render å‡½å¼ä¸­æœ‰å€‹ç‰¹åˆ¥çš„ Element å«åš <code class=\"language-text\">Host</code>ï¼Œåœ¨ Web component çš„ä¸–ç•Œä¸­ï¼Œhost environment ä»£è¡¨çš„æ˜¯ <em>host</em> ä½ çš„ custom web component çš„ç’°å¢ƒï¼Œé€šå¸¸å°±æ˜¯ä¸€èˆ¬çš„ DOM Treeï¼Œè€Œé€™é‚Šçš„ <code class=\"language-text\">Host</code> component ä¹Ÿé›·åŒï¼Œä»£è¡¨çš„å°±æ˜¯ä½ çš„ Web component æœ¬èº«ï¼Œä½ å‚³å…¥çµ¦ Host element çš„å±¬æ€§éƒ½æœƒåæ˜ åœ¨ web component çš„ tag èº«ä¸Šã€‚å¾å®˜ç¶²çµ¦çš„ç¯„ä¾‹ä¾†çœ‹å¯èƒ½æœƒæ›´æ¸…æ¥šï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>tag<span class=\"token operator\">:</span> <span class=\"token string\">'todo-list'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TodoList</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> open <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Host\n        aria<span class=\"token operator\">-</span>hidden<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>open <span class=\"token operator\">?</span> <span class=\"token string\">'false'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'true'</span><span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          <span class=\"token string\">'todo-list'</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'is-open'</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>open\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ ¹æ“šå‚³å…¥ä½ çš„ custom tag çš„å±¬æ€§ <code class=\"language-text\">open</code> çš„ç‹€æ…‹ï¼Œæœƒæ”¹è®Šå…¶ <code class=\"language-text\">aria-hidden</code> å±¬æ€§çš„å…§å®¹ã€‚</p>\n<p>å¦‚æœ <code class=\"language-text\">this.open === true</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token operator\">&lt;</span>todo<span class=\"token operator\">-</span>list <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"todo-list open\"</span> aria<span class=\"token operator\">-</span>hidden<span class=\"token operator\">=</span><span class=\"token string\">\"false\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>todo<span class=\"token operator\">-</span>list<span class=\"token operator\">></span></code></pre></div>\n<p>æ­¤å¤–ï¼Œ<code class=\"language-text\">Host</code> element ä¹Ÿå¯ä»¥å–®ç´”ç”¨ä¾†å–ä»£ React ä¸­çš„ <code class=\"language-text\">Fragement</code>ã€‚</p>\n<h3 id=\"å…¶ä»–ç´°ç¯€èˆ‡æ³¨æ„äº‹é …\" style=\"position:relative;\"><a href=\"#%E5%85%B6%E4%BB%96%E7%B4%B0%E7%AF%80%E8%88%87%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85\" aria-label=\"å…¶ä»–ç´°ç¯€èˆ‡æ³¨æ„äº‹é … permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å…¶ä»–ç´°ç¯€èˆ‡æ³¨æ„äº‹é …</h3>\n<p>è‡³æ­¤ç‚ºæ­¢å…¶å¯¦å°±å·²ç¶“å¯ä»¥ç”¢å‡ºä¸€å€‹ Web Component äº†ï¼Œæ¥ä¸‹ä¾†è¦åšçš„å°±éƒ½åªæ˜¯åŠ å…¥å…ƒä»¶æ‰€éœ€çš„å¯¦ä½œç´°ç¯€ï¼Œä¸‹é¢ç¨‹å¼ç¢¼æˆ‘çœç•¥äº†ä¸€äº›ç”¢ç”Ÿå‹•ç•«çš„ç´°ç¯€ï¼Œæœ‰èˆˆè¶£çš„å¯ä»¥<a href=\"https://github.com/ArvinH/claps-button\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å¾ GitHub ä¸Šåƒè€ƒåŸå§‹ç¢¼</a>ï¼Œå¯¦ä½œæ–¹å¼å…¶å¯¦å¾ˆç°¡å–®æš´åŠ›ï¼Œå°±æ˜¯å›ºå®šç”¢ç”Ÿè¨±å¤šå°å…‰é»ï¼Œç„¶å¾Œç®—å¥½åœ“å½¢åº§æ¨™çš„ä½ç½®èˆ‡ä½ç§»ï¼Œä¸¦åˆ©ç”¨ <code class=\"language-text\">animate API</code> ä¾†åŠ ä¸Š <code class=\"language-text\">keyframe</code>ï¼Œåœ¨é»æ“Šæ‹æ‰‹ emoji çš„æ™‚å€™è§¸ç™¼å‹•ç•«ï¼Œä¸¦åŠ ä¸Š <code class=\"language-text\">text-shadow</code> èˆ‡ <code class=\"language-text\">filter: grayscale</code> çš„å±¬æ€§ä¾†å¢åŠ æ•ˆæœã€‚</p>\n<p>é€™é‚Šæˆ‘è‘—é‡èªªæ˜ä¸€äº›é—œæ–¼ Stencil å¯¦ä½œ web component ä¸Šçš„ä¸€äº›ç´°ç¯€ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Component</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  tag<span class=\"token operator\">:</span> <span class=\"token string\">'claps-button'</span><span class=\"token punctuation\">,</span>\n  styleUrl<span class=\"token operator\">:</span> <span class=\"token string\">'claps-button.scss'</span><span class=\"token punctuation\">,</span>\n  shadow<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Element</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> el<span class=\"token operator\">:</span> HTMLElement<span class=\"token punctuation\">;</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">State</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> count<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> color<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> size<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Prop</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> preserve<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Listen</span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> capture<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    e<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>preserve<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">claps-wc-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>location<span class=\"token punctuation\">.</span>pathname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">runAnimation</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>preserve<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">=</span> <span class=\"token operator\">+</span>localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">claps-wc-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>location<span class=\"token punctuation\">.</span>pathname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">runAnimation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createDocumentFragment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> rootElm  <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">.</span>shadowRoot<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.claps-btn-container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// ...ç•¥</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateChi</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// ...ç•¥</span>\n      <span class=\"token comment\">// ç”¢ç”Ÿåœ“å½¢æ°£é«”é¡†ç²’æ•ˆæœ</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">const</span> chiArray <span class=\"token operator\">=</span> <span class=\"token function\">generateChi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    chiArray<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>chi <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      root<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>chi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    rootElm<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Host<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"counter\"</span> style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          color<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span>\n          borderColor<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span>\n          width<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>size <span class=\"token operator\">||</span> <span class=\"token string\">'3rem'</span><span class=\"token punctuation\">,</span>\n          height<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>size <span class=\"token operator\">||</span> <span class=\"token string\">'3rem'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div\n          <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"claps-btn-container\"</span>\n          data<span class=\"token operator\">-</span>count<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span>\n          onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span>\n          style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n            width<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>size <span class=\"token operator\">||</span> <span class=\"token string\">'3rem'</span><span class=\"token punctuation\">,</span>\n            height<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>size <span class=\"token operator\">||</span> <span class=\"token string\">'3rem'</span><span class=\"token punctuation\">,</span>\n            fontSize<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>size <span class=\"token operator\">||</span> <span class=\"token string\">'3rem'</span><span class=\"token punctuation\">,</span>\n            textShadow<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">1px 0px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>\n              <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">&lt;</span> <span class=\"token number\">20</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">:</span> <span class=\"token number\">20</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px red</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n            filter<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">grayscale(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>\n              <span class=\"token number\">1</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count <span class=\"token operator\">/</span> <span class=\"token number\">20</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span>\n          ğŸ‘\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Host<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>é¦–å…ˆæ˜¯ <strong>lifecycle</strong>ï¼ŒStencil é™¤äº†æä¾› <a href=\"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web Component æ¨™æº–çš„ lifecycle</a> - <code class=\"language-text\">connectedCallback()</code> èˆ‡ <code class=\"language-text\">disconnectedCallback()</code> å¤–ï¼Œé‚„æä¾›äº†è¨±å¤šé¡ä¼¼ç•¶åˆ React çš„ component lifecycleï¼Œå¯ä»¥å¾å®˜æ–¹çš„åœ–æª”ä¸­ä¸€ç›®ç­ç„¶ï¼š</p>\n<p><img src=\"/image/stencil-component-lifecycle.png\" alt=\"stencil-component-lifecycle\" title=\"stencil component lifecycle\"></p>\n<p>æˆ‘å€‘ç¯„ä¾‹ä¸­ç”¨åˆ°çš„ <code class=\"language-text\">componentWillLoad</code> æœƒåœ¨ Component é€²è¡Œç¬¬ä¸€æ¬¡ render å‰è¢«å‘¼å«ï¼Œæ‰€ä»¥é©åˆç”¨ä¾† initialized dataï¼Œé€™é‚Šçš„ä¾‹å­æ˜¯å¾ localStorage ä¸­å–å‡ºè³‡æ–™ã€‚</p>\n<p>å¦ä¸€å€‹åŸ·å¾—æ³¨æ„çš„åœ°æ–¹æ˜¯å–å¾— shadow dom å…ƒç´ çš„æ–¹æ³•ã€‚</p>\n<p>åœ¨ <code class=\"language-text\">runAnimation()</code> å‡½æ•¸ä¸­ï¼Œæˆ‘éœ€è¦å°‡å‹•æ…‹ç”¢ç”Ÿçš„å…‰é»æ›è¼‰åˆ° web component çš„ shadow dom ä¸Šï¼Œè€Œè¦èƒ½å­˜å– shadow domï¼Œéœ€è¦å…ˆåˆ©ç”¨ <code class=\"language-text\">@Element()</code> decorator ä¾†å®£å‘Šä¸€å€‹ Host element çš„ referenceï¼Œè©² decorator æœƒå›å‚³ä¸€å€‹ <code class=\"language-text\">HTMLElement</code> çš„ instanceï¼Œä½ å°±èƒ½ä»¥æ­¤ä¾†å­˜å– shadow domï¼š</p>\n<p><code class=\"language-text\">const rootElm  = this.el.shadowRoot.querySelector('.claps-btn-container');</code></p>\n<p>æœ€å¾Œï¼Œé‚„æœ‰ä¸€äº›é€™æ¬¡ç¯„ä¾‹ä¸­æœªç”¨åˆ°çš„ APIï¼Œåƒæ˜¯ public method çš„ä½¿ç”¨èˆ‡é¡ä¼¼ Observable çš„ Watch decorator ç­‰ç­‰ï¼Œæœ‰èˆˆè¶£çš„è®€è€…åœ¨å‰å¾€å®˜ç¶²æŸ¥çœ‹å³å¯ï¼Œéƒ½å¯«å¾—è »æ¸…æ¥šçš„ã€‚</p>\n<p><a href=\"https://stenciljs.com/docs/decorators\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Stencil API Docs</a></p>\n<h2 id=\"å¦‚ä½•é‹ç”¨åœ¨ä¸åŒ-framework-ä¸Š\" style=\"position:relative;\"><a href=\"#%E5%A6%82%E4%BD%95%E9%81%8B%E7%94%A8%E5%9C%A8%E4%B8%8D%E5%90%8C-framework-%E4%B8%8A\" aria-label=\"å¦‚ä½•é‹ç”¨åœ¨ä¸åŒ framework ä¸Š permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å¦‚ä½•é‹ç”¨åœ¨ä¸åŒ framework ä¸Š</h2>\n<p>ä½¿ç”¨åœ¨ä¸åŒæ¡†æ¶çš„æ–¹æ³•ï¼Œæˆ‘è©¦äº†å…©ç¨®ï¼Œé¦–å…ˆæ˜¯ Reactï¼›</p>\n<iframe\n  src=\"https://codesandbox.io/embed/webcomponent-test-react-w7lyv?fontsize=14&hidenavigation=1&theme=dark\"\n  style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n  title=\"webcomponent-test-react\"\n  allow=\"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb\"\n  sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n></iframe>\n<p>æœ€ç°¡å–®çš„æ–¹å¼å°±æ˜¯åœ¨ template index.html ä¸­æ”¾å…¥ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>https://unpkg.com/claps-button@1.0.7/dist/claps-button.js<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>ç„¶å¾Œå°±èƒ½åœ¨ä»»æ„ component ä¸­åŠ å…¥ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>claps-button</span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3rem<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">preserve</span> <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>claps-button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>ç„¶è€Œåƒ Vue çš„è©±ï¼Œå°±æ²’è¾¦æ³•ç›´æ¥é€™æ¨£åšï¼Œå¿…é ˆè¦ä»¥ <code class=\"language-text\">npm install ${your web component}</code> çš„æ–¹å¼è¼‰å…¥åˆ°ä½ çš„ App ä¸­ï¼Œä¸¦åœ¨ <code class=\"language-text\">main.js</code> ä¸­ï¼Œå¾ stencil æä¾›çš„ loader ä¸­å» <code class=\"language-text\">defineCustomElements</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> Vue <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">\"./App.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  applyPolyfills<span class=\"token punctuation\">,</span>\n  defineCustomElements\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"claps-button/loader/index.cjs.js\"</span><span class=\"token punctuation\">;</span>\nVue<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>productionTip <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Tell Vue to ignore all components defined in the claps-button</span>\n<span class=\"token comment\">// package. The regex assumes all components names are prefixed</span>\n<span class=\"token comment\">// 'claps'</span>\nVue<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>ignoredElements <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">claps-\\w*</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Bind the custom elements to the window object</span>\n<span class=\"token function\">applyPolyfills</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">defineCustomElements</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">Vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">render</span><span class=\"token operator\">:</span> <span class=\"token parameter\">h</span> <span class=\"token operator\">=></span> <span class=\"token function\">h</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">$mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"but\" style=\"position:relative;\"><a href=\"#but\" aria-label=\"but permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>Butï¼</strong></h3>\n<p>é€™æ¨£çš„åšæ³•ç›®å‰ä¼¼ä¹æœ‰è¨±å¤šå•é¡Œï¼Œæœƒä¸€ç›´å‡ºç¾ <code class=\"language-text\">TypeError: Cannot read property 'isProxied' of undefined</code> çš„ Errorï¼Œåœ¨ç¶²è·¯ä¸Šæœ‰è¨±å¤šè¨è«–ï¼Œæˆªè‡³æˆ‘å®Œæˆé€™ç¯‡æ–‡ç« ç‚ºæ­¢ï¼Œå°šæœªæœ‰çµè«–ã€‚ä¾‹å¦‚ï¼š<a href=\"https://github.com/ionic-team/stencil/issues/1661\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub ä¸Šçš„ issue</a> å’Œ <a href=\"https://en.programqa.com/question/59887533/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Svelte çš„ä¾‹å­</a></p>\n<p>æ‰€ä»¥æˆ‘æƒ³ç›®å‰å¯èƒ½é‚„æ˜¯ä»¥ script tag çš„æ–¹å¼å¼•å…¥æœ€ç‚ºä¿éšªã€‚</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>Web Component çš„å­˜åœ¨å¿…è¦é‚„æ˜¯æœ‰å¾ˆå¤šçˆ­è­°ï¼Œæˆ‘å€‹äººåå¥½å°‡å…¶é‹ç”¨åœ¨ Design System ä¸­ï¼Œç”±ä¸€å€‹å›ºå®šçš„ Team å»ç¶­è­·ï¼Œå¦‚æ­¤ä»¥ä¾†æ‰èƒ½ç™¼æ®ä»–ç›®å‰çš„æœ€å¤§åŠŸç”¨ã€‚</p>\n<p>ç”¨ Stencil é–‹ç™¼ Web Component çš„é«”é©—æŒºä¸éŒ¯çš„ï¼Œå¦‚æœä½ æœ‰æ‰‹åˆ»é custom elementsï¼Œä½ æ‡‰è©²ä¹Ÿæœƒé©šè‰·æ–¼ä»–å€‘å°‡æ•´å€‹é–‹ç™¼é«”é©—åŒ…è£¹å¾—å¾ˆå¥½ï¼Œæœ‰æ™‚é–“çš„è©±å€¼å¾—ç©ç©ï¼</p>\n<p>é€™æ¬¡æˆ‘åœ¨é–‹ç™¼çš„æ‹æ‰‹å…ƒä»¶çš„åŒæ™‚ï¼Œé™¤äº†å­¸ç¿’åˆ° Stencil çš„é–‹ç™¼æ–¹å¼å¤–ï¼Œä¹Ÿæ„å¤–ç·´ç¿’åˆ°å‹•ç•«è£½ä½œçš„ç¶“é©—ï¼ŒæŒºæœ‰è¶£çš„ï¼Œå¤§å®¶ä¹Ÿæ‹¿å€‹è‡ªå·±æƒ³åšçš„å° component ä¾†è©¦è©¦çœ‹å§ï¼ä¹Ÿæ­¡è¿è·Ÿæˆ‘åˆ†äº«å¿ƒå¾—äº’ç›¸æŒ‡æ•™ï¼</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://stenciljs.com/docs/introduction\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">StencilJS official site</a></li>\n<li><a href=\"https://codepen.io/realdennis/pen/RwNNqbj\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">emoji claps inspired by this codepen</a></li>\n</ol>","id":"0d43301a-6acf-560a-a1b6-8a606988fb21","fields":{"slug":"stenciljs-webcomponent"},"frontmatter":{"date":"2020-03-28T13:37:30.000Z","title":"åˆ©ç”¨ Stencil å»ºæ§‹ Web Component","tags":["web","stencil","JavaScript","Web Component"],"type":"tech","slug":"stenciljs-webcomponent"},"timeToRead":12},{"excerpt":"ã€é¡˜ä½ é¤˜ç”Ÿæ‰€æœ‰çš„çæƒœéƒ½ä¸ç”¨é å¤±å»ä¾†æ‡‚å¾—ã€‚ã€","html":"<blockquote>\n<p>ã€é¡˜ä½ é¤˜ç”Ÿæ‰€æœ‰çš„çæƒœéƒ½ä¸ç”¨é å¤±å»ä¾†æ‡‚å¾—ã€‚ã€</p>\n</blockquote>\n<!-- more -->\n<h1 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h1>\n<p>æœ€è¿‘å› ç‚ºæ­¦æ¼¢è‚ºç‚çš„é—œä¿‚ï¼Œå…¬å¸å±•é–‹äº†ä¸çŸ¥å¾—æŒçºŒå¤šä¹…çš„ Work From Home æ”¿ç­–ï¼Œé›–ç„¶åœ˜éšŠè£¡æœ‰äº›äººä¸å¤ªå–œæ­¡ï¼Œè¦ºå¾—é€™æ¨£æºé€šèˆ‡é–‹æœƒæ•ˆç‡æ¯”ä¸ä¸Šåœ¨è¾¦å…¬å®¤é¢å°é¢ï¼Œä½†æˆ‘å€‹äººæ˜¯é‚„è »ç¿’æ…£çš„ï¼Œä¸¦ä¸”ï¼Œé€™ç¯€çœä¸‹ä¾†çš„é€šå‹¤æ™‚é–“ï¼Œå‰›å¥½è®“æˆ‘å¯ä»¥å¤šçœ‹ä¸€äº›å½±ç‰‡è·Ÿç©ç© side projectã€‚é€™æ¬¡åœ¨è£œå¸¶ React Conf 2019 çš„å½±ç‰‡æ™‚ï¼Œçœ‹åˆ°å‰ React team çš„ EM, Sophie Alpert ä»‹ç´¹ <a href=\"https://www.youtube.com/watch?v=CGpMlWVcHok\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Building a Custom React Renderer</a>ï¼ŒåŠ ä¸Š side project ç”¨ä¸Šäº† <a href=\"https://github.com/vadimdemedes/ink\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ink</a> é€™å€‹èƒ½ç”¨ React æ’°å¯« command line å·¥å…·çš„å¥—ä»¶ï¼Œè®“æˆ‘æ±ºå®šé€éå¯¦éš›æ“ä½œä¾†äº†è§£ä½•è¬‚ Custom React Rendererï¼Œä»¥åŠè©²å¦‚ä½•æ‰“é€ ã€‚é™¤äº† Sophie Alpert çš„å½±ç‰‡å¤–ï¼ŒåŸºæœ¬ä¸Šæ˜¯åƒè€ƒ <a href=\"https://github.com/nitin42/Making-a-custom-React-renderer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@nitin42 çš„é€™ä»½æ•™å­¸</a>ï¼Œä»¥ <a href=\"https://github.com/Ziv-Barber/officegen\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">officegen</a> ä½œç‚º React Component çš„ host environmentï¼Œè®“æˆ‘å€‘èƒ½ç”¨æ’°å¯« React çš„æ–¹å¼ä¾†è£½ä½œ pptx æŠ•å½±ç‰‡ï¼</p>\n<h1 id=\"react-reconciliation-èˆ‡-renderer\" style=\"position:relative;\"><a href=\"#react-reconciliation-%E8%88%87-renderer\" aria-label=\"react reconciliation èˆ‡ renderer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React Reconciliation èˆ‡ Renderer</h1>\n<p>React çš„æ¶æ§‹ä¸­æœ‰å…©å€‹ä¸»è¦çš„é‡å¿ƒï¼Œ<strong>reconciliation</strong> èˆ‡ <strong>rendering</strong>ã€‚<strong>reconciliation</strong> æ˜¯ React ç”¨ä¾†æ‰¾å‡ºç‹€æ…‹æ”¹è®Šå‰å¾Œï¼Œå…¶ UI æ¨¹ç‹€çµæ§‹å·®ç•°çš„æ¼”ç®—æ³•ï¼Œä¸¦æ±ºå®šå“ªä¸€éƒ¨åˆ†çš„ç¯€é»æ˜¯éœ€è¦è¢«æ›´å‹•çš„ï¼Œä¹Ÿå°±æ˜¯å¸‚é¢ä¸Šæµå‚³æ‰€è¬‚ <code class=\"language-text\">Virtual DOM</code> çš„æ ¸å¿ƒæ¦‚å¿µã€‚ä½†å¯¦éš›ä¸Šæ‰€è¬‚ <code class=\"language-text\">Virtual DOM</code> é€™å€‹åè©æœ‰é»èª¤ç”¨ï¼Œå› ç‚ºåœ¨ <strong>reconciliation</strong> çš„æ¼”ç®—æ³•èˆ‡å®šç¾©ä¸­ï¼Œå®Œå…¨ä¸æ¶‰åŠ <strong>DOM</strong>ï¼Œ<strong>DOM</strong> åªæ˜¯ React reconciliation å¯ä»¥å¥—ç”¨çš„å…¶ä¸­ä¸€å€‹ <strong>Host Environment</strong>ï¼Œ<strong>rendering</strong> çš„éç¨‹æœƒä¾æ“š <strong>reconiliation</strong> çš„çµæœï¼Œæ­é…æ‰€åœ¨çš„ <strong>Host Environment</strong> ä¾†æ¸²æŸ“å‡ºç›¸å°æ‡‰çš„ç•«é¢ï¼Œé€™å°±æ˜¯ <strong>Renderer</strong> æ‰€è² è²¬çš„ã€‚ä¾‹å¦‚ <code class=\"language-text\">React-Native</code> å°±æ˜¯ <strong>Host Environment</strong> ç‚º iOSã€Android å¹³å°çš„ä¸€ç¨® Rendererï¼Œç•¶ç„¶ <code class=\"language-text\">react-dom</code> ä¹Ÿæ˜¯ã€‚</p>\n<p>é€™å€‹æ¶æ§‹è€æ—©å°±å­˜åœ¨æ–¼ React çš„æ ¸å¿ƒä¸­ï¼Œç•¶åˆ Fiber æ¶æ§‹å°±æ˜¯åœ¨æ”¹å–„ <strong>reconciliation</strong> çš„å¯¦ä½œæ–¹å¼ï¼ˆç•¶ç„¶ä¹Ÿæœ‰å½±éŸ¿ renderer çš„å¯¦ä½œï¼‰ï¼Œä¹Ÿæœ‰è¨±å¤šæ–‡ç« åœ¨æ¢è¨èˆ‡èªªæ˜ã€‚</p>\n<p>åªæ˜¯è¼ƒå°‘ç‚ºäººçŸ¥çš„æ˜¯ï¼ŒRect å…¶å¯¦æœ‰ä¸€å€‹ <code class=\"language-text\">react-reconciler</code> çš„å¥—ä»¶å¯ä»¥ä½¿ç”¨ï¼Œå¹«ä½ è™•ç†å¥½ reconciliation çš„éƒ¨åˆ†ï¼Œæä¾›ä¸€äº›ä»‹é¢è®“ä½ æ ¹æ“šæƒ³è¦çš„ host environment å¯¦ä½œ renderingï¼Œè€Œé€™å°±æ˜¯ç‚ºä»€éº¼æœ‰äººèƒ½å®¢è£½åŒ–å„ç¨® rendererï¼Œè®“å¤§å®¶èƒ½ç”¨ React æ’°å¯« VRã€Command Line æˆ–æ˜¯ ç­‰ç­‰ï¼ˆå¯åƒè€ƒæ­¤ <a href=\"https://github.com/chentsulin/awesome-react-renderer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">awesome list</a>ï¼‰ã€‚</p>\n<p>é—œæ–¼ Fiber æ¶æ§‹çš„è§€å¿µä»‹ç´¹ï¼Œæ¨è–¦å¤§å®¶å»çœ‹ <a href=\"https://twitter.com/acdlite?lang=en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Andrew Clark</a> çš„<a href=\"https://github.com/acdlite/react-fiber-architecture\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ–‡ç« </a>ï¼Œé›–ç„¶æ˜¯å¾ˆä¹…ä¹‹å‰å¯«çš„ï¼Œä½†æˆ‘è¦ºå¾—è§€å¿µé—¡è¿°çš„å¾ˆæ¸…æ™°æ˜“æ‡‚ã€‚</p>\n<p>ç°¡å–®ä¾†èªªï¼Œæ‰€è¬‚çš„ fiber æ˜¯åœ¨ reconciliation ä¸­çš„ä¸€å€‹å·¥ä½œå–®ä½ï¼Œä¸€å€‹ fiber æ˜¯ä¸€å€‹ JavaScript objectï¼ŒåŒ…å«è‘—ä¸€å€‹ Component çš„è³‡è¨Šï¼Œå…¶è¼¸å…¥èˆ‡è¼¸å‡ºï¼Œåœ¨æ¥ä¸‹ä¾†çš„å¯¦ä½œä¸­ï¼Œæˆ‘å€‘æœƒåˆ©ç”¨ <code class=\"language-text\">react-reconciler</code> èˆ‡ fiber æ‰€æä¾›çš„ Component è³‡è¨Šä¾†å¯¦ä½œä¸€å€‹å®¢è£½åŒ– PPTXRendererã€‚</p>\n<h2 id=\"æœ€çµ‚çš„çµæœ\" style=\"position:relative;\"><a href=\"#%E6%9C%80%E7%B5%82%E7%9A%84%E7%B5%90%E6%9E%9C\" aria-label=\"æœ€çµ‚çš„çµæœ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æœ€çµ‚çš„çµæœ</h2>\n<p>å…ˆçœ‹ä¸€ä¸‹æœ€çµ‚çš„æˆå“åŠŸèƒ½ï¼Œé€™æ¨£åœ¨èªªæ˜å¾Œé¢çš„å¯¦ä½œæ™‚ï¼Œæ‡‰è©²æœƒæ¯”è¼ƒæœ‰æ„Ÿå—ã€‚</p>\n<p>é€™æ¬¡ç¯„ä¾‹ä¸­æ‰€å®¢è£½åŒ–çš„ PPTXRenderer å¯ä»¥è®“æˆ‘å€‘ä½¿ç”¨å…©å€‹ Componentï¼š<code class=\"language-text\">&lt;Slide></code> èˆ‡ <code class=\"language-text\">&lt;Text></code> ä¾†ç”¢ç”ŸæŠ•å½±ç‰‡ã€‚</p>\n<p>ä¾‹å¦‚åœ¨ <code class=\"language-text\">App.js</code> ä¸­é€™æ¨£å¯«ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Text<span class=\"token punctuation\">,</span> Slide<span class=\"token punctuation\">,</span> render <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../src'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>React<span class=\"token punctuation\">.</span>Fragment<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Slide<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text<span class=\"token operator\">></span>Slide <span class=\"token number\">1</span> ğŸ˜ ğŸ˜<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Slide<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Slide<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text<span class=\"token operator\">></span>Slide <span class=\"token number\">2</span> ğŸ˜ ğŸ˜<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Slide<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>React<span class=\"token punctuation\">.</span>Fragment<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/text.pptx</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æœƒç”¢ç”Ÿé€™æ¨£çš„æŠ•å½±ç‰‡ï¼š</p>\n<p><img src=\"https://static.coderbridge.com/img/ArvinH/29dd4226b9c0462bb75ef278795ee337.gif\" alt=\"demo\"></p>\n<blockquote>\n<p>TL;DR\nç¯‡å¹…æœ‰é»é•·ï¼Œå¾ˆå¤šç¨‹å¼ç¢¼ï¼Œè‹¥ä¸æƒ³çœ‹æ–‡ç« ï¼Œå¯ä»¥ç›´æ¥åƒè€ƒç¨‹å¼ç¢¼ <a href=\"https://github.com/ArvinH/reapptx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">reapptx</a></p>\n</blockquote>\n<h1 id=\"custom-renderer-åŸºæœ¬çµæ§‹\" style=\"position:relative;\"><a href=\"#custom-renderer-%E5%9F%BA%E6%9C%AC%E7%B5%90%E6%A7%8B\" aria-label=\"custom renderer åŸºæœ¬çµæ§‹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Custom Renderer åŸºæœ¬çµæ§‹</h1>\n<p><code class=\"language-text\">react-reconciler</code> æä¾›çš„å‡½å¼å¯ä»¥æ¥å—ä¸€å€‹ <strong>host config object</strong>ï¼Œä¸¦å›å‚³ renderer instanceã€‚å…¶ä¸­ <strong>host config object</strong> æ˜¯æˆ‘å€‘ç”¨ä¾†å®šç¾©èˆ‡å¯¦ä½œåœ¨ renderer çš„ lifecycle ä¸­æ‰€éœ€è¦çš„ methodï¼ŒåŒ…å« <code class=\"language-text\">update</code>ã€<code class=\"language-text\">append children</code>ã€<code class=\"language-text\">remove children</code> ç­‰ç­‰ï¼Œé€™é‚Šæ‰€è™•ç†çš„é€šé€šéƒ½æ˜¯ <strong>host environment</strong> åº•ä¸‹çš„ componentsï¼Œå…¶é¤˜ non-host çš„ components éƒ½æœƒç”± React è² è²¬ç®¡ç†ã€‚</p>\n<p>å…ˆçœ‹çœ‹ <code class=\"language-text\">react-reconciler</code> Readme å…§æä¾›çš„ç¯„ä¾‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> Reconciler <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-reconciler\"</span>\n\n<span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// You'll need to implement some methods here.</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> MyRenderer <span class=\"token operator\">=</span> <span class=\"token function\">Reconciler</span><span class=\"token punctuation\">(</span>HostConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> RendererPublicAPI <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element<span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> MyRendererContainer <span class=\"token operator\">=</span> MyRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">createContainer</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Call MyRenderer.updateContainer() to schedule changes on the roots.</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> RendererPublicAPI<span class=\"token punctuation\">;</span></code></pre></div>\n<p>é‚„è¨˜å¾—ä½ ä¸€èˆ¬é–‹ç™¼ react app æ™‚ï¼Œéƒ½æœƒå‘¼å« <code class=\"language-text\">ReactDOM.render</code> ä¾†å°‡ä½ çš„ root component æ›è¼‰åˆ°ä¸€å€‹ <code class=\"language-text\">div</code> ä¸Šé ­å—ï¼Ÿä¸Šè¿°ç¨‹å¼ç¢¼ä¸­æ‰€ export çš„ <code class=\"language-text\">RenderPublicAPI.render</code> å°±ç­‰åŒæ–¼ <code class=\"language-text\">ReactDOM.render</code>ã€‚</p>\n<p>è€Œåœ¨ <code class=\"language-text\">render</code> å‡½å¼ä¸­ï¼Œç”± <code class=\"language-text\">HostConfig</code> èˆ‡ <code class=\"language-text\">react-conciler</code> æ‰€å»ºæ§‹çš„ custom renderer å°±å¯ä»¥å°‡ React component æ‡‰ç”¨åœ¨ä¸åŒçš„ host environment ä¸­ã€‚</p>\n<p>è‡³æ–¼å¦‚ä½•å¯¦ä½œ <code class=\"language-text\">HostConfig</code>ï¼Œé€™é‚Šæœ‰<a href=\"https://github.com/facebook/react/blob/master/packages/react-reconciler/src/forks/ReactFiberHostConfig.custom.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®Œæ•´çš„ method åˆ—è¡¨</a>ï¼Œä½ ä¹Ÿå¯ä»¥åƒè€ƒ <a href=\"https://github.com/facebook/react/blob/master/packages/react-dom/src/client/ReactDOMHostConfig.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">react-dom</code></a> æˆ– <a href=\"https://github.com/facebook/react/blob/master/packages/react-native-renderer/src/ReactNativeHostConfig.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">react-native</code> çš„ HostConfig</a>ã€‚</p>\n<p>ä¸éå¾åˆ—è¡¨ä¸­æ´‹æ´‹ç‘ç‘ä¸€å † interfaceï¼Œåˆ°åº•å“ªäº›æ˜¯é‡è¦çš„å‘¢ï¼Ÿ</p>\n<p>æˆ‘å€‘å¯ä»¥åˆ©ç”¨ä¸€å€‹æ–¹å¼ä¾†æ¸¬è©¦ï¼Œå…ˆæŠŠåŸæœ¬ä½¿ç”¨ <code class=\"language-text\">react-dom</code> çš„ renderer æ›æˆä½ è‡ªå·±çš„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">import React from \"react\";\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>// import ReactDOM from \"react-dom\";\n<span class=\"token prefix inserted\">+</span>import MyRenderer from \"./MyRenderer\";\n</span>\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\n<span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span>ReactDOM.render(\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>MyRenderer.render(\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> &lt;React.StrictMode>\n<span class=\"token prefix unchanged\"> </span>   &lt;App />\n<span class=\"token prefix unchanged\"> </span> &lt;/React.StrictMode>,\n<span class=\"token prefix unchanged\"> </span> rootElement\n</span>);</code></pre></div>\n<p>è€Œåœ¨ <code class=\"language-text\">MyRenderer.js</code> ä¸­ï¼Œå°‡å„å€‹å‡½å¼ä¸€å€‹ä¸€å€‹æ”¾ä¸Šå»ï¼Œä¸¦åŠ ä¸Š logï¼Œç›´åˆ°ä½ çš„é é¢æ²’æœ‰å‡ºç¾ errorï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> Reconciler <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-reconciler\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">appendInitialChild</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"appendInitialChild\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">createInstance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"createInstance\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">createTextInstance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"createTextInstance\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ... ä¾æ­¤é¡æ¨å°‡å„ç¨® method éƒ½æ”¾ä¸Šå»ï¼Œä¸¦åŠ ä¸Š log</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> MyRenderer <span class=\"token operator\">=</span> <span class=\"token function\">Reconciler</span><span class=\"token punctuation\">(</span>HostConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> RendererPublicAPI <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element<span class=\"token punctuation\">,</span> container</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// render function ä¸­çš„å…§å®¹å‰‡åƒè€ƒ react-conciler çš„ readme</span>\n    <span class=\"token comment\">// å°‡ renderer çš„ container å‰µå»ºå‡ºä¾†ï¼Œä¸¦å°‡å‚³å…¥çš„ element update ä¸Šå»ã€‚</span>\n    <span class=\"token keyword\">const</span> MyRendererContainer <span class=\"token operator\">=</span> MyRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">createContainer</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    MyRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">updateContainer</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> MyRendererContainer<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> RendererPublicAPI<span class=\"token punctuation\">;</span></code></pre></div>\n<p>é€™æ™‚ä½ çš„é é¢æ‡‰è©²æœƒæ˜¯ç©ºç™½çš„ï¼Œå› ç‚ºä½ æ‰€æœ‰ renderer çš„ method éƒ½å°šæœªå¯¦ä½œã€‚ä½†å¦‚æ­¤ä¸€ä¾†å°±èƒ½è§€å¯Ÿå‡ºåœ¨ä½ çš„ <code class=\"language-text\">&lt;App /></code> component ä¸­ï¼Œrenderer æœƒèª¿ç”¨å“ªäº›å‡½æ•¸ã€åŸ·è¡Œé †åºç‚ºä½•ã€å€‹åˆ¥çš„åƒæ•¸æ˜¯ä»€éº¼ã€‚</p>\n<p>é€™é‚Šçµ¦å¤§å®¶ä¸€å€‹ codesandbox çš„ä¾‹å­æŠŠç©ï¼š</p>\n<iframe\n  src=\"https://codesandbox.io/embed/youthful-shaw-cinj5?fontsize=14&hidenavigation=1&theme=dark\"\n  style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n  title=\"custom-react-renderer-check-func-order\"\n  allow=\"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb\"\n  sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<h2 id=\"å¯¦éš›çš„-host-config\" style=\"position:relative;\"><a href=\"#%E5%AF%A6%E9%9A%9B%E7%9A%84-host-config\" aria-label=\"å¯¦éš›çš„ host config permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å¯¦éš›çš„ Host Config</h2>\n<p>åˆæ­¥äº†è§£ Renderer çš„çµæ§‹èˆ‡éœ€è¦å¡«å…¥çš„ Host Config å¾Œï¼Œæˆ‘å€‘å¯ä»¥ä¾†å¯¦ä½œéœ€è¦çš„ methodï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> Reconciler <span class=\"token keyword\">from</span> <span class=\"token string\">'react-reconciler'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> hostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">appendInitialChild</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parentInstance<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>parentInstance<span class=\"token punctuation\">.</span>appendChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      parentInstance<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">createInstance</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\">type<span class=\"token punctuation\">,</span>\n    props<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    hostContext<span class=\"token punctuation\">,</span>\n    internalInstanceHandle</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">COMPONENTS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function-variable function\">ROOT</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PPTXDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">TEXT</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>rootContainerInstance<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">SLIDE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Slide</span><span class=\"token punctuation\">(</span>rootContainerInstance<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">COMPONENTS</span><span class=\"token punctuation\">[</span>type<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token constant\">COMPONENTS</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">getRootHostContext</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">instance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> \n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">getChildHostContext</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parentHostContext<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> rootContainerInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">shouldSetTextContent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">createTextInstance</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\">text<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    hostContext<span class=\"token punctuation\">,</span>\n    internalInstanceHandle</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> text<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">finalizeInitialChildren</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\">parentInstance<span class=\"token punctuation\">,</span>\n    type<span class=\"token punctuation\">,</span>\n    props<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    hostContext</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">getPublicInstance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">inst</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> inst<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">prepareForCommit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rootcontainerInfo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* noop */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">resetAfterCommit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rootcontainerInfo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* noop */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">appendChildToContainer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">container<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* noop */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">removeChildFromContainer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">container<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* noop */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function-variable function\">now</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  supportsMutation<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> PPTXRenderer <span class=\"token operator\">=</span> <span class=\"token function\">Reconciler</span><span class=\"token punctuation\">(</span>hostConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æœ‰è¨±å¤š function æ˜¯å¿…è¦ä½†æˆ‘å€‘çš„ç¯„ä¾‹ä¸­ç”¨ä¸è‘—çš„ï¼Œæ‰€ä»¥ç•™ç©ºï¼Œä¸éæˆ‘é‚„æ˜¯ä¸€å€‹ä¸€å€‹èªªæ˜ä»–å€‘å„è‡ªçš„åŠŸèƒ½ç‚ºä½•ã€‚</p>\n<ul>\n<li><code class=\"language-text\">appendInitialChild(parentInstance, child)</code></li>\n</ul>\n<p>ç•¶ renderer åœ¨ç¹ªè£½ component çš„æ™‚å€™ï¼Œæœƒé€éæ­¤å‡½å¼å°‡è©² component çš„ child component append ä¸Šå»ï¼Œæ‰€ä»¥åœ¨é€™å€‹å‡½å¼ä¸­ï¼Œä½ å¿…é ˆå¯¦ä½œå¦‚ä½•å°‡ä½ æƒ³è¦ render çš„ component child åŠ åˆ°å…¶ parent component ä¸Šé ­ã€‚ä»¥æˆ‘å€‘çš„ç¯„ä¾‹ç‚ºä¾‹ï¼Œæ˜¯æœƒåœ¨æ¯å€‹ component éƒ½å¯¦ä½œä¸€å€‹ <code class=\"language-text\">appendChild</code> å‡½å¼ï¼Œåœ¨é€™é‚Šæˆ‘å€‘å°±åªéœ€è¦åŸ·è¡Œ <code class=\"language-text\">parentInstance.appendChild(child);</code> å³å¯ã€‚</p>\n<ul>\n<li><code class=\"language-text\">createInstance(\ntype,\nprops,\nrootContainerInstance,\nhostContext,\ninternalInstanceHandle\n)</code></li>\n</ul>\n<p>çœ‹åå­—å°±çŸ¥é“æ˜¯åœ¨å‰µå»º Component instance çš„å‡½å¼ï¼Œæœƒå‚³å…¥ç•¶å‰ç¯€é»çš„ typeã€è©²ç¯€é»çš„ propsã€æ ¹ç¯€é»çš„å¯¦ä¾‹ã€host ç’°å¢ƒçš„ contextï¼Œä»¥åŠä¸€å€‹å«åš internalInstanceHandle çš„ç‰©ä»¶ã€‚</p>\n<p>å…¶ä»–åƒæ•¸éƒ½å¾ˆå¥½æ‡‚ï¼Œé€™å€‹ internalInstanceHandle å…¶å¯¦å°±æ˜¯å°æ‡‰æ­¤ç¯€é»çš„ fiberã€‚æˆ‘å€‘å‰é¢æœ‰èªªéï¼Œfiber ä»£è¡¨çš„æ˜¯æ•´å€‹ reconciler éç¨‹ä¸­çš„ä¸€å€‹å·¥ä½œå–®ä½ï¼Œè€Œæ¯å€‹ component éƒ½æœ‰å°æ‡‰çš„å…©ç¨® fiberï¼Œåˆ†åˆ¥æ˜¯å·²ç¶“å®Œæˆå·¥ä½œï¼Œå¯ä»¥render çš„ flushed fiber è·Ÿå°šæœªè™•ç†å®Œçš„ work in progress fiberï¼Œfiber ä¸­åŒ…å«è¨±å¤š component çš„è³‡è¨Šã€‚åŸºæœ¬ä¸Šé€™å€‹ç¯„ä¾‹ä¸­ï¼Œå‰é¢å…©å€‹åƒæ•¸å°±è¶³å¤ äº†ã€‚æƒ³äº†è§£æ›´å¤š fiber çš„å…§å®¹è«‹åƒè€ƒ <a href=\"https://github.com/acdlite/react-fiber-architecture\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">react-fiber-architecture</a>ã€‚</p>\n<p>åœ¨é€™å€‹ç¯„ä¾‹ä¸­ï¼Œæˆ‘å€‘åªéœ€è¦é€éå‚³å…¥çš„ type ä¾†æ±ºå®šæˆ‘å€‘è¦å°æ‡‰ç”¢ç”Ÿå“ªå€‹ component çš„å¯¦ä¾‹ï¼Œå¾Œé¢æœƒåœ¨èªªæ˜æ¯å€‹ component çš„å¯¦ä½œï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token constant\">COMPONENTS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">ROOT</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PPTXDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">TEXT</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>rootContainerInstance<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">SLIDE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Slide</span><span class=\"token punctuation\">(</span>rootContainerInstance<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t\n<span class=\"token keyword\">return</span> <span class=\"token constant\">COMPONENTS</span><span class=\"token punctuation\">[</span>type<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token constant\">COMPONENTS</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">getRootHostContext(instance)</code></li>\n</ul>\n<p>é€™å€‹å‡½å¼è®“ä½ èƒ½å¤ èˆ‡ Host Config ä¸­çš„å…¶ä»– method å…±äº« contextã€‚åŸºæœ¬ä¸Šæœƒå‚³å…¥ root component instance ç•¶åƒæ•¸ã€‚\nåœ¨é€™ç¯„ä¾‹ä¸­ï¼Œä¸¦æ²’æœ‰éœ€è¦ share ä»»ä½• contextï¼Œæ‰€ä»¥å›å‚³å€‹ç©ºç‰©ä»¶å³å¯ã€‚</p>\n<ul>\n<li><code class=\"language-text\">getChildHostContext(parentHostContext, type, rootContainerInstance)</code></li>\n</ul>\n<p>èˆ‡ä¸Šä¸€å€‹å‡½å¼é›·åŒï¼Œè®“ä½ èƒ½å¤ åˆ†äº« context çµ¦ç•¶ä¸‹ç¯€é»çš„ childrenï¼Œä¹Ÿèƒ½å–å¾— parent çš„ contextã€‚æˆ‘å€‘ä¸€æ¨£ä¸éœ€è¦ç”¨åˆ°ï¼Œæ‰€ä»¥å›å‚³ç©ºç‰©ä»¶ã€‚</p>\n<ul>\n<li><code class=\"language-text\">shouldSetTextContent(type, props)</code></li>\n</ul>\n<p>å°±æˆ‘çš„ç†è§£ï¼Œé€™å€‹å‡½æ•¸çš„ç›®çš„å¯ä»¥ç°¡å–®èªªæ˜¯è®“ä½ æœ‰æ©Ÿæœƒåˆ¤æ–·æ˜¯å¦è¦å°‡ traversal åœæ­¢åœ¨ç•¶å‰ç¯€é»ã€‚é€šå¸¸æˆ‘å€‘çš„ leaf node éƒ½æœƒæ˜¯ text nodeï¼Œè‹¥åœ¨æ­¤å‡½å¼å…§ä½ å›å‚³ trueï¼Œå‰‡ reconciler æœƒåœæ­¢ç¹¼çºŒå¾€ä¸‹ traverseï¼Œä»–æœƒåœæ­¢åœ¨é€™å±¤ï¼Œç„¶å¾Œæ¥è‘—å‘¼å« <code class=\"language-text\">createInstance</code> å»å‰µå»ºå¯¦ä¾‹ã€‚</p>\n<p>è‹¥æ˜¯è¨­ç‚º falseï¼Œreconciler æ¾¤æœƒç¹¼çºŒéè¿´ä¸‹å»ï¼Œç›´åˆ°æ­¤å‡½å¼å›å‚³ trueï¼Œæˆ–æ˜¯çœŸçš„é”åˆ°äº† leaf text nodeã€‚è‹¥æ˜¯é”åˆ° leaf text nodeï¼Œå°±æœƒå‘¼å«å¦å€‹å‡½å¼ - <code class=\"language-text\">createTextInstance</code>ã€‚</p>\n<p>ä»¥æˆ‘å€‘çš„ç¯„ä¾‹ä¾†èªªï¼Œæˆ‘å€‘ä¸åƒ <code class=\"language-text\">react-dom</code> éœ€è¦è€ƒæ…® <code class=\"language-text\">textarea</code> æˆ–æ˜¯ <code class=\"language-text\">dangerouslySetInnerHTML</code> ç­‰æƒ…æ³ï¼Œéƒ½ç›´æ¥å›å‚³ false å³å¯ã€‚</p>\n<ul>\n<li><code class=\"language-text\">createTextInstance(text, rootContainerInstance, hostContext, internalInstanceHandle)</code></li>\n</ul>\n<p>é¡§åæ€ç¾©å°±æ˜¯å‰µå»º Text instanceï¼Œé€™å€‹ Text æŒ‡çš„æ˜¯ä½ åœ¨ component ä¸­ç›´æ¥æ’°å¯«çš„ string éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>Text<span class=\"token operator\">></span> Taiwan No<span class=\"token punctuation\">.</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span></code></pre></div>\n<p><code class=\"language-text\">Taiwan No.1</code> å°±æ˜¯é€™é‚Šè¦è™•ç†çš„ Text instanceã€‚åœ¨ <code class=\"language-text\">react-dom</code> ä¸­å°±æ˜¯è¦å‰µå»ºä¸€å€‹ <code class=\"language-text\">textNode</code>ï¼Œè€Œåœ¨é€™é‚Šæˆ‘å€‘ç›´æ¥å›å‚³ Text æœ¬èº«ï¼Œè®“ä»–çš„çˆ¶ç¯€é» <code class=\"language-text\">&lt;Text></code> ä¾†è™•ç†ã€‚\né™¤äº†ç¬¬ä¸€å€‹åƒæ•¸ text å¤–ï¼Œã„§æ¨£æœƒæœ‰ root component instanceã€host context è·Ÿ internalInstanceHandle(fiber)ï¼Œã„§æ¨£æˆ‘å€‘åªæœƒç”¨åˆ°ç¬¬ä¸€å€‹åƒæ•¸ textã€‚</p>\n<ul>\n<li><code class=\"language-text\">finalizeInitialChildren(\nparentInstance,\ntype,\nprops,\nrootContainerInstance,\nhostContext\n)</code></li>\n</ul>\n<p>é€™å€‹å‡½å¼ä¸»è¦ç›®çš„åœ¨æ–¼å‘Šè¨´ reconciler éœ€ä¸éœ€è¦åœ¨ç•¶å‰çš„ component ä¸Šå‘¼å« <code class=\"language-text\">commitMount()</code>ï¼Œä¹Ÿå°±æ˜¯éœ€ä¸éœ€è¦ç­‰åˆ°æ‰€æœ‰ element éƒ½è¢« rendered ä»¥å¾Œæ‰åŸ·è¡ŒæŸäº›äº‹æƒ…ã€‚ä¾‹å¦‚ input elements çš„ autofocusï¼Œå°±éœ€è¦ç­‰ component mount ä»¥å¾Œæ‰èƒ½è¢«å‘¼å«ã€‚\nåœ¨æˆ‘å€‘çš„ç¯„ä¾‹ä¸­ï¼Œä¸éœ€è¦åšé€™äº›äº‹ï¼Œæ‰€ä»¥å°±å›å‚³ false å³å¯ã€‚è‹¥æ˜¯ä½ å›å‚³ trueï¼Œé‚£å°±å¿…é ˆä¹Ÿå¯¦ä½œ <code class=\"language-text\">commitMount</code>ã€‚</p>\n<ul>\n<li><code class=\"language-text\">getPublicInstance(ins)</code></li>\n</ul>\n<p>åªæ˜¯å€‹å…¬é–‹ä»‹é¢è®“ä½ èƒ½å–å¾— instanceã€‚</p>\n<ul>\n<li><code class=\"language-text\">prepareForCommit(rootcontainerInfo)</code></li>\n</ul>\n<p>ç•¶ä½ çš„ç¯€é»å¯¦ä¾‹éƒ½ç”Ÿæˆå¾Œï¼Œå³å°‡æ›è¼‰åˆ°æ ¹ç¯€é»æ™‚ï¼Œå¯ä»¥åœ¨é€™å€‹å‡½å¼å…§é€²è¡Œä¸€äº›æº–å‚™å·¥ä½œï¼Œä¾‹å¦‚çµ±è¨ˆéœ€è¦ autofucs çš„ç¯€é»ç­‰ç­‰ï¼Œä»¥æˆ‘å€‘çš„ç¯„ä¾‹ä¾†èªªä¸éœ€è¦åšä»»ä½•äº‹ï¼Œç•™ç©ºã€‚</p>\n<ul>\n<li><code class=\"language-text\">resetAfterCommit(rootcontainerInfo)</code></li>\n</ul>\n<p>ç•¶ reconciliation çµæŸï¼Œinmemory tree éƒ½æ›è¼‰åˆ° host root element æ™‚ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨é€™å€‹å‡½å¼åŸ·è¡Œä»»ä½•å¾ŒçºŒå‹•ä½œï¼Œåƒæ˜¯å›è¦†ä¸€äº› event ç‹€æ…‹ç­‰ç­‰ã€‚</p>\n<ul>\n<li><code class=\"language-text\">appendChildToContainer(container, child)</code></li>\n<li><code class=\"language-text\">removeChildFromContainer(container, child)</code></li>\n<li><code class=\"language-text\">supportsMutation</code></li>\n</ul>\n<p>é€™å¹¾å€‹å¯ä»¥ä¸€èµ·çœ‹ï¼Œ<code class=\"language-text\">supportsMutation</code> ä»£è¡¨çš„æ˜¯ä½ çš„ host environment æ”¯ä¸æ”¯æ´ä¸€äº›å¯ä»¥æ›´æ”¹çµæ§‹çš„ APIï¼Œåƒæ˜¯ DOM å…§çš„ <code class=\"language-text\">appendChild</code>ï¼Œè‹¥æœ‰å‰‡å›å‚³ trueï¼Œä¸¦å¯¦ä½œ <code class=\"language-text\">appendChildToContainer</code> èˆ‡ <code class=\"language-text\">removeChildFromContainer</code>ï¼Œè®“ renderer çŸ¥é“ç•¶ host element åŸ·è¡Œ mutative api æ™‚è©²å¦‚ä½•è™•ç†ã€‚\nåœ¨æˆ‘å€‘çš„ç¯„ä¾‹ä¸­æˆ‘å€‘ä¸éœ€è¦ç”¨åˆ°é€™äº›ï¼Œä½†å› ç‚ºé€™æ‡‰è©²æ˜¯è »å®¹æ˜“ç”¨åˆ°çš„ï¼Œæ‰€ä»¥æˆ‘è¨­ç‚º true ä¸¦åœ¨é€™é‚Šèªªæ˜ä¸€ä¸‹ã€‚</p>\n<ul>\n<li><code class=\"language-text\">now()</code></li>\n</ul>\n<p>host config å…§æœ€å¾Œä¸€å€‹å‡½å¼ <code class=\"language-text\">now()</code>ï¼Œæ˜¯ reconciler ç”¨ä¾†è¨ˆç®—ç•¶å‰æ™‚é–“çš„ï¼Œæˆ‘å€‘å¯ä»¥ç•™ç©ºï¼Œæˆ–æ˜¯æä¾› <code class=\"language-text\">Date.now</code>ã€‚</p>\n<h2 id=\"å°æ‡‰-custom-renderer-çš„-component\" style=\"position:relative;\"><a href=\"#%E5%B0%8D%E6%87%89-custom-renderer-%E7%9A%84-component\" aria-label=\"å°æ‡‰ custom renderer çš„ component permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å°æ‡‰ Custom Renderer çš„ component</h2>\n<p>çµ‚æ–¼èµ°å®Œä¸€é host configï¼Œæ¥ä¸‹ä¾†å¯ä»¥çœ‹çœ‹æˆ‘å€‘çš„ component è©²æ€éº¼å¯¦ä½œã€‚</p>\n<p>åœ¨æˆ‘å€‘çš„ <code class=\"language-text\">createInstance()</code> ä¸­ï¼Œæˆ‘å€‘æ ¹æ“šå‚³å…¥çš„ fiber type ä¾†æ±ºå®šè¦å¯¦ä¾‹åŒ–å“ªå€‹ componentï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">createInstance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">COMPONENTS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">ROOT</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PPTXDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">TEXT</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span>rootContainerInstance<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">SLIDE</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Slide</span><span class=\"token punctuation\">(</span>rootContainerInstance<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token constant\">COMPONENTS</span><span class=\"token punctuation\">[</span>type<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token constant\">COMPONENTS</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<h4 id=\"root-component---pptxdocument\" style=\"position:relative;\"><a href=\"#root-component---pptxdocument\" aria-label=\"root component   pptxdocument permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Root Component - PPTXDocument</h4>\n<p>Root component åœ¨ <code class=\"language-text\">react-dom</code> å…§å¯ä»¥èªªæ˜¯ <code class=\"language-text\">document</code> ç‰©ä»¶ï¼Œè€Œåœ¨æˆ‘å€‘çš„ PPTXRenderer ä¸­ï¼Œè©²è§’è‰²å°±æ˜¯ <code class=\"language-text\">new officegen('pptx')</code> ç‰©ä»¶ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PPTXDocument</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pptx <span class=\"token operator\">=</span> <span class=\"token function\">officegen</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pptx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è€Œæ­¤ç‰©ä»¶æœƒè¢«ç•¶æˆ <code class=\"language-text\">rootContainerInstance</code> è¢«å‚³åˆ°å…¶ä»– host config çš„å‡½å¼ä¸­ã€‚</p>\n<h4 id=\"slide-component\" style=\"position:relative;\"><a href=\"#slide-component\" aria-label=\"slide component permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Slide Component</h4>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Slide</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">root<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>root <span class=\"token operator\">=</span> root<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>slideInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span>pptx<span class=\"token punctuation\">.</span><span class=\"token function\">makeNewSlide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">child</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ä¾æ“šä¸åŒ Host environment ä¾†æ±ºå®šè¦å¦‚ä½•å¯¦ä½œ</span>\n    <span class=\"token comment\">// åœ¨ react-dom ä¸­ï¼Œå¯èƒ½å°±æ˜¯ document.appendChild(child)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'TEXT'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// render the text node</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>slideInstance<span class=\"token punctuation\">.</span><span class=\"token function\">addText</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Slide component æœƒå–å¾— root instanceï¼Œä¸¦å‘¼å« <code class=\"language-text\">makeNewSlide()</code> ä¾†å‰µå»º slideï¼ˆé€™æ˜¯å±¬æ–¼ <code class=\"language-text\">officegen</code> çš„ APIï¼‰ã€‚</p>\n<p>ç„¶å¾Œæˆ‘å€‘éœ€è¦å¯¦ä½œ <code class=\"language-text\">appendChild(child)</code>ï¼Œå› ç‚ºæˆ‘å€‘å¸Œæœ›èƒ½é€éä»¥ä¸‹çš„æ–¹å¼ä¾†å‰µå»º slidesï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>Slide<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Text<span class=\"token operator\">></span>Slide <span class=\"token number\">1</span> ğŸ˜<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Slide<span class=\"token operator\">></span></code></pre></div>\n<p>èƒ½æ¥æ”¶ä¸€å€‹ <code class=\"language-text\">&lt;Text></code> component ç•¶å­ç¯€é»ä¾† render Text åˆ° slide ä¸Šï¼Œæˆ‘å€‘ç”¨ <code class=\"language-text\">officegen</code> æä¾›çš„ <code class=\"language-text\">addText</code> ä¾†å°‡ <code class=\"language-text\">child.content</code> ç¹ªè£½ä¸Šå»ã€‚æ­¤å‡½å¼æœƒè¢« <code class=\"language-text\">appendInitialChild</code> å‘¼å«ã€‚</p>\n<h4 id=\"text-component\" style=\"position:relative;\"><a href=\"#text-component\" aria-label=\"text component permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Text Component</h4>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Text</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">root<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">'TEXT'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>content <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">child</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> child <span class=\"token operator\">===</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>content <span class=\"token operator\">=</span> child<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åŸºæœ¬çµæ§‹ä¸€æ¨£ï¼Œåªæ˜¯åœ¨ <code class=\"language-text\">appendChild</code> ä¸­ï¼Œæˆ‘å€‘ä¸ç”¨ append ä»»ä½• childï¼Œåä¹‹ï¼Œæˆ‘å€‘éœ€è¦å°‡ text component æ”¶åˆ°çš„ text child å­˜å…¥ä¸€å€‹ content è®Šæ•¸ï¼Œè®“å…¶ parent(slide component) å¯ä»¥æ¥æ”¶åˆ°ã€‚</p>\n<h4 id=\"æ³¨æ„äº‹é …\" style=\"position:relative;\"><a href=\"#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85\" aria-label=\"æ³¨æ„äº‹é … permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ³¨æ„äº‹é …</h4>\n<p>é›–ç„¶æˆ‘å€‘åœ¨é€™é‚Šéƒ½å‰µå»ºäº† <code class=\"language-text\">Slide</code> èˆ‡ <code class=\"language-text\">Text</code> componentï¼Œä½†æ˜¯åœ¨çœŸæ­£ä½¿ç”¨åœ¨ jsx è£¡é¢æ™‚ï¼ˆä¹Ÿå°±æ˜¯ <code class=\"language-text\">App.js</code>ï¼‰æ˜¯ä¸èƒ½ç›´æ¥ import é€™é‚Šçš„ component ä¾†ä½¿ç”¨çš„ï¼Œæˆ‘å€‘å¯ä»¥å¦å¤–å‰µå»ºä¸€å€‹ string alias çµ¦ <code class=\"language-text\">App.js</code> ä½¿ç”¨ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Aliases for createInstance</span>\n<span class=\"token keyword\">const</span> Text <span class=\"token operator\">=</span> <span class=\"token string\">'TEXT'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Slide <span class=\"token operator\">=</span> <span class=\"token string\">'SLIDE'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>Slide<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Text<span class=\"token operator\">></span>Slide <span class=\"token number\">1</span> ğŸ˜ ğŸ˜<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Text<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Slide<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æˆ‘å€‘ä¸Šè¿°æ‰€æ’°å¯«çš„ Component æœƒåœ¨ reconciler çš„ <code class=\"language-text\">createInstance</code> ä¸­ä¾æ“šé€™é‚Šçš„ alias ä¾†å‰µå»ºå¯¦ä¾‹ã€‚</p>\n<h4 id=\"render-function\" style=\"position:relative;\"><a href=\"#render-function\" aria-label=\"render function permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Render function</h4>\n<p>æœ€å¾Œæˆ‘å€‘è¦å¯¦ä½œ render function ä¾†çœŸæ­£å–ä»£ä¸€èˆ¬çš„ <code class=\"language-text\">ReactDOM.render</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// render component</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">component<span class=\"token punctuation\">,</span> filePath</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// å‰µå»º Root component instance ç•¶æ•´å€‹ react tree çš„ rootã€‚ </span>\n  <span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PPTXDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// å‘¼å« create containerï¼Œè©²å‡½å¼æœƒå›å‚³ä¸€å€‹ flushed fiberï¼ˆå®Œæˆå·¥ä½œçš„ fiberï¼Œä»£è¡¨å¯ä»¥ renderï¼‰</span>\n  <span class=\"token keyword\">const</span> node <span class=\"token operator\">=</span> PPTXRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">createContainer</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// æ¥è‘—é€éå‘¼å« updateContainer ä¾†è¨­å®šä¸€å€‹å¾æ ¹ç¯€é»é–‹å§‹çš„ updateï¼Œæ›´æ–°æ•´å€‹æ¨¹ã€‚</span>\n  PPTXRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">updateContainer</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Officegen generates a output stream and not a file</span>\n  <span class=\"token keyword\">const</span> stream <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">createWriteStream</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Generate a pptx document</span>\n    container<span class=\"token punctuation\">.</span>pptx<span class=\"token punctuation\">.</span><span class=\"token function\">generate</span><span class=\"token punctuation\">(</span>stream<span class=\"token punctuation\">,</span> <span class=\"token function\">Events</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">,</span> resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¨˜å¾—æˆ‘å€‘ä¸€èˆ¬åœ¨å‘¼å« <code class=\"language-text\">ReactDOM.render</code> æ™‚ï¼Œéƒ½æœƒå‚³å…¥å…©å€‹åƒæ•¸å—ï¼Ÿä¸€å€‹æ˜¯æˆ‘å€‘çš„ root componentï¼Œä¸€å€‹å°±æ˜¯è¦æ›è¼‰çš„ dom elementï¼Œè€Œåœ¨æˆ‘å€‘çš„ç¯„ä¾‹ä¸­ï¼Œæˆ‘å€‘ä¸€æ¨£å‚³å…¥ root componentï¼Œä½†ç¬¬äºŒåƒæ•¸çµ¦äºˆçš„æ˜¯è¦ç”¢ç”Ÿçš„ ppt çš„è·¯å¾‘ï¼Œè€Œéè¦æ›è¼‰çš„ elementï¼Œå› ç‚ºæˆ‘å€‘æ˜¯è¦å°‡ react component å¯«å…¥ pptx æª”æ¡ˆã€‚</p>\n<p>æœ€å¾Œåœ¨å›å‚³çš„ Promise function ä¸­ï¼Œæˆ‘å€‘å‘¼å« <code class=\"language-text\">officegen</code> çš„ <code class=\"language-text\">generate</code> å‡½å¼ä¾†å°‡æˆ‘å€‘åœ¨å‰é¢ host config çš„ lifecycle method ä¸­æ‰€é™„åŠ åˆ°æ ¹ç¯€é»çš„å…§å®¹ï¼ˆappendChild çš„éƒ¨åˆ†ï¼‰å¯«å…¥æª”æ¡ˆã€‚</p>\n<p>é€™æ¨£å°±å®Œæˆäº†æˆ‘å€‘çš„ Custom Rendererï¼</p>\n<p>å®Œæ•´ç¨‹å¼ç¢¼åœ¨æ­¤ -> <a href=\"https://github.com/ArvinH/reapptx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">reapptx</a></p>\n<h2 id=\"è£œå……èªªæ˜---update\" style=\"position:relative;\"><a href=\"#%E8%A3%9C%E5%85%85%E8%AA%AA%E6%98%8E---update\" aria-label=\"è£œå……èªªæ˜   update permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è£œå……èªªæ˜ - update</h2>\n<p>é€™æ¬¡çš„ç¯„ä¾‹è£¡é¢ä¸¦æ²’æœ‰éœ€è¦æ›´æ–° Component ç‹€æ…‹ï¼Œå¦‚æœä½ éœ€è¦å¯¦ä½œä¸€å€‹èƒ½è™•ç† state update çš„ custom rendererï¼Œåœ¨ä½ çš„ host config ä¸­ï¼Œé™¤äº† <code class=\"language-text\">appendChildToContainer()</code> å’Œ <code class=\"language-text\">removeChildFromContainer()</code> å¤–ï¼Œé‚„éœ€è¦å¯¦ä½œ <code class=\"language-text\">prepareUpdate()</code> èˆ‡ <code class=\"language-text\">commitUpdate()</code>ã€‚</p>\n<ul>\n<li><code class=\"language-text\">prepareUpdate(instance, type, oldProps, newProps, rootContainerInstance, hostContext)</code></li>\n</ul>\n<p>å¾ä»–å‚³å…¥çš„åƒæ•¸å°±å¯ä»¥çœ‹å‡ºï¼Œä½ å¯ä»¥è—‰ç”± <code class=\"language-text\">oldProps</code> èˆ‡ <code class=\"language-text\">newProps</code> çš„æ¯”è¼ƒä¾†æ±ºå®šæ˜¯å¦è¦é€²è¡Œæ›´æ–°ï¼Œè‹¥ä¸éœ€è¦å°±å›å‚³ nullï¼Œè¦çš„è©±å°±å›å‚³è¦æ›´æ–°çš„ payloadã€‚</p>\n<ul>\n<li><code class=\"language-text\">commitUpdate(instance, updatePayload, type, oldProps, newProps, internalInstanceHandle)</code></li>\n</ul>\n<p>é€™å€‹å‡½å¼å°±æ˜¯è² è²¬æœ€å¾Œå°‡è¦ <code class=\"language-text\">prepareUpdate</code> å›å‚³çš„ update payload å¥—ç”¨åˆ°å¯¦éš› instance ä¸Šã€‚</p>\n<p>é—œæ–¼<strong>æ›´æ–°</strong>çš„å¯¦éš›ä¾‹å­ï¼Œå¯ä»¥åƒè€ƒ <a href=\"https://juejin.im/post/5c31b814f265da612b13bf23#heading-3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">react æ¸²æŸ“å™¨äº†è§£ä¸€ä¸‹</a> é€™ç¯‡æ–‡ç« ï¼Œæœ‰å¯¦éš›çš„ä¾‹å­èˆ‡è©³ç´°ç¨‹å¼ç¢¼è¬›è§£ã€‚</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>ä¸€ä¸å°å¿ƒæ´‹æ´‹ç‘ç‘ç´€éŒ„äº†ä¸€å †ï¼Œä½†é€éè£½ä½œ custom react rendererï¼Œä¸€æ­¥æ­¥æŠŠæ•´å€‹æµç¨‹èˆ‡å…¶ä¸­ç”¨åˆ°çš„å‡½å¼éƒ½é‡æ¸…ç”¨é€”å¾Œï¼Œå°æ–¼ react åœ¨é€²è¡Œ reconciliation èˆ‡ rendering çš„æµç¨‹å¤šäº†ä¸å°‘äº†è§£ï¼Œä¹Ÿä¸å†å° React ç‚ºä»€éº¼èƒ½å¥—ç”¨åœ¨é€™éº¼å¤šä¸åŒçš„ç’°å¢ƒä¸­æ„Ÿåˆ°ç¥ç§˜äº†ï¼Œç®—æ˜¯å¾ˆä¸éŒ¯çš„æ”¶ç©«ï¼æœ‰è€å¿ƒçœ‹å®Œçš„è®€è€…è‹¥ç™¼ç¾éŒ¯èª¤æˆ–æ˜¯ä¸æ¸…æ¥šçš„åœ°æ–¹ï¼Œæ­¡è¿ç•™è¨€å‘ŠçŸ¥æŒ‡æ•™ã€‚</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://www.youtube.com/watch?v=CGpMlWVcHok\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Building a Custom React Renderer</a></li>\n<li><a href=\"https://github.com/nitin42/Making-a-custom-React-renderer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Making-a-custom-React-renderer</a></li>\n<li><a href=\"https://blog.atulr.com/react-custom-renderer-1/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">âš›ï¸ğŸ‘†Beginners guide to React Renderers. How to build your own renderer from scratch?</a></li>\n<li><a href=\"https://juejin.im/post/5c31b814f265da612b13bf23#heading-3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">react æ¸²æŸ“å™¨äº†è§£ä¸€ä¸‹?</a></li>\n<li><a href=\"https://github.com/facebook/react/tree/60016c448bb7d19fc989acd05dda5aca2e124381/packages/react-reconciler\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">facebook/react-reconciler</a></li>\n<li><a href=\"https://github.com/chentsulin/awesome-react-renderer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">awesome-react-renderer</a></li>\n</ol>","id":"3000840e-b58a-5470-a668-03d2f4d15680","fields":{"slug":"custom-react-renderer-pttx"},"frontmatter":{"date":"2020-02-26T19:38:40.000Z","title":"è£½ä½œ Custom React renderer - ç”¨ React å¯« ppt","tags":["web","react","renderer"],"type":"tech","slug":"custom-react-renderer-pttx"},"timeToRead":16},{"excerpt":"\"When you look at someone through rose-colored glasses, all the red flags just look like flags.\"","html":"<blockquote>\n<p>\"When you look at someone through rose-colored glasses, all the red flags just look like flags.\"</p>\n</blockquote>\n<!-- more -->\n<h1 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h1>\n<p>åœ¨ Codepen ä¸Šå¸¸å¸¸çœ‹åˆ°å¾ˆå¤šæœƒè¨­è¨ˆåˆæ‡‚å¯«å‰ç«¯çš„é«˜æ‰‹ï¼Œç”¨ SVG ç•«å‡ºå¾ˆæ¼‚äº®çš„åœ–æ¡ˆå¾Œï¼Œé‚„èƒ½è®“ä»–å€‘ç”¢ç”Ÿå¯æ„›çš„å‹•ç•«ï¼Œæˆ‘ä¸€ç›´å¾ˆå¥½å¥‡ä»–å€‘æ˜¯æ€éº¼å¯¦ä½œçš„ï¼Œç¸½è¦ºå¾—å¾ˆå›°é›£ï¼Œå¥½åƒå¾—å° SVG é€å¾¹äº†è§£ï¼Œä¸¦ä¸”è‡ªå·±ç•«å‡ºé‚£äº› SVG åœ–æ¡ˆï¼Œæ‰æœ‰è¾¦æ³•å¯¦ä½œå‹•ç•«ã€‚\nä½†å…¶å¯¦ä¸ç„¶ï¼Œä»Šå¤©å°±ä¾†åˆ†äº«ä¸€å€‹ç°¡å–®çš„å°æŠ€å·§ï¼Œè®“ä½ åœ¨çŸ­çŸ­ååˆ†é˜å…§å°±èƒ½è®“ä¸€å€‹éœæ…‹çš„ SVG åœ–æ¡ˆæ´»èºèµ·ä¾†ï¼</p>\n<p>ç°¡å–®çœ‹å€‹æˆå“ï¼Œä½ å¯ä»¥é»é¸ä¸‹é¢ç¯„ä¾‹ä¸­çš„ <code class=\"language-text\">build</code> æŒ‰éˆ•ï¼Œå¯ä»¥çœ‹åˆ°åŸæœ¬éœæ­¢çš„ SVG æˆ¿å­å‹•äº†èµ·ä¾†ï¼</p>\n<p class=\"codepen\" data-height=\"639\" data-theme-id=\"29194\" data-default-tab=\"result\" data-user=\"arvin0731\" data-slug-hash=\"qBBRYjp\" style=\"height: 639px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"SVG Animation House\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/qBBRYjp\">\n  SVG Animation House</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<h2 id=\"ç¬¬ä¸€æ­¥å…ˆæ‰¾åˆ°ä½ å–œæ­¡çš„-svg-åœ–æ¡ˆ\" style=\"position:relative;\"><a href=\"#%E7%AC%AC%E4%B8%80%E6%AD%A5%E5%85%88%E6%89%BE%E5%88%B0%E4%BD%A0%E5%96%9C%E6%AD%A1%E7%9A%84-svg-%E5%9C%96%E6%A1%88\" aria-label=\"ç¬¬ä¸€æ­¥å…ˆæ‰¾åˆ°ä½ å–œæ­¡çš„ svg åœ–æ¡ˆ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬ä¸€æ­¥ï¼Œå…ˆæ‰¾åˆ°ä½ å–œæ­¡çš„ SVG åœ–æ¡ˆ</h2>\n<p>å¦‚æœä½ è·Ÿæˆ‘ä¸€æ¨£ï¼Œç•«ä¸å‡ºæ¼‚äº®çš„åœ–æ¡ˆæˆ– Iconï¼Œå¯ä»¥åˆ° <a href=\"https://www.flaticon.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Flaticon</a>ã€<a href=\"https://www.iconfinder.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Iconfinder</a> æˆ– <a href=\"https://icons8.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">icons8</a> ç­‰ç¶²ç«™æ‰¾äº›å…è²»çš„ svg icon ä¸‹è¼‰ä½¿ç”¨ï¼ˆæ³¨æ„æˆæ¬Šå³å¯ï¼‰ã€‚</p>\n<p><img src=\"/image/flaticon-desktop.png\" alt=\"Find a good icon\"></p>\n<p>å‰é™£å­åˆ°ç¾åœ‹å‡ºå·®ç™¼ç¾ä»–å€‘å¥½åƒå¾ˆæµè¡Œæ»‘æ¿è»Šï¼ˆscooterï¼‰ï¼Œé‚£å°±åˆ° <a href=\"https://www.flaticon.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Flaticon</a> ä¸Šæ‰¾å€‹é¡ä¼¼çš„åœ–æ¡ˆä¾†ç©ç©ï¼ï¼ˆä¸€é–‹å§‹çš„æˆ¿å±‹ç¯„ä¾‹ä¹Ÿæ˜¯å¾ <a href=\"https://www.flaticon.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Flaticon</a> å–å¾—çš„ï¼‰ï¼š</p>\n<div style=\"margin: 0 auto; display: block; width: 256px;\">\n<svg id=\"Capa_1\" enable-background=\"new 0 0 512.004 512.004\" height=\"256\" viewBox=\"0 0 512.004 512.004\" width=\"256\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m175.669 463.803c-8.283 0-15-6.716-15-15 0-53.743-43.723-97.467-97.467-97.467-14.622 0-28.673 3.153-41.762 9.371-7.483 3.555-16.432.371-19.986-7.112-3.555-7.482-.37-16.431 7.113-19.985 17.143-8.143 35.525-12.273 54.635-12.273 70.286 0 127.467 57.182 127.467 127.467 0 8.283-6.714 14.999-15 14.999z\" fill=\"#c5e1e6\"/><path d=\"m442.768 321.476c-63.027 2.945-113.414 51.086-120.563 112.327h-210.801c-8.285 0-15 6.716-15 15s6.715 15 15 15h224.932c8.285 0 15-6.716 15-15 0-52.162 40.777-94.928 92.832-97.36 8.275-.387 14.67-7.408 14.283-15.684-.387-8.275-7.402-14.684-15.683-14.283z\" fill=\"#008adf\"/><path d=\"m442.768 321.476c-63.027 2.945-113.414 51.086-120.563 112.327h-66.204v30h80.335c8.285 0 15-6.716 15-15 0-52.162 40.777-94.928 92.832-97.36 8.275-.387 14.67-7.408 14.283-15.684-.387-8.275-7.402-14.684-15.683-14.283z\" fill=\"#0065a3\"/><path d=\"m448.787 415.604c-7.721 0-14.279-5.923-14.932-13.755l-28.796-345.572c-1.291-15.484-11.852-26.275-20.521-26.275-8.283 0-15-6.716-15-15s6.717-15 15-15c12.9 0 25.295 5.971 34.9 16.811 8.852 9.99 14.361 23.12 15.518 36.972l28.797 345.573c.688 8.256-5.447 15.506-13.703 16.194-.425.035-.847.052-1.263.052z\" fill=\"#8db9c4\"/><circle cx=\"63.203\" cy=\"448.803\" fill=\"#c5e1e6\" r=\"48.2\"/><path d=\"m63.203 512.002c-34.848 0-63.199-28.351-63.199-63.199 0-34.849 28.352-63.199 63.199-63.199 34.85 0 63.201 28.35 63.201 63.199 0 34.848-28.352 63.199-63.201 63.199zm0-96.398c-18.306 0-33.199 14.893-33.199 33.199 0 18.307 14.894 33.199 33.199 33.199 18.307 0 33.201-14.893 33.201-33.199s-14.895-33.199-33.201-33.199z\" fill=\"#1d4659\"/><circle cx=\"448.803\" cy=\"448.803\" fill=\"#8db9c4\" r=\"48.2\"/><g fill=\"#0e232c\"><path d=\"m448.803 512.002c-34.848 0-63.199-28.351-63.199-63.199 0-34.849 28.352-63.199 63.199-63.199 34.85 0 63.201 28.35 63.201 63.199 0 34.848-28.352 63.199-63.201 63.199zm0-96.398c-18.307 0-33.199 14.893-33.199 33.199 0 18.307 14.893 33.199 33.199 33.199 18.307 0 33.201-14.893 33.201-33.199s-14.895-33.199-33.201-33.199z\"/><path d=\"m352.402.002c-8.283 0-15 6.716-15 15s6.717 15 15 15h32.135v-30h-32.135z\"/></g></svg>\nIcons made by <a href=\"https://www.flaticon.com/authors/freepik\" title=\"Freepik\">Freepik</a> from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a></div>\n<h2 id=\"ç¬¬äºŒæ­¥åˆ†æä¸€ä¸‹ä½ çš„-svg-é•·ä»€éº¼æ¨£å­\" style=\"position:relative;\"><a href=\"#%E7%AC%AC%E4%BA%8C%E6%AD%A5%E5%88%86%E6%9E%90%E4%B8%80%E4%B8%8B%E4%BD%A0%E7%9A%84-svg-%E9%95%B7%E4%BB%80%E9%BA%BC%E6%A8%A3%E5%AD%90\" aria-label=\"ç¬¬äºŒæ­¥åˆ†æä¸€ä¸‹ä½ çš„ svg é•·ä»€éº¼æ¨£å­ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬äºŒæ­¥ï¼Œåˆ†æä¸€ä¸‹ä½ çš„ SVG é•·ä»€éº¼æ¨£å­</h2>\n<p>æ‰¾åˆ°å–œæ­¡çš„ svg icon å¾Œï¼Œç”¨ç€è¦½å™¨æ‰“é–‹ï¼Œæ¥è‘—é–‹å•Ÿ devtoolï¼Œä½ æœƒçœ‹åˆ°ä¸‹é¢çš„çµæœï¼š</p>\n<p><img src=\"/image/svg-in-browser.png\" alt=\"open svg from browser\"></p>\n<p>è£¡é¢çš„ <code class=\"language-text\">path</code> è·Ÿ <code class=\"language-text\">circle</code> éƒ½æ˜¯ svg çš„ DOM å…ƒä»¶ï¼Œè·Ÿå­—é¢ä¸Šæ„æ€ä¸€æ¨£ï¼Œå°±æ˜¯ svg åœ–æ¡ˆå…§çš„ç·šæ¢èˆ‡åœ“å½¢ã€‚</p>\n<p>svg çš„ <code class=\"language-text\">path</code>ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ä¸€é€£ä¸²çš„ svg mini languageï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M 10 25\n         L 10 75\n         L 60 75\n         L 10 25<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>ä¸Šé¢ç¨‹å¼ç¢¼ä¸­çš„ d çš„å…§å®¹ï¼šM ä»£è¡¨å°‡ ç­† ç§»å‹•åˆ° (10, 25)ï¼Œæ¥è‘— L ç•«ä¸€æ¢ç·šåˆ° (10, 75)ï¼Œä»¥æ­¤é¡æ¨ã€‚è©³ç´°ä»‹ç´¹å¯çœ‹<a href=\"https://www.dashingd3js.com/svg-paths-and-d3js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é€™è£¡ - SVG Paths and D3.js</a>ã€‚</p>\n<p>é€é devtoolï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“æ¯å€‹ <code class=\"language-text\">path</code> æ˜¯å°æ‡‰åˆ°ç•«é¢ä¸Šçš„å“ªå€‹éƒ¨åˆ†ï¼š</p>\n<p><img src=\"/image/animate-svg-devtool.gif\" alt=\"devtool-find-parts\"></p>\n<p>åˆ°é€™é‚Šå¤§æ¦‚å°±æœƒæœ‰å€‹æ–¹å‘äº†ï¼Œæ—¢ç„¶æˆ‘å€‘å¯ä»¥çŸ¥é“æ¯å€‹å…ƒä»¶å°æ‡‰åˆ°åœ–æ¡ˆä¸Šçš„å“ªå€‹éƒ¨åˆ†ï¼Œæˆ‘å€‘å°±èƒ½å¤ é‡å°æƒ³è¦å¥—ä¸Šå‹•ç•«çš„ DOM å…ƒä»¶ä¾†æ“ä½œï¼</p>\n<h2 id=\"ç¬¬ä¸‰æ­¥å¥½ç”¨çš„å‹•ç•«å·¥å…·---timelinelite--tweenmax\" style=\"position:relative;\"><a href=\"#%E7%AC%AC%E4%B8%89%E6%AD%A5%E5%A5%BD%E7%94%A8%E7%9A%84%E5%8B%95%E7%95%AB%E5%B7%A5%E5%85%B7---timelinelite--tweenmax\" aria-label=\"ç¬¬ä¸‰æ­¥å¥½ç”¨çš„å‹•ç•«å·¥å…·   timelinelite  tweenmax permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬ä¸‰æ­¥ï¼Œå¥½ç”¨çš„å‹•ç•«å·¥å…· - TimelineLite &#x26; TweenMax</h2>\n<p>ç•¶ç„¶ä½ å¯ä»¥çµ¦äºˆæ¯å€‹ svg å…§çš„ DOM å…ƒä»¶ä¸€å€‹ç¨ç‰¹çš„ idï¼Œæˆ–æ˜¯ class nameï¼Œç„¶å¾Œç”¨ CSS æˆ– JavaScript ä¾†è‡ªè¡Œè™•ç†å‹•ç•«ï¼Œä½†é€™æ¨£é›£åº¦é‚„æ˜¯é —é«˜ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œå°±æ²’è¾¦æ³•åœ¨ååˆ†é˜å…§åšå®Œ XD</p>\n<p>æ‰€ä»¥æˆ‘å€‘å¾—å€Ÿç”¨å·¥å…·ï¼ŒTimeline(Lite|Max) è·Ÿ TweenMax æ˜¯çŸ¥åçš„ <a href=\"https://greensock.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GreenSock Animation Platformï¼ˆç°¡ç¨± GSAPï¼‰</a>æ¨å‡ºçš„å¥—ä»¶ï¼Œå¾åç¨±å°±å¯ä»¥çŒœå‡ºï¼Œä¸»è¦æ˜¯æä¾› <strong>æ™‚é–“è»¸</strong> èˆ‡ <strong>è£œé–“</strong> å‹•ç•«çš„ APIï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- index.html --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>example<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>example__ball<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>example__title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Taiwan No.1!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n  \n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">animateCircle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span> Build! <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- JavaScript --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token comment\">// ä½¿ç”¨ TimelineMax ç‰©ä»¶</span>\n<span class=\"token keyword\">const</span> tl <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TimelineMax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// åˆ©ç”¨ .set è¨­å®šæ“æœ‰ class name .example__title çš„å…ƒç´ </span>\n<span class=\"token comment\">// å°‡å…¶ scale ç¸®å°æˆ 0.2ï¼Œé€æ˜åº¦è¨­ç‚º 0</span>\ntl\n  <span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".example__title\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    scale<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span>\n    autoAlpha<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// å°‡æ“æœ‰ class name .example__ball çš„å…ƒç´ </span>\n  <span class=\"token comment\">// scale ç¸®å°æˆ 0.2</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".example__ball\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    scale<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// tween 1: åœ¨ 1 ç§’å…§æ—‹è½‰ 360 åº¦ï¼Œä¸¦ç¿»è½‰ 180 åº¦</span>\n  <span class=\"token comment\">// æ¥è‘—å›å¾© scale æˆåŸå§‹å¤§å°ï¼Œä¸­é–“ä»¥ Elastic.easeIn é€™å€‹ ease function ä¾†æ§åˆ¶å‹•ç•«é€Ÿåº¦</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".example__ball\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    rotationX<span class=\"token operator\">:</span> <span class=\"token number\">360</span><span class=\"token punctuation\">,</span>\n    rotationY<span class=\"token operator\">:</span> <span class=\"token number\">180</span><span class=\"token punctuation\">,</span>\n    scale<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    ease<span class=\"token operator\">:</span> Elastic<span class=\"token punctuation\">.</span>easeIn<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// tween 2: è·Ÿç¬¬ä¸€å€‹è£œé–“å‹•ç•«é›·åŒï¼Œåªæ˜¯é€™æ¬¡æ˜¯æ§åˆ¶æ–‡å­—ï¼Œä¸¦åœ¨ 0.5 å…§å®Œæˆ</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".example__title\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    autoAlpha<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    scale<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    ease<span class=\"token operator\">:</span> Back<span class=\"token punctuation\">.</span>easeOut<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>GSAP ç”šè‡³æä¾›ä¸€å€‹ <a href=\"https://greensock.com/ease-visualizer/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ease Visualizer</a> è®“ä½ å¯ä»¥çœ‹çœ‹æ¯ç¨® Ease function çš„æ•ˆæœï¼Œæ›´é †å¸¶é™„ä¸Šç¨‹å¼ç¢¼ï¼š</p>\n<p><img src=\"/image/GSAP-ease-visualizer.png\" alt=\"gsap ease visualizer\"></p>\n<p>ä¸Šè¿°çŸ­çŸ­çš„ç¨‹å¼ç¢¼å°±èƒ½é”åˆ°å¦‚ä¸‹æ•ˆæœï¼š</p>\n<p class=\"codepen\" data-height=\"447\" data-theme-id=\"29194\" data-default-tab=\"result\" data-user=\"arvin0731\" data-slug-hash=\"pooKOxo\" style=\"height: 447px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"GSAP Tutorial: Simple Timeline\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/pooKOxo\">\n  GSAP Tutorial: Simple Timeline</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<h2 id=\"ç¬¬å››æ­¥çµåˆ-gsap-å·¥å…·èˆ‡ä½ å–œæ„›çš„-svg\" style=\"position:relative;\"><a href=\"#%E7%AC%AC%E5%9B%9B%E6%AD%A5%E7%B5%90%E5%90%88-gsap-%E5%B7%A5%E5%85%B7%E8%88%87%E4%BD%A0%E5%96%9C%E6%84%9B%E7%9A%84-svg\" aria-label=\"ç¬¬å››æ­¥çµåˆ gsap å·¥å…·èˆ‡ä½ å–œæ„›çš„ svg permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬å››æ­¥ï¼Œçµåˆ GSAP å·¥å…·èˆ‡ä½ å–œæ„›çš„ SVG</h2>\n<p>GSAP çš„ API æ–‡ä»¶è »é½Šå…¨çš„ï¼Œé‚„æœ‰è«–å£‡å¯ä»¥æœå°‹ç›¸é—œå•é¡Œï¼Œä½¿ç”¨ä¸Šæœ‰ä»»ä½•å•é¡Œå¹¾ä¹éƒ½èƒ½åœ¨ä¸Šé¢æ‰¾åˆ°ç­”æ¡ˆï¼š<a href=\"https://greensock.com/docs/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜ç¶²æ–‡ä»¶</a>ã€<a href=\"https://greensock.com/forums/forum/11-gsap/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è«–å£‡</a></p>\n<p>åœ¨ä¸€é–‹å§‹çš„æˆ¿å±‹ç¯„ä¾‹ä¸­ï¼Œæˆ‘ä¸»è¦ä½¿ç”¨çš„æ˜¯ TimelineMax çš„ <code class=\"language-text\">from</code> èˆ‡ <code class=\"language-text\">staggerFrom</code>ï¼Œè·Ÿå‰æ­¥é©Ÿå…§çš„ç¯„ä¾‹ä¸åŒï¼Œé€™å…©å€‹ API åªéœ€è¦è¨­å®šåˆå§‹å€¼ï¼Œä»–æœƒåœ¨æŒ‡å®šæ™‚é–“å…§å°‡è£œé–“å‹•ç•«å®Œæˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">tl<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#House > rect:nth-child(24)'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>scaleX<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> transformOrigin<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> ease<span class=\"token operator\">:</span> Power2<span class=\"token punctuation\">.</span>easeOut<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>å°‡ CSS Selector <code class=\"language-text\">#House > rect:nth-child(24)</code> é€™å€‹å…ƒç´ ï¼Œå¾ scaleX ç‚º 0 é–‹å§‹ï¼Œä»¥ center(ä¸­å¿ƒ) ç‚ºè®Šå½¢èµ·é»ï¼Œåˆ©ç”¨ Power2.easeOut çš„ ease functionï¼Œåœ¨ä¸€ç§’å…§å›å¾©åˆ°åŸå§‹ç‹€æ…‹ï¼Œä¸¦åŸ·è¡Œè£œé–“å‹•ç•«ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">.</span><span class=\"token function\">staggerFrom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'#House > path:nth-child(34)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#House > path:nth-child(32)'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>scaleY<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> transformOrigin<span class=\"token operator\">:</span> <span class=\"token string\">\"bottom\"</span><span class=\"token punctuation\">,</span> ease<span class=\"token operator\">:</span> Bounce<span class=\"token punctuation\">.</span>easeOut<span class=\"token punctuation\">,</span> stagger<span class=\"token operator\">:</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"scene1+=0.5\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>èˆ‡ <code class=\"language-text\">from</code> é›·åŒï¼Œåªæ˜¯ <code class=\"language-text\">staggerFrom</code> å¯ä»¥ä¸€æ¬¡æ”¾å…¥å¤šå€‹ CSS Selectorï¼Œç”¨ <code class=\"language-text\">stagger</code> é€™å€‹å±¬æ€§ä¾†è¨­å®šé™£åˆ—ä¸­çš„ Selector è¦ä»¥æ€æ¨£çš„æ™‚é–“å·®å‡ºç¾ã€‚</p>\n<p>è©³ç´° API åƒæ•¸å¯ä»¥åƒè€ƒ<a href=\"https://greensock.com/docs/v2/TimelineMax\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜æ–¹æ–‡ä»¶</a></p>\n<p>æ¥è‘—å›åˆ°æˆ‘å€‘çš„ SVGï¼Œåœ¨ devtool çš„å¹«åŠ©ä¸‹ï¼Œè¦å–å‡º svg å…§éƒ¨å…ƒç´ çš„ CSS Selector éå¸¸å®¹æ˜“ï¼Œåœ¨ DOM å…ƒä»¶ä¸ŠæŒ‰å³éµï¼Œé¸æ“‡ <code class=\"language-text\">Copy -> Copy selector</code>ï¼Œå°±èƒ½ç›´æ¥è¤‡è£½åˆ°è©²å…ƒä»¶çš„ CSS Selectorï¼š</p>\n<p><img src=\"/image/svg-animation-copy-selector.png\" alt=\"copy selector directly\"></p>\n<p>ç¾åœ¨æˆ‘å€‘èƒ½å–å¾— svg ä¸­ä»»ä½•éƒ¨åˆ†çš„ CSS Selectorï¼Œä¹ŸçŸ¥é“æˆ‘å€‘èƒ½ç”¨ GSAP API ä¾†é€²è¡Œè£œé–“å‹•ç•«ï¼Œç¾åœ¨æ˜¯æ™‚å€™å°‡å…¶çµåˆèµ·ä¾†ï¼</p>\n<p>ç¬¬ä¸€æ­¥å…ˆèª¿æ•´ä¸€ä¸‹åŸºæœ¬ Layoutï¼Œä¸€èˆ¬åœ¨ç©ºç™½ Html å…§ç›´æ¥æ”¾å…¥ svg æ™‚ï¼Œåœ–æ¡ˆå¤§å¤šæœƒç·Šé é é¢å·¦ä¸Šè§’ï¼Œå› ç‚º svg æœ¬èº«é€šå¸¸ä¸æœƒæœ‰ä»»ä½•é—œæ–¼ layout çš„ CSSï¼Œæ‰€ä»¥å¯ä»¥å¥—ç”¨å€‹ <code class=\"language-text\">margin: 0 auto</code> å°‡å…¶ç½®ä¸­ï¼Œçœ‹èµ·ä¾†æœƒé †çœ¼ä¸€äº›ï¼Œä½ ä¹Ÿèƒ½é¡å¤–åŠ äº› paddingã€‚æ­¤å¤–ï¼Œç‚ºäº†æ–¹ä¾¿æ¸¬è©¦å‹•ç•«æ•ˆæœï¼Œä¹Ÿå¯ä»¥æ”¾å€‹ button åœ¨é é¢ä¸Šï¼Œç”¨ä¾†å‘¼å«ä½ çš„å‹•ç•«å‡½å¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!--html part--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\"><span class=\"token function\">animateBike</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span> Build! <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!--css part--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n<span class=\"token selector\">#Capa_1</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0 auto<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> block<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 256px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>æ¥è‘—æˆ‘å€‘ä½¿ç”¨ <code class=\"language-text\">TimelineMax</code> æä¾›çš„ <code class=\"language-text\">staggerFrom</code> å‡½å¼ï¼Œåˆ©ç”¨ devtool å°‡æ»‘æ¿è»Šçš„è¼ªå­éƒ¨åˆ†æ‰¾å‡ºä¾†ï¼Œè¤‡è£½å®ƒå€‘çš„ CSS Selectorï¼Œæ”¾å…¥ <code class=\"language-text\">staggerFrom</code> å‡½å¼åƒæ•¸ä¸­ï¼Œè¨­å®š x èˆ‡ y è»¸çš„ <code class=\"language-text\">scale</code> éƒ½å¾ 0 é–‹å§‹ï¼Œç”± <code class=\"language-text\">center</code> å¢é•·ï¼Œæ¡ç”¨ <code class=\"language-text\">Bounce.easeOut</code> çš„ ease functionï¼Œè€Œå››å€‹ Selector é–“ä»¥ <code class=\"language-text\">stagger: 0.2</code> çš„å±¬æ€§å€¼ä½œç‚ºè£œé–“å‹•ç•«å‡ºç¾çš„æ™‚é–“å·®ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> tl <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TimelineMax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  tl\n    <span class=\"token punctuation\">.</span><span class=\"token function\">staggerFrom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'#Capa_1 > g > path:nth-child(1)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#Capa_1 > circle:nth-child(7)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#Capa_1 > path:nth-child(6)'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#Capa_1 > circle:nth-child(5)'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>scaleY<span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> scaleX<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> transformOrigin<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> ease<span class=\"token operator\">:</span> Bounce<span class=\"token punctuation\">.</span>easeOut<span class=\"token punctuation\">,</span> stagger<span class=\"token operator\">:</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ç°¡å–®å¹¾è¡Œç¨‹å¼ç¢¼ï¼Œå°±èƒ½è®“æˆ‘å€‘çš„æ»‘æ¿è»Šæœ‰äº†å‹•ç•«ï¼</p>\n<p class=\"codepen\" data-height=\"417\" data-theme-id=\"29194\" data-default-tab=\"js,result\" data-user=\"arvin0731\" data-slug-hash=\"MWWXPVm\" style=\"height: 417px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"Scooter - demo1\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/MWWXPVm\">\n  Scooter - demo1</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<h2 id=\"ç¬¬äº”æ­¥ç™¼æ®å‰µæ„å°‡æ•´é«”å‹•ç•«å®Œæˆ\" style=\"position:relative;\"><a href=\"#%E7%AC%AC%E4%BA%94%E6%AD%A5%E7%99%BC%E6%8F%AE%E5%89%B5%E6%84%8F%E5%B0%87%E6%95%B4%E9%AB%94%E5%8B%95%E7%95%AB%E5%AE%8C%E6%88%90\" aria-label=\"ç¬¬äº”æ­¥ç™¼æ®å‰µæ„å°‡æ•´é«”å‹•ç•«å®Œæˆ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬äº”æ­¥ï¼Œç™¼æ®å‰µæ„ï¼Œå°‡æ•´é«”å‹•ç•«å®Œæˆ</h2>\n<p>TimelineMax æ‰€æä¾›çš„ API éƒ½æ˜¯ chainable çš„ï¼Œä½ å¯ä»¥æƒ³åƒæˆæ˜¯æ™‚é–“è»¸ä¸€èˆ¬ï¼Œå‹•ç•«è·Ÿè‘— chain ä¸€æ­¥ä¸€æ­¥ç…§é †åºåŸ·è¡Œï¼Œè€Œ <code class=\"language-text\">staggerFrom</code> å‰‡å¯ä»¥åŒæ™‚è®“å¤šå€‹ DOM å…ƒä»¶ä»¥äº›å¾®æ™‚é–“å·®çš„é †åºå•Ÿå‹•ï¼Œå¦å¤–ä¹Ÿèƒ½è¨­ç½®ä¸€äº› Flag ä¾†æŒ‡å®šè¦ç­‰åˆ°å“ªå¹¾å€‹å‹•ç•«å®Œæˆå¾Œï¼Œæ‰æ¥çºŒå…¶ä»–å‹•ç•«ï¼Œé€™äº›ç´°ç¯€ç•¶ä½ åœ¨æ€è€ƒè¦å¦‚ä½•â€œå‹•ç•«â€ä½ çš„ SVG æ™‚ï¼Œå†å» GSAP çš„æ–‡ä»¶èˆ‡è«–å£‡æŸ¥è©¢ï¼Œç›¸ä¿¡éƒ½èƒ½æ‰¾åˆ°è§£ç­”ã€‚</p>\n<p>æœ€å¾Œï¼Œç™¼æ®è‡ªå·±çš„å‰µæ„ï¼ŒæŠŠ svg çš„å„å€‹éƒ¨åˆ†éƒ½è£œä¸Šå‹•ç•«ï¼Œæ­é… GSAP æä¾›çš„æ–‡ä»¶ï¼Œçµ„åˆå„ç¨® APIï¼Œä¸€å€‹ç°¡å–®çš„ä½œå“å°±å®Œæˆäº†ï¼š</p>\n<p class=\"codepen\" data-height=\"403\" data-theme-id=\"29194\" data-default-tab=\"result\" data-user=\"arvin0731\" data-slug-hash=\"XWWYYWM\" style=\"height: 403px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"Scooter - final-steps\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/XWWYYWM\">\n  Scooter - final-steps</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>é›–ç„¶é€™å€‹å°æŠ€å·§èªªç ´çœŸçš„ä¸å€¼éŒ¢ï¼Œæœ€å›°é›£çš„æŠ€è¡“éƒ½äº¤çµ¦äº† GSAP è™•ç†ï¼ŒSVG é‚„ä¸ç”¨æ˜¯è‡ªå·±ç•«çš„ï¼Œä½†åŠ åœ¨è‡ªå·±çš„éƒ¨è½æ ¼æˆ–æ˜¯æ”¾åœ¨æŠ•å½±ç‰‡ä¸­ï¼Œå¯ä»¥ç¬é–“è®“ç•«é¢æ›´åŠ è±å¯Œï¼Œç„¡èŠæ²’äº‹æ‹¿ä¾†å¨›æ¨‚è‡ªå·±ä¹Ÿæ˜¯å¾ˆä¸éŒ¯çš„é¸æ“‡ï¼Œåƒæ˜¯å‡ºåœ‹æ—…è¡Œå›ä¾†æœ‰æ™‚å·®ç¡ä¸è‘—ï¼Œä¸å¦‚å°±ä¾†ç•«å€‹å‹•ç•«èª¿é¤Šèº«å¿ƒ XD\nç¸½ä¹‹ï¼Œæˆ‘è‡ªå·±è¦ºå¾—è »æœ‰è¶£çš„ï¼Œå¸Œæœ›æˆ–å¤šæˆ–å°‘å°è®€åˆ°é€™ç¯‡æ–‡ç« çš„äººæœ‰é»å¹«åŠ©ã€‚</p>\n<h3 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h3>\n<ol>\n<li><a href=\"https://greensock.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GreenSock Animation Platform</a></li>\n<li><a href=\"https://medium.com/@LewisMenelaws/how-to-create-beautiful-svg-animations-easily-610eb2690ac3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">How to Create Beautiful SVG Animations Easily</a></li>\n</ol>","id":"6f9a0e19-cbd4-5930-8fc8-f30f2d7618ad","fields":{"slug":"svg-animation-in-10-mins"},"frontmatter":{"date":"2019-11-06T08:56:40.000Z","title":"ååˆ†é˜ã€äº”æ­¥é©Ÿï¼ŒSVG å‹•èµ·ä¾†ï¼","tags":["web","svg","animation","TimelineMax","GSAP"],"type":"tech","slug":"svg-animation-in-10mins"},"timeToRead":9},{"excerpt":"ã€You're really lucky you know. You didn't have to wait your whole life to do something specialã€","html":"<blockquote>\n<p>ã€You're really lucky you know. You didn't have to wait your whole life to do something specialã€</p>\n</blockquote>\n<!-- more -->\n<h1 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h1>\n<p>ä½ æ˜¯å¦æ›¾å› ç‚ºç¶²è·¯ä¸Šè¢«æ­§è¦–ã€è¢«éœ¸å‡Œçš„æ–°èæˆ–å½±ç‰‡è€Œæ†¤æ†¤ä¸å¹³ï¼Ÿä½ æ˜¯å¦æ›¾å› ç‚ºå„ç¨®èº«æ®˜å¿ƒä¸æ®˜çš„å‹µå¿—æ•…äº‹è€Œæ„Ÿåˆ°æ¿€å‹µï¼Ÿ\nå¦‚æœä½ æœ‰éä¸Šè¿°ç¶“é©—ï¼Œé‚£ç•¶ä½ åœ¨è£½ä½œç¶²ç«™æ™‚ï¼Œæ˜¯å¦æ›¾ç¶“è€ƒé‡é Web Accessibilityï¼ˆa11yï¼‰ å‘¢ï¼Ÿ</p>\n<p>è€å¯¦èªªï¼Œæˆ‘çœŸçš„å¾ˆå°‘åœ¨å¯¦ä½œæ™‚èªçœŸçš„é©—è­‰è‡ªå·±çš„ç¶²ç«™çš„å¯è¨ªæ€§ï¼ŒèŠ±åœ¨è€ƒé‡æ˜¯å¦èƒ½æ”¯æ´ IE 9 çš„æ™‚é–“é‚„æ¯”è¼ƒå¤šä¸€äº›ã€‚ï¼ˆæƒ³ç•¶å¹´åœ¨æ”¿åºœæ©Ÿé—œæœå‹™æ™‚ï¼Œçœ‹åˆ°å±€è™•é•·å¾ˆè‡ªè±ªå®˜ç¶²æ‹¿åˆ°ç„¡éšœç¤™ç¶²ç«™è©•ç­‰ç¬¬ä¸€æ™‚ï¼Œé‚„è¦ºå¾—è«åå…¶å¦™ï¼Œæƒ³èªªç¶²ç«™é€™éº¼é†œï¼Œåˆ°åº•å“ªè£¡ç„¡éšœç¤™ XDï¼‰</p>\n<p>åœ¨å¯¦ä½œçš„æ™‚å€™ï¼ŒPM æœƒæ‹¿æ•¸æ“šå‘Šè¨´ä½ ï¼Œæœ‰å¤šå°‘ç”¨æˆ¶æ˜¯ä½¿ç”¨èˆŠç‰ˆçš„ç€è¦½å™¨ï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦æ”¯æ´åˆ°ä½•ç¨®ç¨‹åº¦ï¼Œä½†æ‡‰è©²å¾ˆå°‘ PM æœƒæ‹¿å‡ºæ•¸æ“šå‘Šè¨´ä½ ï¼Œæœ‰å¤šå°‘ screen reader ä¾†å­˜å–æˆ‘å€‘çš„ç¶²ç«™Â·ã€‚</p>\n<p>ç„¶è€Œï¼Œå…‰å°ç£ï¼Œ2018 å¹´çš„èº«å¿ƒéšœç¤™äººå£æœ‰ä¸€ç™¾å¤šè¬äººï¼Œå…¶ä¸­è¦–è¦ºéšœç¤™çš„æœ‰å°‡è¿‘å…­è¬ï¼ˆ<a href=\"https://dep.mohw.gov.tw/DOS/lp-2976-113.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¡›ç”Ÿç¦åˆ©è™•çš„è³‡æ–™</a>ï¼‰ï¼Œç¾åœ‹æ¯”ä¾‹æ›´é«˜ï¼Œæœ‰å°‡è¿‘ 25% çš„èº«å¿ƒéšœç¤™äººå£ï¼ˆ<a href=\"https://youtu.be/dvtfNpt75aA?t=26101\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è³‡æ–™ä¾†æº</a>ï¼‰ã€‚</p>\n<p>ä¾ç…§ä½ ç”¢å“çš„ç”¨æˆ¶æ¯”ä¾‹ï¼Œé€™äº›æ•¸æ“šå¤§æ¦‚ç„¡æ³•èªªæœä½ çš„ PMï¼Œè®“ä»–å€‘çµ¦ä½ æ›´å¤šæ™‚é–“æ€è€ƒå¦‚ä½•å¢å¼·ç¶²ç«™çš„å¯è¨ªæ€§ï¼Œä½†ä»”ç´°æƒ³æƒ³ï¼Œå¦‚æœä½ åœ¨ä¹é‚£äº›èº«å¿ƒå¥å…¨å»ä¸é¡˜æ„å‡ç´šè‡ªå·±ç€è¦½å™¨çš„äººï¼Œè€Œä¸åœ¨ä¹é€™äº›èµ°å‡ºéšœç¤™ï¼Œé€£æ¥åˆ°ç¶²è·¯å¸å–çŸ¥è­˜çš„æ®˜éšœäººå£«ï¼Œä½ æ˜¯ä¸æ˜¯ç„¡æ„ä¸­åœ¨ä»–å€‘çš„äººç”Ÿé“è·¯ä¸­å¢åŠ äº†æ›´å¤šé˜»ç¤™ï¼Œä¸è‡ªè¦ºåœ°æˆç‚ºæ­§è¦–ä»–äººçš„ä¸€æ–¹å‘¢ã€‚</p>\n<p>ä»Šå¤©æƒ³é€éé€™ç¯‡æ–‡ç« ï¼Œæ•´ç†ä¸€äº›è³‡æºèˆ‡ç°¡çŸ­çš„å¯¦ä½œè¦é»ï¼Œå–šé†’å¤§å®¶å° Web Accessibility é‡è¦æ€§çš„èªçŸ¥ï¼Œä¹Ÿæ˜¯æé†’è‡ªå·±åœ¨æœªä¾†å¯¦ä½œä¸Šå¿…å®šè¦å¤šåŠ æ³¨æ„ã€‚</p>\n<h1 id=\"ä½¿ç”¨-screen-reader-çš„æ„Ÿè¦ºæ˜¯ä»€éº¼\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8-screen-reader-%E7%9A%84%E6%84%9F%E8%A6%BA%E6%98%AF%E4%BB%80%E9%BA%BC\" aria-label=\"ä½¿ç”¨ screen reader çš„æ„Ÿè¦ºæ˜¯ä»€éº¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ä½¿ç”¨ screen reader çš„æ„Ÿè¦ºæ˜¯ä»€éº¼</h1>\n<p>ç›¸ä¿¡æœƒçœ‹åˆ°é€™ç¯‡æ–‡ç« çš„äººï¼Œå¤šå°‘å°æ–¼ Web Accessiblity éƒ½æœ‰äº†è§£ï¼ŒçŸ¥é“æ˜¯ç‚ºäº†è¼”åŠ©éšœç¤™äººå£«é–±è®€ç¶²é å…§å®¹ï¼Œå¹³å¸¸å¯¦ä½œæ™‚è‡³å°‘åœ¨ <code class=\"language-text\">&lt;img></code> å…ƒç´ ä¸ŠæœƒåŠ ä¸Š <code class=\"language-text\">alt</code> ç­‰æ–‡å­—ä¾†æè¿°åœ–ç‰‡ã€‚ä½†ä½ æœ‰çœŸçš„ä½¿ç”¨é screen reader å—ï¼Ÿä½ çŸ¥é“ä½¿ç”¨é€™äº›è¼”åŠ©å·¥å…·ä¸Šç¶²çš„äººï¼Œçœ‹åˆ°çš„ä¸–ç•Œè·Ÿä½ æœ‰å¤šå¤§çš„ä¸åŒå—ï¼Ÿ</p>\n<p>æˆ‘åŸæœ¬ä¹Ÿä¸çŸ¥é“ï¼Œç›´åˆ°æˆ‘è©¦ç”¨äº† Mac å…§å»ºçš„ VoiceOverï¼Œç”¨å®ƒä¾†é–±è®€å¹³å¸¸çœ‹çš„ç¶²ç«™ï¼Œåƒæ˜¯ wikipediaï¼š</p>\n<iframe style=\"max-width: 560px\" width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/IHm6me_VfyM\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<p>é«”é©—å¯¦åœ¨å¾ˆç³Ÿï¼Œé™¤äº†æ©Ÿå™¨äººçš„è²èª¿å¤–ï¼Œå¤–åŠ æ¥µå¿«çš„èªé€Ÿï¼Œåœ¨ä½ å¾ç€è¦½å™¨çš„åˆ†é æ¨™ç±¤ç§»å‹•åˆ°çœŸæ­£çš„ç¶²é å…§å®¹å‰ï¼Œé‚„éœ€ç¶“éè¨±å¤šç€è¦½å™¨æœ¬èº«æŒ‰éˆ•é¸é …çš„ä»‹ç´¹ï¼Œæ¥è‘—åˆ°äº†ç¶²é å…§å®¹ï¼Œæ–‡ç« å› ç‚ºé€£çµçš„é—œä¿‚ï¼Œè®Šå¾—ç ´ç¢ï¼ˆç‚ºäº†è®“ä½ çŸ¥é“æ˜¯é€£çµæˆ–æ˜¯æŒ‰éˆ•ï¼Œåœ¨æ–‡å­—å…§å®¹å‰éƒ½æœƒå…ˆæœ—è®€å‡ºè©²æ®µå…§å®¹çš„åŠŸèƒ½æ€§ï¼Œåƒæ˜¯ï¼š<em>é€£çµ</em>ã€<em>æŒ‰éˆ•</em>ï¼‰ï¼Œé–±è®€é †åºä¹Ÿèˆ‡æˆ‘å€‘æ†‘çœ¼ç›è§€çœ‹æ™‚çš„ä¸åŒã€‚</p>\n<p>ç„¶è€Œ Wikipedia å·²ç¶“ç®—æ˜¯ a11y è™•ç†å¾—ä¸éŒ¯çš„äº†ï¼Œç•¢ç«Ÿå…§å®¹å¤§å¤šä¹Ÿåªæœ‰æ–‡å­—èˆ‡åœ–ç‰‡ã€‚æƒ³æƒ³çœ‹ç¾åœ¨é€™éº¼å¤šç‚«éº—ä»‹é¢çš„ç¶²ç«™ï¼Œå„ç¨®éœ€è¦ä½¿ç”¨è€…èˆ‡ä¹‹äº’å‹•çš„åŠŸèƒ½ï¼Œå…‰ç”¨æƒ³åƒçš„å°±æ˜¯æ‚²åŠ‡ï¼Œçœ‹ä¸€ä¸‹ Google å¤§è‚†å®£å‚³çš„ AMP Storyï¼š</p>\n<iframe style=\"max-width: 560px\" width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/cdPVMDJB37k\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<p>åœ¨å¼·èª¿ Web performance çš„åŒæ™‚ï¼Œweb accessibility ä¹Ÿè©²è€ƒé‡é€²å»ã€‚é€™é‚Šå°±æœ‰<a href=\"https://ethanmarcotte.com/wrote/amphora/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ–‡ç« </a>åœ¨è¨è«–é—œæ–¼ amp-story åœ¨ a11y çš„ <a href=\"https://github.com/ampproject/meta-ac/blob/master/meetings/2019-03-f2f.md#accessibility\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">issue</a>ï¼Œä¸é ampproject å…§æ˜¯æœ‰ accessibility working group åœ¨æƒ³è¾¦æ³•è§£å±€çš„ã€‚</p>\n<p>ä¸Šé¢çš„ Screen reader ç¯„ä¾‹æ¯”è¼ƒæ˜¯é‡å°è¦–éšœæœ‹å‹çš„ä½¿ç”¨ç‚ºä¸»ï¼Œç¾å¯¦ä¸­èƒ½é€ æˆç”Ÿæ´»ä¸ä¾¿çš„å¯ä¸åªæœ‰è¦–è¦ºä¸Šçš„å›°é›£ï¼Œé‚„æœ‰è½è¦ºã€è‚¢é«”ç­‰ç­‰ï¼Œåƒæ˜¯æ»‘é¼ é€™é¡éœ€è¦é«˜åº¦æ‰‹çœ¼å”èª¿èƒ½åŠ›çš„æ“ä½œï¼Œå°±ä¸æ˜¯é‚£éº¼æœ‰è¦ªå’ŒåŠ›ï¼Œå› æ­¤å…‰æ˜¯é€ééµç›¤æ“ä½œç¶²ç«™çš„é †æš¢åº¦ï¼Œå°±å¿…é ˆå¥½å¥½æ€è€ƒï¼Œä¹Ÿæ˜¯å¯¦ä½œ Web Accessibility æ™‚çš„ä¸€å¤§é‡é»ã€‚</p>\n<p>å¦‚æœæƒ³å¿«é€Ÿé«”é©—ä¸€ä¸‹ä½¿ç”¨ screen reader çš„æ•ˆæœï¼Œåˆä¸æƒ³å­¸ç¿’ Voiceover ç­‰ç³»çµ±å…§å»º reader çš„ï¼Œå¯ä»¥åˆ° udacity æä¾›çš„<a href=\"http://udacity.github.io/ud891/lesson3-semantics-built-in/02-chromevox-lite/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç¶²ç«™</a> è©¦è©¦ï¼Œä½¿ç”¨çš„æ˜¯ Chrome çš„ chromevox-lite é–±è®€å™¨ï¼Œä¸”æœ‰åˆ»æ„å°‡å…§å®¹æ¨¡ç³ŠåŒ–ï¼Œæ„Ÿå—æœƒæ›´çœŸå¯¦é»ã€‚</p>\n<h1 id=\"web-accessibility-çš„è³‡æºèˆ‡å¯¦ä½œè¦é»\" style=\"position:relative;\"><a href=\"#web-accessibility-%E7%9A%84%E8%B3%87%E6%BA%90%E8%88%87%E5%AF%A6%E4%BD%9C%E8%A6%81%E9%BB%9E\" aria-label=\"web accessibility çš„è³‡æºèˆ‡å¯¦ä½œè¦é» permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Accessibility çš„è³‡æºèˆ‡å¯¦ä½œè¦é»</h1>\n<p>èªªäº†è¨±å¤šç·£ç”±ä»¥åŠç¯„ä¾‹ï¼Œç¾åœ¨ä¾†è«‡è«‡è©²å¦‚ä½•å­¸ç¿’ Web Accessibilityï¼Œä¸¦å¯¦ä½œåœ¨æˆ‘å€‘çš„ç¶²ç«™ä¸­ã€‚</p>\n<h2 id=\"ç¶²çµ¡å…§å®¹ç„¡éšœç¤™åŠŸèƒ½æŒ‡å—---web-content-accessibility-guidelines\" style=\"position:relative;\"><a href=\"#%E7%B6%B2%E7%B5%A1%E5%85%A7%E5%AE%B9%E7%84%A1%E9%9A%9C%E7%A4%99%E5%8A%9F%E8%83%BD%E6%8C%87%E5%8D%97---web-content-accessibility-guidelines\" aria-label=\"ç¶²çµ¡å…§å®¹ç„¡éšœç¤™åŠŸèƒ½æŒ‡å—   web content accessibility guidelines permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¶²çµ¡å…§å®¹ç„¡éšœç¤™åŠŸèƒ½æŒ‡å— - Web Content Accessibility Guidelines</h2>\n<p>å…ˆå¾ W3C æŒ‡å—äº†è§£ \"ç„¡éšœç¤™\" çš„å®šç¾©ã€‚<a href=\"https://www.w3.org/TR/WCAG21/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç¶²çµ¡å…§å®¹ç„¡éšœç¤™åŠŸèƒ½æŒ‡å— (WCAG) 2.1</a>ï¼Œæ˜¯ W3C æ“¬å®šçš„ç„¡éšœç¤™åŠŸèƒ½æŒ‡å—å’Œæœ€ä½³åšæ³•ï¼Œæ—¨åœ¨æœ‰ç³»çµ±åœ°é—¡è¿°â€œç„¡éšœç¤™åŠŸèƒ½â€çš„å«ç¾©ã€‚å¾ˆå¤šåœ‹å®¶æ”¿åºœæ©Ÿé—œéƒ½æœƒè¦æ±‚æ ¹æ“šæ­¤æŒ‡å—ä¾†å¯¦ä½œç¶²ç«™ã€‚</p>\n<p>WCAG æœ‰å››å¤§åŸå‰‡ï¼š</p>\n<ul>\n<li>å¯æ„ŸçŸ¥ï¼ˆPerceivableï¼‰ï¼šæ‰€æœ‰è³‡è¨Šèˆ‡ä½¿ç”¨è€…ä»‹é¢å…ƒä»¶éƒ½å¿…é ˆè¦èƒ½ä»¥å„ç¨®ä½¿ç”¨è€…èƒ½æ„ŸçŸ¥çš„æ–¹å¼ï¼Œå‘ˆç¾çµ¦ä½¿ç”¨è€…ã€‚åƒæ˜¯èƒ½è®“ Screen Reader é–±è®€å‡ºå…§å®¹ã€‚ä¸èƒ½è®“ä½¿ç”¨è€…é€éå„ç¨®æ„Ÿå®˜éƒ½ç„¡æ³•æ„ŸçŸ¥åˆ°å…§å®¹ã€‚</li>\n<li>å¯æ“ä½œï¼ˆOperableï¼‰ï¼šä½¿ç”¨è€…å…ƒä»¶èˆ‡ç¶²é å…§å®¹é–“çš„å°è¦½éƒ½è¦å¯æ“ä½œï¼Œä¸èƒ½å‡ºç¾ä½¿ç”¨è€…ç„¡æ³•æ“ä½œçš„ä»‹é¢ã€‚</li>\n<li>å¯ç†è§£ï¼ˆUnderstandableï¼‰ï¼šå‘ˆç¾çµ¦ä½¿ç”¨è€…çš„è³‡è¨Šèˆ‡æ“ä½œæ–¹å¼éƒ½è¦èƒ½è¢«ä½¿ç”¨è€…ç†è§£ã€‚</li>\n<li>å¼·å¥ï¼ˆRobustï¼‰ï¼šä¸è«–æ˜¯è¢«å“ªç¨®è¼”åŠ©ç§‘æŠ€å·¥å…·æˆ–æ˜¯å„ç¨® user agents æ‰€å­˜å–ï¼Œç¶²ç«™å…§å®¹éƒ½è¦èƒ½ä¸å—å½±éŸ¿ï¼Œå‘ˆç¾çµ¦ä½¿ç”¨è€…å®Œæ•´çš„å…§å®¹ï¼Œè‹¥ä½¿ç”¨è€…ä½¿ç”¨çš„å·¥å…·è®Šå¾—æ›´åŠ é€²æ­¥ï¼Œç¶²ç«™ä¹Ÿå¾—è·Ÿä¸Šè…³æ­¥ï¼Œç¶­æŒå…§å®¹çš„å­˜å–ã€é–±è®€æ€§ã€‚</li>\n</ul>\n<p>é€™æ˜¯ç„¡éšœç¤™å…§å®¹çš„ä¸€å€‹æ¦‚è¦½ï¼Œé‚„å¯ä»¥é€é <a href=\"https://webaim.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebAIM</a> æª¢æŸ¥æ¸…å–®ï¼Œä¾†æª¢è¦–æˆ‘å€‘è©²å¦‚ä½•ä¾ç…§ WCAG çš„æŒ‡å—å¯¦ä½œã€‚</p>\n<h2 id=\"å…¶ä»–è³‡æº\" style=\"position:relative;\"><a href=\"#%E5%85%B6%E4%BB%96%E8%B3%87%E6%BA%90\" aria-label=\"å…¶ä»–è³‡æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å…¶ä»–è³‡æº</h2>\n<p>é™¤äº† W3C çš„å®šç¾©æŒ‡å—å¤–ï¼Œé‚„æœ‰è¨±å¤šæ›´è¦ªå’Œçš„è³‡æºå¯ä»¥åƒè€ƒï¼Œç•¢ç«Ÿ Web accessibility ä¸æ˜¯å¾ˆæ–°çš„è­°é¡Œäº†ï¼Œåƒæ˜¯ <a href=\"https://developer.mozilla.org/zh-CN/docs/Learn/Accessibility\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MDN</a> æˆ–æ˜¯ <a href=\"https://developers.google.com/web/fundamentals/accessibility\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Google</a> éƒ½æœ‰éå¸¸è©³ç´°çš„è³‡æ–™èˆ‡æ•™å­¸ï¼ŒUdacity ä¸Šä¹Ÿæœ‰ç›¸é—œ<a href=\"https://www.udacity.com/course/web-accessibility--ud891\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">èª²ç¨‹</a>ã€‚</p>\n<p>çœ‹å®Œå¤§æ¦‚éƒ½éœ€è¦èŠ±ä¸Šå¹¾å€‹å°æ™‚çš„æ™‚é–“ï¼Œå¦‚æœæƒ³å¿«é€Ÿäº†è§£çš„è©±ï¼Œå…¶å¯¦ä¹Ÿå·²ç¶“æœ‰ä¸å°‘é—œæ–¼ a11y çš„ç¹ä¸­æ–‡ç« ï¼Œåƒé€™ç¯‡ - <a href=\"https://medium.com/frochu/%E5%9B%9E%E6%AD%B8%E5%88%9D%E5%BF%83-%E4%B8%80%E6%8E%A2web-accessibility-baaa4d22f4a7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å›æ­¸åˆå¿ƒï¼Œä¸€æ¢ Web Accessibility</a>ï¼Œç°¡çŸ­ç²¾è¦ï¼Œæ•´ç†äº†ä¸Šé¢ Google èˆ‡ Udacity èª²ç¨‹çš„å…§å®¹ï¼Œé©åˆå¿«é€Ÿäº†è§£ä½•è¬‚ a11yï¼Œè€Œæœ€è¿‘<a href=\"https://ithelp.ithome.com.tw/users/20108045/ironman/2454\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">éµäººè³½çš„é€™ç³»åˆ—æ–‡</a>ä¹Ÿå¾ˆä¸éŒ¯ï¼Œè’é›†æ•´ç†éå¸¸å¤šè³‡è¨Šï¼Œç´°ç¯€å¾ˆå¤šï¼Œå¯ä»¥ç•¶ä½œåƒè€ƒå·¥å…·ï¼Œåœ¨å¯¦ä½œæ™‚éš¨æ™‚ç¿»é–±ï¼Œæ¨æ¨ã€‚</p>\n<p>æ­¤å¤–ï¼Œä¸Šé¢çš„è³‡æºè‘—é‡åœ¨ä¸€èˆ¬çš„ç¶²ç«™ä¸Šï¼Œè€Œèº«ç‚ºè³‡æ–™è¦–è¦ºåŒ–çš„æ„›å¥½è€…ï¼Œæˆ‘å¾ˆå¥½å¥‡è©²å¦‚ä½•è™•ç† Data visualization ä¸Šçš„ Web Accessibility å•é¡Œã€‚</p>\n<p>å¾ <a href=\"https://www.a11ywithlindsey.com/about\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Lindsey</a> çš„é€™ç¯‡æ–‡ç«  - <a href=\"https://www.a11ywithlindsey.com/blog/accessibility-d3-bar-charts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Accessibility in d3 Bar Charts</a> ä¸­å¯ä»¥çªºçŸ¥ä¸€äºŒã€‚</p>\n<p>ä¸»è¦æ˜¯è¦åœ¨åœ–è¡¨ä¸­åŠ å…¥è¶³å¤ çš„æè¿°æ–‡å­—ï¼Œç„¶å¾Œåœ¨è¨­è¨ˆé¡è‰²æ™‚ï¼Œä½¿ç”¨ä¸€äº›è¼”åŠ©å·¥å…·å¦‚ <a href=\"http://www.color-blindness.com/coblis-color-blindness-simulator/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">coblis</a> ä¾†å»ºç«‹ color blind friendly çš„åœ–è¡¨ã€‚</p>\n<p>è‹¥æ˜¯è¼ƒå¸¸ä½¿ç”¨ SVG ä¾†è£½ä½œå‹•æ…‹åœ–è¡¨çš„äººï¼Œæ¨è–¦ç ”è®€ä¸€ä¸‹é€™ç¯‡å°ˆé–€ä»‹ç´¹å¦‚ä½•ç‚ºä½ çš„ SVG å¢å¼· accessibility çš„æ–‡ç«  -  <a href=\"https://css-tricks.com/accessible-svgs/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">accessible-svgs</a>ï¼Œå¯ä»¥ç‚ºä½ çš„è³‡è¨Šåœ–è¡¨åœ¨ Web Accessibility ä¸Šå¸¶ä¾†éå¸¸å¤§çš„æ”¹å–„ã€‚</p>\n<h2 id=\"å¯¦ä½œè¦é»\" style=\"position:relative;\"><a href=\"#%E5%AF%A6%E4%BD%9C%E8%A6%81%E9%BB%9E\" aria-label=\"å¯¦ä½œè¦é» permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å¯¦ä½œè¦é»</h2>\n<p>çŸ¥é“äº†ç‚ºä½•éœ€è¦äº†è§£ Web Accessibilityï¼Œä¹ŸçŸ¥é“äº†æœ‰å“ªäº›è³‡æºå¯ä»¥é–±è®€ï¼Œæ¥ä¸‹ä¾†æ ¹æ“šä¸Šé¢é–±è®€çš„è³‡æ–™ï¼Œç°¡å–®ç¸½çµå¹¾å€‹å¯¦ä½œä¸Šè¦é—œæ³¨çš„é‡é»ï¼š</p>\n<h3 id=\"æ€è€ƒç¶²ç«™èƒ½ä»¥ä»€éº¼æ–¹å¼ç€è¦½\" style=\"position:relative;\"><a href=\"#%E6%80%9D%E8%80%83%E7%B6%B2%E7%AB%99%E8%83%BD%E4%BB%A5%E4%BB%80%E9%BA%BC%E6%96%B9%E5%BC%8F%E7%80%8F%E8%A6%BD\" aria-label=\"æ€è€ƒç¶²ç«™èƒ½ä»¥ä»€éº¼æ–¹å¼ç€è¦½ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ€è€ƒç¶²ç«™èƒ½ä»¥ä»€éº¼æ–¹å¼ç€è¦½</h3>\n<p>é€™å…¶å¯¦æ˜¯ <a href=\"https://medium.com/frochu/%E5%9B%9E%E6%AD%B8%E5%88%9D%E5%BF%83-%E4%B8%80%E6%8E%A2web-accessibility-baaa4d22f4a7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å›æ­¸åˆå¿ƒï¼Œä¸€æ¢ Web Accessibility</a> é€™ç¯‡æ–‡ç« ä¸­æ‰€æåˆ°çš„çµè«–ï¼Œæˆ‘è¦ºå¾—è »æœ‰é“ç†çš„ã€‚</p>\n<p>èˆ‡å…¶æ€è€ƒä½¿ç”¨è€…å¤±å»ä»€éº¼æ„Ÿå®˜èƒ½åŠ›ï¼Œä¸å¦‚å°ˆæ³¨åœ¨ä½ çš„ç¶²ç«™èƒ½æä¾›å“ªäº›æ–¹å¼ç€è¦½ã€‚å¯èƒ½æ˜¯ screen readerã€éµç›¤ï¼ˆkeyboardï¼‰ã€è²æ§æˆ–çœ¼å‹•å„€ç­‰å…¶ä»–äººæ©Ÿä»‹é¢ã€‚å¾é€™äº›æ“ä½œä»‹é¢å»æ€è€ƒè©²æ€éº¼åŠ å¼·è‡ªå·±ç¶²ç«™çš„å¯è¨ªæ€§ã€‚</p>\n<h3 id=\"ç¶²é å…ƒä»¶çš„å¯èšç„¦æ€§\" style=\"position:relative;\"><a href=\"#%E7%B6%B2%E9%A0%81%E5%85%83%E4%BB%B6%E7%9A%84%E5%8F%AF%E8%81%9A%E7%84%A6%E6%80%A7\" aria-label=\"ç¶²é å…ƒä»¶çš„å¯èšç„¦æ€§ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¶²é å…ƒä»¶çš„å¯èšç„¦æ€§</h3>\n<p>æ‰€è¬‚çš„å¯èšç„¦ï¼ŒæŒ‡çš„å°±æ˜¯å…ƒä»¶èƒ½å¤ æˆç‚ºç„¦é»ï¼Œè€Œæ‰€è¬‚ç„¦é»ï¼Œæ˜¯æŒ‡ç•¶å‰è¢å¹•ä¸Šç€è¦½å™¨ç•¶ä¸‹èƒ½æ¥æ”¶ä¾†è‡ªéµç›¤è¼¸å…¥ã€å‰ªè²¼æ¿è¼¸å‡ºçš„å…ƒä»¶ï¼ˆå­—æ®µã€è¤‡é¸æ¡†ã€æŒ‰éˆ•æˆ–é€£çµç­‰è¼¸å…¥é …ç›®ï¼‰ï¼Œæ›´ç°¡å–®ä¾†èªªï¼Œå°±æ˜¯ä½¿ç”¨è€…æ­¤åˆ»æ­£åœ¨æ“ä½œçš„å…ƒä»¶ã€‚</p>\n<p>ç‚ºä»€éº¼å¯èšç„¦æ€§å¾ˆé‡è¦å‘¢ï¼Ÿé™¤äº†è®“ä½¿ç”¨è€…çŸ¥é“è‡ªå·±ç›®å‰æ‰€ä½¿ç”¨çš„å…ƒä»¶å¤–ï¼Œå°±æ˜¯è®“ screen reader çŸ¥é“ç›®å‰è©² read å“ªå€‹å…ƒä»¶ã€‚è€Œç€è¦½å™¨ä¸€æ¬¡åªèƒ½èšç„¦åœ¨ä¸€å€‹å…ƒä»¶ä¸Šï¼Œé€™å€‹ç‰¹æ€§è®“ screen reader ä¸æœƒåŒæ™‚è®€åˆ°å…©å€‹ä¸åŒå…ƒä»¶çš„æè¿°ã€‚</p>\n<p>åœ¨ä¸€èˆ¬ç€è¦½å™¨ä¸Šé ­ï¼Œè¢«èšç„¦çš„å…ƒä»¶é€šå¸¸é è¨­æœƒä»¥ä¸€å€‹è—è‰²å¤–æ¡†åŒ…è£¹ä½ï¼š</p>\n<p><img src=\"/image/outline-blue.png\" alt=\"defaul outline\"></p>\n<p>å¯¦å‹™ä¸Šå¾ˆå¤šäººéƒ½æœƒç”¨ <code class=\"language-text\">outline: none</code> æŠŠé€™å€‹å¤–æ¡†æ‹¿æ‰ï¼Œä½†å¯¦éš›ä¸Šæ˜¯éå¸¸ä¸å‹å–„çš„è¡Œç‚ºï¼Œè‹¥æ˜¯ä¸å–œæ­¡ç€è¦½å™¨é è¨­çš„æ¨£å¼ï¼Œå¯ä»¥è·Ÿè¨­è¨ˆå¸«æºé€šï¼Œçœ‹è¦å¦‚ä½•ä¿®æ”¹è¢«èšç„¦çš„å…ƒä»¶æ¨£å¼ï¼Œä½†è¨˜å¾—è¦èƒ½è®“ä½¿ç”¨è€…æ³¨æ„åˆ°æ¨£å¼çš„è®ŠåŒ–ï¼Œæ‰èƒ½å¹«åŠ©ä»–å€‘åˆ¤æ–·å…ƒä»¶çš„èšç„¦èˆ‡å¦ã€‚å¦‚ Youtube ä¸Šçš„å›å¾©æŸ¥çœ‹æŒ‰éˆ•ï¼š</p>\n<p><img src=\"/image/outline-custom.png\" alt=\"custom outline\"></p>\n<p>å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œä¸¦éæ‰€æœ‰å…ƒä»¶éƒ½è¦è¨­æˆå¯èšç„¦ï¼Œåƒæ˜¯æ–‡ç« å…§æ–‡æœ¬èº«ï¼Œæˆ–æ˜¯å…¶ä»–å³ä¾¿è®“ screen reader æœ—è®€å‡ºä¾†ä¹Ÿç„¡æ³•å¾ˆå¥½å‚³é”æ„æ€çš„å…ƒä»¶ï¼Œå…¶å¯¦è·³éåè€Œæ¯”è¼ƒä¸æœƒé€ æˆæ··æ·†èˆ‡å›°æ“¾ã€‚</p>\n<h3 id=\"dom-çš„é †åº\" style=\"position:relative;\"><a href=\"#dom-%E7%9A%84%E9%A0%86%E5%BA%8F\" aria-label=\"dom çš„é †åº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DOM çš„é †åº</h3>\n<p>Screen reader åœ¨ç§»å‹•æ™‚ï¼Œæœƒä¾ç…§ DOM çš„é †åºé€²è¡Œï¼Œæ‰€ä»¥æ‡‰ç•¶ç›¡é‡å°‡ä½ æƒ³è¦å‘ˆç¾çµ¦ä½¿ç”¨è€…çš„å…§å®¹é †åºï¼Œå®Œæ•´çš„å°æ‡‰åˆ° DOM çš„é †åºä¸Šé ­ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œé‚„å¾—æ³¨æ„ CSS çš„å½±éŸ¿ï¼Œä¾‹å¦‚ <code class=\"language-text\">float</code>ï¼Œå°±å¯èƒ½æœƒé€ æˆè¦–è¦ºä¸Šçš„é †åºèˆ‡ DOM é †åºæœ‰æ‰€å·®ç•°ï¼Œå°è‡´ screen reader æœ—è®€çš„æ¬¡åºå—åˆ°å½±éŸ¿èˆ‡ç•«é¢ä¸ç¬¦ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">float</span><span class=\"token punctuation\">:</span> right</span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span>2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span>2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><button style=\"width:100px;background:transparent;color:#5050c5;font-size: 1.5rem;float: right\">1</button><button style=\"width:100px;background:transparent;color:#5050c5;font-size: 1.5rem;\">2</button><button style=\"width:100px;background:transparent;color:#5050c5;font-size: 1.5rem;\">2</button>\n<br/></p>\n<p>å¦å¤–ï¼Œå–„ç”¨ <code class=\"language-text\">tabindex</code>ï¼Œèƒ½å¤ æ›´å¥½çš„å¹«åŠ©ä½¿ç”¨è€…æ“ä½œéµç›¤ï¼ˆtabï¼‰ç€è¦½ç¶²ç«™æ™‚çš„ç§»å‹•é †åºï¼Œç„¡è«–æ˜¯è·³ééš±è—åœ¨ Responsive è¡¨å–®é¸é …ä¸­çš„å…ƒä»¶ï¼Œæˆ–æ˜¯åœ¨é–‹å•Ÿçš„ Modal ä¸­è£½é€ å‡º Key trapï¼Œè®“ä½¿ç”¨è€…ä¸æœƒç§»å‹•åˆ° Modal è¦†è“‹ä¸‹çš„å…ƒä»¶ä¸Šã€‚</p>\n<h3 id=\"èªç¾©åŒ–æ¨™ç±¤\" style=\"position:relative;\"><a href=\"#%E8%AA%9E%E7%BE%A9%E5%8C%96%E6%A8%99%E7%B1%A4\" aria-label=\"èªç¾©åŒ–æ¨™ç±¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>èªç¾©åŒ–æ¨™ç±¤</h3>\n<p>çœ¾æ‰€çš†çŸ¥ï¼ŒSemantic HTML å°æ–¼æé«˜ SEO å¾ˆæœ‰å¹«åŠ©ï¼Œç„¶è€Œï¼Œå®ƒä¹Ÿèƒ½å¤§å¤§å¢åŠ ç¶²ç«™çš„å¯è¨ªæ€§ï¼ˆå¤§æ¦‚ä¹Ÿæ˜¯å› æ­¤æ‰æœƒè®“ SEO æ•ˆæœæå‡ï¼‰ï¼Œä¸€å€‹å¥½çš„ Semantic HTML Element æ‡‰è©²åŒ…å«ï¼š</p>\n<ol>\n<li>Roleï¼š å…ƒä»¶çš„é¡å‹ï¼ˆæŒ‰éˆ•ã€input å…ƒä»¶ã€è¶…é€£çµç­‰ç­‰ï¼‰</li>\n<li>Name(Label)ï¼šé€šå¸¸èˆ‡ input å…ƒä»¶ä¸¦ç”¨ï¼Œåƒæ˜¯ radio inputã€dropdown list ç­‰ç­‰</li>\n<li>Stateï¼šå…ƒä»¶ç•¶ä¸‹çš„ç‹€æ…‹ï¼ˆé»æ“Šã€å±•é–‹ã€æ”¶åˆï¼‰</li>\n<li>Valueï¼šå…ƒä»¶å…§çš„å€¼ï¼ˆInput å…ƒä»¶å…§çš„å€¼ã€Button ä¸Šçš„æ–‡å­—ç­‰ç­‰ï¼‰</li>\n</ol>\n<p>ç€è¦½å™¨æœƒæ ¹æ“šä½ çš„ HTML å»ºé€ å‡º DOM Treeï¼ŒåŒæ™‚ä¹Ÿæœƒä¾ç…§ä½ åœ¨ DOM å…ƒä»¶ä¸Šçš„è³‡è¨Šå»ºé€ å‡º Accessibility Treeï¼ˆ<a href=\"https://developers.google.com/web/fundamentals/accessibility/semantics-builtin/the-accessibility-tree\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">source</a>ï¼‰ï¼š</p>\n<p><img src=\"/image/treestructure.jpg\" alt=\"accessibility-tree\"></p>\n<p>è€Œ Screen reader å°±æœƒæ ¹æ“šé€™æ£µ Accessibility Tree é€²è¡Œæœ—è®€ï¼Œå› æ­¤ä½ æä¾›çš„ Semantic HTML è¶Šæ¸…æ¥šï¼Œè³‡è¨Šè¶Šè©³ç´°ï¼Œå°±èƒ½å¤ å»ºæ§‹å‡ºè¶Šå¼·å¥çš„ Accessibility Tree ä¾›è¼”åŠ©å·¥å…·åƒè€ƒã€‚</p>\n<p>å†è€…ï¼Œå¦‚åŒæ–‡ç« å‰é ­æåˆ°çš„ï¼Œç¶²é ä¸Šçš„åª’é«”å…ƒä»¶ï¼Œåƒæ˜¯ <code class=\"language-text\">img</code>ã€<code class=\"language-text\">video</code> æˆ–æ˜¯è¦–è¦ºåœ–è¡¨ï¼Œéƒ½æ‡‰è©²æä¾›å°æ‡‰çš„ <code class=\"language-text\">alt</code> æè¿°ï¼Œè®“ Screen reader è‡³å°‘èƒ½æ ¹æ“š <code class=\"language-text\">alt</code> ä¾†èªªæ˜è©²åª’é«”å…ƒä»¶çš„å…§å®¹ã€‚ä¸éï¼Œè‹¥æ˜¯å–®ç´”æ‹¿ä¾†è£é£¾ç”¨çš„ <code class=\"language-text\">img</code>ï¼Œå¯ä»¥çµ¦äºˆ <code class=\"language-text\">alt</code> ç©ºå€¼ï¼Œä»£è¡¨å…¶è£é£¾æ€§ã€‚</p>\n<p>æƒ³æª¢æ¸¬ç¶²ç«™æ˜¯å¦æœ‰è¶³å¤ å®Œæ•´çš„ Accessibility Tree çš„è©±ï¼Œå¯ä»¥ç”¨ Chrome æ‰“é–‹ä½ æƒ³çœ‹çš„ç¶²ç«™ï¼Œä¸¦ä¸”é–‹å•Ÿé–‹ç™¼è€…å·¥å…·ï¼Œåœ¨ Element æ¨™ç±¤å…§ï¼Œå³å´å¯ä»¥æ‰¾åˆ° Accessibility çš„ tabï¼Œåœ¨é‚£é‚Šå°±èƒ½çœ‹åˆ°ç•¶å‰é é¢å…ƒä»¶çš„ Accessibility Treeï¼š</p>\n<p><img src=\"/image/chrome-dev-AT.png\" alt=\"Chrome DevTool Accessibility Tree\"></p>\n<h3 id=\"wai-aria\" style=\"position:relative;\"><a href=\"#wai-aria\" aria-label=\"wai aria permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WAI-ARIA</h3>\n<p>WAI-ARIAï¼Œä»£è¡¨ Web Accessibility Initiative â€” Accessibility Rich Internet Applications ï¼ˆç¶²é å¯è¨ªæ€§å€¡è­° â€” ç„¡éšœç¤™ç¶²é æ‡‰ç”¨ï¼‰ã€‚</p>\n<p>ä¸Šé¢ç« ç¯€æˆ‘å€‘æåˆ°ç€è¦½å™¨æœƒä¾ç…§ Semantic HTML Element ä¾†å»ºæ§‹ Accessibility Treeï¼Œç„¶è€Œæœ‰æ™‚ä½ éœ€è¦ä½¿ç”¨åƒæ˜¯ <code class=\"language-text\">div</code>ã€<code class=\"language-text\">span</code> ç­‰å…ƒç´ ä¾†åšä¸€äº›å®¢è£½åŒ–çš„å…ƒä»¶æ™‚ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿä¸å°±ç„¡æ³•ä¿æŒèªç¾©äº†å—ï¼Ÿ</p>\n<p>é€™æ™‚ WAI-ARIA å°±æ´¾å¾—ä¸Šç”¨å ´äº†ã€‚ä½¿ç”¨ ARIA å±¬æ€§ï¼Œæˆ‘å€‘å°±å¯ä»¥è£œè¶³å…ƒä»¶ç¼ºå°‘çš„è¨Šæ¯ï¼Œè®“å®ƒé€²å…¥ Accessibility Tree ç•¶ä¸­ã€‚ï¼ˆ<a href=\"https://developers.google.com/web/fundamentals/accessibility/semantics-builtin/the-accessibility-tree\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">source</a>ï¼‰</p>\n<p><img src=\"/image/dom-aria-tree.png\" alt=\"DOM+ARIA\"></p>\n<p>èˆ‰å€‹ä¾‹å­ï¼š</p>\n<p>ä¸€å€‹ç”¨ <code class=\"language-text\">&lt;li></code> å…ƒä»¶æ‰€å®¢è£½åŒ–çš„ checkboxï¼Œæˆ‘å€‘å¯ä»¥ä¾é  CSS è®“ä»– \"è¡¨ç¾\" å¾—åƒ checkboxï¼Œå°æ–¼è¦–åŠ›æ­£å¸¸çš„äººä¾†èªªæ˜¯æ²’å•é¡Œçš„ï¼Œä½† screen reader å¯ä¸èªå¾—ä»–ï¼Œå› æ­¤æˆ‘å€‘è‡³å°‘å¿…é ˆåŠ ä¸Š ARIA å±¬æ€§ä¸­çš„ï¼š<code class=\"language-text\">role</code> èˆ‡ <code class=\"language-text\">aria-*</code>ï¼Œè®“å…¶åŠ å…¥åˆ° Accessibility Tree ä¸­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span> &lt;li tabindex=\"0\" class=\"checkbox\" checked>\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> &lt;li tabindex=\"0\" class=\"checkbox\" role=\"checkbox\" checked aria-checked=\"true\">\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> Receive promotional offers\n</span><span class=\"token deleted-arrow deleted\"><span class=\"token prefix deleted\"><</span>/li></span></code></pre></div>\n<p><code class=\"language-text\">role</code> ï¼Œç­‰æ–¼å®£å‘Šè©² DOM å…ƒä»¶è©²æ‰®æ¼”ä»€éº¼è§’è‰²ï¼Œåƒæ˜¯ <code class=\"language-text\">checkbox</code>ã€<code class=\"language-text\">button</code> æˆ– <code class=\"language-text\">dialog</code> ç­‰ï¼Œé‚„å¯å†åˆ†é¡å‡º <code class=\"language-text\">Widget roles</code>ã€<code class=\"language-text\">Composite roles</code> å’Œ <code class=\"language-text\">Landmark roles</code> ç­‰ç­‰ã€‚è©³ç´° spec å¯ä»¥çœ‹ <a href=\"https://www.w3.org/TR/wai-aria-1.1/#role_definitions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">W3C çš„å®šç¾©</a></p>\n<p>è€Œæ­é… <code class=\"language-text\">role</code> ä½¿ç”¨çš„ <code class=\"language-text\">aria-*</code> å‰‡ç‚ºå…ƒä»¶å®šç¾©äº†<em>å±¬æ€§</em>èˆ‡<em>ç‹€æ…‹</em>ï¼Œåƒæ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ <code class=\"language-text\">aria-checked=\"true\"</code> å³ç‚ºå…ƒç´ ç‹€æ…‹çš„ä¸€ç¨®ï¼Œå‘ŠçŸ¥ Accessibility Tree é€™å…ƒä»¶ç›®å‰å±¬æ–¼ <code class=\"language-text\">checked</code> ç‹€æ…‹ã€‚</p>\n<p>ä¹Ÿèƒ½é€é <code class=\"language-text\">aria-lable</code> è¨­å®šå°ˆé–€çµ¦è¼”åŠ©å·¥å…·ä½¿ç”¨çš„ APIï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>button aria<span class=\"token operator\">-</span>label<span class=\"token operator\">=</span><span class=\"token string\">\"screen reader only label\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></code></pre></div>\n<p>æˆ–æ˜¯è¨­å®šçˆ¶é …/å­é …è¯ç¹«ï¼Œä¾‹å¦‚æ§åˆ¶ç‰¹å®šå€åŸŸçš„å®¢è£½åŒ–æ²è»¸ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>div role<span class=\"token operator\">=</span><span class=\"token string\">\"scrollbar\"</span> aria<span class=\"token operator\">-</span>controls<span class=\"token operator\">=</span><span class=\"token string\">\"main\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token string\">\"main\"</span><span class=\"token operator\">></span>\n<span class=\"token comment\">// . . .</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></code></pre></div>\n<p>é—œæ–¼ <code class=\"language-text\">role</code> èˆ‡ <code class=\"language-text\">aria-*</code> ç‹€æ…‹å’Œå±¬æ€§ï¼Œå¯ä»¥å…ˆå¾ MDN çš„<a href=\"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/ARIA_Techniques\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é€™ä»½æ–‡ä»¶</a>æ¦‚è§€æ‰€æœ‰åˆ—è¡¨ï¼Œç„¶å¾Œå¾ <a href=\"https://www.w3.org/WAI/PF/aria-1.1/states_and_properties\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">W3C çš„å®šç¾©</a>ä¸­å»ç¿»æ‰¾è©³ç´°è³‡è¨Šã€‚</p>\n<h3 id=\"è‰²å½©æ¨£å¼\" style=\"position:relative;\"><a href=\"#%E8%89%B2%E5%BD%A9%E6%A8%A3%E5%BC%8F\" aria-label=\"è‰²å½©æ¨£å¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è‰²å½©ã€æ¨£å¼</h3>\n<p>æ–‡ç« å‰é¢æœ‰æåˆ°ï¼Œè¨­è¨ˆé¡è‰²æ™‚ï¼Œæ‡‰ç•¶ä½¿ç”¨ä¸€äº›è¼”åŠ©å·¥å…·å¦‚ <a href=\"http://www.color-blindness.com/coblis-color-blindness-simulator/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">coblis</a> ä¾†æ¨¡æ“¬è‰²ç›²çš„ä½¿ç”¨è€…æ˜¯å¦‚ä½• \"çœ‹\" ä½ çš„ç¶²ç«™ï¼Œå¯ä»¥æ ¹æ“šé€™äº›æ¸¬è©¦èˆ‡è³‡è¨Šï¼Œèˆ‡è¨­è¨ˆå¸«è¨è«–ï¼Œè£½ä½œå‡º color blind friendly çš„ä»‹é¢ã€‚</p>\n<p>é™¤äº†é¡è‰²ä¹‹å¤–ï¼Œå¾æ–‡å­—çš„å¤§å°ã€è¡¨æ ¼çš„é–“éš™ï¼Œåˆ°é•·æ¢åœ–ä¸­æ¯æ¢ Bar çš„è·é›¢ï¼Œéƒ½å¯èƒ½å½±éŸ¿åˆ°è¦–è¦ºéšœç¤™çš„ä½¿ç”¨è€…ï¼Œä¹Ÿéƒ½å¯ä»¥åœ¨è¨­è¨ˆç„¡éšœç¤™ç¶²ç«™æ™‚è€ƒæ…®é€²å»ã€‚</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>ä¸çŸ¥é“å¤§å®¶æŠ•èº« Web é ˜åŸŸçš„å‹•æ©Ÿæ˜¯ä»€éº¼ï¼Œæˆ‘æƒ³ä¸€å®šæœ‰éƒ¨åˆ†äººçš„ç†ç”±èˆ‡æˆ‘ç›¸åŒï¼Œç›¸ä¿¡ Web æ˜¯æœ€å¹³æ˜“è¿‘äººçš„åª’ä»‹ï¼Œèƒ½è¼•æ˜“æŠŠä»»ä½•è³‡è¨Šå¸¶çµ¦å…¨ä¸–ç•Œï¼Œä½ ä¸ç”¨å­˜éŒ¢åŠå¤©æ‰èƒ½è²·åˆ°ä¸€å° iPhone é€²å…¥ App Store ä¸‹è¼‰æ‡‰ç”¨ç¨‹å¼ï¼Œåªéœ€è¦åˆ°åœ–æ›¸é¤¨æŠŠé›»è…¦æ‰“é–‹ï¼Œé€éç€è¦½å™¨å³å¯é€£æ¥ä¸–ç•Œã€‚å¦‚æœä½ ä¹Ÿæœ‰åŒæ¨£ä¿¡å¿µï¼Œé™¤äº†åŠ å¼· Web performanceï¼Œè®“å­˜å–ç¶²ç«™çš„é–€æª»é™ä½å¤–ï¼Œæå‡ Web Accessibility è®“ç¶²ç«™èƒ½çœŸæ­£æœå‹™åˆ° \"æ‰€æœ‰äºº\"ï¼Œçµ•å°ä¹Ÿæ˜¯å¿…ä¿®çš„èª²é¡Œä¹‹ä¸€ï¼Œå¼­å¹³è³‡è¨Šè½å·®ï¼Œè½å¯¦å…¬å¹³æ­£ç¾©ï¼Œå¾ä½ æˆ‘åšèµ·ï¼</p>\n<p>P.S. Web Accessibility çš„å…§å®¹å¾ˆå¤šï¼Œé€™ç¯‡æ–‡ç« æ—¨åœ¨å¼•èµ·å¤§å®¶å°å…¶çš„é‡è¦–ï¼Œè©³ç´°çš„è¦æ ¼èˆ‡å¯¦ä½œç´°ç¯€å¯ä»¥å¾åº•ä¸‹çš„åƒè€ƒè³‡æ–™ä¸­å»é–±è®€ã€‚</p>\n<h3 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h3>\n<ol>\n<li><a href=\"https://youtu.be/dvtfNpt75aA?t=26101\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React rally 2019</a></li>\n<li><a href=\"https://ethanmarcotte.com/wrote/amphora/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Amphora</a></li>\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Learn/Accessibility\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MDN - å¯è¨ªå•æ€§</a></li>\n<li><a href=\"https://developers.google.com/web/fundamentals/accessibility\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Google - ç„¡éšœç¤™åŠŸèƒ½</a></li>\n<li><a href=\"https://medium.com/frochu/%E5%9B%9E%E6%AD%B8%E5%88%9D%E5%BF%83-%E4%B8%80%E6%8E%A2web-accessibility-baaa4d22f4a7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å›æ­¸åˆå¿ƒï¼Œä¸€æ¢ Web Accessibility</a></li>\n<li><a href=\"https://ithelp.ithome.com.tw/users/20108045/ironman/2454\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å¯¦è¸ç„¡éšœç¤™ç¶²é è¨­è¨ˆï¼ˆWeb Accessibilityï¼‰ç³»åˆ—</a></li>\n<li><a href=\"https://www.a11ywithlindsey.com/blog/accessibility-d3-bar-charts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Accessibility in d3 Bar Charts</a></li>\n</ol>","id":"98824468-2f67-5ad2-b305-72e3f8289a36","fields":{"slug":"web-accessibility-intro"},"frontmatter":{"date":"2019-10-13T17:07:29.000Z","title":"Web Accessibility çš„é‡è¦æ€§","tags":["web","web accessibility","a11y","javascript"],"type":"tech","slug":"web-accessibility-intro"},"timeToRead":14},{"excerpt":"ã€æ—¢ç„¶å¾ˆå¹¸é‹ä¸éœ€è¦ç‚ºç”Ÿå­˜æ™æ‰, é‚£å°±è©²ç›¡é‡éå¤šç¨®çš„ç”Ÿæ´»æ¯”è¼ƒä¸æ‰è²»è‡ªå·±æŒæ¡çš„è³‡æºã€‚ã€","html":"<blockquote>\n<p>ã€æ—¢ç„¶å¾ˆå¹¸é‹ä¸éœ€è¦ç‚ºç”Ÿå­˜æ™æ‰, é‚£å°±è©²ç›¡é‡éå¤šç¨®çš„ç”Ÿæ´»æ¯”è¼ƒä¸æ‰è²»è‡ªå·±æŒæ¡çš„è³‡æºã€‚ã€</p>\n</blockquote>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>åœ¨ä»Šå¹´å¹´åˆçš„æ™‚å€™ï¼ŒW3C æ­£å¼å°‡ Web Authentication (WebAuthn) åˆ—å…¥<a href=\"https://www.w3.org/TR/webauthn/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ­£å¼æ¨™æº–</a>ï¼Œé–‹ç™¼è€…å¯ä»¥é€é API å•Ÿå‹• <a href=\"https://fidoalliance.org/fido2/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">FIDO 2 é©—è­‰</a>ï¼Œè®“ä½¿ç”¨è€…é€éè¡Œå‹•è£ç½®ã€æŒ‡ç´‹è¾¨è­˜æˆ–ç¡¬é«”å®‰å…¨é‡‘é‘°ä¾†ç™»å…¥å¸³è™Ÿï¼Œä¸éœ€è¼¸å…¥å¯†ç¢¼ï¼</p>\n<p>é›–ç„¶ç›®å‰<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API#Browser_compatibility\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ”¯æ´åº¦é‚„ä¸é«˜</a>ï¼Œä½†æ—¢ç„¶å·²æˆç‚ºæ¨™æº–ï¼Œæ²’ç†ç”±ä¸ä¾†èªè­˜ä¸€ä¸‹ä½•è¬‚ Web Authenticationï¼Œä»¥åŠæˆ‘å€‘å¯ä»¥å¦‚ä½•ä½¿ç”¨ã€‚ä»Šå¤©å°±ä¸€èµ·ä¾†äº†è§£æˆ‘å€‘èƒ½å¦‚ä½•ä½¿ç”¨ Web Authenticationï¼Œå¢åŠ ç¶²ç«™å®‰å…¨æ€§ï¼Œä¸¦å…é™¤å¯†ç¢¼å¸¶çµ¦æˆ‘å€‘çš„è«¸å¤šéº»ç…©ã€‚</p>\n<h2 id=\"å…ˆå›æ†¶ä¸€ä¸‹æˆ‘å€‘å¹³å¸¸çš„è¨»å†Šç™»å…¥æ–¹å¼\" style=\"position:relative;\"><a href=\"#%E5%85%88%E5%9B%9E%E6%86%B6%E4%B8%80%E4%B8%8B%E6%88%91%E5%80%91%E5%B9%B3%E5%B8%B8%E7%9A%84%E8%A8%BB%E5%86%8A%E7%99%BB%E5%85%A5%E6%96%B9%E5%BC%8F\" aria-label=\"å…ˆå›æ†¶ä¸€ä¸‹æˆ‘å€‘å¹³å¸¸çš„è¨»å†Šç™»å…¥æ–¹å¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å…ˆå›æ†¶ä¸€ä¸‹æˆ‘å€‘å¹³å¸¸çš„è¨»å†Šç™»å…¥æ–¹å¼</h2>\n<p>ä¸ç®¡æ˜¯æ‰‹æ©Ÿ application æˆ–æ˜¯ç¶²ç«™ï¼Œåªè¦æ˜¯éœ€è¦ç™»å…¥æ“ä½œçš„ï¼Œå‹¢å¿…éƒ½æœƒæä¾›ä¸€å€‹é é¢è®“ä½ è¨»å†Šå¸³è™Ÿèˆ‡å¯†ç¢¼ï¼Œæ¥è‘—ä½ æ‰èƒ½æ‹¿è‘—é€™çµ„å¸³å¯†ç™»å…¥é€²è¡Œä½¿ç”¨ã€‚é€™æ˜¯æˆ‘å€‘ç¿’ä»¥ç‚ºå¸¸çš„ä½¿ç”¨æ–¹å¼ï¼Œä½†éš¨ä¹‹è€Œä¾†çš„å•é¡Œå¤§å®¶ä¹Ÿæ˜¯è¦‹æ€ªä¸æ€ªï¼š</p>\n<ul>\n<li>æ¯å€‹ç¶²ç«™éƒ½è¦æƒ³ä¸€çµ„æ–°å¯†ç¢¼ï¼Œè‹¥ç”¨å¤ªå›ºå®šçš„ pattern åˆå®¹æ˜“è¢«çŒœåˆ°ã€‚</li>\n<li>å¤ªè¤‡é›œçš„å¯†ç¢¼å®¹æ˜“å¿˜è¨˜ã€‚</li>\n<li>è‡ªå·±è¦é˜²ç¯„é‡£é­šç¶²ç«™ã€‚</li>\n<li>éœ€è¦æ“”å¿ƒè©²ç¶²ç«™è¢«å…¥ä¾µï¼Œå¯†ç¢¼é­å·ç«Šã€‚</li>\n</ul>\n<p>è€Œå¤§ç´„æœ‰<a href=\"https://duo.com/blog/state-of-the-auth-experiences-and-perceptions-of-multi-factor-authentication\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä¸‰æˆå·¦å³</a>å±æ©Ÿæ„è­˜è¼ƒé«˜çš„ä½¿ç”¨è€…æœƒå•Ÿç”¨ 2FA (2 factor authentication)ï¼Œä½†é€™ä½•å˜—ä¸æ˜¯ç‚ºä½¿ç”¨ä¸Šå¸¶ä¾†æ›´å¤šä¸ä¾¿ï¼Ÿ</p>\n<p>å› æ­¤ WebAuthn å°±æ˜¯å¸Œæœ›ä¾†è§£æ±ºé€™äº›å•é¡Œï¼Œç‚ºæˆ‘å€‘ä½¿ç”¨è€…æä¾›ä¸€å€‹é™¤äº†å¯†ç¢¼ç™»å…¥ä»¥å¤–çš„é¸é …ã€‚</p>\n<h2 id=\"å†ä¾†èªªæ˜ä¸€ä¸‹åŸºæœ¬è§€å¿µ\" style=\"position:relative;\"><a href=\"#%E5%86%8D%E4%BE%86%E8%AA%AA%E6%98%8E%E4%B8%80%E4%B8%8B%E5%9F%BA%E6%9C%AC%E8%A7%80%E5%BF%B5\" aria-label=\"å†ä¾†èªªæ˜ä¸€ä¸‹åŸºæœ¬è§€å¿µ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å†ä¾†èªªæ˜ä¸€ä¸‹åŸºæœ¬è§€å¿µ</h2>\n<p>è½åˆ°æ‰€è¬‚<strong>å…å¯†ç¢¼ç™»å…¥</strong>ï¼Œæ‡‰è©²å¾ˆå®¹æ˜“è¯æƒ³åˆ°æˆ‘å€‘é€é SSH é€£é€²é ç«¯ Server æ™‚ï¼Œå¤§å¤šä¹Ÿæœƒè¨­å®šå…å¯†ç¢¼ç™»å…¥ï¼Œé€éçš„æ˜¯ <a href=\"https://en.wikipedia.org/wiki/Public-key_cryptography\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Public-key cryptography</a> æˆ–åˆç¨± <a href=\"https://en.wikipedia.org/wiki/Public-key_cryptography\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">asymmetric cryptography</a>ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨ç”¢ç”Ÿä¸€çµ„éå°ç¨±çš„åŠ å¯†é‡‘é‘°ï¼š<code class=\"language-text\">private key</code> èˆ‡ <code class=\"language-text\">public key</code>ï¼Œåˆå¯ç¨±ä½œ <code class=\"language-text\">credential</code>ï¼Œè®“ä½¿ç”¨è€…è‡ªå·±ä¿ç®¡ private keyï¼Œè€Œæœå‹™ç«¯åˆ©ç”¨ public key ä¾†é©—è­‰ä½¿ç”¨è€…çš„èº«ä»½ã€‚</p>\n<p>WebAuthn ä¹Ÿæ˜¯åˆ©ç”¨ç›¸åŒçš„åŠ å¯†åŸç†ä¾†é”æˆå…å¯†ç¢¼çš„ Authenticationã€‚</p>\n<p><img src=\"/image/oldway-vs-webauthn.png\" alt=\"How we create account\"></p>\n<h2 id=\"é€²å…¥-api-ç´°ç¯€å‰æˆ‘å€‘ç§‘æ™®ä¸€ä¸‹web-authentication-èˆ‡-fido\" style=\"position:relative;\"><a href=\"#%E9%80%B2%E5%85%A5-api-%E7%B4%B0%E7%AF%80%E5%89%8D%E6%88%91%E5%80%91%E7%A7%91%E6%99%AE%E4%B8%80%E4%B8%8Bweb-authentication-%E8%88%87-fido\" aria-label=\"é€²å…¥ api ç´°ç¯€å‰æˆ‘å€‘ç§‘æ™®ä¸€ä¸‹web authentication èˆ‡ fido permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>é€²å…¥ API ç´°ç¯€å‰ï¼Œæˆ‘å€‘ç§‘æ™®ä¸€ä¸‹ï¼ŒWeb Authentication èˆ‡ FIDO</h2>\n<p>å…¶å¯¦å¾ˆå¤šäººæœƒèª¤è§£ï¼Œä»¥ç‚º WebAuthn æŒ‡çš„å°±æ˜¯ä¸Šè¿°åˆ©ç”¨éå°ç¨±åŠ å¯†ä¾†é”åˆ° authentication çš„æŠ€è¡“ï¼Œä½†å¯¦éš›ä¸Šï¼ŒçœŸæ­£è¦ç¯„é€™é …æŠ€è¡“çš„æ˜¯ <a href=\"https://fidoalliance.org/fido2/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">FIDO2</a>ï¼ŒFIDO2 æ˜¯ FIDO Alliance çš„æœ€æ–°è¦ç¯„ï¼Œè£¡é¢åŒ…å«äº†ä¸€ç³»åˆ—æŠ€è¡“ï¼Œè®“ä½¿ç”¨è€…èƒ½é€éä¸€äº›æ™®é€šçš„è¨­å‚™ï¼Œè¼•æ˜“çš„èˆ‡ç·šä¸Šæœå‹™é€²è¡Œ authenticationï¼Œç„¡è«–æ˜¯ Mobile æˆ–æ˜¯ Desktopã€‚</p>\n<p>FIDO2 è¦ç¯„åŒ…å«äº† WebAuthn èˆ‡ Client-to-Authenticator Protocol (CTAP)</p>\n<p><img src=\"/image/FIDO2-Graphic-v3.png\" alt=\"FIDO2\">\nref: <a href=\"https://fidoalliance.org/fido2/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">fidoalliance.org</a></p>\n<p>ä¹Ÿå°±æ˜¯èªªï¼ŒWebAuthn å…¶å¯¦æ˜¯ FIDO2 çš„ä¸€éƒ¨åˆ†ï¼Œç”¨ä¾†è¦ç¯„æ¨™æº–çš„ Web API è®“ç€è¦½å™¨å¯¦ä½œã€‚</p>\n<p>ç›®å‰æ”¯æ´çš„ç€è¦½å™¨æœ‰ Chrome, Firefox, Edge èˆ‡ Safari preview ç‰ˆã€‚å¦å¤–ä¹Ÿå¯ä»¥å†å¤šåƒè€ƒ <a href=\"https://duo.com/blog/developments-to-webauthn-and-the-fido2-framework\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Duo çš„æ–‡ç« </a>ã€‚</p>\n<p>æˆ‘å€‘ç¨å¾®è§£é‡‹ä¸€ä¸‹ä¸Šåœ–ï¼š</p>\n<p>ç•¶ä½¿ç”¨è€…åƒæ‡‰ç”¨ç¨‹åºè¦æ±‚è¨»å†Šæˆ–ç™»å…¥æ™‚ï¼Œä½¿ç”¨ FIDO2 çš„æœå‹™ç«¯ (RP App Server) æœƒå‘ŠçŸ¥ç€è¦½å™¨èªªï¼Œæˆ‘å€‘ç¾åœ¨è¦ç”¨ FIDO Authenticationï¼Œè€Œç€è¦½å™¨å‰‡æœƒä½¿ç”¨ WebAuthn APIï¼Œé€é CTAP protocol ä¾†èˆ‡ Authenticator æºé€šï¼Œå­˜å–åˆ°éœ€è¦çš„è³‡è¨Šä¸¦ç”¢ç”Ÿ public key å‚³å›çµ¦æœå‹™ç«¯ã€‚</p>\n<p>é€™é‚Šå‡ºç¾å…©å€‹æ–°åè©ï¼šRP app server èˆ‡ Authenticatorã€‚</p>\n<p>æ‰€è¬‚çš„ RP (Relying Party)ï¼Œæå¯«çš„å°±æ˜¯è² è²¬è¨»å†Šèˆ‡èªè­‰ä½¿ç”¨è€…çš„çµ„ç¹”æˆ–æ˜¯æœå‹™ï¼ŒåŸºæœ¬ä¸Šæˆ‘è¦ºå¾—å°±æ˜¯ä½ çš„ä¼ºæœå™¨ã€‚</p>\n<p>è€Œ Authenticator å°±æ˜¯è² è²¬ç”¢ç”Ÿ credential çš„è»Ÿç¡¬é«”ï¼Œä¾‹å¦‚ï¼šTouchID, YubiKey ç­‰ç­‰ã€‚TouchID é€™ç¨®å­˜åœ¨æ–¼è¨­å‚™å…§éƒ¨çš„ï¼Œå±¬æ–¼ \"platform\" typeï¼Œè€Œ Yubikey é€™é¡å¤–éƒ¨ç¡¬é«”è¨­æ–½å‰‡å±¬æ–¼ \"cross-platform\" typeã€‚</p>\n<h2 id=\"web-authentication-çš„ä¸»è¦ç‰¹æ€§\" style=\"position:relative;\"><a href=\"#web-authentication-%E7%9A%84%E4%B8%BB%E8%A6%81%E7%89%B9%E6%80%A7\" aria-label=\"web authentication çš„ä¸»è¦ç‰¹æ€§ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Authentication çš„ä¸»è¦ç‰¹æ€§ï¼š</h2>\n<ul>\n<li>å¼·å¥çš„å®‰å…¨é«”ç³»ï¼šAuthentication æœ‰å®‰å…¨æ€§ç¡¬é«”ä½œç‚ºæ”¯æ´ï¼Œä¾†å„²å­˜ç§é‘°èˆ‡é€²è¡Œ Web Authentication éœ€è¦çš„åŠ å¯†é‹ç®—ã€‚</li>\n<li>æ•ˆç”¨å—åˆ°ä½œç”¨åŸŸè¦ç¯„ï¼šç”¢ç”Ÿçš„ Credential keypair æ˜¯ç¶å®šåœ¨ origin ä¸Šçš„ï¼Œæ„æ€æ˜¯èªªï¼Œè¨»å†Šåœ¨ \"techbridge.com\" çš„ keypair æ˜¯ä¸èƒ½ç”¨åœ¨ \"bad-techbridge.com\" çš„ç¶²åŸŸä¸Šé ­ï¼Œæ¶ˆé™¤äº†é‡£é­šæ”»æ“Šçš„å±éšªã€‚</li>\n<li>å—èªè­‰çš„ï¼ˆAttestedï¼‰ï¼šä¸Šé¢æåˆ°è² è²¬ç”¢ç”Ÿ credential çš„ Authenticators å¯ä»¥æä¾› certificate ä¾†å¹«åŠ©æœå‹™ç«¯é©—è­‰æ‹¿åˆ°çš„ public key æ˜¯ç”±å¯ä¿¡ä»»çš„ authenticators ç™¼å‡ºï¼Œè€Œéæœ‰å®³çš„ä¾†æºã€‚</li>\n</ul>\n<h2 id=\"web-authentication-api---registering\" style=\"position:relative;\"><a href=\"#web-authentication-api---registering\" aria-label=\"web authentication api   registering permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Authentication API - Registering</h2>\n<p>æ¥è‘—æˆ‘å€‘å¯ä»¥é–‹å§‹ä¾†çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Web Authentication API ä¾†è¨»å†Šä½¿ç”¨è€… ï¼ˆåƒè€ƒè‡³ Duo çš„ <a href=\"https://webauthn.guide/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">webauthn.guide</a>ï¼š</p>\n<p><code class=\"language-text\">navigator.credentials.create()</code></p>\n<p>é¦–å…ˆï¼ŒServer åˆ©ç”¨ <code class=\"language-text\">navigator.credentials.create()</code> ä¾†ç”¢ç”Ÿ client çš„ credential</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> credential <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    publicKey<span class=\"token operator\">:</span> publicKeyCredentialCreationOptions\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">publicKeyCredentialCreationOptions</code> ä¸­æœ‰ä¸€å † required èˆ‡ optional çš„æ¬„ä½éœ€è¦å¡«å¯«ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// should generate from server</span>\n<span class=\"token keyword\">const</span> challenge <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwindow<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span><span class=\"token function\">getRandomValues</span><span class=\"token punctuation\">(</span>challenge<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> userID <span class=\"token operator\">=</span> <span class=\"token string\">'Kosv9fPtkDoh4Oz7Yq/pVgWHS8HhdlCto5cR0aBoVMw='</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> Uint8Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span><span class=\"token function\">atob</span><span class=\"token punctuation\">(</span>userID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">c</span><span class=\"token operator\">=></span>c<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> publicKeyCredentialCreationOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    challenge<span class=\"token punctuation\">,</span>\n    rp<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">\"Tech Bridge\"</span><span class=\"token punctuation\">,</span>\n        id<span class=\"token operator\">:</span> <span class=\"token string\">\"techbridge.inc\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    user<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        id<span class=\"token punctuation\">,</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">\"arvin@techbridge.cc\"</span><span class=\"token punctuation\">,</span>\n        displayName<span class=\"token operator\">:</span> <span class=\"token string\">\"Arvin\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    pubKeyCredParams<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>alg<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> type<span class=\"token operator\">:</span> <span class=\"token string\">\"public-key\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    authenticatorSelection<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        authenticatorAttachment<span class=\"token operator\">:</span> <span class=\"token string\">\"platform\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    timeout<span class=\"token operator\">:</span> <span class=\"token number\">60000</span><span class=\"token punctuation\">,</span>\n    attestation<span class=\"token operator\">:</span> <span class=\"token string\">\"direct\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">challenge</code>ï¼šchallenge æ˜¯ç”± server ç”¢ç”Ÿçš„ä¸€å€‹ bufferï¼Œè£¡é¢å«æœ‰ä¸€ä¸²éš¨æ©ŸåŠ å¯†éçš„ bytesï¼Œç”¨ä¾†é˜²æ­¢ <a href=\"https://zh.wikipedia.org/wiki/%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">\"replay attacks\"</a>ã€‚é€™é‚Šå–®ç´” demoï¼Œç”¨ <code class=\"language-text\">Unit8Array</code> èˆ‡ <code class=\"language-text\">window.crypto.getRandomValues</code> åšå€‹ç¤ºç¯„ã€‚</p>\n<p><code class=\"language-text\">rp</code>ï¼šå…ˆå‰è§£é‡‹éï¼Œä»£è¡¨ \"relying party\"ï¼ŒæŒ‡çš„å°±æ˜¯è¨»å†Šèˆ‡èªè­‰ä½¿ç”¨è€…çš„ç¶²ç«™ã€‚å…¶ä¸­ï¼Œ<code class=\"language-text\">id</code> ä¸€å®šè¦æ˜¯ç›®å‰ç¶²ç«™çš„ domain çš„ subsetï¼Œåƒæ˜¯å¦‚æœæ˜¯å¾ <code class=\"language-text\">techbridge.cc</code> è§¸ç™¼ WebAuthn èªè­‰ï¼Œé‚£é€™é‚Šçš„ id å°±å¾—å¡«å¯« <code class=\"language-text\">techbridge.cc</code>ã€‚</p>\n<p><code class=\"language-text\">user</code>ï¼šå°±æ˜¯ç›®å‰æƒ³è¦è¨»å†Šçš„ä½¿ç”¨è€…çš„è³‡è¨Šï¼Œé€™é‚Šçš„ <code class=\"language-text\">id</code> å¾ˆé‡è¦ï¼Œauthenticator æœƒç”¨é€™å€‹ id ä¾†èˆ‡ credential åšé€£çµï¼Œé€™æ¨£ä¹‹å¾Œæ‰èƒ½é€éä¸€æ¨£çš„ <code class=\"language-text\">id</code> èˆ‡ä¸€æ¨£çš„ autenticator å»èªè­‰ä½ æ˜¯åŒå€‹ userã€‚è€Œé€™è³‡è¨Šå¯èƒ½æœƒè¢«å­˜åœ¨ authenticator ä¸­ï¼Œä¾æ“šä¸åŒè¼‰å…·èˆ‡å¯¦ä½œæœƒæœ‰ä¸åŒï¼Œä½†æ˜¯å› ç‚ºæœ‰é€™å¯èƒ½æ€§å­˜åœ¨ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸å»ºè­° id å…§è—æœ‰å¯ä»¥èªå‡ºä½ æœ¬èº«çš„ç›¸é—œå€‹äººè³‡è¨Šï¼Œåƒæ˜¯ç”Ÿæ—¥ç­‰ç­‰çš„ã€‚</p>\n<p><code class=\"language-text\">pubKeyCredParams</code>ï¼šé€™å€‹ array ç”¨ä¾†æè¿° Server æ”¯æ´å“ªäº› types çš„ public key (signing algorithms) ã€‚ç›®å‰ FIDO2 servers æˆæ¬Šæ”¯æ´ RS1ã€RS256 èˆ‡ ES256ã€‚ <code class=\"language-text\">alg</code> çš„æ•¸å­—å°æ‡‰å¯ä»¥å¾ <a href=\"https://www.iana.org/assignments/cose/cose.xhtml#algorithms\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">COSE</a> å»æ‰¾ã€‚</p>\n<p><code class=\"language-text\">authenticatorSelection (optional)</code>ï¼šå¯ä»¥ç”¨ä¾†é™åˆ¶ Relying parties æ”¯æ´çš„ authenticators ç¨®é¡ï¼Œåƒé€™é‚Šæˆ‘æŒ‡å®š platformï¼Œå°±æ˜¯ Touch ID ä¹‹é¡å…§å»ºçš„ authenticatorsã€‚</p>\n<p><code class=\"language-text\">timeout (optional)</code>ï¼šä»¥ milliseconds ç‚ºå–®ä½ï¼Œè¡¨ç¤ºèªªå¦‚æœä½¿ç”¨è€…åœ¨é€™æ®µ timeout æ™‚é–“å…§æ²’æœ‰å›æ‡‰ prompt çš„è©±ï¼Œå°±æœƒå›å‚³èªè­‰å¤±æ•—ã€‚</p>\n<p><code class=\"language-text\">attestation (optional)</code>ï¼šattestation data æ˜¯å¾ authenticator å›å‚³çš„å…§å®¹ï¼Œserver å¯ä»¥ç”¨é€™å€‹é¸é …ä¾†æ±ºå®šè¦è·Ÿ authenticators æ‹¿å¤šå°‘è³‡è¨Šï¼Œæœ‰ä¸‰ç¨®é¸é …ï¼š<em>none</em>ã€<em>indirect</em> èˆ‡ <em>direct</em>ã€‚<em>none</em> æŒ‡çš„æ˜¯ server ä¸åœ¨æ„ attestation è³‡æ–™ï¼›indirect è¡¨ç¤ºé¡˜æ„åªæ‹¿åŒ¿åçš„ attestation è³‡æ–™ï¼›è€Œ direct ä»£è¡¨è¦æ±‚ authenticator å›å‚³æ‰€æœ‰ attestation dataã€‚</p>\n<h2 id=\"çœ‹äº†ä¸€äº›ç¨‹å¼ç¢¼ä¾†å˜—è©¦ä¸€ä¸‹å§\" style=\"position:relative;\"><a href=\"#%E7%9C%8B%E4%BA%86%E4%B8%80%E4%BA%9B%E7%A8%8B%E5%BC%8F%E7%A2%BC%E4%BE%86%E5%98%97%E8%A9%A6%E4%B8%80%E4%B8%8B%E5%90%A7\" aria-label=\"çœ‹äº†ä¸€äº›ç¨‹å¼ç¢¼ä¾†å˜—è©¦ä¸€ä¸‹å§ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çœ‹äº†ä¸€äº›ç¨‹å¼ç¢¼ï¼Œä¾†å˜—è©¦ä¸€ä¸‹å§</h2>\n<p>ç¾åœ¨æ‰“é–‹ç€è¦½å™¨çš„ consoleï¼ŒæŠŠä¸Šé¢é‚£æ®µ code è¤‡è£½ä¸Šå»ï¼Œç„¶å¾Œä½ æœƒç™¼ç¾ä»€éº¼äº‹éƒ½æ²’ç™¼ç”Ÿï¼Ÿï¼</p>\n<p>å› ç‚ºä¸Šé¢é‚£æ®µ code ç•¶ä¸­ï¼Œæˆ‘å€‘åœ¨ <code class=\"language-text\">rp</code> ä¸­çš„ id æœ‰æŒ‡å®š <code class=\"language-text\">techbridge.inc</code>ï¼Œè€Œé€™ä¸¦éä½ ç›®å‰æ‰€åœ¨çš„ domainï¼Œå› æ­¤ç„¡æ³•å•Ÿç”¨ WebAuthnã€‚</p>\n<p>ä¿®æ”¹ä¸€ä¸‹ï¼Œå°‡ <code class=\"language-text\">rp</code> ä¸­çš„ <code class=\"language-text\">id</code> ç§»é™¤ï¼Œå†è©¦ä¸€æ¬¡ï¼š</p>\n<p><img src=\"/image/webauthn-makecredential.gif\" alt=\"demo - make credentail\"></p>\n<p>å°±å¯ä»¥ credentials äº†ï¼</p>\n<p>å¦å¤–ï¼Œå› ç‚ºæˆ‘å€‘åœ¨ <code class=\"language-text\">authenticatorSelection.authenticatorAttachment</code> ä¸­æœ‰æŒ‡å®š <code class=\"language-text\">platform</code>ï¼Œæ‰€ä»¥ç•¶æˆ‘å€‘ä¸€è«‹æ±‚ credential å¾Œï¼ŒChrome æœƒç›´æ¥è·³å‡º prompt è¦æ±‚ä½¿ç”¨ TouchIDï¼ˆä¸Šé¢å‡ºç¾ codepen.io æ˜¯å› ç‚ºæˆ‘åœ¨ codepen.io çš„é é¢ console æ¸¬è©¦ï¼š</p>\n<p><img src=\"/image/touchid-authenticator.png\" alt=\"TouchID authenticator\"></p>\n<p>ä½†å¦‚æœä»Šå¤©ä½ æ²’æœ‰æŒ‡å®šï¼Œæˆ–æ˜¯æŒ‡å®šç‚º <code class=\"language-text\">cross-platform</code>ï¼Œå‰‡æœƒé¡¯ç¤ºå¦‚ä¸‹å…©ç¨® promptï¼š</p>\n<p><strong>cross-platform</strong>ï¼š</p>\n<p>æœƒè¦æ±‚ä½ æ’å…¥å¯¦é«” usb keyã€‚</p>\n<p><img src=\"/image/webauthn-cross-platform.png\" alt=\"cross platform\"></p>\n<p>ä¸æŒ‡å®šï¼š</p>\n<p>ä½ æœ‰å…©ç¨®é¸é …å¯ä»¥é¸æ“‡ï¼Œä½¿ç”¨ TouchID æˆ–æ˜¯å¯¦é«” usb keyã€‚</p>\n<p><img src=\"/image/webauthn-both.png\" alt=\"two options\"></p>\n<h2 id=\"parsing-èˆ‡-validating-è¨»å†Šè³‡æ–™\" style=\"position:relative;\"><a href=\"#parsing-%E8%88%87-validating-%E8%A8%BB%E5%86%8A%E8%B3%87%E6%96%99\" aria-label=\"parsing èˆ‡ validating è¨»å†Šè³‡æ–™ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parsing èˆ‡ Validating è¨»å†Šè³‡æ–™</h2>\n<p>å¾å‰›å‰›çš„ç¯„ä¾‹å¯ä»¥çœ‹åˆ°ï¼Œå‘¼å« <code class=\"language-text\">navigator.credentials.create</code> å¾Œæœƒå›å‚³ä¸€å€‹ credential ç‰©ä»¶ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>credential<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nPublicKeyCredential <span class=\"token punctuation\">{</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">'ADSUllKQmbqdGtpu4sjseh4cg2TxSvrbcHDTBsv4NSSX9...'</span><span class=\"token punctuation\">,</span>\n    rawId<span class=\"token operator\">:</span> <span class=\"token function\">ArrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">59</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    response<span class=\"token operator\">:</span> AuthenticatorAttestationResponse <span class=\"token punctuation\">{</span>\n        clientDataJSON<span class=\"token operator\">:</span> <span class=\"token function\">ArrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">121</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        attestationObject<span class=\"token operator\">:</span> <span class=\"token function\">ArrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">306</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">'public-key'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å…¶ä¸­ï¼š</p>\n<p><code class=\"language-text\">id</code>ï¼šä»£è¡¨ç”¢ç”Ÿçš„ credentialï¼Œåœ¨å° user é€²è¡Œ authentication æ™‚ï¼Œç”¨æ­¤ id ä¾† identify user credentialï¼Œæ˜¯ base64-encoded stringã€‚</p>\n<p><code class=\"language-text\">rawId</code>ï¼šåŒä¸Šï¼Œåªæ˜¯æ˜¯ binary formã€‚</p>\n<p><code class=\"language-text\">response.clientDataJSON</code>ï¼šæ˜¯ç€è¦½å™¨ç”¢ç”Ÿçš„ä¸€çµ„è³‡æ–™ï¼ŒåŒ…å« originã€challenge ç­‰ç­‰ï¼Œé€™å€‹è³‡æ–™é‡è¦åœ¨æ–¼å¯ä»¥ç”¨ä¾†é˜²æ­¢ phishing attempã€‚æ­¤å¤–ï¼Œå…§å®¹æ˜¯ç”± authenticator åŠ å¯†éçš„ã€‚</p>\n<p><code class=\"language-text\">response.attestationObject</code>ï¼šåŒ…å«äº† credential public keyã€optional attestation certificate èˆ‡å…¶ä»– metadataï¼Œç”¨ <a href=\"https://cbor.io/impls.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CBOR</a> encoded éçš„ binary dataã€‚</p>\n<p>æ‹¿åˆ° PublicKeyCredential å¾Œï¼Œå°±å¯ä»¥é€åˆ° Server ç«¯å»é€²è¡Œé©—è­‰èˆ‡å¾ŒçºŒå‹•ä½œã€‚</p>\n<p>WebAuthn è¦ç¯„ä¸­æœ‰æè¿°äº†ä¸€ç³»åˆ—<a href=\"https://w3c.github.io/webauthn/#registering-a-new-credential\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é©—è­‰ registration data çš„ç¨‹åº</a>ï¼Œè€Œå¯¦ä½œéƒ¨åˆ†å‰‡èˆ‡ä½ ç”¨ä»€éº¼èªè¨€æœ‰æ‰€ä¸åŒï¼Œå¯ä»¥åƒè€ƒ Duo Labs çš„ <a href=\"https://github.com/duo-labs/webauthn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Go</a> èˆ‡ <a href=\"https://github.com/duo-labs/py_webauthn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Python</a> ç‰ˆæœ¬ã€‚</p>\n<p>é€™é‚Šä»¥ JavaScript ç‚ºä¾‹èªªæ˜ï¼š</p>\n<p>é¦–å…ˆï¼ŒServer ç«¯éœ€è¦å…ˆè§£æ clientDataJSONï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// decode the clientDataJSON into a utf-8 string</span>\n<span class=\"token keyword\">const</span> utf8Decoder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextDecoder</span><span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> decodedClientData <span class=\"token operator\">=</span> utf8Decoder<span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>\n    credential<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>clientDataJSON<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// parse the string as an object</span>\n<span class=\"token keyword\">const</span> clientDataObj <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>decodedClientData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">clientDataObj</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    challenge<span class=\"token operator\">:</span> <span class=\"token string\">\"ZVTQWf9y7JkEjKFH-iWiKL4FTtTrQJwhYt2kiJQlcM8\"</span>\n    origin<span class=\"token operator\">:</span> <span class=\"token string\">\"https://codepen.io\"</span> <span class=\"token comment\">// again, å› ç‚ºæˆ‘åœ¨ codepen.io çš„é é¢ console æ¸¬è©¦ï¼Œæ‰€ä»¥ origin æ‰æœƒæ˜¯é€™å€‹</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">\"webauthn.create\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>é€™é‚Šæˆ‘å€‘æ‹¿å‡º challengeã€origin èˆ‡ type ä¾†é©—è­‰ï¼Œchallenge æ‡‰è©²è¦èˆ‡ç•¶åˆ Server ç”¢ç”Ÿçš„ä¸€è‡´ã€origin è¦æ­£ç¢ºï¼Œä¸” type è¦ç¢ºå®šç‚º createï¼Œæ‰èƒ½ä»£è¡¨æ˜¯åœ¨è¨»å†Šä½¿ç”¨è€…ã€‚å¦‚æ­¤ä¾†é¿å…é‡£é­šèˆ‡ replay attacksã€‚</p>\n<p>æ¥è‘—ï¼Œè™•ç† attestationObjectï¼Œç”±æ–¼æ˜¯ç”± CBOR encodeï¼Œæ‰€ä»¥éœ€è¦é¡å¤–æ‰¾ lib ä¾† decodeï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// éœ€è¦æ‰¾å€‹ CBOR lib ä¾† decode</span>\n<span class=\"token keyword\">const</span> decodedAttestationObj <span class=\"token operator\">=</span> <span class=\"token constant\">CBOR</span><span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>credential<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>attestationObject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>decodedAttestationObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">{</span>\n    authData<span class=\"token operator\">:</span> <span class=\"token function\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">196</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    fmt<span class=\"token operator\">:</span> <span class=\"token string\">\"fido-u2f\"</span><span class=\"token punctuation\">,</span>\n    attStmt<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        sig<span class=\"token operator\">:</span> <span class=\"token function\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        x5c<span class=\"token operator\">:</span> <span class=\"token function\">Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è§£ç¢¼å‡ºä¾†å¾Œçš„ <code class=\"language-text\">attestationObject</code> å«æœ‰å¹¾é …è³‡è¨Šï¼š</p>\n<ul>\n<li>authDataï¼šauthData é€™å€‹ byte array åŒ…å«è‘—æ‰€æœ‰ registration event çš„ metadataï¼Œä»¥åŠ public keyã€‚</li>\n<li>fmtï¼šé€™å€‹æ˜¯åŒ…å«è‘— attestation çš„ formatï¼Œå¦‚æœä½ åœ¨ create credentials æ™‚æœ‰è¦æ±‚ Authenticators æä¾› attestation dataï¼Œé‚£ server å¯ä»¥å¾é€™å€‹æ¬„ä½çŸ¥é“è©²å¦‚ä½• parse èˆ‡ validate attestation dataã€‚</li>\n<li>attStmtï¼šé€™å°±æ˜¯è¦æ±‚ä¾†çš„ attestation dataï¼Œæ ¹æ“š fmt çš„ä¸åŒæœƒæœ‰ä¸åŒçš„çµæ§‹ï¼Œä»¥é€™é‚Šç¯„ä¾‹ç‚ºä¾‹ï¼Œæˆ‘å€‘æ‹¿åˆ°çš„æ˜¯ä¸€å€‹ signature èˆ‡ x5c certificateï¼Œservers å¯ä»¥ç”¨é€™è³‡æ–™ä¾†é©—è­‰ publickey æ˜¯ä¸æ˜¯ä¾†è‡ªé æœŸçš„ authenticatorï¼Œæˆ–æ˜¯æ ¹æ“š authenticator çš„è³‡è¨Šè€Œ reject authenticate (åƒæ˜¯è¦ºå¾—ä¸èƒ½ä¿¡ä»»è©² certifacateï¼Œç­‰ç­‰)</li>\n</ul>\n<p>æœ€å¾Œå¯ä»¥å¾ authData ä¸­å–å¾—æ›´å¤šè³‡æ–™ï¼šcredentialIdã€publicKeyBytesã€publicKeyObject ç­‰ç­‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>authData<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> decodedAttestationObject<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// get the credential ID</span>\n<span class=\"token keyword\">const</span> credentialId <span class=\"token operator\">=</span> authData<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span> credentialIdLength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// get the public key object</span>\n<span class=\"token keyword\">const</span> publicKeyBytes <span class=\"token operator\">=</span> authData<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">55</span> <span class=\"token operator\">+</span> credentialIdLength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// the publicKeyBytes are encoded again as CBOR</span>\n<span class=\"token keyword\">const</span> publicKeyObject <span class=\"token operator\">=</span> <span class=\"token constant\">CBOR</span><span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>publicKeyBytes<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ•´å€‹ Validation process å®Œæˆå¾Œï¼ŒServer å°±èƒ½å°‡ publicKeyBytes èˆ‡ credentialId å­˜é€²è³‡æ–™åº«ï¼Œèˆ‡ä½¿ç”¨è€…é—œè¯èµ·ä¾†ã€‚</p>\n<p>åˆ°é€™é‚Šç‚ºæ­¢ï¼Œæˆ‘å€‘èµ°å®Œäº† <code class=\"language-text\">Registering</code> çš„æµç¨‹ã€‚è€Œå‰›å‰›éƒ½æ˜¯ç›´æ¥åœ¨ console è²¼å…¥ç¨‹å¼ç¢¼ï¼Œå¦‚æœæƒ³çœ‹ç¨å¾®â€çœŸå¯¦â€œä¸€é»çš„ç¯„ä¾‹ï¼Œå¯ä»¥åˆ° <a href=\"https://herrjemand.github.io/FIDO2WebAuthnSeries/WebAuthnIntro/makeCredExample.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://herrjemand.github.io/FIDO2WebAuthnSeries/WebAuthnIntro/makeCredExample.html</a> é€™å€‹ç¶²å€ç©ç©çœ‹ï¼Œé»é¸ button è¨»å†Šçš„æµç¨‹ã€‚</p>\n<p><img src=\"/image/more-real-demo-1.png\" alt=\"more real demo\"></p>\n<p>æ¥è‘—ï¼Œå†åŠªåŠ›ä¸€ä¸‹ï¼Œçœ‹çœ‹ <code class=\"language-text\">Authenticating</code>ï¼Œä¹Ÿå°±æ˜¯ç™»å…¥æ™‚è¦èµ°çš„æ­¥é©Ÿå§ï¼</p>\n<h2 id=\"web-authentication-api---authenticating\" style=\"position:relative;\"><a href=\"#web-authentication-api---authenticating\" aria-label=\"web authentication api   authenticating permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Authentication API - Authenticating</h2>\n<p>Authenticated çš„éç¨‹ä¸­ï¼Œä½¿ç”¨è€…æœƒç”¨å…¶æŒæœ‰çš„ private key ç°½ä¸Šä¸€å€‹ signature åˆ° assertion ä¸Šé ­ï¼Œä¸¦å‚³çµ¦ serverï¼Œserver å‰‡åˆ©ç”¨ public key ä¾†é©—è­‰è©² signatureã€‚</p>\n<p><code class=\"language-text\">navigator.credentials.get()</code></p>\n<p>Authentication çš„éç¨‹åœ¨æ–¼ä½¿ç”¨è€…è¦è­‰æ˜ä»–å€‘æ“æœ‰è¨»å†Šæ™‚æ‰€æäº¤çš„ key pair ä¸­çš„ private keyã€‚è­‰æ˜æ–¹æ³•ç‚ºåˆ©ç”¨ <code class=\"language-text\">navigator.credentials.get()</code> å–å¾—è¨»å†Šæ™‚çš„ credentialï¼Œä¸¦é™„ä¸Š signatureã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> credential <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    publicKey<span class=\"token operator\">:</span> publicKeyCredentialRequestOptions\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> challenge <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwindow<span class=\"token punctuation\">.</span>crypto<span class=\"token punctuation\">.</span><span class=\"token function\">getRandomValues</span><span class=\"token punctuation\">(</span>challenge<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">const</span> publicKeyCredentialRequestOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    challenge<span class=\"token punctuation\">,</span>\n    allowCredentials<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n        id<span class=\"token operator\">:</span> credentialId<span class=\"token punctuation\">,</span> <span class=\"token comment\">// from registration</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">'public-key'</span><span class=\"token punctuation\">,</span>\n        transports<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'usb'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ble'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nfc'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    timeout<span class=\"token operator\">:</span> <span class=\"token number\">60000</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> assertion <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>credentials<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    publicKey<span class=\"token operator\">:</span> publicKeyCredentialRequestOptions\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è·Ÿè¨»å†Šæ™‚æ¯”è¼ƒä¸åŒçš„æ˜¯ <code class=\"language-text\">allowCredentials</code>ï¼Œé€™æ¬„ä½æ˜¯ Servers ç«¯æƒ³è¦ç€è¦½å™¨æä¾›çš„ credentials è³‡è¨Šï¼Œç”¨ä¾†èªè­‰ä½¿ç”¨è€…ï¼Œå…¶ä¸­ id ç‚ºè¨»å†Šæ™‚ç²å–çš„ credentialIdã€‚æ­¤å¤–ä¹Ÿèƒ½æŒ‡å®šè¦ç”¨å“ªç¨®æ–¹å¼å‚³è¼¸ credentials (usbã€bluetooth æˆ– NFC)ã€‚ä½ å¯ä»¥å¡«å…¥å¤šå€‹ credentialIdï¼Œauthenticator æœƒæ‰¾å‡ºä»–èªè­˜çš„ä¾†ä½¿ç”¨ã€‚</p>\n<p><code class=\"language-text\">navigator.credentials.get</code> å–å¾—çš„ <code class=\"language-text\">assertion</code> ä¹Ÿæ˜¯ä¸€å€‹ <code class=\"language-text\">PublicKeyCredential</code> objectï¼Œè·Ÿè¨»å†Šæ™‚çš„å·®åˆ¥åœ¨æ–¼ï¼Œé€™æ¬¡æˆ‘å€‘æ‹¿åˆ°çš„å¤šäº† signatureï¼Œå°‘äº† public keyã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>assertion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nPublicKeyCredential <span class=\"token punctuation\">{</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">'ADSUllKQmbqdGtpu4sjseh4cg2TxSvrbcHDTBsv4NSSX9...'</span><span class=\"token punctuation\">,</span>\n    rawId<span class=\"token operator\">:</span> <span class=\"token function\">ArrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">59</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    response<span class=\"token operator\">:</span> AuthenticatorAssertionResponse <span class=\"token punctuation\">{</span>\n        authenticatorData<span class=\"token operator\">:</span> <span class=\"token function\">ArrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        clientDataJSON<span class=\"token operator\">:</span> <span class=\"token function\">ArrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">118</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        signature<span class=\"token operator\">:</span> <span class=\"token function\">ArrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        userHandle<span class=\"token operator\">:</span> <span class=\"token function\">ArrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">'public-key'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åŸºæœ¬çµæ§‹éƒ½å·®ä¸å¤šï¼Œå¤šå‡ºä¾†çš„ <code class=\"language-text\">signature</code> æ˜¯ç”± private key èˆ‡æ­¤ credential æ‰€ç”¢ç”Ÿï¼Œåœ¨ server ç«¯å¯ä»¥ç”¨ public key ä¾†é©—è­‰æ­¤ signatureã€‚</p>\n<p><code class=\"language-text\">userHandle</code> å‰‡æ˜¯ authenticator æä¾›çš„ä½¿ç”¨è€… idï¼Œä¹Ÿæ˜¯è¨»å†Šæ™‚ä½¿ç”¨çš„é‚£çµ„ã€‚åœ¨ Server ç«¯å¯ä»¥ç”¨ä¾†é—œè¯ä½¿ç”¨è€…ã€‚</p>\n<h2 id=\"parsing-èˆ‡-validating-ç™»å…¥è³‡æ–™\" style=\"position:relative;\"><a href=\"#parsing-%E8%88%87-validating-%E7%99%BB%E5%85%A5%E8%B3%87%E6%96%99\" aria-label=\"parsing èˆ‡ validating ç™»å…¥è³‡æ–™ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parsing èˆ‡ Validating ç™»å…¥è³‡æ–™</h2>\n<p>æ‹¿åˆ° assertion å¾Œï¼Œå¯ä»¥é€å¾€ server é€²è¡Œé©—è­‰ï¼Œserver æœƒç”¨è¨»å†Šæ™‚çš„ public key ä¾†é©—è­‰ signatureã€‚</p>\n<p>ä¸€æ¨£ï¼ŒServer ç«¯å¯¦ä½œæœ‰å„ç¨®èªè¨€ç‰ˆæœ¬ï¼š<a href=\"https://github.com/duo-labs/webauthn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Go</a> èˆ‡ <a href=\"https://github.com/duo-labs/py_webauthn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Python</a>ï¼Œç­‰ç­‰ã€‚</p>\n<p>é€™é‚Šç°¡å–®èˆ‰ä¾‹ï¼š</p>\n<p>é¦–å…ˆï¼Œå¾è³‡æ–™åº«ä¸­å–å¾— credentialã€‚æ¥è‘—åˆ©ç”¨ public key å’Œ client å‚³ä¾†çš„ signature èˆ‡ authenticator data å’Œ SHA-256 hash éçš„ cliendDataJSON åšé©—è­‰ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> storedCredential <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getCredentialFromDatabase</span><span class=\"token punctuation\">(</span>userHandle<span class=\"token punctuation\">,</span> credentialId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> signedData <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>authenticatorDataBytes <span class=\"token operator\">+</span> hashedClientDataJSON<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> signatureIsValid <span class=\"token operator\">=</span> storedCredential<span class=\"token punctuation\">.</span>publicKey<span class=\"token punctuation\">.</span><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span>signature<span class=\"token punctuation\">,</span> signedData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>signatureIsValid<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"Nice! User is authenticated!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"Oops, verification failed.\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>é€™æ¨£æˆ‘å€‘å°±æŠŠä¸€æ®µç„¡å¯†ç¢¼ç™»å…¥çš„è¨»å†Šèˆ‡ç™»å…¥æµç¨‹éƒ½èµ°å®Œäº†ï¼ä¸€æ¨£ï¼Œå¯ä»¥åˆ° <a href=\"https://herrjemand.github.io/FIDO2WebAuthnSeries/WebAuthnIntro/PasswordlessExample.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://herrjemand.github.io/FIDO2WebAuthnSeries/WebAuthnIntro/PasswordlessExample.html</a> ä¾†ç©ç©çœ‹å¯¦éš›ä¸€é»çš„ç¯„ä¾‹ã€‚</p>\n<p><img src=\"/image/more-real-demo-2.gif\" alt=\"more real demo\"></p>\n<h2 id=\"çµè«–èˆ‡æ›´å¤šè³‡æº\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96%E8%88%87%E6%9B%B4%E5%A4%9A%E8%B3%87%E6%BA%90\" aria-label=\"çµè«–èˆ‡æ›´å¤šè³‡æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–èˆ‡æ›´å¤šè³‡æº</h2>\n<p>ä»Šå¤©èŠ±äº†é»æ™‚é–“æŠŠ Web Authentication çš„æ¦‚å¿µèˆ‡å¤§è‡´çš„å¯¦ä½œæ–¹å¼ç­è§£äº†ä¸€ç•ªï¼Œé›–ç„¶æ‰å‰›æˆç‚ºæ¨™æº–ï¼Œé›¢å…¨éƒ¨ç€è¦½å™¨éƒ½æ”¯æ´é‚„éœ€è¦ä¸€é»æ™‚é–“ï¼Œä½†æœ€æ–°ç‰ˆçš„ç€è¦½å™¨å¹¾ä¹éƒ½å·²æ”¯æ´ï¼ˆè‡³å°‘æ¡Œæ©Ÿç‰ˆï¼‰ï¼Œæƒ³å¿…ä¸ä¹…çš„æœªä¾†ï¼Œpasswordless çš„ç™»å…¥æœƒæ˜¯ä¸€ç¨®è¶¨å‹¢ã€‚</p>\n<p>é€™é‚Šå†å¤šæä¾›å¹¾å€‹ç¶²ç«™è³‡æºä¾›å¤§å®¶åƒè€ƒï¼Œè£¡é¢æœ‰æ›´ç‚ºè±å¯Œçš„ç¯„ä¾‹ç¨‹å¼ï¼Œä»¥åŠè©³ç´°çš„ API èˆ‡æƒ…å¢ƒè§£èªªï¼š</p>\n<ol>\n<li><a href=\"https://duo.com/blog/tags/web-authentication\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Duo blog</a> - Duo æ˜¯ Cisco æ——ä¸‹çš„å…¬å¸ï¼Œä¸»è¦ç™¼å±•èˆ‡ Authentication èˆ‡ security ç›¸é—œçš„ç”¢å“ï¼Œä¹Ÿå› æ­¤é‡å° web authentication æœ‰ä¸å°‘çš„æ–‡ç« æ•™å­¸èˆ‡ä»‹ç´¹ã€‚</li>\n<li><a href=\"https://github.com/herrjemand/FIDO2WebAuthnSeries\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">FIDO2WebAuthnSeries</a> - é€™æ˜¯æˆ‘åœ¨æ‰¾è³‡æ–™éç¨‹ä¸­ç™¼ç¾çš„ç¯„ä¾‹ githubï¼Œè£¡é¢æœ‰å¤šç¨®æƒ…å¢ƒçš„ source code èˆ‡ demoï¼Œæ¨è–¦å¤§å®¶å»ç©ç©çœ‹ï¼Œçœ‹çœ‹ç¨‹å¼ç¢¼ï¼Œæƒ³å¿…æœƒæ›´åŠ äº†è§£ã€‚ä½œè€…ä¹Ÿæœ‰åœ¨ Medium ä¸Šå¯«äº†ä¸€ç¯‡<a href=\"https://medium.com/@herrjemand/introduction-to-webauthn-api-5fd1fb46c285\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é•·æ–‡</a>ä»‹ç´¹ï¼Œæ›´è©³ç´°çš„èªªæ˜å„ç¨®æƒ…å¢ƒçš„ Web authentication æ‡‰ç”¨æœƒæ˜¯å¦‚ä½•çš„æµç¨‹ï¼Œè€Œæˆ‘å€‘çš„ç¨‹å¼ç¢¼åˆè©²å¦‚ä½•ä¿®æ”¹ã€‚å¦‚æœè¦ºå¾—é€™ç¯‡æ–‡ç« å…§çš„ç¯„ä¾‹èˆ‡èªªæ˜ä¸å¤ æ¸…æ¥šï¼Œå¯ä»¥åˆ°ä»–çš„ medium çœ‹çœ‹ã€‚</li>\n</ol>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://webauthn.guide/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">webauthn.guide</a></li>\n<li><a href=\"https://medium.com/@herrjemand/introduction-to-webauthn-api-5fd1fb46c285\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Introduction to WebAuthn API</a></li>\n<li><a href=\"https://github.com/herrjemand/FIDO2WebAuthnSeries\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">FIDO2WebAuthnSeries</a></li>\n<li><a href=\"https://webauthn.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">webauthn.io</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web Authentication API - MDN</a></li>\n</ol>","id":"e8f002a3-30f5-5fda-ba02-bdcbc3fc734d","fields":{"slug":"webauthn-intro"},"frontmatter":{"date":"2019-08-17T10:29:18.000Z","title":"ä¸€èµ·ä¾†äº†è§£ Web Authentication","tags":["web","authentication","security"],"type":"tech","slug":"webauthn-intro"},"timeToRead":15},{"excerpt":"å¥½æ­Œåˆ†äº«ï¼šLove is the answer","html":"<blockquote>\n<p>å¥½æ­Œåˆ†äº«ï¼š<a href=\"https://youtu.be/Ugm_E7vERYs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Love is the answer</a></p>\n</blockquote>\n<iframe width=\"100%\" height=\"315\" src=\"https://www.youtube.com/embed/Ugm_E7vERYs\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>è¿‘å¹´ VR/AR ä¸€ç›´ä¸æ–·å‡ºç¾åœ¨å¤§å®¶çš„è¦–ç·šå…§ï¼Œé›–ç„¶ä¸€ç›´æ²’æœ‰ä»€éº¼æ®ºæ‰‹ç´šçš„æ‡‰ç”¨å‡ºç¾ï¼Œä½†é€™é˜»æ­¢ä¸äº†é–‹ç™¼è€…å€‘çš„é›„å¿ƒå£¯å¿—ï¼Œå°¤å…¶æ˜¯ JavaScript ç¤¾ç¾¤ï¼Œç•¢ç«Ÿ Jeff Atwood èªªéï¼š</p>\n<blockquote>\n<p>\"Any application that can be written in JavaScript, will eventually be written in JavaScript.\" â€” Jeff Atwood, Author, Entrepreneur, Cofounder of StackOverflow</p>\n</blockquote>\n<p>éš¨è‘— a-frame çš„å‡ºç¾ï¼ŒWebVR æˆç‚ºç¾å¯¦ï¼Œä¸¦ä¸”å¾ˆå®¹æ˜“é–‹ç™¼ï¼›Web AR éƒ¨åˆ†é€²å±•å‰‡ç›¸å°ç·©æ…¢ã„§äº›ï¼Œç€è¦½å™¨åŸç”Ÿæ”¯æ´çš„ API é‚„ä¸€ç›´è™•æ–¼ä¸ç©©å®šçš„é–‹ç™¼éšæ®µï¼Œä½†å³ä¾¿å¦‚æ­¤ï¼Œæˆ‘å€‘é‚„æ˜¯å¯ä»¥åœ¨ç‰¹å®šç‰ˆæœ¬çš„ç€è¦½å™¨ä¸Šä½¿ç”¨ï¼Œæ­¤å¤–ï¼Œä¹Ÿæœ‰åƒæ˜¯ AR.js é€™æ¨£èåˆ artoolkitã€three.jsã€ï¼·ebGL å’Œ WebRTC ç­‰æŠ€è¡“çš„å·¥å…·å¯ä»¥ä½¿ç”¨ã€‚</p>\n<p>ä»Šå¤©å°±ä¾†ç¨ç¨ç ”ç©¶ä¸€ä¸‹ï¼Œçœ‹çœ‹ç›®å‰çš„æŠ€è¡“èƒ½å¦‚ä½•é–‹ç™¼ Web ARï¼</p>\n<p>ç…§æ…£ä¾‹ï¼Œé–‹å§‹å‰å…ˆçœ‹é» demoï¼ŒæŠŠ Pokemon å¸¶åˆ°ä½ å®¶å®¢æ‡‰ï¼š</p>\n<p><img src=\"/image/arjs-demo.jpg\" alt=\"arjs demo\"></p>\n<!--\n1. ç°¡ä»‹\n2. ä»‹ç´¹ç›®å‰æœ‰çš„ WebAR å¯¦ä½œ lib æˆ– api\n2-1. èªªæ˜ WebXR Viewer on iOS èˆ‡ Google chrome å¯ä»¥è·‘çš„ api\n3. åˆ†åˆ¥ä»¥ AR.js èˆ‡ Web ç´” API ä»‹ç´¹\n-->\n<h2 id=\"ç›®å‰çš„å·¥å…·æœ‰å“ªäº›\" style=\"position:relative;\"><a href=\"#%E7%9B%AE%E5%89%8D%E7%9A%84%E5%B7%A5%E5%85%B7%E6%9C%89%E5%93%AA%E4%BA%9B\" aria-label=\"ç›®å‰çš„å·¥å…·æœ‰å“ªäº› permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç›®å‰çš„å·¥å…·æœ‰å“ªäº›</h2>\n<p><a href=\"https://createwebvr.com/webAR.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Createï¼·ebVR</a> é€™ç¶²ç«™ä¸Šåˆ—å‡ºäº†ä¸€äº›ç›®å‰æœ‰çš„ libraryï¼Œä»¥åŠç›®å‰æ”¯æ´ WebAR çš„ç€è¦½å™¨ï¼š</p>\n<p><img src=\"/image/webar-libs.png\" alt=\"å¸¸è¦‹ lib\"></p>\n<p>å…¶ä¸­ <a href=\"https://github.com/jeromeetienne/AR.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">AR.js</a> ä½¿ç”¨äº† A-Frame (åŸºæ–¼ Three.js) ä»¥åŠ JSARTookit5ï¼ˆJavaScript ç§»æ¤ç‰ˆçš„ <a href=\"https://github.com/artoolkit/artoolkit5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ARToolKit</a>ï¼‰ï¼Œè€Œé€™å…©å€‹æŠ€è¡“ä¸»è¦çš†æ˜¯åˆ©ç”¨ WebGL ç‚ºä¸»ï¼Œå› æ­¤å¤§å¤šç¾è¡Œçš„ç€è¦½å™¨éƒ½èƒ½ç›´æ¥æ”¯æ´ï¼Œä¸éœ€è¦ç‰¹æ®Šçš„ APIã€‚</p>\n<p>é€™å¤§æ¦‚ä¹Ÿæ˜¯ç‚ºä½• AR.js èƒ½åœ¨ GitHub ä¸Šæ“æœ‰ä¸€è¬å¤šé¡†æ˜Ÿæ˜Ÿï¼Œé å‹éä¸Šåˆ—å…¶ä»–å¥—ä»¶çš„åŸå› ã€‚å†åŠ ä¸Šä½œè€…çš„å¯¦é©—è­‰æ˜ AR.js å³ä¾¿åœ¨<a href=\"https://github.com/jeromeetienne/AR.js#performance\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å…©å¹´çš„è€èˆŠæ‰‹æ©Ÿä¸Šä¹Ÿèƒ½é‹è¡Œé †æš¢ï¼Œæ“æœ‰è‰¯å¥½çš„ Performance</a>ã€‚</p>\n<p>ä½† AR.js ä¹Ÿä¸¦éæ²’æœ‰ç¼ºé»ï¼Œç”±æ–¼æ˜¯åŸºæ–¼ ARToolKitï¼Œå› æ­¤åªèƒ½å¤ æ”¯æ´ Marker-based çš„ AR æ•ˆæœï¼Œä¹Ÿå°±æ˜¯åƒæœ€å‰é¢çš„ Demo åœ–ç‰‡ä¸€æ¨£ï¼Œæ˜¯éœ€è¦åœ¨é¡é ­å…§æ”¾ç½®ä¸€å€‹è¨­å®šå¥½çš„ Markerï¼Œè®“å…¶è¾¨è­˜ï¼Œå–å¾—ç’°å¢ƒçš„ä¸€äº› Sensor è³‡è¨Šï¼ŒåŒ…å«é¡é ­çš„æ·±æ·ºé è¿‘ç­‰ç­‰ï¼Œæ‰èƒ½è®“ AR ç‰©ä»¶æ¸²æŸ“åœ¨è¦–çª—ä¸­ã€‚</p>\n<p>å³ä¾¿å¦‚æ­¤ï¼ŒAR.js å…¶ç°¡æ½”ã€ä¾¿åˆ©çš„ä½¿ç”¨æ–¹å¼ï¼ˆ<a href=\"https://github.com/jeromeetienne/AR.js#folders\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æœ‰ a-frame èˆ‡ threejs çš„ extension</a>ï¼‰ï¼Œèƒ½è®“ä½ ç”¨<a href=\"https://medium.com/arjs/augmented-reality-in-10-lines-of-html-4e193ea9fdbf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">çŸ­çŸ­ 10 è¡Œç¨‹å¼ç¢¼å°±ç”¢ç”Ÿå‡ºä¸€å€‹ WebAR æ•ˆæœçš„ç¶²é </a>ï¼Œé‚„æ˜¯éå¸¸å¥½ç”¨çš„ã€‚</p>\n<p><img src=\"/image/webar-browsers.png\" alt=\"æ”¯æ´çš„ browsers\"></p>\n<p>å¦‚æœä½ æ˜¯ä½¿ç”¨ AR.js çš„è©±ï¼ŒåŸºæœ¬ä¸Šç¾è¡Œæœ‰æ”¯æ´ WebGL çš„æ‰‹æ©Ÿç€è¦½å™¨å°±éƒ½èƒ½å¤ é‹è¡Œï¼Œä¸éœ€è¦é¡å¤–çš„ Polyfill ç­‰ç­‰ã€‚</p>\n<p>ä½†å¦‚æœä½ æƒ³è¦ä½¿ç”¨é Marker-based æ•ˆæœçš„ AR æ‡‰ç”¨ï¼Œä½ å°±å¾—ç ”ç©¶ <a href=\"https://immersive-web.github.io/webxr/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">WebXR Device API</code></a>ï¼Œå…¶å‰èº«ç‚º <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebVR_API\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebAR API</a>ã€‚</p>\n<h2 id=\"webxr-device-api\" style=\"position:relative;\"><a href=\"#webxr-device-api\" aria-label=\"webxr device api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WebXR Device API</h2>\n<p>WebXR Device API ç¾åœ¨é‚„åœ¨ä¸æ–·æ›´æ–°ä¸­ï¼Œä¸æ˜¯å€‹ç©©å®šçš„ APIã€‚</p>\n<p>é‹ç”¨åˆ° WebXR Device API çš„æœ‰ Google ä½¿ç”¨çš„ <a href=\"https://github.com/google-ar/three.ar.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">three.ar.js</a> èˆ‡æ•´åˆ A-Frame çš„ <a href=\"https://github.com/chenzlabs/aframe-ar\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">aframe-ar.js</a>ï¼Œä»¥åŠ Mozilla ä¸»å°çš„ <a href=\"https://github.com/mozilla/aframe-xr\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">three.xr.js</a> å’Œ <a href=\"https://github.com/mozilla/three.xr.js/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">aframe-xr.js</a>ã€‚</p>\n<p>Google æä¾›äº† <a href=\"https://github.com/google-ar/WebARonARCore\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebARonARCore</a> å’Œ <a href=\"https://github.com/google-ar/WebARonARKit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebARonARKit</a> å…©ç¨®åˆ†åˆ¥åœ¨ Android èˆ‡ iOS å¹³å°ä¸Šé‹è¡Œçš„ç‰¹æ®Š browsersï¼Œè®“ä½ èƒ½åœ¨ä¸Šé¢è·‘ WebXR Device ç›¸é—œçš„ APIï¼šè€Œ Mozilla åœ¨ iOS ä¸Šä¹Ÿæ¨å‡º <a href=\"https://labs.mozilla.org/projects/webxr-viewer/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Mozilla WebXR Viewer</a> ä¾†å°æ‡‰ï¼Œä¸‰è€…çš†æ˜¯ç”¨åˆ°æ‰‹æ©Ÿå¹³å°åŸç”Ÿçš„ ARKitã€‚</p>\n<p>å¦‚åŒå‰›å‰›æ‰€èªªï¼ŒWebXR Device API é‚„å¾ˆä¸ç©©å®šï¼Œè€Œä¸” Google èˆ‡ Mozilla å„è‡ªåœ¨ Android èˆ‡ iOS ä¸Šæœ‰ä¸åŒçš„å¯¦ä½œï¼Œ<a href=\"https://codelabs.developers.google.com/codelabs/ar-with-webxr/#0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Google code lab ä¸Šçš„ç¯„ä¾‹</a>åªèƒ½é‹è¡Œåœ¨ version ç‚º 70 - 72 çš„ Chrome canary ä¸Šï¼Œè€Œ Mozilla é›–ç„¶æœ‰æ¨å‡º <a href=\"https://labs.mozilla.org/projects/webxr-viewer/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Mozilla WebXR Viewer</a>ï¼Œä½†ä¸Šé¢çš„<a href=\"https://github.com/MozillaReality/webxr-ios-js/tree/master/examples\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç¯„ä¾‹å¯¦ä½œ</a>ä¹Ÿ<strong>åªèƒ½</strong>é‹è¡Œåœ¨ <a href=\"https://labs.mozilla.org/projects/webxr-viewer/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Mozilla WebXR Viewer</a> ä¸Šé ­...</p>\n<p>ä¸éå»çœ‹ä¸€ä¸‹é›™æ–¹çš„ç¯„ä¾‹ç¨‹å¼ç¢¼å¾Œï¼Œæœƒç™¼ç¾å…¶å¯¦ç”¨æ³•è »é›·åŒçš„ï¼Œå¤§å¤šéƒ½æœ‰ä¸‹é¢é€™äº›æµç¨‹ï¼ˆä»¥ Google çš„ç¨‹å¼ç¢¼ä¾†ç•¶ç¯„ä¾‹ï¼‰ï¼š</p>\n<p>åˆ¤æ–·æ˜¯å¦æ”¯æ´ WebXR Device APIï¼Œä¸¦åˆå§‹è¨­å®šï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n   * Fetches the XRDevice, if available.\n   */</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// `navigator.xr` æ˜¯ WebXR Device API çš„å…¥å£ï¼Œæœ‰å¿…è¦ç¢ºèªå…¶å­˜åœ¨</span>\n    <span class=\"token comment\">// è€Œ `XRSession` ä¸­çš„ `requestHitTest` å‰‡æ˜¯è¦ enable #webxr-hit-test flag</span>\n    <span class=\"token comment\">// ç¢ºèªé€™å…©å€‹ API å­˜åœ¨ï¼Œç¢ºä¿èƒ½å¤ è£½é€ å‡ºé»æ“Šç•«é¢</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>navigator<span class=\"token punctuation\">.</span>xr <span class=\"token operator\">&amp;&amp;</span> <span class=\"token class-name\">XRSession</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>requestHitTest<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>device <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> navigator<span class=\"token punctuation\">.</span>xr<span class=\"token punctuation\">.</span><span class=\"token function\">requestDevice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Error handlingï¼Œé€šçŸ¥ä½¿ç”¨è€…çš„ç€è¦½å™¨ä¸¦ä¸æ”¯æ´</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onNoXRDevice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Error handlingï¼Œé€šçŸ¥ä½¿ç”¨è€…çš„ç€è¦½å™¨ä¸¦ä¸æ”¯æ´</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onNoXRDevice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// æˆåŠŸå–å¾— XRDevice ç‰©ä»¶å¾Œï¼Œéœ€è¦ bind ä¸€å€‹ user gesture çš„ eventï¼Œç„¶å¾Œå‘¼å«</span>\n    <span class=\"token comment\">// `device.requestSession()`ï¼Œé€™æ˜¯è¦ç¯„åœ¨ spec  ä¸­çš„</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#enter-ar'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onEnterAR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>å–å¾— <code class=\"language-text\">XRDevice</code> å¾Œï¼Œåˆ©ç”¨ <code class=\"language-text\">device.requestSession()</code> è£½é€ å‡ºé‹è¡Œ XR çš„ç’°å¢ƒï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token keyword\">async</span> <span class=\"token function\">onEnterAR</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> outputCanvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> outputCanvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xrpresent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// `device.requestSession()` ä¸€å®šè¦æ˜¯ç”± user è§¸ç™¼ï¼Œåƒæ˜¯ click handler å…§</span>\n      <span class=\"token keyword\">const</span> session <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>device<span class=\"token punctuation\">.</span><span class=\"token function\">requestSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        outputContext<span class=\"token operator\">:</span> ctx<span class=\"token punctuation\">,</span>\n        environmentIntegration<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>outputCanvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// æˆåŠŸå‰µå»º Session å¾Œå°±èƒ½é–‹å§‹é‹ç®— AR äº†</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onSessionStarted</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Error handlingï¼Œé€šçŸ¥ä½¿ç”¨è€…çš„ç€è¦½å™¨ä¸¦ä¸æ”¯æ´</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">onNoXRDevice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>ç•¶ XRSession æˆåŠŸå‰µå»ºå¾Œï¼Œæ¥è‘—å°±æ˜¯ set up three.jsï¼Œæ’°å¯« rendererï¼Œè¨­å®š sceneã€cameraï¼Œä¸¦ attach ä¸Š XRWebGLLayerï¼Œç„¶å¾Œå•Ÿå‹• render loopï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token function\">onSessionStarted</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">session</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>session <span class=\"token operator\">=</span> session<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...çœç•¥</span>\n  <span class=\"token comment\">// åˆ©ç”¨ Three.js ç¹ªè£½ 3D ç‰©ä»¶ï¼Œå› æ­¤è¦å€Ÿç”¨ THREE.WebGLRenderer ä¾†ç•¶ä½œ XRSession çš„ render layer</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">THREE<span class=\"token punctuation\">.</span>WebGLRenderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    alpha<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    preserveDrawingBuffer<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...çœç•¥</span>\n  <span class=\"token comment\">//  è¨­å®š render layer</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>baseLayer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XRWebGLLayer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>gl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> framebuffer <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>baseLayer<span class=\"token punctuation\">.</span>framebuffer<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderer<span class=\"token punctuation\">.</span><span class=\"token function\">setFramebuffer</span><span class=\"token punctuation\">(</span>framebuffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...çœç•¥, è¨­å®š scene</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene <span class=\"token operator\">=</span> DemoUtils<span class=\"token punctuation\">.</span><span class=\"token function\">createLitScene</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...çœç•¥, è¨­å®š camera</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>camera <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">THREE<span class=\"token punctuation\">.</span>PerspectiveCamera</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...çœç•¥, æ›´å¤šçš„è¨­å®š</span>\n  <span class=\"token comment\">// åœ¨ `requestAnimationFrame` ä¸­å•Ÿå‹• render loop</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onXRFrame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...çœç•¥</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>çœç•¥äº†å¾ˆå¤šç´°ç¯€ï¼Œä½†å¤§è‡´çš„æ­¥é©Ÿå°±æ˜¯é€™æ¨£ï¼Œ<a href=\"https://github.com/googlecodelabs/ar-with-webxr/archive/master.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è©³ç´°ç¨‹å¼ç¢¼åœ¨æ­¤ä¸‹è¼‰</a></p>\n<p>å° WebXR Device API æ¯”è¼ƒæœ‰èˆˆè¶£çš„è®€è€…é™¤äº† <a href=\"https://codelabs.developers.google.com/codelabs/ar-with-webxr/#0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Google code lab ä¸Šçš„ç¯„ä¾‹ç¨‹å¼</a>èˆ‡ Mozilla çš„ <a href=\"https://github.com/MozillaReality/webxr-ios-js/tree/master/examples\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">webxr-ios-js ç¯„ä¾‹</a> å¤–ï¼Œä¹Ÿå¯ä»¥åˆ° <a href=\"https://github.com/immersive-web/webxr/blob/master/explainer.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">immersive-web/webxr</a> çœ‹çœ‹è©² WebXR Device API çš„ Specs detail èˆ‡è§£é‡‹ï¼Œä»–å€‘ä¹Ÿæœ‰æä¾› <a href=\"https://immersive-web.github.io/webxr-samples/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sample Page</a> å¯ä½œåƒè€ƒã€‚</p>\n<h2 id=\"arjs\" style=\"position:relative;\"><a href=\"#arjs\" aria-label=\"arjs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AR.js</h2>\n<p>ç”±æ–¼æ‰‹é‚Šæ²’æœ‰é©åˆçš„ Android æ‰‹æ©Ÿï¼Œä¸èƒ½å˜—è©¦åˆ©ç”¨ WebXR Device APIï¼Œæ‰€ä»¥ä»Šå¤©å°±å…ˆä¾†çœ‹çœ‹ AR.js æœ‰å¤šç°¡å–®ã€‚</p>\n<p>ä½ éœ€è¦çš„å°±åªæœ‰ï¼š</p>\n<ol>\n<li>æº–å‚™å¥½ Marker</li>\n<li>æº–å‚™å¥½ 3D models</li>\n<li>æ’°å¯«åè¡Œç°¡å–®çš„ç¨‹å¼ç¢¼</li>\n<li>host ä½ çš„ WebAR webapp</li>\n</ol>\n<p>AR.js æœ‰æä¾›ä¸€å€‹ Marker generator - <a href=\"https://jeromeetienne.github.io/AR.js/three.js/examples/marker-training/examples/generator.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">AR.js Marker Training</a></p>\n<p><img src=\"/image/arjs-maker-traning.png\" alt=\"ARjs marker training\"></p>\n<p>ä½ å¯ä»¥ä¸Šå‚³æƒ³è¦çš„åœ–ç‰‡æ”¾åˆ° Marker ä¸­ï¼Œä¾‹å¦‚ä¸€å€‹è¨˜è¼‰ä½ çš„ WebVR webapp ç¶²å€çš„ QR code å°±å¾ˆé©åˆã€‚åƒ<a href=\"https://medium.com/%E9%AB%92%E6%A1%B6%E5%AD%90/%E7%94%A8ar-js%E5%81%9A%E4%B8%80%E5%80%8B%E8%AE%93%E5%8F%A6%E5%B0%8D%E6%96%B9-%E5%96%94%E5%96%94%E5%96%94%E5%96%94-%E7%9A%84%E5%B0%8F%E5%8D%A1%E7%89%87%E5%90%A7-4071ceea41dd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é€™ç¯‡æ–‡ç« </a>ä½œè€…åˆ©ç”¨ AR.js çµåˆå¯¦é«”å¡ç‰‡é€çµ¦ä»–å¥³å‹ä¸€å€‹å°é©šå–œã€‚</p>\n<p>æˆ‘å»ºè­°æŠŠä½ åšå¥½çš„ Marker ä¸‹è¼‰ä¸‹ä¾†ï¼Œå¦å‰‡ç•¶ä½ æ‰‹æ©Ÿå°è‘—é›»è…¦ä¸­çš„ marker æ™‚ï¼Œ3D Model æ–¹ä½è¦–è§’æœƒè·Ÿä½ æ˜¯å‚ç›´çš„ï¼Œä¸æ˜¯å¾ˆå¥½çœ‹ã€‚</p>\n<p>æ¥è‘—å¯ä»¥åˆ° <a href=\"https://poly.google.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Poly</a> æˆ–æ˜¯ <a href=\"https://sketchfab.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sketchfab</a> ä¸‹è¼‰ <code class=\"language-text\">gltf</code> çš„ 3D æ¨¡å‹ã€‚(æœå°‹æƒ³è¦çš„ Model æ™‚è¨˜å¾—å‹¾é¸ <code class=\"language-text\">downloadable</code>ï¼Œæ¯”è¼ƒä¸æœƒé¸åˆ°éœ€è¦ä»˜è²»æ‰èƒ½ä¸‹è¼‰çš„ï¼Œç•¶ç„¶ä½ è¦ä»˜è²»ä¹Ÿå¾ˆæ£’ï¼)</p>\n<p>ä»¥æˆ‘æœ€å‰é¢çš„ä¾‹å­ä¾†èªªï¼Œæˆ‘åœ¨ <a href=\"https://sketchfab.com/3d-models/squirtle-18caed58804943d7a839dcbd44d21b80\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sketchfab ä¸­è¼‰äº†ä¸€å€‹å‚‘å°¼é¾œçš„æ¨¡å‹</a></p>\n<p><img src=\"/image/sketchfb-usage.png\" alt=\"sketchfab\"></p>\n<p>æ¥è‘—ç”¨ AR.js å°æ‡‰ AFrame çš„ extension æ’°å¯«ç°¡å–®çš„ WebVR app:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://aframe.io/releases/0.9.2/aframe.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.rawgit.com/jeromeetienne/AR.js/1.7.5/aframe/build/aframe-ar.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span><span class=\"token value css language-css\"><span class=\"token property\">margin</span> <span class=\"token punctuation\">:</span> 0px<span class=\"token punctuation\">;</span> <span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">'</span></span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a-scene</span> <span class=\"token attr-name\">embedded</span> <span class=\"token attr-name\">arjs</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>sourceType: webcam; debugUIEnabled: false;<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a-marker</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>pattern<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>assets/pattern-marker.patt<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a-entity</span> <span class=\"token attr-name\">position</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>0 -6 -12<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">rotation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>-20 0 0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">gltf-model</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>url(assets/scene.gltf)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a-entity</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a-marker</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a-scene</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>åœ¨ <code class=\"language-text\">&lt;a-scene /></code> ä¸­ï¼Œæˆ‘å€‘æŒ‡å®šä¸€å€‹ attribute <code class=\"language-text\">arjs</code>ï¼Œä¸¦ä¸”è¨­å®š <code class=\"language-text\">sourceType</code> ç‚º <code class=\"language-text\">webcam</code>ï¼Œç›¸é—œ attribute è¨­å®šå…¶å¯¦ä¾†è‡ª <code class=\"language-text\">artoolkit system</code>ï¼Œæœ‰éœ€è¦å¯ä»¥åˆ° <a href=\"https://github.com/jeromeetienne/AR.js/tree/master/aframe#artoolkit-system\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub çš„åˆ—è¡¨</a>æŸ¥çœ‹ã€‚</p>\n<p>æ¥è‘—æˆ‘å€‘é€é <code class=\"language-text\">&lt;a-marker /></code> æ”¾å…¥æˆ‘å€‘è£½ä½œçš„ markerï¼Œå‰¯æª”åç‚º <code class=\"language-text\">.patt</code>ï¼Œé€™é‚Šçš„ type attributeï¼Œå¦‚æœä½ æ˜¯å–®ç´”ç”¨ barcode çš„è©±ï¼Œå¯ä»¥è¨­ç‚º <code class=\"language-text\">type=barcode</code>ï¼Œä½†è‹¥æ˜¯å®¢è£½åŒ–çš„ markerï¼Œå°±è¦è¨­ç‚º <code class=\"language-text\">type=pattern</code>ã€‚</p>\n<p>æœ€å¾Œåœ¨ <code class=\"language-text\">&lt;a-entity /></code> ä¸Šé ­è¨­å®šæˆ‘å€‘æƒ³è¦å‘ˆç¾çš„ AR 3D Modelï¼Œ<code class=\"language-text\">gltf-model</code> attribute è¨­å®šæ¨¡å‹çš„è·¯å¾‘ï¼Œå†é€é <code class=\"language-text\">position</code> èˆ‡ <code class=\"language-text\">rotation</code> ä¾†èª¿æ•´ä½ çš„æ¨¡å‹å‡ºç¾åœ¨é¡é ­çš„ä½ç½®ã€‚</p>\n<p>é€™é‚Šç‰¹åˆ¥è¦æ³¨æ„ä¸€ä¸‹ï¼Œå› ç‚ºä½ è¼‰ä¸‹ä¾†çš„ 3D Modelï¼Œéƒ½æœ‰è‡ªå·±çš„ä½ç½®å±¬æ€§ï¼Œæ‰€ä»¥ä½ å¯èƒ½æœƒéœ€è¦è‡ªå·±å¤šåŠ èª¿æ•´å‡ºé©åˆçš„ <code class=\"language-text\">position</code> èˆ‡ <code class=\"language-text\">rotation</code> å€¼ï¼Œå¦å‰‡ä½ çš„ 3D Model å¾ˆå¯èƒ½ä¸€ç›´æˆåƒåœ¨ä½ æ‰‹æ©Ÿçš„é¡é ­å¤–è€Œçœ‹ä¸åˆ°ï¼Œç„¶å¾Œä½ é‚„ä»¥ç‚ºæ˜¯ç¨‹å¼å‡ºå•é¡Œ...</p>\n<p>ç•¶æ‰‹æ©Ÿé¡é ­åµæ¸¬åˆ° <code class=\"language-text\">&lt;a-marker /></code> å…§å°æ‡‰çš„ marker æ™‚ï¼Œå°±æœƒåœ¨é¡é ­å…§æ¸²æŸ“å‡º <code class=\"language-text\">&lt;a-entiy /></code>ã€‚</p>\n<p>å¦‚æœåªæ˜¯åƒæˆ‘ä¸€æ¨£æƒ³è¦å˜—è©¦ä¸€ä¸‹çš„è©±ï¼Œå¯ä»¥ç°¡å–®åˆ©ç”¨ Chrome çš„ webapp - <a href=\"https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web Server for Chrome</a> ä¾† host ä½ çš„ htlm fileï¼Œç„¶å¾Œåˆ©ç”¨ <a href=\"https://ngrok.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ngork</a> æˆ–æ˜¯ <a href=\"https://serveo.net/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">serveo</a> ä¾†ç•¶ä½œä½  localhost çš„ proxyï¼Œè®“ä½ çš„æ‰‹æ©Ÿå¯ä»¥æ–¹ä¾¿ç›¸é€£ã€‚</p>\n<p>ä¸€åˆ‡é †åˆ©çš„è©±ï¼Œä½ å°±æœƒçœ‹åˆ°ä¸€éš»å‚‘å°¼é¾œå‡ºç¾åœ¨ä½ å®¶è£¡å•¦ï½</p>\n<p><img src=\"/image/another-arjs-demo.jpg\" alt=\"another arjs demo\"></p>\n<p>å¦‚æœä½ æ²’æœ‰æ‰‹æ©Ÿå¯ä»¥ç©ï¼Œæƒ³ç”¨é›»è…¦ Browser è·‘çš„è©±ï¼Œæœƒéœ€è¦åˆ° <code class=\"language-text\">chrome://flags</code> ä¸­æŠŠ <code class=\"language-text\">WebVR</code> çš„é¸é …é–‹å•Ÿï¼Œç„¶å¾Œç”¨ inpsecter å°‡ Browser èª¿æ•´æˆæ‰‹æ©Ÿæ¨¡å¼ã€‚</p>\n<p><img src=\"/image/chrome-flags.png\" alt=\"chrome flags\"></p>\n<p>ä¸¦ä¸”éœ€è¦åŠ ä¸Š polyfillï¼Œå› ç‚ºæ™®é€šçš„ chrome æ˜¯æ²’æœ‰æ”¯æ´ <code class=\"language-text\">navigator.xr</code> api çš„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>https://cdn.jsdelivr.net/npm/webxr-polyfill@latest/build/webxr-polyfill.js<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">var</span> polyfill <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebXRPolyfill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><img src=\"/image/arjs-run-mac.png\" alt=\"run on chrome\"></p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>é›–ç„¶ WebXR Device API é‚„ä¸ç©©å®šï¼Œä½†å°±æ˜¯åœ¨é€™æ™‚å€™é–‹å§‹è©¦ç”¨æ‰æ›´èƒ½çµ¦å‡ºå›é¥‹ï¼Œé«˜æ‰‹å€‘ä¾†è©¦è©¦å§ï¼æ±ºå®šä¸‹æ¬¡æ‹¿å…¬å¸æ¸¬è©¦æ©Ÿä¾†è·Ÿè‘— Code lab ä¸Šçš„ç¯„ä¾‹æ”¹æ”¹çœ‹ï¼\nå¦å¤–ï¼ŒAR.js é›–ç„¶ç›®å‰æ˜¯ Marker-basedï¼Œä½†å¾ <a href=\"https://github.com/jeromeetienne/AR.js/issues/190\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub ä¸Šçš„ä¸€äº›è¨è«–</a> ä¾†çœ‹ï¼Œä¹‹å¾Œæ‡‰è©²æ˜¯æœ‰æ©Ÿæœƒæ”¯æ´ Markerless çš„ã€‚</p>\n<p>AR é€™æ¨£ç‰½æ‰¯åˆ°é›»è…¦è¦–è¦ºã€ç¡¬é«”ã€æ¼”ç®—æ³•ã€Sensor ç­‰è¤‡é›œé‹ç®—çš„æŠ€è¡“ï¼Œè¦å¯¦ä½œåˆ° Web ä¸Šæ›´æ˜¯å›°é›£ï¼Œé€²åº¦æ…¢æ˜¯å¯ä»¥ç†è§£çš„ï¼Œä½†é‚„æ˜¯è¡·å¿ƒæœŸç›¼è‘—é‚£ä¸€å¤©ï¼Œèƒ½å¤ é–‹å•Ÿç¶²é å°±èƒ½ä¸ˆé‡å‚¢ä¿±å°ºå¯¸æˆ–æ˜¯è©¦ç©¿è¡£ç‰©ï¼</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://github.com/immersive-web/webxr\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Repository for the WebXR Device API Specification.</a></li>\n<li><a href=\"https://createwebvr.com/webAR.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Createï¼·ebVR</a></li>\n<li><a href=\"https://github.com/jeromeetienne/AR.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">AR.js</a></li>\n<li><a href=\"https://medium.com/chialab-open-source/ar-js-the-simpliest-way-to-get-cross-browser-ar-on-the-web-8f670dd45462\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">AR.js â€” The Simplest Way to get Cross-Browser Augmented Reality on the Web</a></li>\n<li><a href=\"https://blog.halolabs.io/building-ar-vr-with-javascript-and-html-97af4434bcf6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Building AR/VR with Javascript and HTML</a></li>\n<li><a href=\"https://medium.com/agora-io/web-vs-app-ar-edition-d9aafe988ba2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web vs App (AR edition)</a></li>\n<li><a href=\"https://poly.google.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Poly</a></li>\n<li><a href=\"https://sketchfab.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sketchfab</a></li>\n<li><a href=\"https://medium.com/%E9%AB%92%E6%A1%B6%E5%AD%90/%E7%94%A8ar-js%E5%81%9A%E4%B8%80%E5%80%8B%E8%AE%93%E5%8F%A6%E5%B0%8D%E6%96%B9-%E5%96%94%E5%96%94%E5%96%94%E5%96%94-%E7%9A%84%E5%B0%8F%E5%8D%A1%E7%89%87%E5%90%A7-4071ceea41dd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç”¨ar-jsåšä¸€å€‹è®“å¦å°æ–¹-å–”å–”å–”å–”-çš„å°å¡ç‰‡å§</a></li>\n<li><a href=\"https://codelabs.developers.google.com/codelabs/ar-with-webxr/#0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">google code lab - WebXR</a></li>\n<li><a href=\"https://immersive-web.github.io/webxr-samples/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebXR Sample page</a></li>\n</ol>\n<p>é—œæ–¼ä½œè€…ï¼š\n<a href=\"http://blog.arvinh.info/about/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@arvinh</a> å‰ç«¯æ”»åŸç…ï¼Œç†±æ„›æ•¸æ“šåˆ†æå’Œè³‡è¨Šè¦–è¦ºåŒ–</p>","id":"a776efbf-720d-5861-94eb-4b4becb96984","fields":{"slug":"web-ar"},"frontmatter":{"date":"2019-07-16T17:40:44.000Z","title":"æ·ºåš Web AR","tags":["web","ar","javascript"],"type":"tech","slug":"web-ar"},"timeToRead":12},{"excerpt":"If you don't want to start over, don't give up","html":"<blockquote>\n<p>If you don't want to start over, don't give up</p>\n</blockquote>\n<!-- more -->\n<h2 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>åœ¨ä»Šå¹´çš„ Google I/O 2019 ä¸­ï¼Œ<a href=\"https://twitter.com/dassurma\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@Surma</a>, <a href=\"https://twitter.com/jaffathecake\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@Jake</a> èˆ‡ <a href=\"https://twitter.com/kosamari\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@Mariko</a> æ¨å‡ºäº†ä¸€æ¬¾èƒ½åœ¨ä½éšçš„ feature phone ä¸Šé‹ä½œé †æš¢çš„ <a href=\"https://github.com/GoogleChromeLabs/proxx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">web app - PROXX</a>ï¼Œå…¶ä¸­åˆ©ç”¨åˆ°äº† Web worker ä¾†åˆ†æ“”è¨±å¤š Browser main thread ä¸­çš„å·¥ä½œï¼Œè®“ç•«é¢æ¸²æŸ“å¯ä»¥æ›´é †æš¢ï¼Œä¹Ÿå› æ­¤è®“æˆ‘æ³¨æ„åˆ°å»å¹´åœ¨ Chrome dev summit 2018 ä¸­çš„ä¸€æ”¯å½±ç‰‡ - <a href=\"https://www.youtube.com/watch?v=Vg60lf92EkM&#x26;list=PLNYkxOF6rcIDjlCx1PcphPpmf43aKOAdF&#x26;index=17&#x26;t=0s\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Architecting Web Apps - Lights, Camera, Action!</a>ï¼Œè®“æˆ‘çœ¼ç›ç‚ºä¹‹ä¸€äº®ï¼Œè£¡é¢è¬›åˆ°ä»–å€‘åˆ©ç”¨ Actor Model ä¾†å°‡é—œæ³¨é»åˆ†é›¢ï¼Œä¸åŒçš„ Actors å„è‡ªè² è²¬ä¸åŒçš„å·¥ä½œï¼Œå½¼æ­¤ä¹‹é–“ç”¨å…±é€šçš„ä»‹é¢æºé€šï¼Œå¦‚æ­¤ä¸€ä¾†ï¼Œé™¤äº†å°‡è¤‡é›œçš„é‹ç®—é‚è¼¯æ”¾å…¥ Web worker å¤–ï¼Œç”±æ–¼æ¶æ§‹ä¸Šçš„ç‰¹æ€§ï¼Œç†è«–ä¸Šä¹Ÿèƒ½å¾ˆæ–¹ä¾¿çš„æŠ½æ› View çš„å¯¦ä½œæ–¹å¼ï¼Œåƒæ˜¯ä¸€å¥— web appï¼Œå¯ä»¥åœ¨ä¸é‡å¯«æ‰€æœ‰é‚è¼¯çš„æƒ…æ³ä¸‹ï¼Œå¾ Vue å¯¦ä½œ viewï¼Œè½‰æ›åˆ°ä»¥ React å¯¦ä½œã€‚</p>\n<p>è½èµ·ä¾†éå¸¸åˆç†ï¼Œè€Œæœ‰è¶£çš„æ˜¯ï¼Œé€™å€‹ Actor Model å…¶å¯¦æ—©åœ¨ 46 å¹´å‰å°±è¢«æå‡ºï¼Œä¹Ÿæœ‰æ‡‰ç”¨åœ¨ Web é ˜åŸŸä¸Šéï¼Œåƒæ˜¯ç”¨ Scala æ’°å¯« çš„ Akkaï¼Œæˆ–æ˜¯åœ¨é›»ä¿¡é€šè¨Šä¸Šæœ‰åçš„ Erlangï¼Œä½†æ˜¯åœ¨å‰ç«¯ä¸Šä¼¼ä¹æ˜¯ç¬¬ä¸€æ¬¡è¢«æå‡ºä¾†ã€‚</p>\n<p>ä»Šå¤©é€éé€™ç¯‡æ–‡ç« ä¾†äº†è§£ä¸€ä¸‹é€™å€‹ 46 å¹´å‰å°±å­˜åœ¨çš„è§€å¿µæ˜¯ä»€éº¼ï¼Œè€Œåˆèƒ½å¦‚ä½•èˆ‡ Web å‰ç«¯æ•´åˆå‘¢ï¼</p>\n<h2 id=\"actor-model-ä»‹ç´¹\" style=\"position:relative;\"><a href=\"#actor-model-%E4%BB%8B%E7%B4%B9\" aria-label=\"actor model ä»‹ç´¹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Actor Model ä»‹ç´¹</h2>\n<p>Actor Model æ˜¯ä¸€å€‹é—œæ–¼ concurrent computation çš„ conceptual modelï¼Œåœ¨ 1973 å¹´æœ€æ—©è¢«æå‡ºæ™‚ï¼Œåªæ˜¯ä¸€å€‹æ¦‚å¿µæ¨¡å‹ï¼Œç”¨ä¾†æŠ½è±¡åŒ–ä¸¦è¡Œè™•ç†ç¨‹åºçš„è¤‡é›œç¨‹å¼ï¼Œç›´åˆ° 1985 æ‰è¢«å»¶ä¼¸å‡ºä¸€å€‹å®Œæ•´çš„ Actor model theoryï¼Œæœ‰èˆˆè¶£å¯ä»¥åˆ° <a href=\"https://en.wikipedia.org/wiki/Actor_model\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">wiki</a> æŸ¥çœ‹ã€‚</p>\n<p>è€Œç‚ºä»€éº¼æœƒéœ€è¦æå‡º Actor Model ä¾†è™•ç† concurrent issue å‘¢ï¼Ÿ</p>\n<p>æ­·å²ä¸Šçš„å‰å› å¾Œæœåœ¨é€™å€‹å½±ç‰‡ä¸­çš„å‰åŠæ®µè§£é‡‹å¾—è »æ¸…æ¥šçš„ <a href=\"https://www.youtube.com/watch?v=k3ja9I6bGvU\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[COSCUP 2011] Programming for the Future, Introduction to the Actor Model and Akka Framework</a></p>\n<p>å¤§é«”ä¸Šæ˜¯èªªï¼Œç”±æ–¼ CPU çš„è£½ç¨‹æ˜¯æœ‰å…¶æ¥µé™å­˜åœ¨ï¼Œå·²ç¶“ç„¡æ³•ä¿è­‰ Moore's Law æœƒæŒçºŒä¸‹å»ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ç”¨å¤šæ ¸å¿ƒä¾†æé«˜è™•ç†å™¨å…§çš„é›»æ™¶é«”æ•¸é‡ï¼Œé€éå¤šæ ¸å¿ƒçš„ä¸¦è¡Œè™•ç†ä¾†æé«˜é‹ç®—é€Ÿåº¦ï¼Œè€Œå¹³è¡Œè™•ç†å°æ–¼æ’°å¯«ç¨‹å¼çš„æˆ‘å€‘ä¾†èªªï¼Œå°±æ˜¯å¾ˆè¤‡é›œçš„ä¸€å€‹å­˜åœ¨ï¼Œå› ç‚ºæˆ‘å€‘æœ‰ Shared mutable stateï¼Œé€ æˆ race conditionã€dead lock ç­‰ç­‰çš„ issue éœ€è¦é¿å…ï¼Œè€Œ Actor Model å°±æ˜¯å› æ‡‰è€Œç”Ÿçš„è§£æ±ºæ–¹æ¡ˆä¹‹ä¸€ã€‚</p>\n<p>Actor Model ä¸»è¦æœ‰å¹¾å€‹ç‰¹é»ï¼š</p>\n<ul>\n<li>è¼•é‡ç‰©ä»¶: Actor æ˜¯ç³»çµ±å…§çš„ä¸€å€‹åŸºç¤å–®ä½ï¼Œæ¯å€‹ Actor åªè² è²¬è‡ªå·±çš„å·¥ä½œï¼Œæ‰€ä»¥å¯ä»¥å¾ˆè¼•é‡ã€‚</li>\n<li>æ²’æœ‰ shared stateï¼šæ¯å€‹ Actor å„è‡ªç®¡ç†è‡ªå·±çš„ stateï¼Œè·‘åœ¨å„è‡ªçš„ thread ä¸Šï¼Œä¸å…±äº« memory èˆ‡ stateã€‚</li>\n<li>é€é message æºé€šï¼šæ¯å€‹ Actor æœƒæœ‰ä¸€å€‹ message queueï¼Œæˆ–ç¨±ä½œ mailboxï¼Œæ¥æ”¶åˆ°çš„è¨Šæ¯æœƒåœ¨æ­¤æ’éšŠç­‰è‘—ä¾åºåŸ·è¡Œã€‚</li>\n</ul>\n<p>ä¸€å€‹ Actor çš„æ¶æ§‹ç•¥å¦‚ä¸‹åœ–ï¼š</p>\n<p><img src=\"/image/actor-model.png\" alt=\"Actor Model\"></p>\n<p>æ¯å€‹ Actor éƒ½æœ‰è‡ªå·±çš„ private stateï¼Œåˆ¥çš„ Actor æ²’è¾¦æ³•ç›´æ¥æ›´å‹•ä½ çš„ stateï¼Œé™ä½äº†å› ç‚º shared state ç”¢ç”Ÿçš„å•é¡Œã€‚</p>\n<p>æˆ‘å€‘æ‹‰é ä¸€é»ä¾†çœ‹ï¼ŒActor é‹è¡Œåœ¨ä¸åŒçš„ Thread ä¸­ï¼Œå½¼æ­¤ä¹‹é–“é€é Message ä¾†æºé€šï¼Œæ”¶åˆ°è¨Šæ¯å¾Œå„è‡ªæ±ºå®šè¦æ¡å–ä»€éº¼æ¨£çš„å°æ‡‰å‹•ä½œï¼Œè€Œæ›´æ”¹çš„éƒ½åªæœƒæ˜¯è‡ªå·±çš„ private stateï¼Œæ²’æœ‰ share memoryï¼Œå½¼æ­¤ä¹‹é–“æ˜¯äº’ç›¸ç¨ç«‹çš„ã€‚</p>\n<p><img src=\"/image/actor-model-system.png\" alt=\"Actor Model system\"></p>\n<p>è€Œåœ¨æ“ä½œä¸Šï¼Œæ¯å€‹ Actor åªè¢«å…è¨±åšä¸‹é¢ä¸‰ç¨® operationï¼š</p>\n<ol>\n<li>å‰µå»ºå¦ä¸€å€‹ Actor</li>\n<li>å‚³é€ Message</li>\n<li>æŒ‡ç¤ºè©²å¦‚ä½•è™•ç†ä¸‹ä¸€å€‹ Message</li>\n</ol>\n<p>å‰é¢å…©ç¨®å¾ˆå¥½ç†è§£ï¼Œä½†ç¬¬ä¸‰å€‹å°±è »æœ‰è¶£çš„äº†ï¼Œèˆ‰ä¾‹ä¾†èªªï¼Œå‡è¨­æœ‰å€‹ Counter Actor Aï¼Œä¸€ç›´ä»¥ä¾†éƒ½æ˜¯æœƒæŠŠæ¥å—åˆ°çš„ Message æ•¸å­—ç´¯åŠ åˆ°è‡ªå·±çš„ counter state ä¸­ï¼Œä½†ä»Šå¤©å¯ä»¥æœ‰å¦ä¸€å€‹ Actor B å‚³éè¨Šæ¯è·Ÿ Actor A èªªï¼šã€hey, ä½ é€™æ¬¡å…ˆä¸ç”¨ç´¯åŠ æ•¸å­—äº†ï¼Œä½†æ˜¯ä¸‹ä¸€å€‹å‚³é€²ä¾†çš„è¨Šæ¯ï¼Œä½ è¦ä¹˜ä»¥ 2 ä»¥å¾Œå†æ”¾åˆ°è¨ˆæ•¸å™¨å…§å–”ã€ã€‚</p>\n<p><img src=\"/image/actor-model-counter.png\" alt=\"Counter example\"></p>\n<p>é€™å€‹ä¸‰å€‹ç‰¹æ€§åˆå†ä¸€èµ·æ™‚ï¼Œæœ‰å€‹å¾ˆå¤§çš„å¥½è™•ï¼šå®¹éŒ¯ç³»çµ±ã€‚</p>\n<p>ä¸€å€‹ Actor å°æ–¼ä»–å‰µå»ºçš„ Actor å¯ä»¥æ“æœ‰ supervisor çš„æ¬Šé™ï¼Œå¯ä»¥å‘Šè¨´å…¶ç®¡æ§çš„ Actor èªªï¼šã€å¦‚æœä½  crash äº†ï¼Œè‡³å°‘æ­»å‰ä¸Ÿçµ¦æˆ‘å€‹è¨Šæ¯è·Ÿæˆ‘èªªã€ï¼Œç„¶å¾Œç•¶ Supervisor Actor æ”¶åˆ° Actor æ­»äº¡è¨Šæ¯æ™‚ï¼Œå¯ä»¥å†å‚³é€ \"restart\" Message å»é‡å•Ÿ Actorï¼Œé€™æ¨£çš„èƒ½åŠ›é€ å°±äº†ä¸€å€‹ Self-healing systemsï¼š</p>\n<p><img src=\"/image/actor-model-fault-tolerance.png\" alt=\"Fault Tolerance System\"></p>\n<p>çœ‹åˆ°é€™é‚Šæœƒç™¼ç¾ï¼Œé›–ç„¶ Actor model æ˜¯å› ç‚º concurrent computation è€Œæå‡ºçš„ï¼Œä½†å…¶ç‰¹æ€§ç”¨åœ¨<strong>åˆ†æ•£å¼ç³»çµ±</strong>ä¸Šä¹Ÿæ˜¯éå¸¸åˆé©çš„ï¼Œæ¯å€‹ Actor è·‘åœ¨ä¸åŒçš„ thread ä¸Šï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥æ˜¯ä¸åŒçš„é ç«¯ç’°å¢ƒä¸Šï¼Œä¸¦é€éçµ±ä¸€å€‹ Message ä»‹é¢æºé€šã€‚</p>\n<h2 id=\"é‹ç”¨åˆ°-web-å‰ç«¯ä¸Š\" style=\"position:relative;\"><a href=\"#%E9%81%8B%E7%94%A8%E5%88%B0-web-%E5%89%8D%E7%AB%AF%E4%B8%8A\" aria-label=\"é‹ç”¨åˆ° web å‰ç«¯ä¸Š permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>é‹ç”¨åˆ° Web å‰ç«¯ä¸Š</h2>\n<p>åœ¨ç€è¦½å™¨çš„ä¸–ç•Œä¸­ï¼Œä¹Ÿæ˜¯å­˜åœ¨æœ‰å¤šç¨® Process èˆ‡ Contextï¼ˆæ¨è–¦é–±è®€ @Mariko çš„é€™ç¯‡<a href=\"https://developers.google.com/web/updates/2018/09/inside-browser-part1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç€è¦½å™¨æ·±å…¥æ·ºå‡ºä»‹ç´¹</a>)ï¼Œåƒæ˜¯è² è²¬æ¸²æŸ“çš„ UI Processï¼Œè€Œåœ¨ DOM å¤–çš„ web worker å‰‡æ˜¯å¦ä¸€å€‹ç¨ç«‹çš„ Worker Processï¼Œå°±æƒ³æ˜¯ä¸€å€‹ç¸®å°ç‰ˆçš„åˆ†æ•£å¼ç³»çµ±ï¼ŒWorker Process æ²’è¾¦æ³•ç›´æ¥å­˜å– UI Process æ‰€æ§åˆ¶çš„ DOM å…ƒä»¶ï¼Œç›¸å°çš„ UI Process ä¹Ÿç„¡æ³•ç›´æ¥å‘¼å« Worker Process ä¸­æ‰€å­˜åœ¨çš„å‡½å¼ã€‚</p>\n<p>ç…§è‘—é€™æ¨£çš„é‚è¼¯æ¢³ç†ä¸‹ä¾†ï¼ŒWeb å‰ç«¯çœŸçš„æ˜¯è »é©åˆå¥—ç”¨ Actor Model çš„ï¼Œå°±åƒæˆ‘å€‘æœ‰å€‹ UI Actor é‹è¡Œåœ¨ UI Processï¼ŒåŒæ™‚è² è²¬æ§åˆ¶ç‹€æ…‹çš„ State Actor é‹è¡Œåœ¨ Worker Processï¼Œå½¼æ­¤ä¹‹é–“é€é Message ä¾†æºé€šã€‚</p>\n<p>é€é Actor Model ä¾†åˆ‡å‰² UI èˆ‡ State çš„é—œä¿‚ï¼Œåªè¦è™•ç†å¾—ç•¶ï¼Œç†è«–ä¸Šæˆ‘å€‘èƒ½å¤ è®“ä¸€å¥—ç›¸åŒå•†æ¥­é‚è¼¯çš„ Web appï¼Œè¼•æ˜“åœ°å¾æ™®é€šçš„ Web è½‰æ›æˆ 3D ç‰ˆæœ¬ï¼Œæˆ–æ˜¯ Web VR ç‰ˆæœ¬ã€‚</p>\n<p>æ›´æ£’çš„æ˜¯ï¼Œå°‡é—œæ³¨é»åˆ†é›¢æˆå„ç¨® Actor å¾Œï¼Œcode splitting è®Šå¾—æ›´è‡ªç„¶æ›´å®¹æ˜“äº†ï¼Œæ¯å€‹ Actor éƒ½èƒ½å¤ åœ¨éœ€è¦çš„æ™‚å€™å†è¼‰å…¥å³å¯ã€‚</p>\n<h2 id=\"web-æ‡‰ç”¨çš„ç¯„ä¾‹\" style=\"position:relative;\"><a href=\"#web-%E6%87%89%E7%94%A8%E7%9A%84%E7%AF%84%E4%BE%8B\" aria-label=\"web æ‡‰ç”¨çš„ç¯„ä¾‹ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web æ‡‰ç”¨çš„ç¯„ä¾‹</h2>\n<p>èªªäº†é€™éº¼å¤šï¼Œä¾†çœ‹é»å¯¦éš›çš„ä¾‹å­ï¼</p>\n<p>æ—¢ç„¶é€™å€‹æ¦‚å¿µæ˜¯ Google engineer åœ¨ä»–å€‘çš„é–‹ç™¼å¤§æœƒå±•ç¤ºçš„ï¼Œå‹¢å¿…æœ‰ Demo code å¯ä»¥çœ‹ï¼Œé€™å¥—å«åš <a href=\"https://github.com/PolymerLabs/actor-boilerplate\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">actor-boilerplate</a> çš„ repository åŒ…å«äº† <a href=\"https://github.com/PolymerLabs/actor-helpers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">actor-helper</a> ä¾†å¹«å¿™ cover äº† Actor Model èˆ‡ Messaging system çš„å¯¦ä½œç´°ç¯€ï¼Œè®“æˆ‘å€‘èƒ½è¼•æ˜“çš„é«”é©— Actor Model é‹ç”¨åœ¨ Web Frontend çš„æ„Ÿè¦ºã€‚</p>\n<p>æˆ‘å€‘åšå€‹ç°¡å–®çš„åŸºç¤ä»£è¬ç‡(BMR)è¨ˆç®—å™¨ä¾†æ„Ÿå—ä¸€ä¸‹ã€‚</p>\n<p>å…ˆçœ‹ä¸€ä¸‹æˆæœï¼š</p>\n<p><img src=\"/image/actor-bmr-demo.gif\" alt=\"bmr calculator - actor model\"></p>\n<p>UI ä¸Šå°±æ˜¯ç°¡å–®å¹¾å€‹ input æ¬„ä½è€Œå·²ï¼ŒæŒ‰ä¸‹æŒ‰éˆ•å¾Œï¼Œå–å‡ºä½¿ç”¨è€…è¼¸å…¥çš„å€¼é€²è¡Œè¨ˆç®—ï¼Œæœ€å¾Œé¡¯ç¤ºçµæœã€‚é€™æ®µæµç¨‹æˆ‘å€‘å¯ä»¥æ‹†åˆ†æˆå…©å€‹ Actor ä¾†å®Œæˆï¼Œåˆ†åˆ¥æ˜¯æ§åˆ¶ UI çš„ <strong>UI Actor</strong> èˆ‡æ›´å‹• State çš„ <strong>State Actor</strong>ã€‚ï¼ˆä»”ç´°çœ‹ä¸Šæ–¹çš„ gif çš„è©±ï¼Œå¯ä»¥çœ‹åˆ° State Actor å…¶å¯¦æ˜¯é‹è¡Œåœ¨ Worker process ä¸Šçš„ã€‚</p>\n<p>æ¥è‘—æˆ‘å€‘å…ˆä¾†çœ‹çœ‹ UI Actor é•·ä»€éº¼æ¨£å­ï¼Œé—œéµçš„ç¨‹å¼ç¢¼åœ¨ä¸‹é¢é€™å¹¾è¡Œï¼ˆé †å¸¶ä¸€æï¼Œå› ç‚º action-boilerplate æœ¬èº«å°±æ˜¯ä»¥ TypeScript å¯¦ä½œï¼Œå› æ­¤æ¥ä¸‹ä¾†ç¯„ä¾‹ä¹Ÿæ˜¯ TypeScriptï¼‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Actor<span class=\"token punctuation\">,</span> lookup <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"actor-helpers/src/actor/Actor.js\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UiActor</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Actor</span><span class=\"token operator\">&lt;</span>Message<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> state <span class=\"token operator\">=</span> <span class=\"token function\">lookup</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"state\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> resultEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> HTMLSpanElement<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token function-variable function\">getInputVal</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// gender</span>\n    <span class=\"token keyword\">const</span> genderEl <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gender\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> HTMLSelectElement<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> genderVal <span class=\"token operator\">=</span> genderEl<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// height, weight, age ä¾æ­¤é¡æ¨...</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      gender<span class=\"token operator\">:</span> genderVal<span class=\"token punctuation\">,</span>\n      height<span class=\"token operator\">:</span> heightVal<span class=\"token punctuation\">,</span>\n      weight<span class=\"token operator\">:</span> weightVal<span class=\"token punctuation\">,</span>\n      age<span class=\"token operator\">:</span> ageVal<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> calculateButton <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"Calculate\"</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> HTMLButtonElement<span class=\"token punctuation\">;</span>\n    calculateButton<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        type<span class=\"token operator\">:</span> StateMessageType<span class=\"token punctuation\">.</span><span class=\"token constant\">CALCULATE</span><span class=\"token punctuation\">,</span>\n        value<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInputVal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">//...ç•¥</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">onMessage</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">msg<span class=\"token operator\">:</span> Message</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>resultEl<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>msg<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>result<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>é¦–å…ˆå¾ <code class=\"language-text\">actor-helpers</code> ä¸­å–å‡º Actor ç‰©ä»¶ä¾†ç¹¼æ‰¿ï¼Œå¯¦ä½œå…©å€‹ä¸»è¦å‡½å¼ï¼š<code class=\"language-text\">init()</code> èˆ‡ <code class=\"language-text\">onMessage()</code>ï¼š</p>\n<ul>\n<li>init()ï¼š\nè² è²¬åœ¨åˆå§‹æ™‚èˆ‡ DOM å…ƒä»¶å»ºç«‹é—œä¿‚ï¼Œç¶å®š event handlerï¼Œç•¶äº‹ä»¶è§¸ç™¼æ™‚å‚³éè¨Šæ¯çµ¦ State Actorã€‚</li>\n<li>onMessage():\nå°±åƒæ˜¯æ¥æ”¶ <code class=\"language-text\">postMessage</code> å‚³é€çš„è¨Šæ¯ä¸€èˆ¬ï¼Œ<code class=\"language-text\">actor-helpers</code> å¹«æˆ‘å€‘ä¸²æ¥å¥½è¨Šæ¯æºé€šé€™æ®µï¼Œåœ¨é€™ <code class=\"language-text\">onMessage()</code> ä¸­ï¼Œå¯ä»¥æ¥æ”¶åˆ°å…¶ä»– Actor å‚³é€éä¾†çš„è¨Šæ¯ã€‚</li>\n</ul>\n<p>åœ¨ <code class=\"language-text\">init()</code> ä¸­çš„ <code class=\"language-text\">this.state</code> æ˜¯ä»€éº¼å‘¢ï¼Ÿç‚ºä»€éº¼ä»–å¯ä»¥ send messageï¼Ÿ</p>\n<p>é‚£æ˜¯æˆ‘å€‘åˆ©ç”¨ <code class=\"language-text\">actor-helpers</code> æä¾›çš„ <code class=\"language-text\">lookup</code> å‡½å¼ï¼Œå°‡ State Actor ç¶å®šåˆ°å‰µå»ºçš„ç§æœ‰è®Šæ•¸ä¸Šï¼Œé€™æ¨£å°±èƒ½ä½¿ç”¨ <code class=\"language-text\">send</code> ä¾†å‚³é€è¨Šæ¯ã€‚</p>\n<p>æ¥è‘—æˆ‘å€‘ä¾†çœ‹çœ‹ State Actorï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Actor<span class=\"token punctuation\">,</span> lookup <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"actor-helpers/src/actor/Actor.js\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// lots of Type definitions...</span>\n<span class=\"token comment\">// ...ç•¥</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">StateActor</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Actor</span><span class=\"token operator\">&lt;</span>Message<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> ui <span class=\"token operator\">=</span> <span class=\"token function\">lookup</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ui\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> state<span class=\"token operator\">:</span> State <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    result<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">onMessage</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">msg<span class=\"token operator\">:</span> Message</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">case</span> MessageType<span class=\"token punctuation\">.</span><span class=\"token constant\">CALCULATE</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n          weight<span class=\"token punctuation\">,</span>\n          height<span class=\"token punctuation\">,</span>\n          age<span class=\"token punctuation\">,</span>\n          gender\n        <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> BMRParams <span class=\"token operator\">=</span> msg<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Do the math</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> bmr<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> MessageType<span class=\"token punctuation\">.</span><span class=\"token constant\">RESET</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      state<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è·Ÿ UI Actor å¤§åŒå°ç•°ï¼Œç¹¼æ‰¿ <code class=\"language-text\">Actor</code> ä¸¦åˆ©ç”¨ <code class=\"language-text\">lookup</code> ç¶å®š UI Actor åˆ°ç§æœ‰è®Šæ•¸ä¸Šï¼Œåœ¨ <code class=\"language-text\">onMessage()</code> ä¸­ï¼Œæ ¹æ“šæ¥æ”¶åˆ°çš„ Message Type ä¾†åŸ·è¡Œå°æ‡‰å‹•ä½œï¼Œä¸¦æ›´æ”¹è‡ªèº«çš„ stateï¼Œå†å°‡ Result Message å‚³å›çµ¦ UI Actorã€‚</p>\n<p>é€é <code class=\"language-text\">action-helps</code>ï¼Œå¯¦ä½œ Actor è®Šå¾—æ–¹ä¾¿è¨±å¤šï¼ˆç•¶ç„¶ä¹Ÿæ˜¯å› ç‚ºé€™æ˜¯å¾ˆç°¡å–®çš„ä¾‹å­...ï¼‰ã€‚</p>\n<p>ä¸éé‚„æ²’çµæŸï¼ŒActor éƒ½æœ‰äº†ä»¥å¾Œï¼Œæˆ‘å€‘è¦æ€éº¼ä½¿ç”¨å‘¢ï¼Ÿ</p>\n<p>æˆ‘å€‘è¦æº–å‚™å…©å€‹ç‰¹æ®Šçš„æª”æ¡ˆï¼Œ<code class=\"language-text\">bootstrap.ts</code> èˆ‡ <code class=\"language-text\">worker.ts</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> hookup<span class=\"token punctuation\">,</span> initializeQueues <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"actor-helpers/src/actor/Actor.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> UiActor <span class=\"token keyword\">from</span> <span class=\"token string\">\"./actors/ui.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">initializeQueues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">hookup</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ui\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UiActor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> worker <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Worker</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"worker.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// This is necessary in Safari to keep the worker alive.</span>\n  <span class=\"token comment\">// ç›¸é—œè¨è«–å¯ä»¥çœ‹ repo å…§çš„ issue https://github.com/PolymerLabs/actor-boilerplate/issues/13</span>\n  <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    worker<span class=\"token punctuation\">.</span><span class=\"token function\">postMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é¡§åæ€ç¾©ï¼Œ<code class=\"language-text\">bootstrap.ts</code> è² è²¬å•Ÿå‹•æ•´å€‹å°ˆæ¡ˆï¼Œé€é <code class=\"language-text\">hookup</code> è¼‰å…¥ UI Actorï¼Œä¸¦ä¸” new å‡ºä¸€å€‹ worker ä¾†é‹è¡Œæˆ‘å€‘çš„ State Actorã€‚</p>\n<p><code class=\"language-text\">initializeQueues</code> ä¸»è¦æ˜¯åœ¨ç¨‹å¼åŸ·è¡Œå‰ï¼Œæ¸…ç©ºç›®å‰ç€è¦½å™¨çš„ Message queueï¼Œè©²å‡½å¼çš„ç¨‹å¼ç¢¼ä¹Ÿå°±ä¸€è¡Œ <code class=\"language-text\">await messageStore.popMessages(\"*\");</code>ã€‚</p>\n<p>è€Œ <code class=\"language-text\">worker.ts</code> çš„å…§å®¹æ›´ç°¡å–®ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> hookup <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"actor-helpers/src/actor/Actor.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> StateActor <span class=\"token keyword\">from</span> <span class=\"token string\">\"./actors/state.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">hookup</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"state\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StateActor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å°±æ˜¯ <code class=\"language-text\">hookup</code> State Actorï¼</p>\n<p>æœ€å¾Œåœ¨ä½ çš„ html ä¸ŠåŠ å…¥ <code class=\"language-text\">bootstrap.ts</code> å³å¯ï¼Œé€™æ¨£æˆ‘å€‘å°±å®Œæˆäº†ä¸€å€‹ä»¥ Actor Model ç‚ºåŸºç¤æ¶æ§‹çš„ Web appï¼</p>\n<p><a href=\"https://github.com/ArvinH/actor-boilerplate\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®Œæ•´ç¨‹å¼ç‘ªå¯å¾æ­¤åƒè€ƒ</a>ã€‚</p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>Actor Model é›–ç„¶æœ‰äº† <code class=\"language-text\">actor-helps</code> çš„å¹«å¿™ï¼Œå¯¦ä½œä¸Šä¾†èªªå·²ç¶“ç°¡æ˜“å¾ˆå¤šï¼Œä½†ä»»ä½•æ“ä½œéƒ½è¦é€é Message çš„å¯¦ä½œæ–¹å¼åœ¨å‰ç«¯æ‡‰ç”¨ä¸Šææ€•é‚„æ˜¯ä¸å¥½è¢«æ¥å—ï¼Œå¯èƒ½ä¹Ÿå› ç‚ºå¦‚æ­¤ï¼Œ<code class=\"language-text\">actor-boilerplate</code> å…¶å¯¦åœ¨å»å¹´ Chrome dev summit çµæŸå¾Œä¼¼ä¹å°±æ²’å†æ›´æ–°äº† XD</p>\n<p>ä¸éæˆ‘å€‹äººæ˜¯è »å–œæ­¡é€™å€‹æƒ³æ³•çš„ï¼Œä¹‹å¾Œæœ‰æ©Ÿæœƒå†ä¾†çœŸçš„å¯¦ä½œä¸€å€‹ä¸åŒ View ä½†ä½¿ç”¨åŒæ¨£ State çš„ Web app çœ‹çœ‹ï¼</p>\n<p>å¦å¤–ï¼Œæˆ‘ä¹Ÿç™¼ç¾åˆ°ï¼ŒWeb worker é›–å­˜åœ¨å·²ä¹…ï¼Œä½†æ˜¯ä½¿ç”¨ä¸Šçš„é™åˆ¶ï¼Œè®“ä¸€èˆ¬æˆ‘å€‘åœ¨é–‹ç™¼ä¸Šå¾ˆå°‘æœƒå»è€ƒæ…®ä»–ï¼Œä½†é€™å¹¾å¹´çœ‹ä¾†ï¼Œåƒæ˜¯ AMP ç­‰ç­‰çš„å‡ºç¾ï¼Œç™¼ç¾ Google ä¼¼ä¹åœ¨æ¨å»£ä¸€å€‹æ¦‚å¿µï¼Œå°±æ˜¯ User experience firstï¼ŒDeveloper experience secondï¼ŒDeveloper æ“…é•·è™•ç†è¤‡é›œçš„äº‹æƒ…ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘å€‘æ‡‰è©²å°ˆæ³¨åœ¨æä¾›ä½¿ç”¨è€…æœ€ä½³ä½¿ç”¨é«”é©—ä¸Šï¼Œè€ŒçŠ§ç‰²ä¸€é»é–‹ç™¼é«”é©—ã€‚</p>\n<p>å¦‚æœä½ çš„ Web app æœ‰è¤‡é›œé‹ç®—çš„éœ€æ±‚ï¼Œå°±è©¦è©¦çœ‹ç”¨ Actor Model ä¾†å°‡è¤‡é›œçš„é‚è¼¯ä¸Ÿçµ¦åœ¨ Worker process çš„ Actor è™•ç†å§ï¼</p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://dassur.ma/things/lights-camera-action/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Lights, Camera, Action!</a></li>\n<li><a href=\"https://github.com/PolymerLabs/actor-boilerplate\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">actor-boilerplate</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=k3ja9I6bGvU\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[COSCUP 2011] Programming for the Future, Introduction to the Actor Model and Akka Framework</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Actor_model\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">wiki - Actor Model</a></li>\n<li><a href=\"https://developers.google.com/web/updates/2018/09/inside-browser-part1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Inside Browser</a></li>\n</ol>","id":"f58e6401-0c27-5e8f-a15e-5d313b471e6a","fields":{"slug":"actor-model-in-web"},"frontmatter":{"date":"2019-06-21T13:37:30.000Z","title":"46 å¹´è€æŠ€è¡“èˆ‡ Web çš„æ–°ç«èŠ± - Actor Model in Web","tags":["web","web worker","google chrome","architecture"],"type":"tech","slug":"actor-model-in-web"},"timeToRead":10},{"excerpt":"ã€çŸ¥è­˜è®Šç¾æ˜¯ä¸€ç›´å­˜åœ¨çš„ï¼Œä½†çœŸæ­£èƒ½è®Šç¾çš„çŸ¥è­˜æ˜¯ â€œèªçŸ¥å·®ç•°â€ã€","html":"<blockquote>\n<p>ã€çŸ¥è­˜è®Šç¾æ˜¯ä¸€ç›´å­˜åœ¨çš„ï¼Œä½†çœŸæ­£èƒ½è®Šç¾çš„çŸ¥è­˜æ˜¯ â€œèªçŸ¥å·®ç•°â€ã€</p>\n</blockquote>\n<!-- more -->\n<h1 id=\"å‰è¨€\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"å‰è¨€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h1>\n<p>éå¹´é™¤èˆŠä½ˆæ–°ï¼Œå‰›å¥½è¶é€™å€‹æ©Ÿæœƒä¾†è¤‡ç¿’ä¸€ä¸‹å·²ç¶“æ˜¯è€è§€å¿µçš„ Virtual DOMã€‚å¾ˆå¤šäººåœ¨è¬›åˆ° React çš„æ™‚å€™éƒ½ä¸€å®šæœƒæåˆ° Virtual DOMï¼Œè€Œå•åˆ° Virtual DOM çš„å¥½è™•æ™‚ï¼Œå°±æœƒèªªåˆ°å¯¦éš› DOM çš„æ“ä½œæˆæœ¬å¾ˆè²´ï¼Œæ‰€ä»¥é€é Virtual DOM å¯ä»¥é™ä½æˆæœ¬ã€‚</p>\n<p>ä½ åœ¨é™¤å¤•é¤æ¡Œä¸Šé€™æ¨£è¬›å¯èƒ½æ²’å•é¡Œï¼Œé¢è©¦åªè¬›é€™æ¨£æ‡‰è©²ä¸å¤ªå¥½ã€‚</p>\n<p>ç•¢ç«Ÿä½ æœ€å¾Œé‚„æ˜¯æœƒæ“ä½œå¯¦é«” DOM å•Šï¼Œé€™æ¨£èªªæ˜å¤ªç°¡åŒ–äº†ã€‚</p>\n<p>Virtual DOM çš„ç”±ä¾†å¯ä»¥å¾ MVC å’Œ MVVM çš„æ¶æ§‹è¿½æº¯èµ·ï¼Œä¸»è¦éƒ½æ˜¯ç‚ºäº†è§£æ±ºå‰ç«¯é é¢å‘ˆç¾ã€è³‡æ–™æ›´å‹•ã€ä½¿ç”¨è€…æ“ä½œé€™ä¸‰ç¨®ç‹€æ…‹äº¤äº’ä½œç”¨ç”¢ç”Ÿçš„è¤‡é›œæ€§ï¼ŒMVC æä¾›äº†ä¸€å€‹è§£æ³•ï¼ŒMVVM æå‡ºçš„ View Model æœ‰äº†å„ªåŒ–çš„æ–¹æ¡ˆï¼Œé‚„æœ‰ data èˆ‡ view é›™å‘ç¶å®šçš„æ–¹å¼ç­‰ç­‰ï¼Œè€Œ React æå‡ºäº†å¦ä¸€ç¨®æ€è·¯ï¼Œä½†é‚£ä¸æ˜¯æˆ‘ä»Šå¤©çš„é‡é»ï¼Œæœ‰èˆˆè¶£ä¸”é‚„ä¸çŸ¥é“é€™äº›åè©æ˜¯ä»€éº¼çš„è®€è€…å¯ä»¥å»æœå°‹çœ‹çœ‹ï¼Œæœ‰å¾ˆå¤šæ–‡ç« åœ¨èªªæ˜é€™äº›è³‡è¨Šèˆ‡æ­·å²ã€‚</p>\n<p>React çš„ Virtual DOM æ˜¯å› æ‡‰å…¶æ•¸æ“šèˆ‡ UI æ›´æ–°ç¹ªè£½çš„ç‰¹æ®Šæ€è·¯è€Œæå‡ºçš„æ•ˆèƒ½è§£æ±ºæ–¹æ¡ˆã€‚</p>\n<p>React å¸Œæœ›åœ¨è³‡æ–™æ›´æ–°æ™‚ï¼Œèƒ½å¤ ç›´æ¥é‡æ–°æ¸²æŸ“é é¢ï¼Œä¸ç”¨ä¸»å‹•å»æ¢ç©¶æ˜¯æ•¸æ“šçš„å“ªéƒ¨ä»½ç™¼ç”Ÿè®ŠåŒ–ï¼Œè¦å°æ‡‰å»æ›´æ–°é é¢å“ªä¸€éƒ¨åˆ†çš„ DOMã€‚ä½†é é¢é‡æ–°æ¸²æŸ“çš„æˆæœ¬å¯æ˜¯æ›´é«˜ï¼Œæ‰€ä»¥æ‰éœ€è¦ Virtual DOM ä½œç‚ºç·©è¡ï¼Œé€éè³‡æ–™æ›´æ–°å¾Œï¼Œé‡æ–°ç¹ªè£½ Virtual DOMï¼Œèˆ‡å¯¦é«” DOM é€²è¡Œ Diffï¼Œæœ€å¾Œå†æŠŠå·®ç•°éƒ¨åˆ† Patch ä¸Šå»ï¼Œé€™ä¸åƒ…ä¿®æ­£äº†é‡æ–°æ¸²æŸ“çš„æˆæœ¬å•é¡Œï¼Œä¹Ÿé™ä½äº† data èˆ‡ view äº¤äº’æ›´æ–°çš„è¤‡é›œåº¦ï¼Œæé«˜äº† developer çš„é–‹ç™¼é«”é©—ã€‚</p>\n<p>èªªäº†é€™éº¼å¤šï¼Œå…¶å¯¦ä»Šå¤©å°±åªæ˜¯å–®ç´”æƒ³è‡ªå·±æ‰‹åˆ»ä¸€å€‹ Virtual DOM ä¾†ç†è§£ä¸€ä¸‹è©²æ€éº¼å¯¦ç¾é€™æ¨£çš„åŠŸèƒ½ï¼Œç•¢ç«ŸçŸ¥é“äº†æ¦‚å¿µï¼Œç¸½è¦ºå¾—æ‰‹åˆ»æ‡‰è©²ä¸é›£ã€‚\næ‰‹åˆ» Virtual DOM å…¶å¯¦ä¹Ÿæ²’ä»€éº¼å¤ªå¤§æ„ç¾©ï¼Œä½†å¾ˆå¤šæ™‚å€™å°±æ˜¯ for funï¼Œç„¶å¾Œåšå€‹è¨˜éŒ„ã€‚</p>\n<p>ä¸»è¦åƒè€ƒè‡³ <a href=\"https://twitter.com/ycmjason\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@ycmjason</a> çš„ <a href=\"https://youtu.be/85gJMUEcnkc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">talk</a> èˆ‡ <a href=\"https://dev.to/ycmjason/building-a-simple-virtual-dom-from-scratch-3d05#mount-node-target\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">blog</a>ï¼Œéå¸¸æ¨è–¦æ¬£è³ï¼Œè¬›è€…çš„ç†±æƒ…å®Œå…¨æ©è“‹æ‰éŸ³è¨Šä¸ä½³çš„ç¼ºé»ï¼Œåˆå¾ˆæ¸…æ¥šåœ°ä»‹ç´¹äº† VDOM å¯¦ä½œã€‚</p>\n<h2 id=\"æ‰€ä»¥virtual-dom-åˆ°åº•é•·ä»€éº¼æ¨£å­\" style=\"position:relative;\"><a href=\"#%E6%89%80%E4%BB%A5virtual-dom-%E5%88%B0%E5%BA%95%E9%95%B7%E4%BB%80%E9%BA%BC%E6%A8%A3%E5%AD%90\" aria-label=\"æ‰€ä»¥virtual dom åˆ°åº•é•·ä»€éº¼æ¨£å­ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ‰€ä»¥ï¼ŒVirtual DOM åˆ°åº•é•·ä»€éº¼æ¨£å­ï¼Ÿ</h2>\n<p>Virtual DOM å°±åªæ˜¯å€‹ javascript plain objectï¼Œä¸¦ä¸”æ¨¡ä»¿ Actual DOM çš„çµæ§‹ï¼ˆä½†ç•¶ç„¶ç°¡åŒ–å¾ˆå¤šï¼‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> vElement <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  tagName<span class=\"token operator\">:</span> <span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span>\n  attrs<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">'v-element'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¸€å€‹åŸºæœ¬çš„ VDOMï¼Œæˆ‘å€‘åªéœ€è¦å…ƒç´ åç¨±ï¼ˆtagNameï¼‰ã€å…ƒç´ å±¬æ€§ï¼ˆattrsï¼‰èˆ‡å…¶ Children listï¼ˆæ—¢ç„¶æ˜¯è™›æ“¬ DOMï¼Œé€™å€‹ plain object è£¡é¢çš„å±¬æ€§å…¶å¯¦éš¨ä¾¿ä½ å–åï¼Œåªè¦å°æ‡‰å¾—åˆ°å¯¦éš› DOM å³å¯ï¼‰ã€‚</p>\n<p>æ ¹æ“šé€™å€‹æƒ³æ³•ï¼Œæˆ‘å€‘å¯ä»¥æ¨¡ä»¿ç¾å­˜çš„ VDOM libï¼Œæä¾›ä¸€å€‹ <code class=\"language-text\">createElement</code> çš„ functionï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jscreateelement.js\"><pre class=\"language-jscreateelement.js\"><code class=\"language-jscreateelement.js\">export default (tagName, { attrs = {}, children = [] }) =&gt; {\n  const vElement = Object.create(null);\n\n  Object.assign(vElement, {\n    tagName,\n    attrs,\n    children,\n  });\n\n  return vElement;\n};</code></pre></div>\n<blockquote>\n<p>Note: åˆ©ç”¨ <code class=\"language-text\">Object.create(null)</code> èˆ‡ <code class=\"language-text\">Object.assign</code> çš„æ–¹å¼ç”¢ç”Ÿç‰©ä»¶ï¼Œå¯ä»¥é¿å…ç›´æ¥æ¡ç”¨ Object literals çš„æ–¹å¼æœƒç¹¼æ‰¿åˆ° object prototype çš„å±¬æ€§ã€‚</p>\n</blockquote>\n<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsmain.js\"><pre class=\"language-jsmain.js\"><code class=\"language-jsmain.js\">import createElement from &#39;./createElement&#39;;\n\nconst vRootApp = createElement(&#39;div&#39;, {\n  attrs: {\n    id: &#39;root&#39;,\n  },\n  children: [\n    createElement(&#39;img&#39;, {\n      attrs: {\n        src: &#39;http://placekitten.com/200/300&#39;,\n      },\n    }),\n  ],\n});\nconsole.log(vRootApp);</code></pre></div>\n<p>çµæœï¼š</p>\n<p><img src=\"/image/vdom-createElement.png\" alt=\"vdom-createElement\"></p>\n<h2 id=\"å¾-virtual-dom-åˆ°-real-dom\" style=\"position:relative;\"><a href=\"#%E5%BE%9E-virtual-dom-%E5%88%B0-real-dom\" aria-label=\"å¾ virtual dom åˆ° real dom permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å¾ Virtual DOM åˆ° Real DOM</h2>\n<p>æœ‰äº† Virtual DOMï¼Œæˆ‘å€‘é‚„éœ€è¦ä¸€å€‹ <code class=\"language-text\">render</code> å‡½æ•¸ä¾†å°‡å…¶ç¹ªè£½åˆ°é é¢ä¸Šã€‚æ–¹æ³•å¾ˆç°¡å–®ï¼Œæˆ‘å€‘åªéœ€è¦ <code class=\"language-text\">document.createElement</code>ã€<code class=\"language-text\">setAttribute</code> èˆ‡ <code class=\"language-text\">appendChild</code> ä¸‰å€‹ web api å³å¯å®Œæˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsrender.js\"><pre class=\"language-jsrender.js\"><code class=\"language-jsrender.js\">const renderElem = ({ tagName, attrs, children }) =&gt; {\n  const elem = document.createElement(tagName);\n  for (const [k, v] of Object.entries(attrs)) {\n    elem.setAttribute(k, v);\n  }\n  for (const child of children) {\n    elem.appendChild(renderElem(child));\n  }\n  return elem;\n};\nexport default renderElem;</code></pre></div>\n<p>æ ¹æ“š <code class=\"language-text\">tagName</code> ä½¿ç”¨ <code class=\"language-text\">document.createElement</code> ä¾†å»ºç«‹å¯¦éš›çš„ DOM ç‰©ä»¶ï¼Œä¸¦ä¸”å°‡ <code class=\"language-text\">attrs</code> ä¸€å€‹ä¸€å€‹ <code class=\"language-text\">setAttribute</code> åˆ°å¯¦éš›çš„ DOM å…ƒç´ ä¸Šï¼›æœ€å¾Œå†å°‡ <code class=\"language-text\">children</code> éè¿´ä¸Ÿå…¥ <code class=\"language-text\">renderElem</code> å‡½æ•¸ä¸­ï¼Œå°‡æ‰€æœ‰å°å­©çš„å¯¦éš› DOM object éƒ½å»ºç«‹å¥½ä¸¦ <code class=\"language-text\">appendChild</code> åˆ°ä¸Šå±¤çš„å¯¦éš› DOM ç‰©ä»¶ä¸Šï¼Œæœ€å¾Œå°‡å®Œæ•´çš„ real DOM object å›å‚³å‡ºå»ã€‚</p>\n<p>ä»¥æ¦‚å¿µä¾†èªªåŸºæœ¬ä¸Šé€™æ¨£å°±å®Œæˆäº†ï¼Œä½†å¯ä»¥è®“ä»–åœ¨å®Œæ•´ä¸€é»ï¼Œæä¾› <code class=\"language-text\">textNode</code> çš„æ”¯æ´ï¼Œåˆ©ç”¨ <code class=\"language-text\">document.createTextNode</code> ä¾†ç”¢ç”Ÿç´” string çš„å…ƒç´ ï¼Œç¨å¾®ä¿®æ”¹ <code class=\"language-text\">render.js</code> å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsrender.js\"><pre class=\"language-jsrender.js\"><code class=\"language-jsrender.js\">const renderElem = ({ tagName, attrs, children }) =&gt; {\n  const elem = document.createElement(tagName);\n  for (const [k, v] of Object.entries(attrs)) {\n    elem.setAttribute(k, v);\n  }\n  for (const child of children) {\n    elem.appendChild(render(child));\n  }\n  return elem;\n};\nconst render = (vNode) =&gt; {\n  if (typeof vNode === &#39;string&#39;) {\n    return document.createTextNode(vNode);\n  }\n  return renderElem(vNode);\n};\nexport default render;</code></pre></div>\n<p>å¾ <code class=\"language-text\">render</code> å‡½æ•¸å›å‚³çš„åŸºæœ¬ä¸Šå°±æœƒæ˜¯ä¸€é¡†å®Œæ•´çš„ Virtual DOM Tree äº†ï¼Œèˆ‰å€‹ä¾‹å­ä¾†çœ‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> createElement <span class=\"token keyword\">from</span> <span class=\"token string\">'./createElement'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> render <span class=\"token keyword\">from</span> <span class=\"token string\">'./render'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> vRootApp <span class=\"token operator\">=</span> <span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  attrs<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'Hello VDOM'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'img'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      attrs<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        src<span class=\"token operator\">:</span> <span class=\"token string\">'http://placekitten.com/200/300'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> rootApp <span class=\"token operator\">=</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>vRootApp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>çµæœå¦‚ä¸‹ï¼ŒVirtual DOM å°±æ˜¯å€‹ Javascript plain objectï¼Œè€Œç¶“ç”± <code class=\"language-text\">render</code> å‡½æ•¸å›å‚³çš„å³æ˜¯åŒ…å«å¯¦éš› DOM å±¬æ€§çš„ Real DOMï¼š</p>\n<p><img src=\"/image/vDom-render-actualDOM.png\" alt=\"Render to real dom\"></p>\n<h3 id=\"æ›åˆ°é é¢ä¸Šå§\" style=\"position:relative;\"><a href=\"#%E6%8E%9B%E5%88%B0%E9%A0%81%E9%9D%A2%E4%B8%8A%E5%90%A7\" aria-label=\"æ›åˆ°é é¢ä¸Šå§ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ›åˆ°é é¢ä¸Šå§ï¼</h3>\n<p>é€é <code class=\"language-text\">render</code> æˆ‘å€‘æœ‰äº†å¯¦é«” DOMï¼Œä½†é€™æ¨£é‚„æ²’è¾¦æ³•åœ¨é é¢ä¸Šé¡¯ç¤ºï¼Œéœ€è¦æœ‰å€‹é¡ä¼¼ <code class=\"language-text\">ReactDOM.render</code> çš„æ–¹æ³•ä¾†å¹«åŠ©æˆ‘å€‘å¯¦ç¾ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsmount.js\"><pre class=\"language-jsmount.js\"><code class=\"language-jsmount.js\">export default (element, targetNode) =&gt; {\n  targetNode.appendChild(element);\n};</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsmain.js\"><pre class=\"language-jsmain.js\"><code class=\"language-jsmain.js\">import createElement from &#39;./createElement&#39;;\nimport render from &#39;./render&#39;;\nimport mount from &#39;./mount&#39;;\n\nconst vRootApp = createElement(&#39;div&#39;, {\n  attrs: {\n    id: &#39;root&#39;,\n  },\n  children: [\n    &#39;Hello VDOM&#39;,\n    createElement(&#39;img&#39;, {\n      attrs: {\n        src: &#39;http://placekitten.com/200/300&#39;,\n      },\n    }),\n  ],\n});\n\nconst rootApp = render(vRootApp);\nmount(rootApp, document.getElementById(&#39;rootApp&#39;));</code></pre></div>\n<p>å¾ˆç°¡å–®ï¼Œå°±æŠŠæˆ‘å€‘ç”¢ç”Ÿçš„ Real DOM <code class=\"language-text\">appendChild</code> åˆ° targetNode ä¸‹å°±å¥½ã€‚</p>\n<p>æˆ–æ˜¯ä¹Ÿèƒ½ç”¨ <code class=\"language-text\">targetNode.replaceWith(element);</code> çš„æ–¹å¼ç›´æ¥å–ä»£æ‰ targetNodeã€‚ï¼ˆä¸éè¦æ³¨æ„ä¸€ä¸‹ IE æ˜¯ç„¡æ³•ä½¿ç”¨çš„å–”ï¼ï¼‰</p>\n<p><img src=\"/image/mount-to-html.png\" alt=\"Mounted DOM\"></p>\n<h1 id=\"diff-virtual-dom---reconciliation\" style=\"position:relative;\"><a href=\"#diff-virtual-dom---reconciliation\" aria-label=\"diff virtual dom   reconciliation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Diff Virtual DOM - Reconciliation</h1>\n<p>çŸ¥é“æ€éº¼ç”¢ç”Ÿ Virtual DOM ä¸¦ç¹ªè£½åˆ°é é¢ä¸Šå¾Œï¼Œä¹Ÿæ˜¯æ™‚å€™é€²å…¥é‡é ­æˆ²äº†ï¼</p>\n<p>å¦‚å‰è¨€æ‰€èªªï¼ŒVirtual DOM ä½œç‚ºæˆ‘å€‘æ“ä½œ Real DOM çš„ä¸€å±¤ç·©è¡ï¼Œæˆ‘å€‘æ¯”è¼ƒç¶“éç‹€æ…‹è®ŠåŒ–å¾Œç”¢ç”Ÿçš„æ–°èˆŠ Virtual DOM ä¾†æ‰¾å‡ºå¯¦éš›éœ€è¦æ›´æ–°çš„ Real DOM ä½ç½®ï¼Œå¦‚æ­¤ä¸€ä¾†ï¼Œå„˜ç®¡æ¯æ¬¡éƒ½é‡æ–° Renderï¼Œå¯¦éš›æ›´æ–°çš„ DOM ä¹Ÿä¸æœƒæ˜¯å…¨éƒ¨ï¼Œå¯ä»¥å¤§å¹…æ”¹å–„ç›´æ¥é‡æ–°æ¸²æŸ“çš„æ•ˆèƒ½å•é¡Œã€‚</p>\n<p>è€Œ tree diff çš„æ¼”ç®—æ³•å…¶å¯¦å¾ˆè¤‡é›œï¼Œå¦‚æœç”¨ <a href=\"https://grfia.dlsi.ua.es/ml/algorithms/references/editsurvey_bille.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Tree Edit Distance</a> çš„æ–¹å¼éè¿´æª¢æŸ¥æ¯å€‹ç¯€é»ï¼Œè¤‡é›œåº¦å°‡å¯é”åˆ° O(n^3)ï¼Œæ˜¯éå¸¸é©šäººçš„æ•¸å­—ï¼Œå¹¾ä¹ç„¡æ³•åœ¨çŸ­æ™‚é–“è™•ç†å®Œï¼Œå› æ­¤ React æ‰€æå‡ºçš„ reconciliation åˆ¶å®šäº†ä¸€äº›ç­–ç•¥ï¼Œä¾†å°‡è¤‡é›œåº¦å¾ O(n^3) é™è‡³ O(n)ã€‚<a href=\"https://reactjs.org/docs/reconciliation.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React å®˜æ–¹æ–‡æª”å…¶å¯¦èªªæ˜å¾—å¾ˆæ¸…æ¥š</a>ã€‚</p>\n<p>ä¸»è¦æœ‰å…©å€‹å‡è¨­ï¼š</p>\n<ol>\n<li>åªéœ€è¦æ¯”è¼ƒåŒä¸€å±¤çš„ç¯€é»ï¼ŒåŒä¸€å±¤å…§çš„å…ƒç´ è‹¥æ“æœ‰ä¸åŒçš„ typeï¼Œå¾€ä¸‹é•·å‡ºçš„æ¨¹å°±æœƒä¸åŒã€‚</li>\n<li>åŒæ¨£ type çš„å…ƒä»¶ï¼Œé–‹ç™¼è€…å¯ä»¥ä½¿ç”¨ <code class=\"language-text\">key</code> é€™å€‹ props ä¾†æ±ºå®šå…¶å­æ¨¹æ˜¯å¦éœ€è¦é‡æ–° renderã€‚</li>\n</ol>\n<p>å¦‚å‡è¨­ä¸€æåŠï¼Œæˆ‘å€‘åªæ¯”è¼ƒæ–°èˆŠå…©æ£µ Virtual DOM Tree ä¸­ï¼ŒåŒå€‹çˆ¶ç¯€é»ä¸‹çš„æ‰€æœ‰å­ç¯€é»ï¼Œè‹¥ç™¼ç¾æŸå€‹ç¯€é»ä¸å­˜åœ¨äº†ï¼Œé‚£å°±æ•´å€‹å­æ¨¹éƒ½æœƒåˆªé™¤ä¸å»é€²ä¸€æ­¥æ¯”è¼ƒã€‚</p>\n<p><img src=\"/image/vdom-level-comparison.png\" alt=\"åªæ¯”åŒ level çš„ node\"></p>\n<p>é€™æ¨£åšçš„æ„æ€å°±æ˜¯èªªï¼Œå¦‚æœä»Šå¤©ç™¼ç”Ÿäº†ä¸€äº›è·¨å±¤ç´šçš„æ“ä½œï¼Œåƒæ˜¯æ•´é¡†å­æ¨¹è¢«æ¬ç§»åˆ°å¦ä¸€å€‹ç¯€é»ä¸Šï¼Œå° React ä¾†èªªï¼Œæœƒæ˜¯åˆªæ‰åŸæœ‰çš„å­æ¨¹ï¼Œç„¶å¾Œé‡æ–°åœ¨æ–°çš„ä½ç½®å»ºç«‹ä¸€æ¨¡ä¸€æ¨£çš„å­æ¨¹å‡ºä¾†ï¼š</p>\n<p><img src=\"/image/vdom-cross-level-modify.png\" alt=\"åˆªæ‰åŸå­æ¨¹ï¼Œåœ¨æ–°ä½ç½®é‡å»º\"></p>\n<blockquote>\n<p>Note: å¯¦éš›ä¸Š React åœ¨é€™å…©å€‹å‡è¨­ä¸‹ï¼Œé‚„åšäº†è¨±å¤šæ›´ç´°ç¯€çš„äº‹æƒ…ï¼ˆcomponent diffã€element diffï¼‰ï¼Œå¯ä»¥å…ˆå»åƒè€ƒé€™ç¯‡å¾ˆä¹…ä¹‹å‰çš„<a href=\"https://zhuanlan.zhihu.com/p/20346379\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ–‡ç« </a>ï¼Œå†å»é–±è®€ <a href=\"https://github.com/acdlite/react-fiber-architecture\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React fiber çš„ä»‹ç´¹</a>ã€‚</p>\n</blockquote>\n<p>åŸºæ–¼é€™å…©å€‹å‡è¨­æˆ‘å€‘å¯ä»¥é–‹å§‹å¯¦ä½œç°¡å–®ç‰ˆçš„ Virtual DOM Diffing æ¼”ç®—æ³•ï¼ŒåŸºæœ¬ä¸Šæœ‰å››å€‹ cases è™•ç†ï¼š</p>\n<ol>\n<li>newTreeRoot ç‚º undefinedï¼Œä¹Ÿå°±æ˜¯æŸå€‹ç¯€é»è¢«åˆªé™¤äº†ã€‚</li>\n<li>å…©å€‹ Node éƒ½æ˜¯ç´”å­—ä¸²ã€‚</li>\n<li>ä¸€å€‹ Node ç‚ºç´”å­—ä¸²ï¼Œä¸€å€‹ Node ç‚º Virtual Elementã€‚</li>\n<li>æ–°èˆŠ TreeRoot çš„ TagName ä¸åŒã€‚</li>\n</ol>\n<p>æ ¹æ“šé€™å››ç¨® cases æˆ‘å€‘å€‹åˆ¥è™•ç†ï¼Œä¸¦ä¸”å›å‚³ä¸€å€‹ <code class=\"language-text\">patch</code> å‡½æ•¸ï¼Œä¾›ä¹‹å¾Œä¾†å°‡ diff å®Œçš„çµæœ attach åˆ° Real DOM ä¸Š ï¼ˆNote: r é–‹é ­çš„éƒ½ä»£è¡¨ Real DOMï¼Œv é–‹é ­ç‚º Virtual DOMï¼‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsdiff.js\"><pre class=\"language-jsdiff.js\"><code class=\"language-jsdiff.js\">import render from &#39;./render&#39;;\nconst diff = (oldVTreeRoot, newVTreeRoot) =&gt; {\n  // å‡è¨­ oldVTreeRoot ä¸€å®šéƒ½å­˜åœ¨ï¼Œåªæœ‰ newVTreeRoot æœ‰æ©Ÿæœƒè¢«åˆªé™¤ï¼Œä¹Ÿå°±æ˜¯ undefined\n  if (newVTreeRoot === undefined) {\n    // å›å‚³ patch å‡½æ•¸ï¼Œæœƒæ¥æ”¶ Real DOMï¼Œé€™é‚Š r é–‹é ­çš„éƒ½ä»£è¡¨ Real DOMï¼Œv é–‹é ­ç‚º Virtual DOM\n    return rNode =&gt; {\n      // å› ç‚ºæ–°çš„ Virtual DOM Tree æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å›å‚³çš„ Patch å‡½å¼å°±æ˜¯ç›´æ¥æŠŠ Real DOM åˆªé™¤ã€‚\n      rNode.remove();\n      return undefined;\n    }\n  }\n  if (typeof oldVTreeRoot === &#39;string&#39; ||\n    typeof newVTreeRoot === &#39;string&#39;) {\n    if (oldVTreeRoot !== newVTreeRoot) {\n      // é€™é‚ŠåŒ…å«å…©ç¨® casesï¼š\n      // Case 1ï¼šæ–°èˆŠ Virtual DOM Tree å…¶ä¸­ä¸€å€‹ç‚º stringï¼Œä¸€å€‹ç‚º Virtual Nodeï¼Œæ‰€ä»¥ç•¶ç„¶æœƒ !==\n      // Case 2ï¼šæ˜¯å…©è€…éƒ½ç‚º stringï¼Œä½† !==\n      // æˆ‘å€‘ç›´æ¥æ ¹æ“šæ–°çš„ Virtual Tree render æ–°çš„ Real Treeï¼Œä¸¦ replace æ‰åŸæœ¬çš„ Real Tree\n      return rNode =&gt; {\n          // å›å‚³ patch å‡½æ•¸\n          const rNewNode = render(newVTreeRoot);\n          rNode.replaceWith(rNewNode);\n          return rNewNode;\n       };\n    } else {\n      // è‹¥éƒ½ç‚º string ä¸”å€¼ç›¸åŒï¼Œé‚£å°±ä¸ç”¨æ”¹ã€‚\n      return rNode =&gt; rNode; // å›å‚³ patch å‡½æ•¸\n    }\n  }\n  if (oldVTreeRoot.tagName !== newVTreeRoot.tagName) {\n    // æ ¹æ“šå„ªåŒ– Tree diffing æ¼”ç®—æ³•çš„å‡è¨­ä¸€ï¼Œåªè¦ tagName ä¸åŒï¼Œæˆ‘å€‘å°±ç›´æ¥é‡æ–° renderã€‚\n    return rNode =&gt; {\n      // å›å‚³ patch å‡½æ•¸\n      const rNewNode = render(newVTreeRoot);\n      rNode.replaceWith(rNewNode);\n      return rNewNode;\n    };\n  }\n  // ...\n};\nexport default diff;</code></pre></div>\n<p>è°æ˜çš„ä½ çœ‹åˆ°é€™é‚Šå°±æœƒç™¼å•äº†ï¼štag name ç›¸åŒçš„ case æ²’æœ‰è™•ç†åˆ°å•Šï¼Ÿ</p>\n<p>æ²’éŒ¯ï¼Œå¦‚æœæ–°èˆŠå…©æ£µ Virtual Tree çš„ tag name éƒ½ä¸€æ¨£ï¼Œé‚£æˆ‘å€‘é‚„å¾—æ¯” attributesï¼Œè€Œè¦æ¯”è¼ƒå…©å€‹ç¯€é»çš„æ‰€æœ‰ attributesï¼Œä¸å¦‚ç›´æ¥ replace ä¸Šæ–°çš„å°±å¥½ã€‚ä½†è¦æ³¨æ„ï¼Œå› ç‚º attributes å¾ˆå¤šï¼Œæ‰€ä»¥æœƒç”¢ç”Ÿå¤šå€‹ patch å‡½æ•¸éœ€è¦è¢« apply åˆ° Real DOM ä¸Šï¼Œæˆ‘å€‘é¡å¤–ç”¨ä¸€å€‹é™£åˆ—æš«å­˜ï¼Œæœ€å¾Œå›å‚³ä¸€å€‹ wrapper patch å‡½æ•¸ï¼ŒæŠŠæ‰€æœ‰æš«å­˜çš„ patch å‡½æ•¸éƒ½ apply åˆ°å‚³é€²ä¾†çš„ Real DOM ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsdiffattrs.js\"><pre class=\"language-jsdiffattrs.js\"><code class=\"language-jsdiffattrs.js\">const diffAttrs = (oldAttrs, newAttrs) =&gt; {\n  // å› ç‚º attributes å¾ˆå¤šï¼Œéœ€è¦ä¸€å€‹ array ä¾†å­˜æ‰€æœ‰éœ€è¦çš„ patch å‡½æ•¸\n  const patches = [];\n  // æ”¾ä¸Šæ–°çš„ attributes\n  for (const [k, v] of Object.entries(newAttrs)) {\n    patches.push(rNode =&gt; {\n      // æš«å­˜ patch å‡½æ•¸\n      rNode.setAttribute(k, v);\n      return rNode;\n    });\n  }\n  // ç§»é™¤èˆŠçš„ attributes\n  for (const k in oldAttrs) {\n    if (!(k in newAttrs)) {\n      patches.push(rNode =&gt; {\n        // æš«å­˜ patch å‡½æ•¸\n        rNode.removeAttribute(k);\n        return rNode;\n      });\n    }\n  }\n  // æœ€å¾Œå‚³å‡ºå»çš„å¤–å±¤ patch å‡½æ•¸\n  return rNode =&gt; {\n    for (const patch of patches) {\n      // æŠŠæ¯å€‹æš«å­˜çš„ patch å‡½æ•¸éƒ½ apply åˆ° Real DOM ä¸Š\n      patch(rNode);\n    }\n    return rNode;\n  };\n};\nexport default diffAttrs;</code></pre></div>\n<p>è™•ç†å®Œ attributes å¾Œï¼Œæˆ‘å€‘é‚„å¾—è€ƒæ…® childrenï¼Œdiff children çš„æ–¹å¼å…¶å¯¦è·Ÿ diff æ•´æ£µæ¨¹ä¸€æ¨£ï¼Œä½†æˆ‘å€‘è¦è€ƒæ…®åˆ°å­æ¨¹çš„é•·åº¦ï¼š</p>\n<ol>\n<li><code class=\"language-text\">oldVChildren.length === newVChildren.length</code>ï¼Œé‚£å°±ç›´æ¥ <code class=\"language-text\">diff(oldVChildren[i], newVchildren[i])</code>ï¼Œi å¾ 0 åˆ° <code class=\"language-text\">oldVChildren.length</code>ã€‚</li>\n<li><code class=\"language-text\">oldVChildren.length > newVChildren.length</code>ï¼Œè·Ÿ case 1 å…¶å¯¦ä¸€æ¨£ï¼Œå› ç‚ºæ–°å­æ¨¹æ¯”è¼ƒå°‘ï¼Œå°±ä»£è¡¨æœ‰ Node è¢«åˆªé™¤ï¼Œåœ¨æˆ‘å€‘åŸæœ¬çš„ diff å‡½å¼ä¸­æœ‰è™•ç†äº†ã€‚</li>\n<li><code class=\"language-text\">oldVChildren.length &lt; newVChildren.length</code>ï¼Œæ–°å­æ¨¹æ¯”è¼ƒé•·ï¼Œé‚£å°±å…ˆæŠŠèˆŠå­æ¨¹çš„æ‰€æœ‰é»å…ˆ update å¥½ï¼Œå†æŠŠå‰©é¤˜çš„æ–°å­æ¨¹ patch ä¸Šå»ã€‚</li>\n</ol>\n<p>å¾ä¸Šè¿°ä¸‰å€‹ cases ä¾†çœ‹ï¼Œæˆ‘å€‘æ©«è±éƒ½éœ€è¦ loop oldVChildren ä¸€æ¬¡ï¼Œæœ€å¾Œè‹¥æœ‰å¤šé¤˜çš„ newVChildren å†æƒ³è¾¦æ³• update ä¸Šå»ã€‚å¦å¤–ï¼Œé€™é‚Šä¸€æ¨£éœ€è¦æš«å­˜å¤šå€‹ patch å‡½æ•¸ï¼Œå¯¦ä½œç´°ç¯€æˆ‘è¨»è§£åœ¨ code è£¡æ¯”è¼ƒæ¸…æ¥šï¼Œæœ€å¾Œå›å‚³çš„ patch å‡½æ•¸æ¯”è¼ƒç‰¹åˆ¥ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsdiffchildren.js\"><pre class=\"language-jsdiffchildren.js\"><code class=\"language-jsdiffchildren.js\">const diffChildren = (oldVChildren, newVChildren) =&gt; {\n  // ç„¡è«–å¦‚ä½•éƒ½ loop é oldVChildren ä¸€æ¬¡ï¼ŒæŠŠæ‰€æœ‰ diff å›å‚³çš„ patch å‡½æ•¸æš«å­˜åœ¨ childrenPatches å…§\n  // é€™æ˜¯ä¸€å®šæœƒ apply åˆ° old tree çš„éƒ¨åˆ†ã€‚\n  const childPatches = [];\n  oldVChildren.forEach((oldVChild, i) =&gt; {\n    childPatches.push(diff(oldVChild, newVChildren[i]));\n  });\n  // æ¥è‘—æˆ‘å€‘çœ‹çœ‹ `newVChildren` æ˜¯å¦æœ‰å¤šé¤˜çš„å­æ¨¹éœ€è¦è™•ç†\n  // è‹¥æœ‰ï¼Œæˆ‘å€‘ç”¢ç”Ÿçš„ patch å‡½æ•¸å°±æ˜¯å–®ç´” `render` å‡º Real Node ä¸¦ä¸”\n  // appendChild åˆ° patch å‚³é€²çš„ Real Node ä¸Šï¼ˆå¯¦éš›è¦è¢« patch çš„ parent ç¯€é»ï¼‰\n  const additionalPatches = [];\n  for (const additionalVChild of newVChildren.slice(oldVChildren.length)) {\n    additionalPatches.push(rNode =&gt; {\n      rNode.appendChild(render(additionalVChild));\n      return rNode;\n    });\n  }\n  return rParent =&gt; {\n    // ç”±æ–¼é€™æ˜¯ children çš„ patchï¼Œåƒé€²ä¾†çš„æœƒæ˜¯ parent çš„ Real DOM\n    // æˆ‘å€‘è¦æŠ“å‡º `rParent.childNodes` ä¾†é‡å° old tree åš patch\n    // zip å‡½æ•¸å…¶å¯¦å°±æ˜¯ lodash çš„ zipï¼Œæˆå°å°‡ childPatches, rParent.childNodes çš„å…ƒç´ ä¸¦æ’å‚³å‡ºï¼Œé€™æ¨£æ¯”è¼ƒç°¡æ½”\n    for (const [patch, rChild] of zip(childPatches, rParent.childNodes)) {\n      patch(rChild);\n    }\n    // æœ€å¾ŒæŠŠ new tree å¤šé¤˜çš„ patches ç›´æ¥ patch åˆ° parent çš„ Real DOM ä¸‹å³å¯ï¼ˆå› ç‚ºæˆ‘å€‘æ˜¯ appendChildï¼‰\n    for (const patch of additionalPatches) {\n      patch(rParent);\n    }\n    return rParent;\n  };\n};</code></pre></div>\n<p>æœ€å¾Œåœ¨æˆ‘å€‘åŸæœ¬çš„ <code class=\"language-text\">diff.js</code> ä¸­çš„æœ€å¾Œé¢åŠ ä¸Šï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsdiff.js\"><pre class=\"language-jsdiff.js\"><code class=\"language-jsdiff.js\">import render from &#39;./render&#39;;\nconst diff = (oldVTreeRoot, newVTreeRoot) =&gt; {\n  if (newVTreeRoot === undefined) {\n    // ....\n  }\n  if (typeof oldVTreeRoot === &#39;string&#39; ||\n    typeof newVTreeRoot === &#39;string&#39;) {\n    if (oldVTreeRoot !== newVTreeRoot) {\n      // ....\n    } else {\n      // ....\n    }\n  }\n  if (oldVTreeRoot.tagName !== newVTreeRoot.tagName) {\n      // ....\n  }\n  const patchAttrs = diffAttrs(oldVTreeRoot.attrs, newVTreeRoot.attrs);\n  const patchChildren = diffChildren(oldVTreeRoot.children, newVTreeRoot.children);\n\n  return rNode =&gt; {\n    patchAttrs(rNode);\n    patchChildren(rNode);\n    return rNode;\n  };\n};\nexport default diff;</code></pre></div>\n<p>å®Œæ•´çš„ diff code å¯ä»¥çœ‹é€™é‚Š <a href=\"https://codesandbox.io/s/434xr5mr84\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">codesandbox</a></p>\n<p>åˆ°é€™é‚Šç‚ºæ­¢ï¼ŒVirtual DOM ç®—æ˜¯å‘Šä¸€æ®µè½äº†ï¼</p>\n<h2 id=\"æœ€å¾Œä¿®æ”¹ä¸‹-mainjsåšé»è®ŠåŒ–è®“å¤§å®¶çœ‹è£½ä½œå‡ºçš„-vdom-æ•ˆæœ\" style=\"position:relative;\"><a href=\"#%E6%9C%80%E5%BE%8C%E4%BF%AE%E6%94%B9%E4%B8%8B-mainjs%E5%81%9A%E9%BB%9E%E8%AE%8A%E5%8C%96%E8%AE%93%E5%A4%A7%E5%AE%B6%E7%9C%8B%E8%A3%BD%E4%BD%9C%E5%87%BA%E7%9A%84-vdom-%E6%95%88%E6%9E%9C\" aria-label=\"æœ€å¾Œä¿®æ”¹ä¸‹ mainjsåšé»è®ŠåŒ–è®“å¤§å®¶çœ‹è£½ä½œå‡ºçš„ vdom æ•ˆæœ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æœ€å¾Œä¿®æ”¹ä¸‹ main.jsï¼Œåšé»è®ŠåŒ–è®“å¤§å®¶çœ‹è£½ä½œå‡ºçš„ VDOM æ•ˆæœ</h2>\n<p>æˆ‘å€‘è®“ <code class=\"language-text\">createVApp</code> æŸ¯é‡ŒåŒ–ï¼Œå¤šå‚³ä¸€å€‹åƒæ•¸ <code class=\"language-text\">count</code> é€²å»æ”¹è®Š attributes è·Ÿåœ–ç‰‡å°ºå¯¸ï¼Œæ¥è‘— <code class=\"language-text\">setInterval</code> è®“æ¯å…©ç§’ç”¢ç”Ÿä¸€å€‹éš¨æ©Ÿæ•¸å­—ç•¶ä½œ <code class=\"language-text\">count</code> å€¼ï¼Œç”¨ä¾† update æˆ‘å€‘çš„ç¯€é»ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsmain.js\"><pre class=\"language-jsmain.js\"><code class=\"language-jsmain.js\">const createVApp = count =&gt; createElement(&#39;div&#39;, {\n  attrs: {\n    id: &#39;root&#39;,\n    dataCount: count, // we use the count here\n  },\n  children: [\n    &#39;Hello Kitty&#39;,\n    createElement(&#39;img&#39;, {\n      attrs: {\n        src: `http://placekitten.com/${count}00/${count}00`,\n      },\n    }),\n  ],\n});\n\nlet vApp = createVApp(0);\nconst rApp = render(vApp);\nlet rRootEl = mount(rApp, document.getElementById(&#39;rootApp&#39;));\nsetInterval(() =&gt; {\n  const n = Math.floor(Math.random() * 10);\n  const vNewApp = createVApp(n);\n  const patch = diff(vApp, vNewApp);\n  // æ¯æ¬¡ patch å®Œå°± assgin å›åŸæœ‰è®Šæ•¸ï¼Œé€™æ¨£ä¸‹å€‹ interval æ‰æœƒæŠ“åˆ°æ›´æ–°çš„æ¨¹\n  rRootEl = patch(rRootEl);\n  vApp = vNewApp;\n}, 2000);</code></pre></div>\n<p>æ•ˆæœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åœ–ç‰‡ä¸€ç›´è®Šå‹•ï¼Œä½†æ˜¯æˆ‘å€‘çœŸçš„åªæ”¹åˆ°äº†éœ€è¦æ”¹çš„ç¯€é»èˆ‡ attributesï¼Œä¸¦ä¸æœƒæ•´å€‹é é¢é‡æ–°åˆ·æ–°ï¼š</p>\n<p><img src=\"/image/vdom-demo.gif\" alt=\"demo\"></p>\n<h2 id=\"çµè«–\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"çµè«– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>çµè«–</h2>\n<p>é›–ç„¶æ²’è¾¦æ³•è·Ÿå¸‚é¢ä¸Šå¯¦éš›çš„ VDOM ç›¸æä¸¦è«–ï¼Œä½†æ˜¯å¾é€™ç°¡å–®çš„å¯¦ä½œå¯ä»¥å¾ˆæ¸…æ¥šçš„çŸ¥é“æ•´å€‹æ¦‚å¿µèˆ‡è¦è§£æ±ºçš„å•é¡Œï¼Œæˆ‘è¦ºå¾—æ˜¯è »ä¸éŒ¯çš„å°ç·´ç¿’ï¼Œæ¥ä¸‹ä¾†å†å»çœ‹ React æˆ–æ˜¯ Vue åœ¨é€™æ–¹é¢çš„å¯¦ä½œæ‡‰è©²æœƒæ¯”è¼ƒæœ‰é ­ç·’ä¸€äº›ï¼\næœ€å¾Œå†é™„ä¸Šä¸€æ¬¡ codesandbox é€£çµè®“æƒ³ç©çš„äººç›´æ¥è©¦è©¦ï¼š<a href=\"https://codesandbox.io/s/434xr5mr84\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">codesandbox</a></p>\n<h2 id=\"è³‡æ–™ä¾†æº\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"è³‡æ–™ä¾†æº permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è³‡æ–™ä¾†æº</h2>\n<ol>\n<li><a href=\"https://youtu.be/85gJMUEcnkc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video: Building a Simple Virtual DOM from Scratch - Jason Yu</a></li>\n<li><a href=\"https://dev.to/ycmjason/building-a-simple-virtual-dom-from-scratch-3d05#mount-node-target\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Blog: Building a Simple Virtual DOM from Scratch - Jason Yu</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/20346379\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React æºç¢¼å‰–æç³»åˆ— ï¼ ä¸å¯æ€è­°çš„ react diff</a></li>\n<li><a href=\"https://github.com/livoras/blog/issues/13\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ·±åº¦å‰–æï¼šå¦‚ä½•å®ç°ä¸€ä¸ª Virtual DOM ç®—æ³•</a></li>\n</ol>","id":"17b2e615-d357-52dc-8e0a-2cd83e9dfcbb","fields":{"slug":"vdom-from-scratch"},"frontmatter":{"date":"2019-02-04T11:19:30.000Z","title":"å¾é ­æ‰“é€ ä¸€å€‹ç°¡å–®çš„ Virtual DOM","tags":["virtual dom","react","javascript","web"],"type":"tech","slug":"vdom-from-scratch"},"timeToRead":13}],"tagName":"web","type":"tech"}},"staticQueryHashes":["2123680655"]}