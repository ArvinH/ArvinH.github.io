{"componentChunkName":"component---src-templates-post-tsx","path":"/tech/practice-animation-on-button","result":{"data":{"markdownRemark":{"html":"<p>製作動畫，人人有責。</p>\n<!-- more -->\n<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<p>疫情升溫，待在家裡救人救己，除了打電動玩健身環外，也是個好機會來培養培養自己的美術能力，然而平常工作沒什麼機會製作動畫的我，即便有了時間，也不知道要從何下手，上了 Dribbble、CodePen 找靈感，的確看到很多有趣的作品，但是大多都很複雜，不像是一個週末午後的休閒良品，例如，<a href=\"https://www.tinydesign.co.uk/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ben Evans</a> 的這個作品：</p>\n<p class=\"codepen\" data-height=\"379\" data-theme-id=\"dark\" data-default-tab=\"result\" data-user=\"ivorjetski\" data-slug-hash=\"xxGYWQG\" data-preview=\"true\" style=\"height: 379px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"Pure CSS Landscape - An Evening in Southwold\">\n  <span>See the Pen <a href=\"https://codepen.io/ivorjetski/pen/xxGYWQG\">\n  Pure CSS Landscape - An Evening in Southwold</a> by Ben Evans (<a href=\"https://codepen.io/ivorjetski\">@ivorjetski</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n<p>這張像是照片一樣的圖片，你能想像是單純用 CSS 製作的嗎？作者有放上他製作這作品的<a href=\"https://youtu.be/rUCVBNNyjC4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">縮時影片</a>（影片的音樂還是他自己做的，真有才華），雖然不知道總共花了多少時間，但以他的另一個同樣驚人且至少花費一百小時的<a href=\"https://codepen.io/ivorjetski/pen/dBYWWZ\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">作品</a>推斷，時數少不到哪去的。</p>\n<p>我知道很多人會覺得，『對呀很酷，但為什麼？』。</p>\n<p>我也不懂為什麼，但知道能利用 CSS 做出這種極限真的很令人感到興奮。光是觀察他的程式碼就可以學到不少技巧，像是：</p>\n<ol>\n<li>Custom HTML tag</li>\n</ol>\n<p>即便是用 CSS 繪圖，相信大部分的人也都是用普通的 <code class=\"language-text\">div</code>、<code class=\"language-text\">span</code> 來組裝圖案，但如果你打開剛剛那範例的 HTML，會看到這樣的結構：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>landscape</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>sky</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>x</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span><span class=\"token punctuation\">></span></span>\n      ...<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>x</span>\n    <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>sky</span>\n  <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>landscape</span>\n<span class=\"token punctuation\">></span></span></code></pre></div>\n<p>全都是 custom element，以為是他自製的 web component 但他又沒有對應的 Javascript？🤔</p>\n<p>其實現今瀏覽器對這種 invalid 的 HTML tag 容忍度很高，只要有給定 CSS，瀏覽器還是能正常渲染出來。實際專案上當然不建議這樣做，但在製作 CSS 繪圖或藝術動畫這類通常擁有複雜 HTML 結構的作品上時，就能讓程式碼看起來簡潔許多，等同於讓 tag name 取代 class name。</p>\n<ol start=\"2\">\n<li>Responsive rem</li>\n</ol>\n<p>我們都知道 <code class=\"language-text\">rem</code> 會隨著 root element 的 font-size 自動調整大小，所以若是我們也能動態調整 root element 的大小，並用 <code class=\"language-text\">rem</code> 來設定所有元素的 size，那就能讓頁面輕鬆 responsive。要做到這點可以利用 <code class=\"language-text\">vmin</code>：</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">html</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1vmin<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">vmin</code> 對應 viewport 的短邊，意即螢幕縮小時，該值也會隨之變小，這樣就能達到我們要的效果。</p>\n<p>其實還有其他技巧，但已經扯夠遠了😅。</p>\n<p>雖然試著理解高手如何做到是能吸收不少經驗，但還是會想要自己動手做點什麼，好在我又發現了另一個稍微平易近人的高手 - <a href=\"https://dribbble.com/ai\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Aaron Iker</a>，他大多的作品都圍繞在一個網頁上不可缺乏，但鮮少被人拿來做文章的元件 - <strong>\"按鈕\"</strong>上。</p>\n<p>按鈕，幾乎所有網頁都會用到它，但就是拿來觸發一些動作，被觸發的動作才是我們在意的，很少會在上頭多作著墨，頂多加個 Hover 變色或位移就很差不多了。</p>\n<p>但看看下面這個<a href=\"https://dribbble.com/shots/14524315-Download-Button\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">實例</a>：</p>\n<p><video width=\"100%\" height=\"315\" controls src=\"https://cdn.dribbble.com/users/414694/screenshots/14524315/media/d4970a372ae0c6b9a4bf8d60c4d5d82f.mp4\"></video></p>\n<p>一點小巧思，瞬間就讓按鈕活了起來。</p>\n<p>而且因為範圍限縮在了按鈕的大小，就算動畫稍微華麗一些也不會對整體頁面造成太多干擾。</p>\n<p>受到 Aaron 啟發，趁著空閒時間我也試著做了一個<a href=\"https://codepen.io/arvin0731/full/dyvvrBb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">按鈕動畫</a>，今天這篇文章就分享一下過程中使用到的工具與眉角！</p>\n<p><video width=\"100%\" height=\"315\" controls src=\"https://i.imgur.com/I27O5GT.mp4\"></video></p>\n<h2 id=\"靈感來源\" style=\"position:relative;\"><a href=\"#%E9%9D%88%E6%84%9F%E4%BE%86%E6%BA%90\" aria-label=\"靈感來源 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>靈感來源</h2>\n<p>這次的按鈕動畫主要修改自 Dribbble 上 <a href=\"https://dribbble.com/yorkun\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">YorKun</a> 的作品 - <a href=\"https://dribbble.com/shots/15522609-Button-Lock-Animation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Button Lock Animation</a>，感謝作者還有附上 Figma 檔案，讓我能更輕鬆的參照 Style。</p>\n<p>不過我並沒有完全照著原作的動畫製作，主要是想多試試一些不同的動畫組合，接下來我會一一介紹。</p>\n<h2 id=\"動畫實作\" style=\"position:relative;\"><a href=\"#%E5%8B%95%E7%95%AB%E5%AF%A6%E4%BD%9C\" aria-label=\"動畫實作 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>動畫實作</h2>\n<p>我一開始想達到的動畫有四項：</p>\n<ol>\n<li>滑動解鎖</li>\n<li>鎖頭開啟與掉落</li>\n<li>對應開鎖狀態的動畫</li>\n<li>鎖頭拖拉時的 2D 物理效果</li>\n</ol>\n<p>理論上應該是很快就能完成，但因為對 GSAP 不熟，花了些冤枉路，導致最後只完成了前三項的效果，算是差強人意。</p>\n<p>用到的工具主要是 <a href=\"https://greensock.com/docs/v3/GSAP/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GSAP</a> 與 GSAP 的 <a href=\"https://greensock.com/draggable/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Draggable plugin</a></p>\n<h3 id=\"滑動解鎖\" style=\"position:relative;\"><a href=\"#%E6%BB%91%E5%8B%95%E8%A7%A3%E9%8E%96\" aria-label=\"滑動解鎖 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>滑動解鎖</h3>\n<p>GSAP 的 <a href=\"https://greensock.com/draggable/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Draggable plugin</a> 真的有夠簡單好用，只要給定想要啟動 Draggable 的 DOM 物件，並指定要拖拉的方向（type）與範圍（bounds），就能瞬間完成這樣的效果（<a href=\"https://codepen.io/arvin0731/pen/JjWWyZG?editors=1010\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">demo 由此去</a>）：</p>\n<p><video width=\"100%\" height=\"315\" controls src=\"https://i.imgur.com/1aL8FNc.mp4\"></video></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 註冊 gsap 的 draggable plugin</span>\ngsap<span class=\"token punctuation\">.</span><span class=\"token function\">registerPlugin</span><span class=\"token punctuation\">(</span>Draggable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 把需要互動的 DOM 用 querySelector 選出來</span>\n<span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".unlock-btn\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> lockerArea <span class=\"token operator\">=</span> button<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".locker\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> dropArea <span class=\"token operator\">=</span> button<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".drop\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 主要的 Draggable instance</span>\nDraggable<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  type<span class=\"token operator\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span>\n  bounds<span class=\"token operator\">:</span> button<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">onDrag</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">onRelease</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">hitTest</span><span class=\"token punctuation\">(</span>dropArea<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      gsap<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        x<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n        ease<span class=\"token operator\">:</span> <span class=\"token string\">\"elastic.out(1, .75)\"</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// this.disable();</span>\n      gsap<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        x<span class=\"token operator\">:</span> dropArea<span class=\"token punctuation\">.</span>offsetLeft <span class=\"token operator\">-</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n        ease<span class=\"token operator\">:</span> <span class=\"token string\">\"elastic.out(1, .8)\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">onUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          tl<span class=\"token punctuation\">.</span><span class=\"token function\">restart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>中間可以看到，我們指定 <code class=\"language-text\">type</code> 為 <code class=\"language-text\">x</code>，表示移動方向為 x 軸，而 <code class=\"language-text\">bounds</code> 為 <code class=\"language-text\">button</code> DOM 物件，所以最多不會拖移超過 butotn 的範圍。</p>\n<p>另外，影片中有一個效果是當你拖拉到前後兩端點的時候，會有一個吸力把拖移中的物件吸過去，這段其實是需要靠額外的兩個動畫效果來達成。</p>\n<p><code class=\"language-text\">Draggable.create()</code> 可以傳入的 Option 中，能指定 <code class=\"language-text\">onDrag</code> 與 <code class=\"language-text\">onRelease</code> handler，在 <code class=\"language-text\">onRelease</code> 的時候我們可以透過 <code class=\"language-text\">this.hitTest(dropArea)</code> 這個 Draggable 內建的函式判斷拖拉中的物件是否觸碰到另一個指定的 DOM 物件，若還沒碰到，我們就拉回到起點，也就是這段所做的事：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">gsap<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  x<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  duration<span class=\"token operator\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n  ease<span class=\"token operator\">:</span> <span class=\"token string\">\"elastic.out(1, .75)\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>透過 <code class=\"language-text\">gsap.to</code> 可以讓指定的 DOM 物件變換到我們傳入的 property 狀態，以此例子來說就是位移到原點，等同於 apply  <code class=\"language-text\">transform:translateX(0)</code>。</p>\n<p>而若觸碰到指定物件，則可以調整 <code class=\"language-text\">x</code> 來將拖移物件直接拉到指定物件，這樣就能製造出<em>吸力</em>的效果。</p>\n<p>此外，在觸碰到物件後的 <code class=\"language-text\">gsap.to</code> 函式中，我們也傳入了 <code class=\"language-text\">onUpdate</code> handler，該 handler 會在動畫完成後被觸發，剛好讓我們能接著下一階段的動畫 - <strong>鎖頭開啟與掉落</strong>。</p>\n<h3 id=\"鎖頭開啟與掉落\" style=\"position:relative;\"><a href=\"#%E9%8E%96%E9%A0%AD%E9%96%8B%E5%95%9F%E8%88%87%E6%8E%89%E8%90%BD\" aria-label=\"鎖頭開啟與掉落 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>鎖頭開啟與掉落</h3>\n<p>當拖移物件觸碰到指定物件時，<code class=\"language-text\">onUpdate</code> 會被觸發：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">onUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  tl<span class=\"token punctuation\">.</span><span class=\"token function\">restart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">onUpdate</code> 中我們放的是一個 <a href=\"https://greensock.com/docs/v3/GSAP/Timeline\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Timeline</code> 物件</a>，它能讓我們進行序列動畫，一步步指定各個物件該如何依序執行動畫。</p>\n<p>由於我是將整個 timeline 動畫定義在別處，所以當 <code class=\"language-text\">onUpdate</code> 被觸發時是呼叫 <code class=\"language-text\">tl.restart()</code>，你也可以直接定義在 handler 裡面。</p>\n<p>Timeline 使用方法一樣簡單：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> tl <span class=\"token operator\">=</span> gsap<span class=\"token punctuation\">.</span><span class=\"token function\">timeline</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> paused<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//create the timeline</span></code></pre></div>\n<p>先創建一個 timeline 物件，這邊傳入 <code class=\"language-text\">{ paused: true }</code> 是因為我希望在之後才觸發他（上述所說，在拖移物件移動到指定區域後才觸發)，所以先預設讓他暫停，這樣我們在 <code class=\"language-text\">onUpdate</code> 時再呼叫 <code class=\"language-text\">restart()</code> 即可。</p>\n<p>題外話，一開始我並不是用 <a href=\"https://greensock.com/docs/v3/GSAP/Timeline\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Timeline</a> 而是在每個 <code class=\"language-text\">gsap.to</code> 的 <code class=\"language-text\">onUpdate</code> 中去呼叫另一個 <code class=\"language-text\">gsap.to</code>，這樣雖然也是可行，但讓程式碼可讀性降低很多，最終我才改成用 <a href=\"https://greensock.com/docs/v3/GSAP/Timeline\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Timeline</a> 來串接序列動畫。</p>\n<p>接著就是針對每個我們想要觸發動畫的 DOM 物件設定欲變化的值：</p>\n<p>先讓整個鎖頭的身體部分往下位移，讓上面鐵環部分保持原地，造出開鎖的效果。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">tl<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerBody<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  y<span class=\"token operator\">:</span> <span class=\"token string\">\"120%\"</span><span class=\"token punctuation\">,</span>\n  duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"/image/button-animation-open-lock.gif\" alt=\"demo\"></p>\n<p>接著利用 <code class=\"language-text\">keyframes</code> 針對單一物件進行一連串較為細緻的動畫，這邊主要是要將整個鎖頭（包含身體與鐵環部分）進行位移與旋轉，營造出鎖頭打開並從鎖上拿掉的動畫：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">tl<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerBody<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/*...略*/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>locker<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    keyframes<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        rotation<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span>\n        x<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n        transformOrigin<span class=\"token operator\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        x<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n        y<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        x<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n        y<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        y<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n        opacity<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"/image/button-animation-drop-locker.gif\" alt=\"demo\"></p>\n<p>接著也是差不多的步驟，一步步對其他的 DOM 物件加上最後的 - <strong>對應開鎖狀態的動畫</strong>，替換掉 <em>UNLOCK</em> 字樣：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">tl<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerBody<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/*...略*/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>locker<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/*...略*/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>lockerArea<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    rotation<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n    duration<span class=\"token operator\">:</span> <span class=\"token number\">0.3</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".message,.drop,.locker-area\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    y<span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n    opacity<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    duration<span class=\"token operator\">:</span> <span class=\"token number\">0.1</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">fromTo</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\".read-ok, .unlock-msg\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      y<span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n      opacity<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      opacity<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      y<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      duration<span class=\"token operator\">:</span> <span class=\"token number\">0.2</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>注意到的是我們除了傳入 DOM object 給 <code class=\"language-text\">gsap.to</code> 與 <code class=\"language-text\">gsap.fromTo</code> 外，也能直接指定 class name，非常方便。</p>\n<p>就這樣簡單幾行程式碼，就做好了一個套用在按鈕上的動畫，應該還算是不錯吧！</p>\n<p class=\"codepen\" data-height=\"369\" data-theme-id=\"29194\" data-default-tab=\"result\" data-user=\"arvin0731\" data-slug-hash=\"dyvvrBb\" style=\"height: 369px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"Drag to unlock button with locker (final ver.)\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/dyvvrBb\">\n  Drag to unlock button with locker (final ver.)</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n<h2 id=\"結論\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"結論 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>結論</h2>\n<p>今天簡單練習了一下從 Dribbble 上找靈感然後用前端技術將動畫實作出來的過程，或許沒有什麼新的東西，但希望能給大家帶來點啟發，防疫期間不妨在家做點有趣的動畫或 CSS art，自娛娛人一下！</p>\n<h2 id=\"資料來源\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"資料來源 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>資料來源</h2>\n<ol>\n<li><a href=\"https://www.tinydesign.co.uk/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ben Evans</a> </li>\n<li><a href=\"https://dribbble.com/ai\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Aaron Iker</a></li>\n<li><a href=\"https://greensock.com/docs/v3/GSAP/gsap.to()\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GSAP</a></li>\n<li><a href=\"https://frontend.horse/articles/realistic-art-with-css/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">frontend.horse</a></li>\n</ol>","fields":{"slug":"practice-animation-on-button"},"frontmatter":{"title":"練習動畫的好選擇 - 按鈕","date":"05-22-2021","tags":["css","gsap","web"]},"timeToRead":9}},"pageContext":{"slug":"practice-animation-on-button","prev":{"excerpt":"最近很迷 Netflix 上的 Formula 1: Drive to Survive，看各家車廠與車手為了爭奪那幾秒的速度而拼盡全力，非常熱血勵志，把這精神延伸到網頁製作上，大概就是要將網頁效能調整到極致，各種能減少 Loading 時間的技巧都得用上。","html":"<p>最近很迷 Netflix 上的 Formula 1: Drive to Survive，看各家車廠與車手為了爭奪那幾秒的速度而拼盡全力，非常熱血勵志，把這精神延伸到網頁製作上，大概就是要將網頁效能調整到極致，各種能減少 Loading 時間的技巧都得用上。</p>\n<!-- more -->\n<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<p>最近公司有個行銷活動需要做一個簡單的 SPA，基本上只有簡單的三個頁面，完全可以利用 Gatsby 或 Nextjs 來製作靜態頁面，然後部署到 CDN 上頭，效能上來說理應足夠好了，但是我們的設計師在頁面上混用了多種的字體，尤其是日文部分，除了一般瀏覽器內建的字體外，某些元件採用額外的免費字體，例如 <a href=\"https://www.freejapanesefont.com/corporate-logo-font-download/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Corporate Logo Font</a>，這代表我們需要額外去下載這些字型，但為了頁面上的幾個字，去下載一整個字型檔案（ttf, 2.6MB）實在很浪費，因此只好來研究一下如何客製化字型檔案，只載入我們需要的字。</p>\n<p>雖然這感覺是個很容易遇到的需求，但我還真的是第一次實際需要處理，感謝同事 Carlos 提供解法，透過這篇文章筆記一下，希望對他人也有點幫助。</p>\n<h3 id=\"開始前先稍稍複習一下什麼是-ttf還有什麼其他字型格式呢\" style=\"position:relative;\"><a href=\"#%E9%96%8B%E5%A7%8B%E5%89%8D%E5%85%88%E7%A8%8D%E7%A8%8D%E8%A4%87%E7%BF%92%E4%B8%80%E4%B8%8B%E4%BB%80%E9%BA%BC%E6%98%AF-ttf%E9%82%84%E6%9C%89%E4%BB%80%E9%BA%BC%E5%85%B6%E4%BB%96%E5%AD%97%E5%9E%8B%E6%A0%BC%E5%BC%8F%E5%91%A2\" aria-label=\"開始前先稍稍複習一下什麼是 ttf還有什麼其他字型格式呢 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>開始前先稍稍複習一下，什麼是 ttf？還有什麼其他字型格式呢？</h3>\n<p><a href=\"https://zh.wikipedia.org/zh-tw/TrueType\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TTF（TrueType Font）</a>是由蘋果和微軟共同開發的一種電腦輪廓字型類型標準，是 Mac 與 Windows 上最常見的格式，基本上所有主流瀏覽器都支援，也是免費或便宜的第三方字體最常提供的格式。缺點是檔案未經過壓縮，文件大小較大。</p>\n<p>另一個主流格式為 <a href=\"https://zh.wikipedia.org/zh-hant/OpenType\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OTF（OpenType Font）</a>，是一種可縮放字型（scalable font）電腦字型類型，由 TrueType 延伸而來，採用 PostScript 格式，是微軟與 Adobe 聯合開發，用來替代 TrueType 字型的新字型。</p>\n<p><a href=\"https://zh.wikipedia.org/wiki/Web%E9%96%8B%E6%94%BE%E5%AD%97%E5%9E%8B%E6%A0%BC%E5%BC%8F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WOFF（Web Open Font Format）</a> 則是完全為了 Web 而設計的格式，由 Mozilla、Microsoft 與 Opera 合作推出。WOFF 的字型都經由 WOFF 的編碼工具壓縮，體積能比 tff 小 40%，現在已經是網頁字體的推薦標準。WOFF2 則是 WOFF 的升級版，體積可以壓得更小。</p>\n<p>最後，當然大家熟悉的 SVG 也可以算是一種。</p>\n<p>在主流的作業系統與瀏覽器上，這幾種格式的支援度都很高，而其主要的細節差異，因為非本篇重點，就不多著墨，有興趣的讀者可以到 wiki 上查看。</p>\n<p>今天要減少的字型檔案為最常見的 tff 格式。</p>\n<p>順帶一提，當我在撰寫文章的時候，對於字型、字體等名詞的差異很模糊，好在 JustFont 在<a href=\"https://blog.justfont.com/2013/02/some_nouns/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">多年前的一篇文章</a>解釋得蠻清楚的，推薦大家理解一下！</p>\n<h2 id=\"setup\" style=\"position:relative;\"><a href=\"#setup\" aria-label=\"setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setup</h2>\n<p>要針對字型進行處理的話，首先我們需要下載 FontForge，FontForge 是一個很有名的軟體，可以用來設計、創建字體，或是進行各種字型相關的操作，可以從 <a href=\"https://fontforge.org/en-US/downloads/mac-dl/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://fontforge.org/en-US/downloads/mac-dl/</a> 下載 Mac 版本（也有 Linux 與 Windows 的版本）。</p>\n<p>在官網上你可以找到許多文件，甚至是一整個 <a href=\"http://designwithfontforge.com/en-US/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ebook</a> 來教你如何用 FontForge 來設計字體。</p>\n<h3 id=\"用-fontforge-開啟原始字型檔\" style=\"position:relative;\"><a href=\"#%E7%94%A8-fontforge-%E9%96%8B%E5%95%9F%E5%8E%9F%E5%A7%8B%E5%AD%97%E5%9E%8B%E6%AA%94\" aria-label=\"用 fontforge 開啟原始字型檔 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>用 FontForge 開啟原始字型檔</h3>\n<p>載好 FontForge 後，我們先打開原始的字型檔，這邊以前面提到的 Corporate Logo Font 為例（註： 在 MacOS Catalina 或 Big Sur，直接點選載好在 Apps 內的 FontForge app 可能會被 OS 擋下來，快一點的方式是<code class=\"language-text\">按右鍵 -> \"Show Package Contents\" -> \"Contents\" -> \"MacOS\"</code>，然後點選 FontForg.app，接者就會打開 terminal 並執行 FontForge。）：</p>\n<p><img src=\"/image/fontforge-corporatelogo-original.png\" alt=\"original-font-file-in-fontforge\"></p>\n<p>開啟後可以看到所有的字圖，接著其實你就可以選取你不要的字圖，然後 <code class=\"language-text\">clear</code> 掉它們：</p>\n<p><img src=\"/image/clear-font.png\" alt=\"clear-font\"></p>\n<p>但照這樣處理，弄到天荒地老六親不認都弄不完。工程師要用更聰明的解法。</p>\n<h2 id=\"正確的姿勢\" style=\"position:relative;\"><a href=\"#%E6%AD%A3%E7%A2%BA%E7%9A%84%E5%A7%BF%E5%8B%A2\" aria-label=\"正確的姿勢 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>正確的姿勢</h2>\n<p>打從一開始，我們就是因為原始字檔裡面太多我們不要的東西，我們需要的很少，才想要從原始檔案中擷取需要的部分，既然如此，就應該從我們<strong>想要的字圖</strong>下手，而不是慢慢刪掉我們不要的字圖。</p>\n<p>FontForge 其實有提供一個很方便的功能，叫做 <code class=\"language-text\">Invert Selection</code>，能夠選取所有<em>你沒有選取到的東西</em>，直接看個動圖範例：</p>\n<p><img src=\"/image/fontforge-invert-select.gif\" alt=\"fontforge-invert-select\"></p>\n<p>這樣一來，就很簡單了，只要選取住你想要的字圖，然後點選 <code class=\"language-text\">Edit -> Select -> Invert Selection</code>，就完成了，接著就把 Fontforge 自動幫你選取的字圖 <code class=\"language-text\">clear</code> 掉即可。</p>\n<p>但這樣還是有個問題。</p>\n<p>字型檔內容這麼多，我要手動在 FontForge 中找到自己想要的字圖不也是找到山窮水盡嗎？</p>\n<h3 id=\"正確姿勢二\" style=\"position:relative;\"><a href=\"#%E6%AD%A3%E7%A2%BA%E5%A7%BF%E5%8B%A2%E4%BA%8C\" aria-label=\"正確姿勢二 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>正確姿勢二</h3>\n<p>FontForge 是個蠻強大的工具，除了 GUI 以外，也提供 interpreters，讓你能撰寫 scripts 來修改字型檔。</p>\n<p>一個 interpreter 是 Python，另一個則是其內建的 scripting language。<a href=\"https://fontforge.org/docs/scripting/scripting.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">詳細的範例、語法等可以從官網查看，文件很完整</a>。</p>\n<p>有了 scripting 的功能，我們就不用自己手動選取字圖啦。</p>\n<p>在 FontForge UI 上，你可以點選 <code class=\"language-text\">File -> Execute Script</code> 叫出 Dialog，可以選擇直接貼上 Python 程式碼，也可以選擇 <code class=\"language-text\">FF -> Call</code>，來載入使用另一個內建 interpreter 的 script file。</p>\n<p><img src=\"/image/fontforge-exec-scripts.gif\" alt=\"fontforge-exec-scripts\"></p>\n<p>因為我們要處理的動作很簡單，只有三個動作（選取字型、反轉選取、刪除），所以直接用內建的 script language 其實比較簡單，可以利用 NodeJS 來產生執行檔。</p>\n<h3 id=\"需要的-api\" style=\"position:relative;\"><a href=\"#%E9%9C%80%E8%A6%81%E7%9A%84-api\" aria-label=\"需要的 api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>需要的 API</h3>\n<p>三個動作，選取字圖、反轉選取、刪除，分別對應的 API 為 <code class=\"language-text\">SelectMore()</code>、<code class=\"language-text\">SelectInvert()</code>、<code class=\"language-text\">DetachAndRemoveGlyphs()</code>。</p>\n<p>我們要匯入進 FontForge 的執行檔，就只需要這三個 API 即可。</p>\n<p><code class=\"language-text\">SelectMore()</code> 用法是傳入字型的 unicode 作為參數，即可選取該字圖，不過執行一次只能選取一個字圖。<code class=\"language-text\">SelectInvert()</code> 與 <code class=\"language-text\">DetachAndRemoveGlyphs()</code> 則不需要參數。</p>\n<h3 id=\"範例程式\" style=\"position:relative;\"><a href=\"#%E7%AF%84%E4%BE%8B%E7%A8%8B%E5%BC%8F\" aria-label=\"範例程式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>範例程式</h3>\n<p>知道了需要的 API，我們就可以來寫程式產生執行檔 <code class=\"language-text\">subset-font.pe</code>，<code class=\"language-text\">.pe</code> 是 FontForge 可以接受的格式，<code class=\"language-text\">.ff</code> 也行：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 挑選出你頁面上需要用到的字</span>\n<span class=\"token keyword\">const</span> characters <span class=\"token operator\">=</span> <span class=\"token string\">'123招待コード'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> stream <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">createWriteStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./subset-font.pe'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nstream<span class=\"token punctuation\">.</span><span class=\"token function\">once</span><span class=\"token punctuation\">(</span><span class=\"token string\">'open'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fd</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  characters<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">char</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 轉換成 16 進位</span>\n    <span class=\"token keyword\">let</span> hex <span class=\"token operator\">=</span> char<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 補零，以符合 \\u 格式</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hex<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      hex <span class=\"token operator\">=</span> hex<span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// 然後執行檔內寫入 SelectMore</span>\n    stream<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">SelectMore(\"u</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>hex<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\")\\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 反轉選擇，選取所有其他不要的字</span>\n  stream<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SelectInvert()\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 最後移除字型</span>\n  stream<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'DetachAndRemoveGlyphs()\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  stream<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>利用 FontForge API 搭配上面程式後，會產生以下內容：</p>\n<div class=\"gatsby-highlight\" data-language=\"shsubset-font.pe\"><pre class=\"language-shsubset-font.pe\"><code class=\"language-shsubset-font.pe\">SelectMore(&quot;u0031&quot;)\nSelectMore(&quot;u0032&quot;)\nSelectMore(&quot;u0033&quot;)\nSelectMore(&quot;u62db&quot;)\nSelectMore(&quot;u5f85&quot;)\nSelectMore(&quot;u30b3&quot;)\nSelectMore(&quot;u30fc&quot;)\nSelectMore(&quot;u30c9&quot;)\nSelectInvert()\nDetachAndRemoveGlyphs()</code></pre></div>\n<p>接著依照<a href=\"#%E6%AD%A3%E7%A2%BA%E5%A7%BF%E5%8B%A2%E4%BA%8C\">正確姿勢二</a>的方式，匯入此執行檔，FontForge 就會產生只包含我們想要的字圖的字型檔了！：</p>\n<p><img src=\"/image/fontforge-script-subset-font.gif\" alt=\"fontforge-script-subset-font.gif\"></p>\n<p>不過因為刪掉的字圖很多，我們可以進一步透過 FontForge 的壓縮功能來輔助我們檢視成品：</p>\n<p>剛執行完 script 後，畫面會停留在 select 所有其他你不要的字圖的狀態，你可以先隨便點選空白處 deselect 所有字圖，然後選擇 <code class=\"language-text\">Encoding -> Compact</code>：</p>\n<p><img src=\"/image/fontforge-compact.gif\" alt=\"fontforge-compact\"></p>\n<p>就能清楚看到整個檔案的確只剩下我們所選的字圖（以上面範例 script 來說就是 <code class=\"language-text\">123招待コード</code>）。</p>\n<p>最後步驟就是產生字型檔案，點選 <code class=\"language-text\">File -> Generate Fonts...</code>，然後看你要 export 成什麼格式，如果是網頁上要用，當然就推薦使用 <code class=\"language-text\">woff</code>：</p>\n<p><img src=\"/image/fontforge-subset-font-generate-file.png\" alt=\"fontforge-subset-font-generate-file\"></p>\n<p>按下 <code class=\"language-text\">Generate</code> 後可能會出現 Error，可以不用理他，繼續 generate：</p>\n<p><img src=\"/image/fontforge-generate-error.png\" alt=\"fontforge-generate-error\"></p>\n<p>這樣就大功告成了！</p>\n<p>（註：關掉 FontForge 時，記得選 <code class=\"language-text\">Don't Save</code>，不然會蓋掉原始的檔案喔！）</p>\n<h2 id=\"結論\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"結論 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>結論</h2>\n<p>這個方式可以用在各種字體檔案，非常方便，對於靜態頁面上內容文字不太會變動的狀況下，利用這個技巧可以大幅降低需要載入的檔案大小，以我公司專案的例子來說，從原本 2.6MB 的 tff 檔案，最後可以變成 8KB 的 woff 檔案，省下的大小很可觀的。</p>\n<p>簡單的筆記，希望對大家有幫助！</p>\n<h2 id=\"資料來源\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"資料來源 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>資料來源</h2>\n<ol>\n<li><a href=\"https://zhuanlan.zhihu.com/p/28179203\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Web 字體簡介: TTF, OTF, WOFF, EOT &#x26; SVG</a></li>\n<li><a href=\"https://stackoverflow.com/questions/35555816/delete-all-unused-characters-from-a-ttf-font-with-fontforge/35754448#35754448\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Delete all unused characters from a TTF-font with Fontforge</a></li>\n<li><a href=\"https://fontforge.org/docs/scripting/scripting.html#\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">fontforge docs</a></li>\n<li><a href=\"https://blog.justfont.com/2013/02/some_nouns/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[but] 雜談 ─ 常常搞混的一些詞</a></li>\n</ol>","id":"50a95194-1c2f-534b-9d86-281727779fe5","fields":{"slug":"make-smaller-ttf-font-files-for-web"},"frontmatter":{"date":"2021-04-23T23:20:17.000Z","title":"透過減少 ttf 字體檔案大小來增進網頁效能","tags":["web","font","performance"],"type":"tech","slug":"make-smaller-ttf-font-files-for-web"},"timeToRead":8},"next":{"excerpt":"chromium 手下留情，別廢掉 SVG SMIL 呀！","html":"<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-additive.svg\" alt=\"animate values attribute demo\">\n</p>\n<p>chromium 手下留情，別廢掉 SVG SMIL 呀！</p>\n<!-- more -->\n<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<p>前幾個禮拜看到 jotai 的作者推文提到 jotai 的 logo 用了 <code class=\"language-text\">animateTransform</code> 來製作動畫（不知道 jotai 的可以看這篇 - <a href=\"https://blog.techbridge.cc/2021/03/01/jotai-intro/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Jōtai 介紹</a>）：</p>\n<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">If you are not familiar with SVG animation, check this out. jotai <a href=\"https://t.co/Zadia8oug7\">https://t.co/Zadia8oug7</a> 👻 logo is using &lt;animateTransform&gt;. <a href=\"https://t.co/vll2SU5f16\">pic.twitter.com/vll2SU5f16</a></p>&mdash; Daishi Kato (@dai_shi) <a href=\"https://twitter.com/dai_shi/status/1401516470882893827?ref_src=twsrc%5Etfw\">June 6, 2021</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<img src=\"https://raw.githubusercontent.com/pmndrs/jotai/master/img/title.svg\" alt=\"jotai logo\">\n<p>(要等一會兒才會出現...如果沒有，可能是 cache 問題，可以點<a href=\"https://raw.githubusercontent.com/pmndrs/jotai/master/img/title.svg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">此</a>開新頁查看。)</p>\n<p>svg 檔案會動不稀奇，像是<a href=\"https://blog.techbridge.cc/2019/11/06/svg-animation-in-10mins/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">十分鐘、五步驟，SVG 動起來！</a>中介紹的，透過第三方套件可以很容易達成，或是用一些繪圖、動畫工具也行，例如：<a href=\"https://app.svgator.com/#/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SVGator</a>，不過這些都得搭配 JavaScript，然而簡單的動畫只要利用 SVG 支援的語法即可達成！</p>\n<p>今天就一起來了解一下，怎麼在不靠其它套件的狀況下，單純的製作 SVG 動畫。</p>\n<h2 id=\"svg-animation-with-smil\" style=\"position:relative;\"><a href=\"#svg-animation-with-smil\" aria-label=\"svg animation with smil permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SVG animation with SMIL</h2>\n<p>能讓 SVG 不靠 JavaScript 與 CSS 就能動起來是因為使用了 <a href=\"https://www.w3.org/TR/REC-smil\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SMIL（Synchronized Multimedia Integration Language）</a>，音同 smile，是 W3C 的標準之一，旨在以 XML 格式提供多媒體的交互表現（白話點其實就是動畫），是 Web 上動畫的開路先鋒，啟發了 Web animation 與 CSS animation。SVG 與 SMIL 的開發團隊合作，讓 SVG 能利用 SMIL 達到如下效果：</p>\n<ul>\n<li>動畫化元素的數值屬性（x, y 值等等)</li>\n<li>動畫化元素的 transform 屬性（平移、旋轉）</li>\n<li>動畫化元素顏色</li>\n<li>軌跡路線移動動畫，類似於 <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/offset-path\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CSS 中的 <code class=\"language-text\">offset-path</code></a></li>\n</ul>\n<p>光是這些特性就夠我們組合出很多種的動畫了，還不需要 JavaScript 與 CSS 的輔助。</p>\n<p>使用方法也不難，只要在 SVG 元素內置入以下四種元素即可操作動畫：</p>\n<ol>\n<li><code class=\"language-text\">&lt;set></code></li>\n<li><code class=\"language-text\">&lt;animate></code></li>\n<li><code class=\"language-text\">&lt;animateTransform></code></li>\n<li><code class=\"language-text\">&lt;animateMotion></code></li>\n</ol>\n<p>接著我們針對這四種元素一一介紹。</p>\n<p>不過在開始前，有個小插曲值得一提。</p>\n<p>SMIL 這個標準其實在 2015 年的時候差點被廢除，因為使用人數少，支援的主流瀏覽器也不多，所以 chromium 工程師本來想要 deprecate 它，順勢推廣 Web animation 與 CSS animation，但在消息公布後，收到了社群很多人的回饋，最終決定暫停廢除計劃，也因此我們到現在都還能使用 SVG SMIL animation，<a href=\"https://caniuse.com/svg-smil\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">主流瀏覽器也都支援</a>了，使用者也從 0.04% 上升到 <a href=\"https://www.chromestatus.com/metrics/feature/timeline/popularity/501\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">1% 以上</a>。</p>\n<p>有興趣的讀者可以回追一下<a href=\"https://groups.google.com/a/chromium.org/g/blink-dev/c/5o0yiO440LM\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">這串討論</a>。</p>\n<h2 id=\"svg-animation-element-介紹與示範\" style=\"position:relative;\"><a href=\"#svg-animation-element-%E4%BB%8B%E7%B4%B9%E8%88%87%E7%A4%BA%E7%AF%84\" aria-label=\"svg animation element 介紹與示範 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SVG animation element 介紹與示範</h2>\n<h3 id=\"set\" style=\"position:relative;\"><a href=\"#set\" aria-label=\"set permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;set></h3>\n<p>利用 <code class=\"language-text\">&lt;set></code> 元素你能夠指定在一段時間後，改變 svg 的一個屬性，例如 2 秒後將 Rick 的眼睛變成往下看：</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-set.svg\" alt=\"set element demo\">\n</p>\n<p>疑？你說他本來就是往下看的？</p>\n<p>那是因為 <code class=\"language-text\">set</code> 不會重複執行，從你載入這篇文章到看到這個位置為止，相信已經超過 2 秒，所以已經是執行後的結果，建議你按右鍵 -> \"在新分頁中開啟圖片\"，實際體驗一下，再不然看看下面的 gif 也行：</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-svg-animation-set.gif\" alt=\"set element demo\">\n</p>\n<p>相關程式碼如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>circle</span> <span class=\"token attr-name\">cx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>56.7573<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>92.8179<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">r</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>set</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>cy<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>105.7318<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2s<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>circle</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>將 <code class=\"language-text\">&lt;set></code> 元素放在你想要套用效果的 svg shape 內即可。</p>\n<p><code class=\"language-text\">attributeName</code> 指定你要更動的屬性；<code class=\"language-text\">to</code> 代表變化值；<code class=\"language-text\">begin</code> 代表從載入後的什麼時候開始執行。</p>\n<p>除了 <code class=\"language-text\">attributeName</code> 外，有另一個參數叫 <code class=\"language-text\">attributeType</code>，用來告訴瀏覽器你要動畫化的屬性值是屬於 <code class=\"language-text\">XML</code>（e.g. <code class=\"language-text\">cy</code>），還是 <code class=\"language-text\">CSS</code>（e.g. <code class=\"language-text\">opacity</code>），不指定的話，瀏覽器會自己猜。不過呢，這個參數也已經 <a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/attributeType\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">deprecated</a> 了，所以實際上我們不再需要它。</p>\n<h3 id=\"animate\" style=\"position:relative;\"><a href=\"#animate\" aria-label=\"animate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;animate></h3>\n<p><code class=\"language-text\">&lt;animate></code> 元素讓你能針對單一屬性變化套用動畫補間效果。用法一樣是放在你想要套用效果的 svg shape 內：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>circle</span> <span class=\"token attr-name\">cx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>56.7573<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>92.8179<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">r</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animate</span>\n      <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>cx<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">from</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>56.7573<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>64.7573<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>circle</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>與 <code class=\"language-text\">&lt;set></code> 相比，多了 <code class=\"language-text\">from</code> 屬性來指定要從哪個值開始做變化，<code class=\"language-text\">dur</code> 指定動畫的執行時間，<code class=\"language-text\">repeatCount</code> 指定要重複幾次，這邊我們設定 <code class=\"language-text\">indefinite</code> 讓他無限重播（若看不到效果請以分頁開新圖片）：</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate.svg\" alt=\"animate element demo\">\n</p>\n<p>利用 <code class=\"language-text\">animate</code>，讓 Rick 的眼睛向右看。</p>\n<p>也可以用來改變顏色：</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-color.svg\" alt=\"animate element color demo\">\n</p>\n<p>也因為可以用來改變顏色，所以本來有個 <code class=\"language-text\">&lt;animateColor></code> 元素就被取代掉了，現在<a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Element/animatecolor\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">已經 deprecated 了</a>。</p>\n<h3 id=\"animatetransform\" style=\"position:relative;\"><a href=\"#animatetransform\" aria-label=\"animatetransform permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;animateTransform></h3>\n<p><code class=\"language-text\">&lt;animateTransform></code> 可以用來控制 <code class=\"language-text\">transform</code> 屬性，用 <code class=\"language-text\">animate</code> 無法做到。跟 CSS 中的 transform 一樣，可以控制 <strong>translation</strong>、<strong>scaling</strong>、<strong>rotation</strong> 跟 <strong>skewing</strong>。</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-transform.svg\" alt=\"animateTransform element demo\">\n</p>\n<p>可以讓 Rick 頭轉起來，看起來頗ㄎㄧㄤ LOL\n（註：經實測，animateTransform 在手機上似乎不支援，請用桌面版瀏覽器查看此範例）</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rotate<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">from</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>360 0 0<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>如上面所述，要控制 <code class=\"language-text\">transform</code> 屬性，所以 <code class=\"language-text\">attributeName=\"transform\"</code>，接著 <code class=\"language-text\">type</code> 參數就看你想要 transform 的類型是什麼，<code class=\"language-text\">rotate</code>、<code class=\"language-text\">scale</code> 都可以。其餘 <code class=\"language-text\">from</code>、<code class=\"language-text\">to</code>、<code class=\"language-text\">begin</code>、<code class=\"language-text\">dur</code>等參數都與之前的相同，用來指定動畫的起始終點值、時間長度與執行次數。</p>\n<h3 id=\"animatemotion\" style=\"position:relative;\"><a href=\"#animatemotion\" aria-label=\"animatemotion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;animateMotion></h3>\n<p>最後一個元素，<code class=\"language-text\">animateMotion</code>，讓 svg 沿著軌跡 <code class=\"language-text\">path</code> 移動（若看不到效果請以分頁開新圖片）：</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-motion.svg\" alt=\"animateMotion element demo\">\n</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!--軌跡--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M10,50 q60,50 100,0 q60,-50 100,0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\">&lt;!-- Rick 飛船 svg--></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateMotion</span>\n    <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M10,50 q60,50 100,0 q60,-50 100,0<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>上述程式碼內的 <code class=\"language-text\">&lt;path></code> 只是為了讓大家看清楚路徑與實際動畫的軌跡無關，實際使用上只要給定 <code class=\"language-text\">animateMotion</code> 一條 <code class=\"language-text\">path</code> 屬性值，包含 <code class=\"language-text\">animateMotion</code> 元素的 svg 就會跟著該路徑移動。</p>\n<p>其他屬性值跟其他元素雷同，不過 <code class=\"language-text\">animateMotion</code> 還有個特別的屬性值 <code class=\"language-text\">rotate</code>，用來指定是否要隨著路徑移動的同時，選轉綁定的 svg 物件，可以設定為 <code class=\"language-text\">auto</code> 或 <code class=\"language-text\">auto-reverse</code>：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateMotion</span>\n  <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M10,50 q60,50 100,0 q60,-50 100,0<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rotate</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>auto<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-motion-rotate.svg\" alt=\"animateMotion element demo\">\n</p>\n<p>此外，除了給定 <code class=\"language-text\">path</code> 屬性值外，其實也能夠利用既有的 <code class=\"language-text\">&lt;path></code> 來當作 <code class=\"language-text\">animateMotion</code> 的路徑，但是得透過 <code class=\"language-text\">mpath</code> 這個 sub-element：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!--軌跡--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>path1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M10,50 q60,50 100,0 q60,-50 100,0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\">&lt;!-- Rick 飛船 svg--></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateMotion</span> <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mpath</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#path1<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>animateMotion</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>要注意的是，若要使用 <code class=\"language-text\">xlink:href</code> 來指定連接的 svg 元素，在你的 <code class=\"language-text\">&lt;svg></code> tag 上得先記得宣告 <code class=\"language-text\">xmlns:xlink=\"http://www.w3.org/1999/xlink\"</code>。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>300<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>200<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 500 300<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>xlink</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/1999/xlink<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>有了 <code class=\"language-text\">xlink:href</code>，我們也就不用像之前範例中所做的一樣，一定得把 <code class=\"language-text\">animate</code> 元素放在要綁定的 svg shape 內，可以透過 <code class=\"language-text\">id</code> 與 <code class=\"language-text\">xlink:href</code> 來連結，例如第一個 <code class=\"language-text\">&lt;set></code> 的範例可改為：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>circle</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>eyes<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>56.7573<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">cy</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>92.8179<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">r</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>black<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stroke-width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>circle</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>set</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#eyes<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>cy<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>105.7318<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>2s<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>至此我們介紹完了四種 SVG animation element，除了個別拿來使用外，這些元素是能夠組合在一起使用的，就只要個別把對應的 animate element 套用在想要的 svg shape 上即可，舉例來說，可以讓 Rick 旋轉的同時，髮色改變、眼睛轉動（可右鍵看 svg 原始碼，在裡面可以找到多個 animate element）：</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-combine.svg\" alt=\"combine animate elements demo\">\n</p>\n<p>（註：經實測，animateTransform 在手機上似乎不支援，請用桌面版瀏覽器查看此範例）</p>\n<h2 id=\"svg-smil-animation-重點參數介紹\" style=\"position:relative;\"><a href=\"#svg-smil-animation-%E9%87%8D%E9%BB%9E%E5%8F%83%E6%95%B8%E4%BB%8B%E7%B4%B9\" aria-label=\"svg smil animation 重點參數介紹 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SVG SMIL animation 重點參數介紹</h2>\n<p>在上面的 Demo 裡面，我們可以發現 SVG animate element 有很多參數可以使用，範例中只用到了一部分，但其實這些參數能設定的值都有不少變化，想要清楚知道每一個參數的用途與範例，推薦參考這篇文章 - <a href=\"https://css-tricks.com/guide-svg-animations-smil/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">A Guide to SVG Animations (SMIL)</a>，不介意簡體中文的話，可以看<a href=\"https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">這篇</a>，都寫得非常好非常詳細。</p>\n<p>在這個章節我會重點介紹一些我覺得比較有趣及實用的參數。</p>\n<h3 id=\"from-to-by-values\" style=\"position:relative;\"><a href=\"#from-to-by-values\" aria-label=\"from to by values permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>from, to, by, values</h3>\n<p><code class=\"language-text\">from</code> 跟 <code class=\"language-text\">to</code> 在前面的範例中都有看到，功能也如同字面般好懂，就是指定動畫變化的移動區間，從（<code class=\"language-text\">from</code>）某個值變化到（<code class=\"language-text\">to</code>）另個值；而 <code class=\"language-text\">by</code> 則是代表位移量，相對於明確告知要變動到哪個值，我們可以用 <code class=\"language-text\">by</code> 告訴 svg 要變動”多少的量“，例如前面 <code class=\"language-text\">animateTransform</code> 的例子，我們可以改為：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rotate<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">from</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">by</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>360<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>10s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>看到這邊你應該會注意到，<code class=\"language-text\">by</code> 跟 <code class=\"language-text\">to</code> 功能上有點重複，所以彼此之間有優先權，如果同時有指定 <code class=\"language-text\">to</code> 與 <code class=\"language-text\">by</code>，則只會套用到 <code class=\"language-text\">to</code> 的值。</p>\n<p>再來看看 <code class=\"language-text\">values</code>，這個剛剛的範例都沒出現，它的功用是來補足 <code class=\"language-text\">from</code>、<code class=\"language-text\">to</code>、<code class=\"language-text\">by</code> 的不足。不足的點在於， <code class=\"language-text\">from</code>、<code class=\"language-text\">to</code>、<code class=\"language-text\">by</code> 只能指定兩個值之間的變化，從 a 變化到 b，而 <code class=\"language-text\">values</code> 可以給定多個值，用分號 <code class=\"language-text\">;</code> 隔開，就能有 a -> b -> c -> b -> a 這樣的變化，舉個例子：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>translate<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">values</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20;120;20<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-values.svg\" alt=\"animate values attribute demo\">\n</p>\n<h3 id=\"begin-end\" style=\"position:relative;\"><a href=\"#begin-end\" aria-label=\"begin end permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>begin, end</h3>\n<p><code class=\"language-text\">begin</code> 跟 <code class=\"language-text\">end</code> 分別用來控制何時開始執行動畫，何時停止動畫，在上面的例子中我們都只用到時間，像是 <code class=\"language-text\">begin=\"2s\"</code>，但其實這兩個參數能給的值有非常多的種類，而且能向 <code class=\"language-text\">values</code> 一樣賦予多個值，只要用 <code class=\"language-text\">;</code> 隔開即可：</p>\n<p><code class=\"language-text\">begin = &lt;offset-value> | &lt;syncbase-value> | &lt;event-value> | &lt;repeat-value> | &lt;accessKey-value> | &lt;wallclock-sync-value></code></p>\n<p>每種類型的詳細介紹，我推薦直接看 <a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/begin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MDN</a>，或是對岸網友的<a href=\"https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">整理</a>，這邊我只說明幾個我覺得比較實用的。</p>\n<p>首先是 <code class=\"language-text\">&lt;syncbase-value></code>。</p>\n<p>從字面有點難懂，主要是用其他 animate 元素的 begin/end 值再做加減，舉個例子就比較好懂：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- Rick head --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>scale<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">values</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1;1.2;1<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ship.end<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3s<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- spaceship --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ship<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>translate<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">values</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20;120;20<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>這次範例中的 svg 內有兩個 animate 元素，給定針對太空船做動畫的元素一個 id 值 <code class=\"language-text\">ship</code>，然後在 Rick 的動畫元素上利用 <code class=\"language-text\">begin=\"ship.end\"</code>，就可以讓 Rick 頭的動畫等到太空船的動畫做完後再啟動，效果如下（這需要麻煩讀者用新分頁開啟圖片來觀看）：</p>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-begin-syncbase.svg\" alt=\"animate begin syncbase demo\">\n</p>\n<p>另一個我覺得實用的值是 <code class=\"language-text\">event-value</code>，看名字就知道，是可以依照 <code class=\"language-text\">event</code> 來啟動或終結動畫，用法與 <code class=\"language-text\">syncbase-value</code> 雷同，給定元素 id，然後根據該元素觸發的事件讓動畫 <code class=\"language-text\">begin</code> 或是 <code class=\"language-text\">end</code>。幾乎所有 DOM element 支援的 event 都能使用，<a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/begin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MDN</a> 有列出所有可用事件。</p>\n<p>一樣舉個例子，點擊 Rick 就能讓太空船移動（礙於 blog 格式，這範例得放在 codepen 上）：</p>\n<p class=\"codepen\" data-height=\"182\" data-theme-id=\"29194\" data-default-tab=\"result\" data-user=\"arvin0731\" data-slug-hash=\"BaWEJpm\" style=\"height: 182px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"SVG SMIL Demo - rick and spaceship\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/BaWEJpm\">\n  SVG SMIL Demo - rick and spaceship</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n<p>程式碼如下，<code class=\"language-text\">rickhead.click</code>（[元素 id].[event]）：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rickhead<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!--// 略 --></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ship<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>translate<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">values</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20;120;20<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rickhead.click<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>最後是 <code class=\"language-text\">indefinite</code>，如果你的 <code class=\"language-text\">begin</code> 值為 <code class=\"language-text\">indefinite</code>，代表無限等待，這時就需要透過 <code class=\"language-text\">[animate 元素].beginElement()</code> 來觸發，或是用 <code class=\"language-text\">&lt;a></code> tag 的 <code class=\"language-text\">xlink:href=\"#[animate 元素 id]\"</code> 來啟動。</p>\n<p class=\"codepen\" data-height=\"189\" data-theme-id=\"29194\" data-default-tab=\"html,result\" data-user=\"arvin0731\" data-slug-hash=\"PopgERE\" style=\"height: 189px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\" data-pen-title=\"SVG SMIL Demo - rick and spaceship - event trigger\">\n  <span>See the Pen <a href=\"https://codepen.io/arvin0731/pen/PopgERE\">\n  SVG SMIL Demo - rick and spaceship - event trigger</a> by Arvin (<a href=\"https://codepen.io/arvin0731\">@arvin0731</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n<h3 id=\"calcmode-keytimes-keysplines\" style=\"position:relative;\"><a href=\"#calcmode-keytimes-keysplines\" aria-label=\"calcmode keytimes keysplines permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>calcMode, keyTimes, keySplines</h3>\n<p>這三個參數主要讓你能夠更細微的調整動畫的速度變化。</p>\n<p><code class=\"language-text\">calcMode</code> 有四種模式：<code class=\"language-text\">discrete</code>、<code class=\"language-text\">linear</code>、<code class=\"language-text\">paced</code>、<code class=\"language-text\">spline</code>。</p>\n<p><strong>discrete</strong> 顧名思義就是離散的，<code class=\"language-text\">from</code> 值跳到 <code class=\"language-text\">to</code> 值不做補間; <strong>linear</strong> 跟 <strong>paced</strong> 我覺得效果雷同，都是讓讓補間動畫的速度維持一致（linear）與平均（paced）; <code class=\"language-text\">spline</code> 則是使用貝式曲線，需要搭配 <code class=\"language-text\">keyTimes</code> 與 <code class=\"language-text\">keySplines</code> 來使用。</p>\n<p><code class=\"language-text\">keyTimes</code> 就是關鍵影格，跟前面提過的 <code class=\"language-text\">values</code> 一樣，可以接受多個以分號區隔的值，定義動畫的關鍵時間點，搭配不同的 <code class=\"language-text\">calcMode</code> 就能在不同的時間點有不同的速度效果。</p>\n<p><code class=\"language-text\">keySpline</code> 是當你 <code class=\"language-text\">calcMode</code> 設定為 <code class=\"language-text\">spline</code> 時，用來定義貝式曲線的四個控制點的。</p>\n<p>這邊直接引用對岸網友精緻的 Demo 頁面給大家參考，用看的會比較清楚好理解：<a href=\"http://www.zhangxinxu.com/study/201408/svg-animation-calcmode.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">calcMode、keyTimes、keySplines 屬性 DEMO</a>。該作者對於 <code class=\"language-text\">keySpline</code> 的值也有<a href=\"https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">畫圖說明</a>，很好懂，有興趣研究的話值得一看。</p>\n<h3 id=\"additive\" style=\"position:relative;\"><a href=\"#additive\" aria-label=\"additive permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>additive</h3>\n<p>看到最後，不知道你會不會有個疑問：如果我想針對同的 SVG shape 的同個屬性做多個連續變化時該怎麼辦？</p>\n<p>例如：透過 <code class=\"language-text\">animateTransform</code> 先將圖案放大再位移。</p>\n<p>這時就要靠 <code class=\"language-text\">additive</code> 這個參數出馬了，<code class=\"language-text\">additive</code> 參數告知 SVG 是否要累加（<code class=\"language-text\">sum</code>）動畫效果，或是取代（<code class=\"language-text\">replace</code>），預設是 <code class=\"language-text\">replace</code>。</p>\n<p>例子：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>scale<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">by</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1.1<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">additive</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sum<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>animateTransform</span> <span class=\"token attr-name\">attributeName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>transform<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rotate<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">from</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 0<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>360 0 0<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">begin</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0s<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">dur</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5s<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">repeatCount</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>indefinite<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">additive</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sum<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p style=\"text-align:center;\">\n  <img src=\"/image/rick-animate-additive.svg\" alt=\"animate values attribute demo\">\n</p>\n<p>（註：經實測，animateTransform 在手機上似乎不支援，請用桌面版瀏覽器查看此範例）</p>\n<h2 id=\"結論\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"結論 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>結論</h2>\n<p>今天花了不小的篇幅介紹了 SVG SMIL animation，感謝看到這邊的各位，製作 Demo 的過程對我來說很有趣，也學習了怎麼繪製 SVG，從網路上的其他資源也查到許多詳細的資料，收穫不少！希望對看到這篇文章的你們也能有所啟發，除了常用的 Web animation 與 CSS animation 外，有機會也試試用 SVG 直接作動畫吧！</p>\n<h3 id=\"資料來源\" style=\"position:relative;\"><a href=\"#%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90\" aria-label=\"資料來源 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>資料來源</h3>\n<ol>\n<li><a href=\"https://www.zhangxinxu.com/wordpress/2014/08/so-powerful-svg-smil-animation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">超级强大的SVG SMIL animation动画详解</a></li>\n<li><a href=\"https://css-tricks.com/guide-svg-animations-smil/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">A Guide to SVG Animations (SMIL)</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/SVG_animation_with_SMIL\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SVG animation with SMIL</a></li>\n<li><a href=\"http://tutorials.jenkov.com/svg/svg-animation.html#set\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SVG Animation</a></li>\n</ol>","id":"d92d1023-e99a-574a-8942-b9f6a51ceb0d","fields":{"slug":"svg-smil-animation-intro"},"frontmatter":{"date":"2021-06-18T08:56:40.000Z","title":"讓 SVG 自己動起來！ SVG SMIL Animation 介紹","tags":["web","svg","animation","smil"],"type":"tech","slug":"svg-smil-animation-intro"},"timeToRead":14},"type":"tech"}},"staticQueryHashes":["2123680655"]}